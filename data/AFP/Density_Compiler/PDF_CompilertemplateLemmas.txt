   [("PDF_Compiler.eq_i_oI",
     "Predicate.eq ?x ?xa ==> pred.eval (eq_i_o ?x) ?xa",
     template_implication
      ([template_predicate
         (
            template_app
             (template_app (template_hole 2, template_var 1),
              template_var 0)
            )],
       template_predicate
        (
           template_app
            (template_app
              (template_hole 1,
               template_app (template_hole 0, template_var 1)),
             template_var 0)
           ))),
    ("PDF_Compiler.eq_o_iI",
     "Predicate.eq ?x ?xa ==> pred.eval (eq_o_i ?xa) ?x",
     template_implication
      ([template_predicate
         (
            template_app
             (template_app (template_hole 2, template_var 1),
              template_var 0)
            )],
       template_predicate
        (
           template_app
            (template_app
              (template_hole 1,
               template_app (template_hole 0, template_var 0)),
             template_var 1)
           ))),
    ("PDF_Compiler.eq_i_iI",
     "Predicate.eq ?x ?xa ==> pred.eval (eq_i_i ?x ?xa) ()",
     template_implication
      ([template_predicate
         (
            template_app
             (template_app (template_hole 3, template_var 1),
              template_var 0)
            )],
       template_predicate
        (
           template_app
            (template_app
              (template_hole 2,
               template_app
                (template_app (template_hole 1, template_var 1),
                 template_var 0)),
             template_hole 0)
           ))),
    ("PDF_Compiler.expr_compiles_to_sound",
     "?e : ?t \<Rightarrow>\<^sub>c ?f ==> ?\<Gamma> \<turnstile> ?e : ?t",
     template_implication
      ([template_predicate
         (
            template_app
             (template_app
               (template_app (template_hole 1, template_var 3),
                template_var 2),
              template_var 1)
            )],
       template_predicate
        (
           template_app
            (template_app
              (template_app (template_hole 0, template_var 0),
               template_var 3),
             template_var 2)
           ))),
    ("PDF_Compiler.expr_compiles_to_i_o_iI",
     "?x : ?xa \<Rightarrow>\<^sub>c ?xb ==>
      pred.eval (expr_compiles_to_i_o_i ?x ?xb) ?xa",
     template_implication
      ([template_predicate
         (
            template_app
             (template_app
               (template_app (template_hole 2, template_var 2),
                template_var 1),
              template_var 0)
            )],
       template_predicate
        (
           template_app
            (template_app
              (template_hole 1,
               template_app
                (template_app (template_hole 0, template_var 2),
                 template_var 0)),
             template_var 1)
           ))),
    ("PDF_Compiler.expr_compiles_to_i_i_oI",
     "?x : ?xa \<Rightarrow>\<^sub>c ?xb ==>
      pred.eval (expr_compiles_to_i_i_o ?x ?xa) ?xb",
     template_implication
      ([template_predicate
         (
            template_app
             (template_app
               (template_app (template_hole 2, template_var 2),
                template_var 1),
              template_var 0)
            )],
       template_predicate
        (
           template_app
            (template_app
              (template_hole 1,
               template_app
                (template_app (template_hole 0, template_var 2),
                 template_var 1)),
             template_var 0)
           ))),
    ("PDF_Compiler.expr_has_density_cexpr_Piiii_i_oI",
     "?x \<turnstile>\<^sub>c ?xa \<Rightarrow> ?xb ==>
      pred.eval (expr_has_density_cexpr_Piiii_i_o ?x ?xa) ?xb",
     template_implication
      ([template_predicate
         (
            template_app
             (template_app
               (template_app (template_hole 2, template_var 2),
                template_var 1),
              template_var 0)
            )],
       template_predicate
        (
           template_app
            (template_app
              (template_hole 1,
               template_app
                (template_app (template_hole 0, template_var 2),
                 template_var 1)),
             template_var 0)
           ))),
    ("PDF_Compiler.expr_typing_i_i_oI",
     "?x \<turnstile> ?xa : ?xb ==>
      pred.eval (expr_typing_i_i_o ?x ?xa) ?xb",
     template_implication
      ([template_predicate
         (
            template_app
             (template_app
               (template_app (template_hole 2, template_var 2),
                template_var 1),
              template_var 0)
            )],
       template_predicate
        (
           template_app
            (template_app
              (template_hole 1,
               template_app
                (template_app (template_hole 0, template_var 2),
                 template_var 1)),
             template_var 0)
           ))),
    ("PDF_Compiler_Pred.prob_space_empty_dens_ctxt",
     "prob_space
       (dens_ctxt_measure ({}, {}, ?\<Gamma>, %_. 1) (%_. undefined))",
     template_predicate
      (
         template_app
          (template_hole 7,
           template_app
            (template_app
              (template_hole 6,
               template_app
                (template_app (template_hole 5, template_hole 4),
                 template_app
                  (template_app (template_hole 3, template_hole 4),
                   template_app
                    (template_app (template_hole 2, template_var 0),
                     t_empty)))),
             t_empty))
         )),
    ("PDF_Compiler.expr_compiles_to_sound",
     "?e : ?t \<Rightarrow>\<^sub>c ?f ==> free_vars ?f <= {0}",
     template_implication
      ([template_predicate
         (
            template_app
             (template_app
               (template_app (template_hole 5, template_var 2),
                template_var 1),
              template_var 0)
            )],
       template_inequation
        (less_equals, template_app (template_hole 3, template_var 0),
         template_app
          (template_app (template_hole 2, template_hole 1),
           template_hole 0)))),
    ("PDF_Compiler.expr_compiles_to_sound",
     "?e : ?t \<Rightarrow>\<^sub>c ?f ==>
      case_nat ?t ?\<Gamma>' \<turnstile>\<^sub>c ?f : REAL",
     template_implication
      ([template_predicate
         (
            template_app
             (template_app
               (template_app (template_hole 3, template_var 3),
                template_var 2),
              template_var 1)
            )],
       template_predicate
        (
           template_app
            (template_app
              (template_app
                (template_hole 2,
                 template_app
                  (template_app (template_hole 1, template_var 2),
                   template_var 0)),
               template_var 1),
             template_hole 0)
           ))),
    ("PDF_Compiler.expr_compiles_to_i_o_oI",
     "?x : ?xa \<Rightarrow>\<^sub>c ?xb ==>
      pred.eval (expr_compiles_to_i_o_o ?x) (?xa, ?xb)",
     template_implication
      ([template_predicate
         (
            template_app
             (template_app
               (template_app (template_hole 3, template_var 2),
                template_var 1),
              template_var 0)
            )],
       template_predicate
        (
           template_app
            (template_app
              (template_hole 2,
               template_app (template_hole 1, template_var 2)),
             template_app
              (template_app (template_hole 0, template_var 1),
               template_var 0))
           ))),
    ("PDF_Compiler.expr_compiles_to_i_i_iI",
     "?x : ?xa \<Rightarrow>\<^sub>c ?xb ==>
      pred.eval (expr_compiles_to_i_i_i ?x ?xa ?xb) ()",
     template_implication
      ([template_predicate
         (
            template_app
             (template_app
               (template_app (template_hole 3, template_var 2),
                template_var 1),
              template_var 0)
            )],
       template_predicate
        (
           template_app
            (template_app
              (template_hole 2,
               template_app
                (template_app
                  (template_app (template_hole 1, template_var 2),
                   template_var 1),
                 template_var 0)),
             template_hole 0)
           ))),
    ("PDF_Compiler.expr_has_density_cexpr_Piiii_i_iI",
     "?x \<turnstile>\<^sub>c ?xa \<Rightarrow> ?xb ==>
      pred.eval (expr_has_density_cexpr_Piiii_i_i ?x ?xa ?xb) ()",
     template_implication
      ([template_predicate
         (
            template_app
             (template_app
               (template_app (template_hole 3, template_var 2),
                template_var 1),
              template_var 0)
            )],
       template_predicate
        (
           template_app
            (template_app
              (template_hole 2,
               template_app
                (template_app
                  (template_app (template_hole 1, template_var 2),
                   template_var 1),
                 template_var 0)),
             template_hole 0)
           ))),
    ("PDF_Compiler.expr_typing_i_i_iI",
     "?x \<turnstile> ?xa : ?xb ==>
      pred.eval (expr_typing_i_i_i ?x ?xa ?xb) ()",
     template_implication
      ([template_predicate
         (
            template_app
             (template_app
               (template_app (template_hole 3, template_var 2),
                template_var 1),
              template_var 0)
            )],
       template_predicate
        (
           template_app
            (template_app
              (template_hole 2,
               template_app
                (template_app
                  (template_app (template_hole 1, template_var 2),
                   template_var 1),
                 template_var 0)),
             template_hole 0)
           ))),
    ("PDF_Compiler_Pred.branch_prob_empty_ctxt",
     "branch_prob ({}, {}, ?\<Gamma>, %_. 1) (%_. undefined) = 1",
     template_equation
      (template_app
        (template_app
          (template_hole 6,
           template_app
            (template_app (template_hole 5, template_hole 4),
             template_app
              (template_app (template_hole 3, template_hole 4),
               template_app
                (template_app (template_hole 2, template_var 0),
                 t_empty)))),
         t_empty),
       template_hole 1)),
    ("PDF_Compiler_Pred.expr_has_density_intros",
     "(?V, ?V', ?\<Gamma>, ?\<delta>) \<turnstile>\<^sub>d
       Fail ?t \<Rightarrow> (%_ _. 0)",
     template_predicate
      (
         template_app
          (template_app
            (template_app
              (template_hole 5,
               template_app
                (template_app (template_hole 4, template_var 4),
                 template_app
                  (template_app (template_hole 3, template_var 3),
                   template_app
                    (template_app (template_hole 2, template_var 2),
                     template_var 1)))),
             template_app (template_hole 1, template_var 0)),
           t_empty)
         )),
    ("PDF_Compiler.nonneg_cexpr_shift_iff",
     "nonneg_cexpr (shift_var_set ?V) (case_nat ?t ?\<Gamma>)
       (map_vars Suc ?e) =
      nonneg_cexpr ?V ?\<Gamma> ?e",
     template_equation
      (template_app
        (template_app
          (template_app
            (template_hole 4,
             template_app (template_hole 3, template_var 3)),
           template_app
            (template_app (template_hole 2, template_var 2),
             template_var 1)),
         template_app
          (template_app (template_hole 1, template_hole 0),
           template_var 0)),
       template_app
        (template_app
          (template_app (template_hole 4, template_var 3), template_var 1),
         template_var 0))),
    ("PDF_Compiler_Pred.restrict_state_measure",
     "(%x. restrict x ?V')
      : state_measure (?V Un ?V') ?\<Gamma> \<rightarrow>\<^sub>M
        state_measure ?V' ?\<Gamma>",
     template_predicate
      (
         template_app
          (template_app (template_hole 4, t_empty),
           template_app
            (template_app
              (template_hole 2,
               template_app
                (template_app
                  (template_hole 1,
                   template_app
                    (template_app (template_hole 0, template_var 1),
                     template_var 2)),
                 template_var 0)),
             template_app
              (template_app (template_hole 1, template_var 2),
               template_var 0)))
         )),
    ("PDF_Compiler.eq_i_oE",
     "[| pred.eval (eq_i_o ?x) ?xa; Predicate.eq ?x ?xa ==> ?P |] ==> ?P",
     template_implication
      ([template_predicate
         (
            template_app
             (template_app
               (template_hole 2,
                template_app (template_hole 1, template_var 2)),
              template_var 1)
            ),
        template_implication
         ([template_predicate
            (
               template_app
                (template_app (template_hole 0, template_var 2),
                 template_var 1)
               )],
          template_predicate (template_var 0))],
       template_predicate (template_var 0))),
    ("PDF_Compiler.eq_o_iE",
     "[| pred.eval (eq_o_i ?xa) ?x; Predicate.eq ?x ?xa ==> ?P |] ==> ?P",
     template_implication
      ([template_predicate
         (
            template_app
             (template_app
               (template_hole 2,
                template_app (template_hole 1, template_var 2)),
              template_var 1)
            ),
        template_implication
         ([template_predicate
            (
               template_app
                (template_app (template_hole 0, template_var 1),
                 template_var 2)
               )],
          template_predicate (template_var 0))],
       template_predicate (template_var 0))),
    ("PDF_Compiler.expr_compiles_to_sound",
     "?e : ?t \<Rightarrow>\<^sub>c ?f ==>
      ALL x:type_universe ?t. 0 <= eval_cexpr ?f ?\<sigma>' x",
     template_implication
      ([template_predicate
         (
            template_app
             (template_app
               (template_app (template_hole 5, template_var 3),
                template_var 2),
              template_var 1)
            )],
       template_predicate
        (
           template_app
            (template_app
              (template_hole 4,
               template_app (template_hole 3, template_var 2)),
             t_empty)
           ))),
    ("PDF_Compiler.eq_i_iE",
     "[| pred.eval (eq_i_i ?x ?xa) ?y; Predicate.eq ?x ?xa ==> ?P |]
      ==> ?P",
     template_implication
      ([template_predicate
         (
            template_app
             (template_app
               (template_hole 2,
                template_app
                 (template_app (template_hole 1, template_var 3),
                  template_var 2)),
              template_var 1)
            ),
        template_implication
         ([template_predicate
            (
               template_app
                (template_app (template_hole 0, template_var 3),
                 template_var 2)
               )],
          template_predicate (template_var 0))],
       template_predicate (template_var 0))),
    ("PDF_Compiler.expr_compiles_to_i_o_iE",
     "[| pred.eval (expr_compiles_to_i_o_i ?x ?xb) ?xa;
         ?x : ?xa \<Rightarrow>\<^sub>c ?xb ==> ?P |]
      ==> ?P",
     template_implication
      ([template_predicate
         (
            template_app
             (template_app
               (template_hole 2,
                template_app
                 (template_app (template_hole 1, template_var 3),
                  template_var 2)),
              template_var 1)
            ),
        template_implication
         ([template_predicate
            (
               template_app
                (template_app
                  (template_app (template_hole 0, template_var 3),
                   template_var 1),
                 template_var 2)
               )],
          template_predicate (template_var 0))],
       template_predicate (template_var 0))),
    ("PDF_Compiler.expr_typing_i_i_oE",
     "[| pred.eval (expr_typing_i_i_o ?x ?xa) ?xb;
         ?x \<turnstile> ?xa : ?xb ==> ?P |]
      ==> ?P",
     template_implication
      ([template_predicate
         (
            template_app
             (template_app
               (template_hole 2,
                template_app
                 (template_app (template_hole 1, template_var 3),
                  template_var 2)),
              template_var 1)
            ),
        template_implication
         ([template_predicate
            (
               template_app
                (template_app
                  (template_app (template_hole 0, template_var 3),
                   template_var 2),
                 template_var 1)
               )],
          template_predicate (template_var 0))],
       template_predicate (template_var 0))),
    ("PDF_Compiler.expr_compiles_to_i_i_oE",
     "[| pred.eval (expr_compiles_to_i_i_o ?x ?xa) ?xb;
         ?x : ?xa \<Rightarrow>\<^sub>c ?xb ==> ?P |]
      ==> ?P",
     template_implication
      ([template_predicate
         (
            template_app
             (template_app
               (template_hole 2,
                template_app
                 (template_app (template_hole 1, template_var 3),
                  template_var 2)),
              template_var 1)
            ),
        template_implication
         ([template_predicate
            (
               template_app
                (template_app
                  (template_app (template_hole 0, template_var 3),
                   template_var 2),
                 template_var 1)
               )],
          template_predicate (template_var 0))],
       template_predicate (template_var 0))),
    ("PDF_Compiler.expr_has_density_cexpr_Piiii_i_oE",
     "[| pred.eval (expr_has_density_cexpr_Piiii_i_o ?x ?xa) ?xb;
         ?x \<turnstile>\<^sub>c ?xa \<Rightarrow> ?xb ==> ?P |]
      ==> ?P",
     template_implication
      ([template_predicate
         (
            template_app
             (template_app
               (template_hole 2,
                template_app
                 (template_app (template_hole 1, template_var 3),
                  template_var 2)),
              template_var 1)
            ),
        template_implication
         ([template_predicate
            (
               template_app
                (template_app
                  (template_app (template_hole 0, template_var 3),
                   template_var 2),
                 template_var 1)
               )],
          template_predicate (template_var 0))],
       template_predicate (template_var 0))),
    ("PDF_Compiler.expr_compiles_to_i_o_oE",
     "[| pred.eval (expr_compiles_to_i_o_o ?x) (?xa, ?xb);
         ?x : ?xa \<Rightarrow>\<^sub>c ?xb ==> ?P |]
      ==> ?P",
     template_implication
      ([template_predicate
         (
            template_app
             (template_app
               (template_hole 3,
                template_app (template_hole 2, template_var 3)),
              template_app
               (template_app (template_hole 1, template_var 2),
                template_var 1))
            ),
        template_implication
         ([template_predicate
            (
               template_app
                (template_app
                  (template_app (template_hole 0, template_var 3),
                   template_var 2),
                 template_var 1)
               )],
          template_predicate (template_var 0))],
       template_predicate (template_var 0))),
    ("PDF_Compiler.expr_compiles_to_i_i_iE",
     "[| pred.eval (expr_compiles_to_i_i_i ?x ?xa ?xb) ?y;
         ?x : ?xa \<Rightarrow>\<^sub>c ?xb ==> ?P |]
      ==> ?P",
     template_implication
      ([template_predicate
         (
            template_app
             (template_app
               (template_hole 2,
                template_app
                 (template_app
                   (template_app (template_hole 1, template_var 4),
                    template_var 3),
                  template_var 2)),
              template_var 1)
            ),
        template_implication
         ([template_predicate
            (
               template_app
                (template_app
                  (template_app (template_hole 0, template_var 4),
                   template_var 3),
                 template_var 2)
               )],
          template_predicate (template_var 0))],
       template_predicate (template_var 0))),
    ("PDF_Compiler.expr_has_density_cexpr_Piiii_i_iE",
     "[| pred.eval (expr_has_density_cexpr_Piiii_i_i ?x ?xa ?xb) ?y;
         ?x \<turnstile>\<^sub>c ?xa \<Rightarrow> ?xb ==> ?P |]
      ==> ?P",
     template_implication
      ([template_predicate
         (
            template_app
             (template_app
               (template_hole 2,
                template_app
                 (template_app
                   (template_app (template_hole 1, template_var 4),
                    template_var 3),
                  template_var 2)),
              template_var 1)
            ),
        template_implication
         ([template_predicate
            (
               template_app
                (template_app
                  (template_app (template_hole 0, template_var 4),
                   template_var 3),
                 template_var 2)
               )],
          template_predicate (template_var 0))],
       template_predicate (template_var 0))),
    ("PDF_Compiler.expr_typing_i_i_iE",
     "[| pred.eval (expr_typing_i_i_i ?x ?xa ?xb) ?y;
         ?x \<turnstile> ?xa : ?xb ==> ?P |]
      ==> ?P",
     template_implication
      ([template_predicate
         (
            template_app
             (template_app
               (template_hole 2,
                template_app
                 (template_app
                   (template_app (template_hole 1, template_var 4),
                    template_var 3),
                  template_var 2)),
              template_var 1)
            ),
        template_implication
         ([template_predicate
            (
               template_app
                (template_app
                  (template_app (template_hole 0, template_var 4),
                   template_var 3),
                 template_var 2)
               )],
          template_predicate (template_var 0))],
       template_predicate (template_var 0))),
    ("PDF_Compiler.expr_compiles_to_sound",
     "?e : ?t \<Rightarrow>\<^sub>c ?f ==>
      expr_sem ?\<sigma> ?e =
      density (stock_measure ?t)
       (%x. ennreal (eval_cexpr ?f ?\<sigma>' x))",
     template_implication
      ([template_predicate
         (
            template_app
             (template_app
               (template_app (template_hole 6, template_var 4),
                template_var 3),
              template_var 2)
            )],
       template_equation
        (template_app
          (template_app (template_hole 4, template_var 1), template_var 4),
         template_app
          (template_app
            (template_hole 3,
             template_app (template_hole 2, template_var 3)),
           t_empty)))),
    ("PDF_Compiler.case_nat_case_nat",
     "(case case ?i of 0 => ?y | Suc x => ?m x of 0 => ?x | Suc x => ?n x) =
      (case ?i of 0 => case ?y of 0 => ?x | Suc x => ?n x
       | Suc i' => case ?m i' of 0 => ?x | Suc x => ?n x)",
     template_equation
      (template_app
        (template_app
          (template_app (template_hole 1, template_var 4), template_var 3),
         template_app
          (template_app
            (template_app (template_hole 0, template_var 2),
             template_var 1),
           template_var 0)),
       template_app
        (template_app
          (template_app
            (template_hole 1,
             template_app
              (template_app
                (template_app (template_hole 1, template_var 4),
                 template_var 3),
               template_var 2)),
           t_empty),
         template_var 0))),
    ("PDF_Compiler_Pred.expr_has_density_intros",
     "?x : ?V ==>
      (?V, ?V', ?\<Gamma>, ?\<delta>) \<turnstile>\<^sub>d
       Var ?x \<Rightarrow> marg_dens (?V, ?V', ?\<Gamma>, ?\<delta>) ?x",
     template_implication
      ([template_predicate
         (
            template_app
             (template_app (template_hole 6, template_var 4),
              template_var 3)
            )],
       template_predicate
        (
           template_app
            (template_app
              (template_app
                (template_hole 5,
                 template_app
                  (template_app (template_hole 4, template_var 3),
                   template_app
                    (template_app (template_hole 3, template_var 2),
                     template_app
                      (template_app (template_hole 2, template_var 1),
                       template_var 0)))),
               template_app (template_hole 1, template_var 4)),
             template_app
              (template_app
                (template_hole 0,
                 template_app
                  (template_app (template_hole 4, template_var 3),
                   template_app
                    (template_app (template_hole 3, template_var 2),
                     template_app
                      (template_app (template_hole 2, template_var 1),
                       template_var 0)))),
               template_var 4))
           ))),
    ("PDF_Compiler.nonneg_cexpr_shift_iff2",
     "nonneg_cexpr (shift_var_set (shift_var_set ?V))
       (case_nat ?t1.0 (case_nat ?t2.0 ?\<Gamma>))
       (map_vars (case_nat 0 (%x. Suc (Suc x))) ?e) =
      nonneg_cexpr (shift_var_set ?V) (case_nat ?t1.0 ?\<Gamma>) ?e",
     template_equation
      (template_app
        (template_app
          (template_app
            (template_hole 6,
             template_app
              (template_hole 5,
               template_app (template_hole 5, template_var 4))),
           template_app
            (template_app (template_hole 4, template_var 3),
             template_app
              (template_app (template_hole 4, template_var 2),
               template_var 1))),
         template_app
          (template_app
            (template_hole 3,
             template_app
              (template_app (template_hole 2, template_hole 1), t_empty)),
           template_var 0)),
       template_app
        (template_app
          (template_app
            (template_hole 6,
             template_app (template_hole 5, template_var 4)),
           template_app
            (template_app (template_hole 4, template_var 3),
             template_var 1)),
         template_var 0))),
    ("PDF_Compiler_Pred.expr_has_density_intros",
     "(?V, ?V', ?\<Gamma>, ?\<delta>) \<turnstile>\<^sub>d
       ?e \<Rightarrow> ?f ==>
      (?V, ?V', ?\<Gamma>, ?\<delta>) \<turnstile>\<^sub>d
       Random ?dst ?e \<Rightarrow> apply_dist_to_dens ?dst ?f",
     template_implication
      ([template_predicate
         (
            template_app
             (template_app
               (template_app
                 (template_hole 5,
                  template_app
                   (template_app (template_hole 4, template_var 6),
                    template_app
                     (template_app (template_hole 3, template_var 5),
                      template_app
                       (template_app (template_hole 2, template_var 4),
                        template_var 3)))),
                template_var 2),
              template_var 1)
            )],
       template_predicate
        (
           template_app
            (template_app
              (template_app
                (template_hole 5,
                 template_app
                  (template_app (template_hole 4, template_var 6),
                   template_app
                    (template_app (template_hole 3, template_var 5),
                     template_app
                      (template_app (template_hole 2, template_var 4),
                       template_var 3)))),
               template_app
                (template_app (template_hole 1, template_var 0),
                 template_var 2)),
             template_app
              (template_app (template_hole 0, template_var 0),
               template_var 1))
           ))),
    ("PDF_Compiler_Pred.has_subprob_density_distr_Fst",
     "has_subprob_density ?M (stock_measure (PRODUCT ?t1.0 ?t2.0)) ?f ==>
      has_subprob_density (distr ?M (stock_measure ?t1.0) (op_sem Fst))
       (stock_measure ?t1.0)
       (%x. \<integral>\<^sup>+ y. ?f <|x, y|>
                               \<partial>stock_measure ?t2.0)",
     template_implication
      ([template_predicate
         (
            template_app
             (template_app
               (template_app (template_hole 7, template_var 3),
                template_app
                 (template_hole 6,
                  template_app
                   (template_app (template_hole 5, template_var 2),
                    template_var 1))),
              template_var 0)
            )],
       template_predicate
        (
           template_app
            (template_app
              (template_app
                (template_hole 7,
                 template_app
                  (template_app
                    (template_app (template_hole 4, template_var 3),
                     template_app (template_hole 6, template_var 2)),
                   template_app (template_hole 3, template_hole 2))),
               template_app (template_hole 6, template_var 2)),
             t_empty)
           ))),
    ("PDF_Compiler_Pred.has_subprob_density_distr_Snd",
     "has_subprob_density ?M (stock_measure (PRODUCT ?t1.0 ?t2.0)) ?f ==>
      has_subprob_density (distr ?M (stock_measure ?t2.0) (op_sem Snd))
       (stock_measure ?t2.0)
       (%y. \<integral>\<^sup>+ x. ?f <|x, y|>
                               \<partial>stock_measure ?t1.0)",
     template_implication
      ([template_predicate
         (
            template_app
             (template_app
               (template_app (template_hole 7, template_var 3),
                template_app
                 (template_hole 6,
                  template_app
                   (template_app (template_hole 5, template_var 2),
                    template_var 1))),
              template_var 0)
            )],
       template_predicate
        (
           template_app
            (template_app
              (template_app
                (template_hole 7,
                 template_app
                  (template_app
                    (template_app (template_hole 4, template_var 3),
                     template_app (template_hole 6, template_var 1)),
                   template_app (template_hole 3, template_hole 2))),
               template_app (template_hole 6, template_var 1)),
             t_empty)
           ))),
    ("PDF_Compiler_Pred.expr_has_density_intros",
     "(?V, ?V', ?\<Gamma>, ?\<delta>) \<turnstile>\<^sub>d
       ?e \<Rightarrow> ?f ==>
      (?V, ?V', ?\<Gamma>, ?\<delta>) \<turnstile>\<^sub>d
       Minus $$ ?e \<Rightarrow>
       (%\<sigma> x. ?f \<sigma> (op_sem Minus x))",
     template_implication
      ([template_predicate
         (
            template_app
             (template_app
               (template_app
                 (template_hole 6,
                  template_app
                   (template_app (template_hole 5, template_var 5),
                    template_app
                     (template_app (template_hole 4, template_var 4),
                      template_app
                       (template_app (template_hole 3, template_var 3),
                        template_var 2)))),
                template_var 1),
              template_var 0)
            )],
       template_predicate
        (
           template_app
            (template_app
              (template_app
                (template_hole 6,
                 template_app
                  (template_app (template_hole 5, template_var 5),
                   template_app
                    (template_app (template_hole 4, template_var 4),
                     template_app
                      (template_app (template_hole 3, template_var 3),
                       template_var 2)))),
               template_app
                (template_app (template_hole 2, template_hole 1),
                 template_var 1)),
             t_empty)
           ))),
    ("PDF_Compiler.space_state_measure_shift_iff",
     "(?\<sigma>
       : space (state_measure (shift_var_set ?V) (case_nat ?t ?\<Gamma>))) =
      (EX x \<sigma>'.
          x : type_universe ?t &
          \<sigma>' : space (state_measure ?V ?\<Gamma>) &
          ?\<sigma> = case_nat x \<sigma>')",
     template_equation
      (template_app
        (template_app (template_hole 11, template_var 3),
         template_app
          (template_hole 10,
           template_app
            (template_app
              (template_hole 9,
               template_app (template_hole 8, template_var 2)),
             template_app
              (template_app (template_hole 7, template_var 1),
               template_var 0)))),
       template_app (template_hole 6, t_empty))),
    ("PDF_Compiler_Pred.expr_has_density_intros",
     "countable_type (val_type ?v) ==>
      (?V, ?V', ?\<Gamma>, ?\<delta>) \<turnstile>\<^sub>d
       Val ?v \<Rightarrow>
       (%\<rho> x.
           branch_prob (?V, ?V', ?\<Gamma>, ?\<delta>) \<rho> *
           indicator {?v} x)",
     template_implication
      ([template_predicate
         (
            template_app
             (template_hole 11,
              template_app (template_hole 10, template_var 4))
            )],
       template_predicate
        (
           template_app
            (template_app
              (template_app
                (template_hole 9,
                 template_app
                  (template_app (template_hole 8, template_var 3),
                   template_app
                    (template_app (template_hole 7, template_var 2),
                     template_app
                      (template_app (template_hole 6, template_var 1),
                       template_var 0)))),
               template_app (template_hole 5, template_var 4)),
             t_empty)
           ))),
    ("PDF_Compiler.space_state_measureD_shift",
     "?\<sigma>
      : space (state_measure (shift_var_set ?V) (case_nat ?t ?\<Gamma>)) ==>
      EX x \<sigma>'.
         x : type_universe ?t &
         \<sigma>' : space (state_measure ?V ?\<Gamma>) &
         ?\<sigma> = case_nat x \<sigma>'",
     template_implication
      ([template_predicate
         (
            template_app
             (template_app (template_hole 11, template_var 3),
              template_app
               (template_hole 10,
                template_app
                 (template_app
                   (template_hole 9,
                    template_app (template_hole 8, template_var 2)),
                  template_app
                   (template_app (template_hole 7, template_var 1),
                    template_var 0))))
            )],
       template_predicate (template_app (template_hole 6, t_empty)))),
    ("PDF_Compiler.expr_has_density_cexpr_sound",
     "[| ([], [], ?\<Gamma>, CReal 1) \<turnstile>\<^sub>c
          ?e \<Rightarrow> ?f;
         ?\<Gamma> \<turnstile> ?e : ?t; free_vars ?e = {} |]
      ==> free_vars ?f <= {0}",
     template_implication
      ([template_predicate
         (
            template_app
             (template_app
               (template_app
                 (template_hole 15,
                  template_app
                   (template_app (template_hole 14, template_hole 13),
                    template_app
                     (template_app (template_hole 12, template_hole 13),
                      template_app
                       (template_app (template_hole 11, template_var 3),
                        template_app
                         (template_hole 10,
                          template_app
                           (template_hole 9, template_hole 8)))))),
                template_var 2),
              template_var 1)
            ),
        template_predicate
         (
            template_app
             (template_app
               (template_app (template_hole 7, template_var 3),
                template_var 2),
              template_var 0)
            ),
        template_equation
         (template_app (template_hole 5, template_var 2), template_hole 4)],
       template_inequation
        (less_equals, template_app (template_hole 2, template_var 1),
         template_app
          (template_app (template_hole 1, template_hole 0),
           template_hole 4)))),
    ("PDF_Compiler_Pred.dens_ctxt_measure_empty_bind",
     "[| ?\<rho> : space (state_measure ?V' ?\<Gamma>);
         ?f : state_measure ?V' ?\<Gamma> \<rightarrow>\<^sub>M
              subprob_algebra ?N |]
      ==> dens_ctxt_measure ({}, ?V', ?\<Gamma>, %_. 1) ?\<rho> >>= ?f =
          ?f ?\<rho>",
     template_implication
      ([template_predicate
         (
            template_app
             (template_app (template_hole 13, template_var 4),
              template_app
               (template_hole 12,
                template_app
                 (template_app (template_hole 11, template_var 3),
                  template_var 2)))
            ),
        template_predicate
         (
            template_app
             (template_app (template_hole 10, template_var 1),
              template_app
               (template_app
                 (template_hole 9,
                  template_app
                   (template_app (template_hole 11, template_var 3),
                    template_var 2)),
                template_app (template_hole 8, template_var 0)))
            )],
       template_equation
        (template_app
          (template_app
            (template_hole 6,
             template_app
              (template_app
                (template_hole 5,
                 template_app
                  (template_app (template_hole 4, template_hole 3),
                   template_app
                    (template_app (template_hole 2, template_var 3),
                     template_app
                      (template_app (template_hole 1, template_var 2),
                       t_empty)))),
               template_var 4)),
           template_var 1),
         template_app (template_var 1, template_var 4)))),
    ("PDF_Compiler_Pred.expr_has_density_sound",
     "[| ({}, {}, ?\<Gamma>, %_. 1) \<turnstile>\<^sub>d
          ?e \<Rightarrow> ?f;
         ?\<Gamma> \<turnstile> ?e : ?t; free_vars ?e = {} |]
      ==> has_subprob_density (expr_sem ?\<sigma> ?e) (stock_measure ?t)
           (?f (%_. undefined))",
     template_implication
      ([template_predicate
         (
            template_app
             (template_app
               (template_app
                 (template_hole 12,
                  template_app
                   (template_app (template_hole 11, template_hole 10),
                    template_app
                     (template_app (template_hole 9, template_hole 10),
                      template_app
                       (template_app (template_hole 8, template_var 4),
                        t_empty)))),
                template_var 3),
              template_var 2)
            ),
        template_predicate
         (
            template_app
             (template_app
               (template_app (template_hole 6, template_var 4),
                template_var 3),
              template_var 1)
            ),
        template_equation
         (template_app (template_hole 4, template_var 3),
          template_hole 10)],
       template_predicate
        (
           template_app
            (template_app
              (template_app
                (template_hole 3,
                 template_app
                  (template_app (template_hole 2, template_var 0),
                   template_var 3)),
               template_app (template_hole 1, template_var 1)),
             template_app (template_var 2, t_empty))
           ))),
    ("PDF_Compiler.nonneg_cexprI_shift",
     "(!!x \<sigma>.
          [| x : type_universe ?t;
             \<sigma> : space (state_measure ?V ?\<Gamma>) |]
          ==> 0 <= extract_real (cexpr_sem (case_nat x \<sigma>) ?e)) ==>
      nonneg_cexpr (shift_var_set ?V) (case_nat ?t ?\<Gamma>) ?e",
     template_implication
      ([template_predicate (template_app (template_hole 15, t_empty))],
       template_predicate
        (
           template_app
            (template_app
              (template_app
                (template_hole 2,
                 template_app (template_hole 1, template_var 2)),
               template_app
                (template_app (template_hole 0, template_var 3),
                 template_var 1)),
             template_var 0)
           ))),
    ("PDF_Compiler.expr_has_density_cexpr_sound",
     "[| ([], [], ?\<Gamma>, CReal 1) \<turnstile>\<^sub>c
          ?e \<Rightarrow> ?f;
         ?\<Gamma> \<turnstile> ?e : ?t; free_vars ?e = {};
         ?\<Gamma>' 0 = ?t |]
      ==> ?\<Gamma>' \<turnstile>\<^sub>c ?f : REAL",
     template_implication
      ([template_predicate
         (
            template_app
             (template_app
               (template_app
                 (template_hole 15,
                  template_app
                   (template_app (template_hole 14, template_hole 13),
                    template_app
                     (template_app (template_hole 12, template_hole 13),
                      template_app
                       (template_app (template_hole 11, template_var 4),
                        template_app
                         (template_hole 10,
                          template_app
                           (template_hole 9, template_hole 8)))))),
                template_var 3),
              template_var 2)
            ),
        template_predicate
         (
            template_app
             (template_app
               (template_app (template_hole 7, template_var 4),
                template_var 3),
              template_var 1)
            ),
        template_equation
         (template_app (template_hole 5, template_var 3), template_hole 4),
        template_equation
         (template_app (template_var 0, template_hole 2), template_var 1)],
       template_predicate
        (
           template_app
            (template_app
              (template_app (template_hole 1, template_var 0),
               template_var 2),
             template_hole 0)
           ))),
    ("PDF_Compiler.expr_has_density_cexpr_sound",
     "[| ([], [], ?\<Gamma>, CReal 1) \<turnstile>\<^sub>c
          ?e \<Rightarrow> ?f;
         ?\<Gamma> \<turnstile> ?e : ?t; free_vars ?e = {} |]
      ==> has_subprob_density (expr_sem ?\<sigma> ?e) (stock_measure ?t)
           (%x. ennreal (eval_cexpr ?f ?\<sigma> x))",
     template_implication
      ([template_predicate
         (
            template_app
             (template_app
               (template_app
                 (template_hole 16,
                  template_app
                   (template_app (template_hole 15, template_hole 14),
                    template_app
                     (template_app (template_hole 13, template_hole 14),
                      template_app
                       (template_app (template_hole 12, template_var 4),
                        template_app
                         (template_hole 11,
                          template_app
                           (template_hole 10, template_hole 9)))))),
                template_var 3),
              template_var 2)
            ),
        template_predicate
         (
            template_app
             (template_app
               (template_app (template_hole 8, template_var 4),
                template_var 3),
              template_var 1)
            ),
        template_equation
         (template_app (template_hole 6, template_var 3), template_hole 5)],
       template_predicate
        (
           template_app
            (template_app
              (template_app
                (template_hole 4,
                 template_app
                  (template_app (template_hole 3, template_var 0),
                   template_var 3)),
               template_app (template_hole 2, template_var 1)),
             t_empty)
           ))),
    ("PDF_Compiler.expr_has_density_cexpr_sound",
     "[| ([], [], ?\<Gamma>, CReal 1) \<turnstile>\<^sub>c
          ?e \<Rightarrow> ?f;
         ?\<Gamma> \<turnstile> ?e : ?t; free_vars ?e = {} |]
      ==> ALL x:type_universe ?t.
             0 <= extract_real (cexpr_sem (case_nat x ?\<sigma>) ?f)",
     template_implication
      ([template_predicate
         (
            template_app
             (template_app
               (template_app
                 (template_hole 18,
                  template_app
                   (template_app (template_hole 17, template_hole 16),
                    template_app
                     (template_app (template_hole 15, template_hole 16),
                      template_app
                       (template_app (template_hole 14, template_var 4),
                        template_app
                         (template_hole 13,
                          template_app
                           (template_hole 12, template_hole 11)))))),
                template_var 3),
              template_var 2)
            ),
        template_predicate
         (
            template_app
             (template_app
               (template_app (template_hole 10, template_var 4),
                template_var 3),
              template_var 1)
            ),
        template_equation
         (template_app (template_hole 8, template_var 3), template_hole 7)],
       template_predicate
        (
           template_app
            (template_app
              (template_hole 6,
               template_app (template_hole 5, template_var 1)),
             t_empty)
           ))),
    ("PDF_Compiler_Pred.expr_has_density_intros",
     "(?V, ?V', ?\<Gamma>, ?\<delta>) \<turnstile>\<^sub>d
       ?e \<Rightarrow> ?f ==>
      (?V, ?V', ?\<Gamma>, ?\<delta>) \<turnstile>\<^sub>d
       Fst $$ ?e \<Rightarrow>
       (%\<rho> x.
           \<integral>\<^sup>+ y. ?f \<rho> <|x, y|>
                              \<partial>stock_measure
   (the (expr_type ?\<Gamma> (Snd $$ ?e))))",
     template_implication
      ([template_predicate
         (
            template_app
             (template_app
               (template_app
                 (template_hole 11,
                  template_app
                   (template_app (template_hole 10, template_var 5),
                    template_app
                     (template_app (template_hole 9, template_var 4),
                      template_app
                       (template_app (template_hole 8, template_var 3),
                        template_var 2)))),
                template_var 1),
              template_var 0)
            )],
       template_predicate
        (
           template_app
            (template_app
              (template_app
                (template_hole 11,
                 template_app
                  (template_app (template_hole 10, template_var 5),
                   template_app
                    (template_app (template_hole 9, template_var 4),
                     template_app
                      (template_app (template_hole 8, template_var 3),
                       template_var 2)))),
               template_app
                (template_app (template_hole 7, template_hole 6),
                 template_var 1)),
             t_empty)
           ))),
    ("PDF_Compiler_Pred.expr_has_density_intros",
     "(?V, ?V', ?\<Gamma>, ?\<delta>) \<turnstile>\<^sub>d
       ?e \<Rightarrow> ?f ==>
      (?V, ?V', ?\<Gamma>, ?\<delta>) \<turnstile>\<^sub>d
       Inverse $$ ?e \<Rightarrow>
       (%\<sigma> x.
           ?f \<sigma> (op_sem Inverse x) *
           ennreal ((inverse (extract_real x))\<^sup>2))",
     template_implication
      ([template_predicate
         (
            template_app
             (template_app
               (template_app
                 (template_hole 14,
                  template_app
                   (template_app (template_hole 13, template_var 5),
                    template_app
                     (template_app (template_hole 12, template_var 4),
                      template_app
                       (template_app (template_hole 11, template_var 3),
                        template_var 2)))),
                template_var 1),
              template_var 0)
            )],
       template_predicate
        (
           template_app
            (template_app
              (template_app
                (template_hole 14,
                 template_app
                  (template_app (template_hole 13, template_var 5),
                   template_app
                    (template_app (template_hole 12, template_var 4),
                     template_app
                      (template_app (template_hole 11, template_var 3),
                       template_var 2)))),
               template_app
                (template_app (template_hole 10, template_hole 9),
                 template_var 1)),
             t_empty)
           ))),
    ("PDF_Compiler_Pred.expr_has_density_intros",
     "(?V, ?V', ?\<Gamma>, ?\<delta>) \<turnstile>\<^sub>d
       ?e \<Rightarrow> ?f ==>
      (?V, ?V', ?\<Gamma>, ?\<delta>) \<turnstile>\<^sub>d
       Snd $$ ?e \<Rightarrow>
       (%\<rho> y.
           \<integral>\<^sup>+ x. ?f \<rho> <|x, y|>
                              \<partial>stock_measure
   (the (expr_type ?\<Gamma> (Fst $$ ?e))))",
     template_implication
      ([template_predicate
         (
            template_app
             (template_app
               (template_app
                 (template_hole 11,
                  template_app
                   (template_app (template_hole 10, template_var 5),
                    template_app
                     (template_app (template_hole 9, template_var 4),
                      template_app
                       (template_app (template_hole 8, template_var 3),
                        template_var 2)))),
                template_var 1),
              template_var 0)
            )],
       template_predicate
        (
           template_app
            (template_app
              (template_app
                (template_hole 11,
                 template_app
                  (template_app (template_hole 10, template_var 5),
                   template_app
                    (template_app (template_hole 9, template_var 4),
                     template_app
                      (template_app (template_hole 8, template_var 3),
                       template_var 2)))),
               template_app
                (template_app (template_hole 7, template_hole 6),
                 template_var 1)),
             t_empty)
           ))),
    ("PDF_Compiler_Pred.expr_has_density_intros",
     "[| randomfree ?e; free_vars ?e <= ?V' |]
      ==> (?V, ?V', ?\<Gamma>, ?\<delta>) \<turnstile>\<^sub>d
           Random ?dst ?e \<Rightarrow>
           (%\<rho> x.
               branch_prob (?V, ?V', ?\<Gamma>, ?\<delta>) \<rho> *
               dist_dens ?dst (expr_sem_rf \<rho> ?e) x)",
     template_implication
      ([template_predicate
         (template_app (template_hole 11, template_var 5)),
        template_inequation
         (less_equals, template_app (template_hole 9, template_var 5),
          template_var 4)],
       template_predicate
        (
           template_app
            (template_app
              (template_app
                (template_hole 8,
                 template_app
                  (template_app (template_hole 7, template_var 3),
                   template_app
                    (template_app (template_hole 6, template_var 4),
                     template_app
                      (template_app (template_hole 5, template_var 2),
                       template_var 1)))),
               template_app
                (template_app (template_hole 4, template_var 0),
                 template_var 5)),
             t_empty)
           ))),
    ("PDF_Compiler_Pred.expr_has_density_intros",
     "[| ?x : ?V; ?y : ?V; ?x ~= ?y |]
      ==> (?V, ?V', ?\<Gamma>, ?\<delta>) \<turnstile>\<^sub>d
           <Var ?x ,  Var ?y> \<Rightarrow>
           marg_dens2 (?V, ?V', ?\<Gamma>, ?\<delta>) ?x ?y",
     template_implication
      ([template_predicate
         (
            template_app
             (template_app (template_hole 9, template_var 5),
              template_var 4)
            ),
        template_predicate
         (
            template_app
             (template_app (template_hole 9, template_var 3),
              template_var 4)
            ),
        template_negation
         (template_equation (template_var 5, template_var 3))],
       template_predicate
        (
           template_app
            (template_app
              (template_app
                (template_hole 6,
                 template_app
                  (template_app (template_hole 5, template_var 4),
                   template_app
                    (template_app (template_hole 4, template_var 2),
                     template_app
                      (template_app (template_hole 3, template_var 1),
                       template_var 0)))),
               template_app
                (template_app
                  (template_hole 2,
                   template_app (template_hole 1, template_var 5)),
                 template_app (template_hole 1, template_var 3))),
             template_app
              (template_app
                (template_app
                  (template_hole 0,
                   template_app
                    (template_app (template_hole 5, template_var 4),
                     template_app
                      (template_app (template_hole 4, template_var 2),
                       template_app
                        (template_app (template_hole 3, template_var 1),
                         template_var 0)))),
                 template_var 5),
               template_var 3))
           ))),
    ("PDF_Compiler_Pred.expr_has_density_intros",
     "(?V, ?V', ?\<Gamma>, ?\<delta>) \<turnstile>\<^sub>d
       ?e \<Rightarrow> ?f ==>
      (?V, ?V', ?\<Gamma>, ?\<delta>) \<turnstile>\<^sub>d
       Add $$ ?e \<Rightarrow>
       (%\<sigma> z.
           \<integral>\<^sup>+ x. ?f \<sigma>
                                   <|x, op_sem Add <|z, op_sem Minus x|>|>
                              \<partial>stock_measure (val_type z))",
     template_implication
      ([template_predicate
         (
            template_app
             (template_app
               (template_app
                 (template_hole 11,
                  template_app
                   (template_app (template_hole 10, template_var 5),
                    template_app
                     (template_app (template_hole 9, template_var 4),
                      template_app
                       (template_app (template_hole 8, template_var 3),
                        template_var 2)))),
                template_var 1),
              template_var 0)
            )],
       template_predicate
        (
           template_app
            (template_app
              (template_app
                (template_hole 11,
                 template_app
                  (template_app (template_hole 10, template_var 5),
                   template_app
                    (template_app (template_hole 9, template_var 4),
                     template_app
                      (template_app (template_hole 8, template_var 3),
                       template_var 2)))),
               template_app
                (template_app (template_hole 7, template_hole 6),
                 template_var 1)),
             t_empty)
           ))),
    ("PDF_Compiler_Pred.expr_has_density_intros",
     "(?V, ?V', ?\<Gamma>, ?\<delta>) \<turnstile>\<^sub>d
       ?e \<Rightarrow> ?f ==>
      (?V, ?V', ?\<Gamma>, ?\<delta>) \<turnstile>\<^sub>d
       Exp $$ ?e \<Rightarrow>
       (%\<sigma> x.
           if 0 < extract_real x
           then ?f \<sigma> (lift_RealVal safe_ln x) *
                ennreal (inverse (extract_real x))
           else 0)",
     template_implication
      ([template_predicate
         (
            template_app
             (template_app
               (template_app
                 (template_hole 15,
                  template_app
                   (template_app (template_hole 14, template_var 5),
                    template_app
                     (template_app (template_hole 13, template_var 4),
                      template_app
                       (template_app (template_hole 12, template_var 3),
                        template_var 2)))),
                template_var 1),
              template_var 0)
            )],
       template_predicate
        (
           template_app
            (template_app
              (template_app
                (template_hole 15,
                 template_app
                  (template_app (template_hole 14, template_var 5),
                   template_app
                    (template_app (template_hole 13, template_var 4),
                     template_app
                      (template_app (template_hole 12, template_var 3),
                       template_var 2)))),
               template_app
                (template_app (template_hole 11, template_hole 10),
                 template_var 1)),
             t_empty)
           ))),
    ("PDF_Compiler.nonneg_cexpr_Add",
     "[| ?\<Gamma> \<turnstile>\<^sub>c ?e1.0 : REAL;
         ?\<Gamma> \<turnstile>\<^sub>c ?e2.0 : REAL; free_vars ?e1.0 <= ?V;
         free_vars ?e2.0 <= ?V; nonneg_cexpr ?V ?\<Gamma> ?e1.0;
         nonneg_cexpr ?V ?\<Gamma> ?e2.0 |]
      ==> nonneg_cexpr ?V ?\<Gamma> (?e1.0 +\<^sub>c ?e2.0)",
     template_implication
      ([template_predicate
         (
            template_app
             (template_app
               (template_app (template_hole 7, template_var 3),
                template_var 2),
              template_hole 6)
            ),
        template_predicate
         (
            template_app
             (template_app
               (template_app (template_hole 7, template_var 3),
                template_var 1),
              template_hole 6)
            ),
        template_inequation
         (less_equals, template_app (template_hole 4, template_var 2),
          template_var 0),
        template_inequation
         (less_equals, template_app (template_hole 4, template_var 1),
          template_var 0),
        template_predicate
         (
            template_app
             (template_app
               (template_app (template_hole 3, template_var 0),
                template_var 3),
              template_var 2)
            ),
        template_predicate
         (
            template_app
             (template_app
               (template_app (template_hole 3, template_var 0),
                template_var 3),
              template_var 1)
            )],
       template_predicate
        (
           template_app
            (template_app
              (template_app (template_hole 3, template_var 0),
               template_var 3),
             template_app
              (template_app (template_hole 2, template_hole 1),
               template_app
                (template_app (template_hole 0, template_var 2),
                 template_var 1)))
           ))),
    ("PDF_Compiler_Pred.expr_has_density_intros",
     "[| (?V, ?V', ?\<Gamma>, ?\<delta>) \<turnstile>\<^sub>d
          ?e \<Rightarrow> ?f;
         randomfree ?e'; free_vars ?e' <= ?V' |]
      ==> (?V, ?V', ?\<Gamma>, ?\<delta>) \<turnstile>\<^sub>d
           Add $$ <?e ,  ?e'> \<Rightarrow>
           (%\<rho> x.
               ?f \<rho>
                (op_sem Add <|x, expr_sem_rf \<rho> (Minus $$ ?e')|>))",
     template_implication
      ([template_predicate
         (
            template_app
             (template_app
               (template_app
                 (template_hole 13,
                  template_app
                   (template_app (template_hole 12, template_var 6),
                    template_app
                     (template_app (template_hole 11, template_var 5),
                      template_app
                       (template_app (template_hole 10, template_var 4),
                        template_var 3)))),
                template_var 2),
              template_var 1)
            ),
        template_predicate (template_app (template_hole 9, template_var 0)),
        template_inequation
         (less_equals, template_app (template_hole 7, template_var 0),
          template_var 5)],
       template_predicate
        (
           template_app
            (template_app
              (template_app
                (template_hole 13,
                 template_app
                  (template_app (template_hole 12, template_var 6),
                   template_app
                    (template_app (template_hole 11, template_var 5),
                     template_app
                      (template_app (template_hole 10, template_var 4),
                       template_var 3)))),
               template_app
                (template_app (template_hole 6, template_hole 5),
                 template_app
                  (template_app (template_hole 4, template_var 2),
                   template_var 0))),
             t_empty)
           ))),
    ("PDF_Compiler_Pred.expr_has_density_intros",
     "[| countable_type (the (expr_type ?\<Gamma> (?oper $$ ?e)));
         (?V, ?V', ?\<Gamma>, ?\<delta>) \<turnstile>\<^sub>d
          ?e \<Rightarrow> ?f |]
      ==> (?V, ?V', ?\<Gamma>, ?\<delta>) \<turnstile>\<^sub>d
           ?oper $$ ?e \<Rightarrow>
           (%\<rho> y.
               \<integral>\<^sup>+ x. (if op_sem ?oper x = y then 1
 else 0) *
?f \<rho> x
                                  \<partial>stock_measure
       (the (expr_type ?\<Gamma> ?e)))",
     template_implication
      ([template_predicate
         (
            template_app
             (template_hole 15,
              template_app
               (template_hole 14,
                template_app
                 (template_app (template_hole 13, template_var 6),
                  template_app
                   (template_app (template_hole 12, template_var 5),
                    template_var 4))))
            ),
        template_predicate
         (
            template_app
             (template_app
               (template_app
                 (template_hole 11,
                  template_app
                   (template_app (template_hole 10, template_var 3),
                    template_app
                     (template_app (template_hole 9, template_var 2),
                      template_app
                       (template_app (template_hole 8, template_var 6),
                        template_var 1)))),
                template_var 4),
              template_var 0)
            )],
       template_predicate
        (
           template_app
            (template_app
              (template_app
                (template_hole 11,
                 template_app
                  (template_app (template_hole 10, template_var 3),
                   template_app
                    (template_app (template_hole 9, template_var 2),
                     template_app
                      (template_app (template_hole 8, template_var 6),
                       template_var 1)))),
               template_app
                (template_app (template_hole 12, template_var 5),
                 template_var 4)),
             t_empty)
           ))),
    ("PDF_Compiler_Pred.expr_has_density_intros",
     "[| ({}, ?V Un ?V', ?\<Gamma>, %_. 1) \<turnstile>\<^sub>d
          ?e1.0 \<Rightarrow> ?f;
         (shift_var_set ?V, Suc ` ?V',
          case_nat (the (expr_type ?\<Gamma> ?e1.0)) ?\<Gamma>,
          insert_dens ?V ?V' ?f ?\<delta>) \<turnstile>\<^sub>d
          ?e2.0 \<Rightarrow> ?g |]
      ==> (?V, ?V', ?\<Gamma>, ?\<delta>) \<turnstile>\<^sub>d
           LET ?e1.0 IN ?e2.0 \<Rightarrow>
           (%\<rho>. ?g (case_nat undefined \<rho>))",
     template_implication
      ([template_predicate
         (
            template_app
             (template_app
               (template_app
                 (template_hole 16,
                  template_app
                   (template_app (template_hole 15, template_hole 14),
                    template_app
                     (template_app
                       (template_hole 13,
                        template_app
                         (template_app (template_hole 12, template_var 7),
                          template_var 6)),
                      template_app
                       (template_app (template_hole 11, template_var 5),
                        t_empty)))),
                template_var 4),
              template_var 3)
            ),
        template_predicate
         (
            template_app
             (template_app
               (template_app
                 (template_hole 16,
                  template_app
                   (template_app
                     (template_hole 15,
                      template_app (template_hole 9, template_var 7)),
                    template_app
                     (template_app
                       (template_hole 13,
                        template_app
                         (template_app (template_hole 8, template_hole 7),
                          template_var 6)),
                      template_app
                       (template_app
                         (template_hole 11,
                          template_app
                           (template_app
                             (template_hole 6,
                              template_app
                               (template_hole 5,
                                template_app
                                 (template_app
                                   (template_hole 4, template_var 5),
                                  template_var 4))),
                            template_var 5)),
                        template_app
                         (template_app
                           (template_app
                             (template_app
                               (template_hole 3, template_var 7),
                              template_var 6),
                            template_var 3),
                          template_var 2))))),
                template_var 1),
              template_var 0)
            )],
       template_predicate
        (
           template_app
            (template_app
              (template_app
                (template_hole 16,
                 template_app
                  (template_app (template_hole 15, template_var 7),
                   template_app
                    (template_app (template_hole 13, template_var 6),
                     template_app
                      (template_app (template_hole 11, template_var 5),
                       template_var 2)))),
               template_app
                (template_app (template_hole 2, template_var 4),
                 template_var 1)),
             t_empty)
           ))),
    ("PDF_Compiler_Pred.expr_has_density_intros",
     "[| randomfree ?b;
         (?V, ?V', ?\<Gamma>,
          if_dens_det ?\<delta> ?b True) \<turnstile>\<^sub>d
          ?e1.0 \<Rightarrow> ?g1.0;
         (?V, ?V', ?\<Gamma>,
          if_dens_det ?\<delta> ?b False) \<turnstile>\<^sub>d
          ?e2.0 \<Rightarrow> ?g2.0 |]
      ==> (?V, ?V', ?\<Gamma>, ?\<delta>) \<turnstile>\<^sub>d
           IF ?b THEN ?e1.0 ELSE ?e2.0 \<Rightarrow>
           (%\<rho> x. ?g1.0 \<rho> x + ?g2.0 \<rho> x)",
     template_implication
      ([template_predicate (template_app (template_hole 9, template_var 8)),
        template_predicate
         (
            template_app
             (template_app
               (template_app
                 (template_hole 8,
                  template_app
                   (template_app (template_hole 7, template_var 7),
                    template_app
                     (template_app (template_hole 6, template_var 6),
                      template_app
                       (template_app (template_hole 5, template_var 5),
                        template_app
                         (template_app
                           (template_app (template_hole 4, template_var 4),
                            template_var 8),
                          template_hole 3))))),
                template_var 3),
              template_var 2)
            ),
        template_predicate
         (
            template_app
             (template_app
               (template_app
                 (template_hole 8,
                  template_app
                   (template_app (template_hole 7, template_var 7),
                    template_app
                     (template_app (template_hole 6, template_var 6),
                      template_app
                       (template_app (template_hole 5, template_var 5),
                        template_app
                         (template_app
                           (template_app (template_hole 4, template_var 4),
                            template_var 8),
                          template_hole 2))))),
                template_var 1),
              template_var 0)
            )],
       template_predicate
        (
           template_app
            (template_app
              (template_app
                (template_hole 8,
                 template_app
                  (template_app (template_hole 7, template_var 7),
                   template_app
                    (template_app (template_hole 6, template_var 6),
                     template_app
                      (template_app (template_hole 5, template_var 5),
                       template_var 4)))),
               template_app
                (template_app
                  (template_app (template_hole 1, template_var 8),
                   template_var 3),
                 template_var 1)),
             t_empty)
           ))),
    ("PDF_Compiler_Pred.expr_has_density_intros",
     "[| (?V, ?V', ?\<Gamma>, ?\<delta>) \<turnstile>\<^sub>d
          ?e \<Rightarrow> ?f;
         val_type ?c = REAL; ?c ~= RealVal 0 |]
      ==> (?V, ?V', ?\<Gamma>, ?\<delta>) \<turnstile>\<^sub>d
           Mult $$ <?e ,  Val ?c> \<Rightarrow>
           (%\<rho> x.
               ?f \<rho> (op_sem Mult <|x, op_sem Inverse ?c|>) *
               ennreal (inverse \<bar>extract_real ?c\<bar>))",
     template_implication
      ([template_predicate
         (
            template_app
             (template_app
               (template_app
                 (template_hole 22,
                  template_app
                   (template_app (template_hole 21, template_var 6),
                    template_app
                     (template_app (template_hole 20, template_var 5),
                      template_app
                       (template_app (template_hole 19, template_var 4),
                        template_var 3)))),
                template_var 2),
              template_var 1)
            ),
        template_equation
         (template_app (template_hole 17, template_var 0),
          template_hole 16),
        template_negation
         (
            template_equation
             (template_var 0,
              template_app (template_hole 13, template_hole 12))
            )],
       template_predicate
        (
           template_app
            (template_app
              (template_app
                (template_hole 22,
                 template_app
                  (template_app (template_hole 21, template_var 6),
                   template_app
                    (template_app (template_hole 20, template_var 5),
                     template_app
                      (template_app (template_hole 19, template_var 4),
                       template_var 3)))),
               template_app
                (template_app (template_hole 11, template_hole 10),
                 template_app
                  (template_app (template_hole 9, template_var 2),
                   template_app (template_hole 8, template_var 0)))),
             t_empty)
           ))),
    ("PDF_Compiler_Pred.expr_has_density_sound_aux",
     "[| (?V, ?V', ?\<Gamma>, ?\<delta>) \<turnstile>\<^sub>d
          ?e \<Rightarrow> ?f;
         ?\<Gamma> \<turnstile> ?e : ?t;
         density_context ?V ?V' ?\<Gamma> ?\<delta>;
         free_vars ?e <= ?V Un ?V' |]
      ==> has_parametrized_subprob_density (state_measure ?V' ?\<Gamma>)
           (%\<rho>.
               dens_ctxt_measure (?V, ?V', ?\<Gamma>, ?\<delta>) \<rho> >>=
               (%\<sigma>. expr_sem \<sigma> ?e))
           (stock_measure ?t) ?f",
     template_implication
      ([template_predicate
         (
            template_app
             (template_app
               (template_app
                 (template_hole 14,
                  template_app
                   (template_app (template_hole 13, template_var 6),
                    template_app
                     (template_app (template_hole 12, template_var 5),
                      template_app
                       (template_app (template_hole 11, template_var 4),
                        template_var 3)))),
                template_var 2),
              template_var 1)
            ),
        template_predicate
         (
            template_app
             (template_app
               (template_app (template_hole 10, template_var 4),
                template_var 2),
              template_var 0)
            ),
        template_predicate
         (
            template_app
             (template_app
               (template_app
                 (template_app (template_hole 9, template_var 6),
                  template_var 5),
                template_var 4),
              template_var 3)
            ),
        template_inequation
         (less_equals, template_app (template_hole 7, template_var 2),
          template_app
           (template_app (template_hole 6, template_var 6),
            template_var 5))],
       template_predicate
        (
           template_app
            (template_app
              (template_app
                (template_app
                  (template_hole 5,
                   template_app
                    (template_app (template_hole 4, template_var 5),
                     template_var 4)),
                 t_empty),
               template_app (template_hole 0, template_var 0)),
             t_empty)
           ))),
    ("PDF_Compiler_Pred.addc_density_measurable",
     "[| (%(x, y). ?f x y)
         : borel_measurable
            (state_measure ?V' ?\<Gamma> \<Otimes>\<^sub>M
             stock_measure ?t);
         ?t = REAL | ?t = INTEG; ?\<Gamma> \<turnstile> ?e' : ?t;
         randomfree ?e'; free_vars ?e' <= ?V' |]
      ==> (%(\<rho>, x).
              ?f \<rho>
               (op_sem Add <|x, expr_sem_rf \<rho> (Minus $$ ?e')|>))
          : borel_measurable
             (state_measure ?V' ?\<Gamma> \<Otimes>\<^sub>M
              stock_measure ?t)",
     template_implication
      ([template_predicate
         (
            template_app
             (template_app
               (template_hole 20,
                template_app (template_hole 19, template_var 4)),
              template_app
               (template_app
                 (template_hole 18,
                  template_app
                   (template_app
                     (template_hole 17,
                      template_app
                       (template_app (template_hole 16, template_var 3),
                        template_var 2)),
                    template_app (template_hole 15, template_var 1))),
                template_hole 14))
            ),
        template_predicate
         (
            template_app
             (template_app
               (template_hole 13,
                template_app
                 (template_app (template_hole 12, template_var 1),
                  template_hole 11)),
              template_app
               (template_app (template_hole 12, template_var 1),
                template_hole 10))
            ),
        template_predicate
         (
            template_app
             (template_app
               (template_app (template_hole 9, template_var 2),
                template_var 0),
              template_var 1)
            ),
        template_predicate (template_app (template_hole 8, template_var 0)),
        template_inequation
         (less_equals, template_app (template_hole 6, template_var 0),
          template_var 3)],
       template_predicate
        (
           template_app
            (template_app
              (template_hole 20, template_app (template_hole 19, t_empty)),
             template_app
              (template_app
                (template_hole 18,
                 template_app
                  (template_app
                    (template_hole 17,
                     template_app
                      (template_app (template_hole 16, template_var 3),
                       template_var 2)),
                   template_app (template_hole 15, template_var 1))),
               template_hole 14))
           ))),
    ("PDF_Compiler.expr_has_density_cexpr_sound_aux",
     "[| ?\<Gamma> \<turnstile> ?e : ?t;
         (?vs, ?vs', ?\<Gamma>, ?\<delta>) \<turnstile>\<^sub>c
          ?e \<Rightarrow> ?f;
         cdens_ctxt_invar ?vs ?vs' ?\<Gamma> ?\<delta>;
         free_vars ?e <= set ?vs Un set ?vs' |]
      ==> dens_ctxt_\<alpha>
           (?vs, ?vs', ?\<Gamma>, ?\<delta>) \<turnstile>\<^sub>d
           ?e \<Rightarrow> (%x xa. ennreal (eval_cexpr ?f x xa)) &
          is_density_expr (?vs, ?vs', ?\<Gamma>, ?\<delta>) ?t ?f",
     template_implication
      ([template_predicate
         (
            template_app
             (template_app
               (template_app (template_hole 15, template_var 6),
                template_var 5),
              template_var 4)
            ),
        template_predicate
         (
            template_app
             (template_app
               (template_app
                 (template_hole 14,
                  template_app
                   (template_app (template_hole 13, template_var 3),
                    template_app
                     (template_app (template_hole 12, template_var 2),
                      template_app
                       (template_app (template_hole 11, template_var 6),
                        template_var 1)))),
                template_var 5),
              template_var 0)
            ),
        template_predicate
         (
            template_app
             (template_app
               (template_app
                 (template_app (template_hole 10, template_var 3),
                  template_var 2),
                template_var 6),
              template_var 1)
            ),
        template_inequation
         (less_equals, template_app (template_hole 8, template_var 5),
          template_app
           (template_app
             (template_hole 7,
              template_app (template_hole 6, template_var 3)),
            template_app (template_hole 6, template_var 2)))],
       template_predicate
        (
           template_app
            (template_app
              (template_hole 5,
               template_app
                (template_app
                  (template_app
                    (template_hole 4,
                     template_app
                      (template_hole 3,
                       template_app
                        (template_app (template_hole 13, template_var 3),
                         template_app
                          (template_app (template_hole 12, template_var 2),
                           template_app
                            (template_app
                              (template_hole 11, template_var 6),
                             template_var 1))))),
                   template_var 5),
                 t_empty)),
             template_app
              (template_app
                (template_app
                  (template_hole 0,
                   template_app
                    (template_app (template_hole 13, template_var 3),
                     template_app
                      (template_app (template_hole 12, template_var 2),
                       template_app
                        (template_app (template_hole 11, template_var 6),
                         template_var 1)))),
                 template_var 4),
               template_var 0))
           ))),
    ("PDF_Compiler_Pred.expr_has_density_intros",
     "[| ({}, ?V Un ?V', ?\<Gamma>, %_. 1) \<turnstile>\<^sub>d
          ?b \<Rightarrow> ?f;
         (?V, ?V', ?\<Gamma>,
          if_dens ?\<delta> ?f True) \<turnstile>\<^sub>d
          ?e1.0 \<Rightarrow> ?g1.0;
         (?V, ?V', ?\<Gamma>,
          if_dens ?\<delta> ?f False) \<turnstile>\<^sub>d
          ?e2.0 \<Rightarrow> ?g2.0 |]
      ==> (?V, ?V', ?\<Gamma>, ?\<delta>) \<turnstile>\<^sub>d
           IF ?b THEN ?e1.0 ELSE ?e2.0 \<Rightarrow>
           (%\<rho> x. ?g1.0 \<rho> x + ?g2.0 \<rho> x)",
     template_implication
      ([template_predicate
         (
            template_app
             (template_app
               (template_app
                 (template_hole 11,
                  template_app
                   (template_app (template_hole 10, template_hole 9),
                    template_app
                     (template_app
                       (template_hole 8,
                        template_app
                         (template_app (template_hole 7, template_var 9),
                          template_var 8)),
                      template_app
                       (template_app (template_hole 6, template_var 7),
                        t_empty)))),
                template_var 6),
              template_var 5)
            ),
        template_predicate
         (
            template_app
             (template_app
               (template_app
                 (template_hole 11,
                  template_app
                   (template_app (template_hole 10, template_var 9),
                    template_app
                     (template_app (template_hole 8, template_var 8),
                      template_app
                       (template_app (template_hole 6, template_var 7),
                        template_app
                         (template_app
                           (template_app (template_hole 4, template_var 4),
                            template_var 5),
                          template_hole 3))))),
                template_var 3),
              template_var 2)
            ),
        template_predicate
         (
            template_app
             (template_app
               (template_app
                 (template_hole 11,
                  template_app
                   (template_app (template_hole 10, template_var 9),
                    template_app
                     (template_app (template_hole 8, template_var 8),
                      template_app
                       (template_app (template_hole 6, template_var 7),
                        template_app
                         (template_app
                           (template_app (template_hole 4, template_var 4),
                            template_var 5),
                          template_hole 2))))),
                template_var 1),
              template_var 0)
            )],
       template_predicate
        (
           template_app
            (template_app
              (template_app
                (template_hole 11,
                 template_app
                  (template_app (template_hole 10, template_var 9),
                   template_app
                    (template_app (template_hole 8, template_var 8),
                     template_app
                      (template_app (template_hole 6, template_var 7),
                       template_var 4)))),
               template_app
                (template_app
                  (template_app (template_hole 1, template_var 6),
                   template_var 3),
                 template_var 1)),
             t_empty)
           ))),
    ("PDF_Compiler_Pred.hd_cong",
     "[| (?V, ?V', ?\<Gamma>, ?\<delta>) \<turnstile>\<^sub>d
          ?e \<Rightarrow> ?f;
         density_context ?V ?V' ?\<Gamma> ?\<delta>;
         ?\<Gamma> \<turnstile> ?e : ?t; free_vars ?e <= ?V Un ?V';
         !!\<rho> x.
            [| \<rho> : space (state_measure ?V' ?\<Gamma>);
               x : space (stock_measure ?t) |]
            ==> ?f \<rho> x = ?f' \<rho> x |]
      ==> (?V, ?V', ?\<Gamma>, ?\<delta>) \<turnstile>\<^sub>d
           ?e \<Rightarrow> ?f'",
     template_implication
      ([template_predicate
         (
            template_app
             (template_app
               (template_app
                 (template_hole 17,
                  template_app
                   (template_app (template_hole 16, template_var 7),
                    template_app
                     (template_app (template_hole 15, template_var 6),
                      template_app
                       (template_app (template_hole 14, template_var 5),
                        template_var 4)))),
                template_var 3),
              template_var 2)
            ),
        template_predicate
         (
            template_app
             (template_app
               (template_app
                 (template_app (template_hole 13, template_var 7),
                  template_var 6),
                template_var 5),
              template_var 4)
            ),
        template_predicate
         (
            template_app
             (template_app
               (template_app (template_hole 12, template_var 5),
                template_var 3),
              template_var 1)
            ),
        template_inequation
         (less_equals, template_app (template_hole 10, template_var 3),
          template_app
           (template_app (template_hole 9, template_var 7),
            template_var 6)),
        template_predicate (template_app (template_hole 8, t_empty))],
       template_predicate
        (
           template_app
            (template_app
              (template_app
                (template_hole 17,
                 template_app
                  (template_app (template_hole 16, template_var 7),
                   template_app
                    (template_app (template_hole 15, template_var 6),
                     template_app
                      (template_app (template_hole 14, template_var 5),
                       template_var 4)))),
               template_var 3),
             template_var 0)
           ))),
    ("PDF_Compiler.cdens_ctxt_invar_insert_bool",
     "[| dens_ctxt_\<alpha>
          ([], ?vs @ ?vs', ?\<Gamma>, CReal 1) \<turnstile>\<^sub>d
          ?b \<Rightarrow> (%\<rho> x. ennreal (eval_cexpr ?f \<rho> x));
         is_density_expr ([], ?vs @ ?vs', ?\<Gamma>, CReal 1) BOOL ?f;
         ?\<Gamma> \<turnstile> ?b : BOOL;
         free_vars ?b <= set ?vs Un set ?vs';
         cdens_ctxt_invar ?vs ?vs' ?\<Gamma> ?\<delta> |]
      ==> cdens_ctxt_invar ?vs ?vs' ?\<Gamma>
           (?\<delta> *\<^sub>c cexpr_subst_val ?f (BoolVal ?v))",
     template_implication
      ([template_predicate
         (
            template_app
             (template_app
               (template_app
                 (template_hole 24,
                  template_app
                   (template_hole 23,
                    template_app
                     (template_app (template_hole 22, template_hole 21),
                      template_app
                       (template_app
                         (template_hole 20,
                          template_app
                           (template_app (template_hole 19, template_var 6),
                            template_var 5)),
                        template_app
                         (template_app (template_hole 18, template_var 4),
                          template_app
                           (template_hole 17,
                            template_app
                             (template_hole 16, template_hole 15))))))),
                template_var 3),
              t_empty)
            ),
        template_predicate
         (
            template_app
             (template_app
               (template_app
                 (template_hole 12,
                  template_app
                   (template_app (template_hole 22, template_hole 21),
                    template_app
                     (template_app
                       (template_hole 20,
                        template_app
                         (template_app (template_hole 19, template_var 6),
                          template_var 5)),
                      template_app
                       (template_app (template_hole 18, template_var 4),
                        template_app
                         (template_hole 17,
                          template_app
                           (template_hole 16, template_hole 15)))))),
                template_hole 11),
              template_var 2)
            ),
        template_predicate
         (
            template_app
             (template_app
               (template_app (template_hole 10, template_var 4),
                template_var 3),
              template_hole 11)
            ),
        template_inequation
         (less_equals, template_app (template_hole 8, template_var 3),
          template_app
           (template_app
             (template_hole 7,
              template_app (template_hole 6, template_var 6)),
            template_app (template_hole 6, template_var 5))),
        template_predicate
         (
            template_app
             (template_app
               (template_app
                 (template_app (template_hole 5, template_var 6),
                  template_var 5),
                template_var 4),
              template_var 1)
            )],
       template_predicate
        (
           template_app
            (template_app
              (template_app
                (template_app (template_hole 5, template_var 6),
                 template_var 5),
               template_var 4),
             template_app
              (template_app (template_hole 4, template_hole 3),
               template_app
                (template_app (template_hole 2, template_var 1),
                 template_app
                  (template_app (template_hole 1, template_var 2),
                   template_app (template_hole 0, template_var 0)))))
           ))),
    ("PDF_Compiler.cdens_ctxt_invar_insert",
     "[| cdens_ctxt_invar ?vs ?vs' ?\<Gamma> ?\<delta>;
         ?\<Gamma> \<turnstile> ?e : ?t';
         free_vars ?e <= set ?vs Un set ?vs';
         dens_ctxt_\<alpha>
          ([], ?vs @ ?vs', ?\<Gamma>, CReal 1) \<turnstile>\<^sub>d
          ?e \<Rightarrow> (%x xa. ennreal (eval_cexpr ?f x xa));
         is_density_expr ([], ?vs @ ?vs', ?\<Gamma>, CReal 1) ?t' ?f |]
      ==> cdens_ctxt_invar (shift_vars ?vs) (map Suc ?vs')
           (case_nat ?t' ?\<Gamma>) (map_vars Suc ?\<delta> *\<^sub>c ?f)",
     template_implication
      ([template_predicate
         (
            template_app
             (template_app
               (template_app
                 (template_app (template_hole 26, template_var 6),
                  template_var 5),
                template_var 4),
              template_var 3)
            ),
        template_predicate
         (
            template_app
             (template_app
               (template_app (template_hole 25, template_var 4),
                template_var 2),
              template_var 1)
            ),
        template_inequation
         (less_equals, template_app (template_hole 23, template_var 2),
          template_app
           (template_app
             (template_hole 22,
              template_app (template_hole 21, template_var 6)),
            template_app (template_hole 21, template_var 5))),
        template_predicate
         (
            template_app
             (template_app
               (template_app
                 (template_hole 20,
                  template_app
                   (template_hole 19,
                    template_app
                     (template_app (template_hole 18, template_hole 17),
                      template_app
                       (template_app
                         (template_hole 16,
                          template_app
                           (template_app (template_hole 15, template_var 6),
                            template_var 5)),
                        template_app
                         (template_app (template_hole 14, template_var 4),
                          template_app
                           (template_hole 13,
                            template_app
                             (template_hole 12, template_hole 11))))))),
                template_var 2),
              t_empty)
            ),
        template_predicate
         (
            template_app
             (template_app
               (template_app
                 (template_hole 8,
                  template_app
                   (template_app (template_hole 18, template_hole 17),
                    template_app
                     (template_app
                       (template_hole 16,
                        template_app
                         (template_app (template_hole 15, template_var 6),
                          template_var 5)),
                      template_app
                       (template_app (template_hole 14, template_var 4),
                        template_app
                         (template_hole 13,
                          template_app
                           (template_hole 12, template_hole 11)))))),
                template_var 1),
              template_var 0)
            )],
       template_predicate
        (
           template_app
            (template_app
              (template_app
                (template_app
                  (template_hole 26,
                   template_app (template_hole 7, template_var 6)),
                 template_app
                  (template_app (template_hole 6, template_hole 5),
                   template_var 5)),
               template_app
                (template_app (template_hole 4, template_var 1),
                 template_var 4)),
             template_app
              (template_app (template_hole 3, template_hole 2),
               template_app
                (template_app
                  (template_hole 1,
                   template_app
                    (template_app (template_hole 0, template_hole 5),
                     template_var 3)),
                 template_var 0)))
           ))),
    ("PDF_Compiler_Pred.expr_has_density_sound_op",
     "[| density_context ?V ?V' ?\<Gamma> ?\<delta>;
         has_parametrized_subprob_density (state_measure ?V' ?\<Gamma>)
          (%\<rho>.
              dens_ctxt_measure (?V, ?V', ?\<Gamma>, ?\<delta>) \<rho> >>=
              (%\<sigma>. expr_sem \<sigma> ?e))
          (stock_measure ?t) ?f;
         (%(x, y). ?g x y)
         : borel_measurable
            (state_measure ?V' ?\<Gamma> \<Otimes>\<^sub>M
             stock_measure ?t');
         !!M \<rho>.
            has_subprob_density M (stock_measure ?t) (?f \<rho>) ==>
            has_density (distr M (stock_measure ?t') (op_sem ?oper))
             (stock_measure ?t') (?g \<rho>);
         ?\<Gamma> \<turnstile> ?e : ?t; op_type ?oper ?t = Some ?t';
         free_vars (?oper $$ ?e) <= ?V Un ?V' |]
      ==> has_parametrized_subprob_density (state_measure ?V' ?\<Gamma>)
           (%\<rho>.
               dens_ctxt_measure (?V, ?V', ?\<Gamma>, ?\<delta>) \<rho> >>=
               (%\<sigma>. expr_sem \<sigma> (?oper $$ ?e)))
           (stock_measure ?t') ?g",
     template_implication
      ([template_predicate
         (
            template_app
             (template_app
               (template_app
                 (template_app (template_hole 28, template_var 9),
                  template_var 8),
                template_var 7),
              template_var 6)
            ),
        template_predicate
         (
            template_app
             (template_app
               (template_app
                 (template_app
                   (template_hole 27,
                    template_app
                     (template_app (template_hole 26, template_var 8),
                      template_var 7)),
                  t_empty),
                template_app (template_hole 19, template_var 4)),
              template_var 3)
            ),
        template_predicate
         (
            template_app
             (template_app
               (template_hole 18,
                template_app (template_hole 17, template_var 2)),
              template_app
               (template_app
                 (template_hole 16,
                  template_app
                   (template_app
                     (template_hole 15,
                      template_app
                       (template_app (template_hole 26, template_var 8),
                        template_var 7)),
                    template_app (template_hole 19, template_var 1))),
                template_hole 14))
            ),
        template_predicate (template_app (template_hole 13, t_empty)),
        template_predicate
         (
            template_app
             (template_app
               (template_app (template_hole 7, template_var 7),
                template_var 5),
              template_var 4)
            ),
        template_equation
         (template_app
           (template_app (template_hole 5, template_var 0), template_var 4),
          template_app (template_hole 4, template_var 1)),
        template_inequation
         (less_equals,
          template_app
           (template_hole 2,
            template_app
             (template_app (template_hole 1, template_var 0),
              template_var 5)),
          template_app
           (template_app (template_hole 0, template_var 9),
            template_var 8))],
       template_predicate
        (
           template_app
            (template_app
              (template_app
                (template_app
                  (template_hole 27,
                   template_app
                    (template_app (template_hole 26, template_var 8),
                     template_var 7)),
                 t_empty),
               template_app (template_hole 19, template_var 1)),
             template_var 2)
           )))]
