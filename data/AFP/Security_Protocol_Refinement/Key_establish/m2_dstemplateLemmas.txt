   [("m2_ds.PO_m2_leak_refines_m1_leak",
     "{R12} m1_leak ?Rs, m2_leak ?Rs {> R12}",
     template_predicate
      (
         template_app
          (template_app
            (template_app
              (template_app (template_hole 3, template_hole 2),
               template_app (template_hole 1, template_var 0)),
             template_app (template_hole 0, template_var 0)),
           template_hole 2)
         )),
    ("m2_ds.PO_m2_tick_refines_m1_tick",
     "{R12} m1_tick ?T, m2_tick ?T {> R12}",
     template_predicate
      (
         template_app
          (template_app
            (template_app
              (template_app (template_hole 3, template_hole 2),
               template_app (template_hole 1, template_var 0)),
             template_app (template_hole 0, template_var 0)),
           template_hole 2)
         )),
    ("m2_ds.PO_m2_step1_refines_m1_step1",
     "{R12} m1_step1 ?Ra ?A ?B, m2_step1 ?Ra ?A ?B {> R12}",
     template_predicate
      (
         template_app
          (template_app
            (template_app
              (template_app (template_hole 3, template_hole 2),
               template_app
                (template_app
                  (template_app (template_hole 1, template_var 2),
                   template_var 1),
                 template_var 0)),
             template_app
              (template_app
                (template_app (template_hole 0, template_var 2),
                 template_var 1),
               template_var 0)),
           template_hole 2)
         )),
    ("m2_ds.PO_m2_step2_refines_m1_step2",
     "{R12} m1_step2 ?Rb ?A ?B, m2_step2 ?Rb ?A ?B {> R12}",
     template_predicate
      (
         template_app
          (template_app
            (template_app
              (template_app (template_hole 3, template_hole 2),
               template_app
                (template_app
                  (template_app (template_hole 1, template_var 2),
                   template_var 1),
                 template_var 0)),
             template_app
              (template_app
                (template_app (template_hole 0, template_var 2),
                 template_var 1),
               template_var 0)),
           template_hole 2)
         )),
    ("m2_ds.insert_commute_aKey",
     "insert (aKey ?K) (insert ?y ?A) = insert ?y (insert (aKey ?K) ?A)",
     template_equation
      (template_app
        (template_app
          (template_hole 1, template_app (template_hole 0, template_var 2)),
         template_app
          (template_app (template_hole 1, template_var 1), template_var 0)),
       template_app
        (template_app (template_hole 1, template_var 1),
         template_app
          (template_app
            (template_hole 1,
             template_app (template_hole 0, template_var 2)),
           template_var 0)))),
    ("m2_ds.PO_m2_step3_refines_m1_step3",
     "{R12} m1_step3 ?Rs ?A ?B ?Kab
             ?Ts, m2_step3 ?Rs ?A ?B ?Kab ?Ts {> R12}",
     template_predicate
      (
         template_app
          (template_app
            (template_app
              (template_app (template_hole 3, template_hole 2),
               template_app
                (template_app
                  (template_app
                    (template_app
                      (template_app (template_hole 1, template_var 4),
                       template_var 3),
                     template_var 2),
                   template_var 1),
                 template_var 0)),
             template_app
              (template_app
                (template_app
                  (template_app
                    (template_app (template_hole 0, template_var 4),
                     template_var 3),
                   template_var 2),
                 template_var 1),
               template_var 0)),
           template_hole 2)
         )),
    ("m2_ds.PO_m2_step4_refines_m1_step4",
     "{R12 Int
       UNIV \<times>
       (m2_inv4_M2a Int
        m2_inv3_extrKey)} m1_step4 ?Ra ?A ?B ?Kab
                           ?Ts, m2_step4 ?Ra ?A ?B ?Kab ?Ts {> R12}",
     template_predicate
      (
         template_app
          (template_app
            (template_app
              (template_app
                (template_hole 9,
                 template_app
                  (template_app (template_hole 8, template_hole 7),
                   template_app
                    (template_app (template_hole 6, template_hole 5),
                     t_empty))),
               template_app
                (template_app
                  (template_app
                    (template_app
                      (template_app (template_hole 1, template_var 4),
                       template_var 3),
                     template_var 2),
                   template_var 1),
                 template_var 0)),
             template_app
              (template_app
                (template_app
                  (template_app
                    (template_app (template_hole 0, template_var 4),
                     template_var 3),
                   template_var 2),
                 template_var 1),
               template_var 0)),
           template_hole 7)
         )),
    ("m2_ds.PO_m2_step5_refines_m1_step5",
     "{R12 Int
       UNIV \<times>
       (m2_inv4_M2b Int
        m2_inv3_extrKey)} m1_step5 ?Rb ?A ?B ?Kab
                           ?Ts, m2_step5 ?Rb ?A ?B ?Kab ?Ts {> R12}",
     template_predicate
      (
         template_app
          (template_app
            (template_app
              (template_app
                (template_hole 9,
                 template_app
                  (template_app (template_hole 8, template_hole 7),
                   template_app
                    (template_app (template_hole 6, template_hole 5),
                     t_empty))),
               template_app
                (template_app
                  (template_app
                    (template_app
                      (template_app (template_hole 1, template_var 4),
                       template_var 3),
                     template_var 2),
                   template_var 1),
                 template_var 0)),
             template_app
              (template_app
                (template_app
                  (template_app
                    (template_app (template_hole 0, template_var 4),
                     template_var 3),
                   template_var 2),
                 template_var 1),
               template_var 0)),
           template_hole 7)
         )),
    ("m2_ds.m2_inv3a_sesK_compr_simps",
     "?x : m2_inv3a_sesK_compr ==>
      (aKey ?K : extr (insert (aKey ?Kab) ik0) (chan ?x)) =
      (?K = ?Kab | aKey ?K : extr ik0 (chan ?x))",
     template_implication
      ([template_predicate
         (
            template_app
             (template_app (template_hole 10, template_var 2),
              template_hole 9)
            )],
       template_implication
        ([template_predicate
           (
              template_app
               (template_app
                 (template_hole 7,
                  template_app (template_hole 6, template_var 1)),
                template_app
                 (template_app
                   (template_hole 5,
                    template_app
                     (template_app
                       (template_hole 4,
                        template_app (template_hole 6, template_var 0)),
                      template_hole 3)),
                  template_app (template_hole 2, template_var 2)))
              )],
         template_predicate
          (
             template_app
              (template_app
                (template_hole 1,
                 template_app
                  (template_app (template_hole 0, template_var 1),
                   template_var 0)),
               template_app
                (template_app
                  (template_hole 7,
                   template_app (template_hole 6, template_var 1)),
                 template_app
                  (template_app (template_hole 5, template_hole 3),
                   template_app (template_hole 2, template_var 2))))
             )))),
    ("m2_ds.m2_inv3a_sesK_comprD",
     "?x : m2_inv3a_sesK_compr ==>
      (aKey ?K : extr (aKey ` ?KK Un ik0) (chan ?x)) =
      (?K : ?KK | aKey ?K : extr ik0 (chan ?x))",
     template_implication
      ([template_predicate
         (
            template_app
             (template_app (template_hole 11, template_var 2),
              template_hole 10)
            )],
       template_equation
        (template_app
          (template_app
            (template_hole 8,
             template_app (template_hole 7, template_var 1)),
           template_app
            (template_app
              (template_hole 6,
               template_app
                (template_app
                  (template_hole 5,
                   template_app
                    (template_app (template_hole 4, template_hole 7),
                     template_var 0)),
                 template_hole 3)),
             template_app (template_hole 2, template_var 2))),
         template_app
          (template_app
            (template_hole 1,
             template_app
              (template_app (template_hole 0, template_var 1),
               template_var 0)),
           template_app
            (template_app
              (template_hole 8,
               template_app (template_hole 7, template_var 1)),
             template_app
              (template_app (template_hole 6, template_hole 3),
               template_app (template_hole 2, template_var 2))))))),
    ("m2_ds.m2_inv3a_sesK_comprI",
     "(!!K KK.
          (aKey K : extr (aKey ` KK Un ik0) (chan ?x)) =
          (K : KK | aKey K : extr ik0 (chan ?x))) ==>
      ?x : m2_inv3a_sesK_compr",
     template_implication
      ([template_predicate (template_app (template_hole 14, t_empty))],
       template_predicate
        (
           template_app
            (template_app (template_hole 1, template_var 0),
             template_hole 0)
           ))),
    ("m2_ds.m2_inv3a_sesK_compr_simps",
     "?x : m2_inv3a_sesK_compr ==>
      (aKey ?K : extr (insert (aKey ?Kab) (aKey ` ?KK Un ik0)) (chan ?x)) =
      (?K = ?Kab | ?K : ?KK | aKey ?K : extr ik0 (chan ?x))",
     template_implication
      ([template_predicate
         (
            template_app
             (template_app (template_hole 13, template_var 3),
              template_hole 12)
            )],
       template_implication
        ([template_predicate
           (
              template_app
               (template_app
                 (template_hole 10,
                  template_app (template_hole 9, template_var 2)),
                template_app
                 (template_app
                   (template_hole 8,
                    template_app
                     (template_app
                       (template_hole 7,
                        template_app (template_hole 9, template_var 1)),
                      template_app
                       (template_app
                         (template_hole 6,
                          template_app
                           (template_app (template_hole 5, template_hole 9),
                            template_var 0)),
                        template_hole 4))),
                  template_app (template_hole 3, template_var 3)))
              )],
         template_predicate
          (
             template_app
              (template_app
                (template_hole 2,
                 template_app
                  (template_app (template_hole 1, template_var 2),
                   template_var 1)),
               template_app
                (template_app
                  (template_hole 2,
                   template_app
                    (template_app (template_hole 0, template_var 2),
                     template_var 0)),
                 template_app
                  (template_app
                    (template_hole 10,
                     template_app (template_hole 9, template_var 2)),
                   template_app
                    (template_app (template_hole 8, template_hole 4),
                     template_app (template_hole 3, template_var 3)))))
             )))),
    ("m2_ds.m2_inv3a_sesK_comprE",
     "[| ?x : m2_inv3a_sesK_compr;
         (!!K KK.
             (aKey K : extr (aKey ` KK Un ik0) (chan ?x)) =
             (K : KK | aKey K : extr ik0 (chan ?x))) ==>
         PROP ?W |]
      ==> PROP ?W",
     template_implication
      ([template_predicate
         (
            template_app
             (template_app (template_hole 13, template_var 1),
              template_hole 12)
            ),
        template_implication
         ([template_predicate (template_app (template_hole 11, t_empty))],
          template_predicate (template_var 0))],
       template_predicate (template_var 0))),
    ("m2_ds.m2_inv34_M2a_authorized",
     "[| StatCh secure Sv ?A (Msg [aAgt ?B, aKey ?K, aNum ?T]) : chan ?s;
         ?s : m2_inv3_extrKey; ?s : m2_inv4_M2a; ?K ~: leak ?s |]
      ==> (?K, ?A) : azC (runs ?s)",
     template_implication
      ([template_predicate
         (
            template_app
             (template_app
               (template_hole 23,
                template_app
                 (template_app
                   (template_app
                     (template_app
                       (template_hole 22,
                        template_app
                         (template_app (template_hole 21, template_hole 20),
                          template_app
                           (template_app
                             (template_hole 21, template_hole 19),
                            template_hole 18))),
                      template_hole 17),
                    template_var 4),
                  template_app
                   (template_hole 16,
                    template_app
                     (template_app
                       (template_hole 15,
                        template_app (template_hole 14, template_var 3)),
                      template_app
                       (template_app
                         (template_hole 15,
                          template_app (template_hole 13, template_var 2)),
                        template_app
                         (template_app
                           (template_hole 15,
                            template_app
                             (template_hole 12, template_var 1)),
                          template_hole 11)))))),
              template_app (template_hole 10, template_var 0))
            ),
        template_predicate
         (
            template_app
             (template_app (template_hole 9, template_var 0),
              template_hole 8)
            ),
        template_predicate
         (
            template_app
             (template_app (template_hole 9, template_var 0),
              template_hole 7)
            ),
        template_negation
         (
            template_predicate
             (
                template_app
                 (template_app (template_hole 5, template_var 2),
                  template_app (template_hole 4, template_var 0))
                )
            )],
       template_predicate
        (
           template_app
            (template_app
              (template_hole 3,
               template_app
                (template_app (template_hole 2, template_var 2),
                 template_var 4)),
             template_app
              (template_hole 1,
               template_app (template_hole 0, template_var 0)))
           ))),
    ("m2_ds.m2_inv34_M2b_authorized",
     "[| StatCh secure Sv ?B (Msg [aKey ?K, aAgt ?A, aNum ?T]) : chan ?s;
         ?s : m2_inv3_extrKey; ?s : m2_inv4_M2b; ?K ~: leak ?s |]
      ==> (?K, ?B) : azC (runs ?s)",
     template_implication
      ([template_predicate
         (
            template_app
             (template_app
               (template_hole 23,
                template_app
                 (template_app
                   (template_app
                     (template_app
                       (template_hole 22,
                        template_app
                         (template_app (template_hole 21, template_hole 20),
                          template_app
                           (template_app
                             (template_hole 21, template_hole 19),
                            template_hole 18))),
                      template_hole 17),
                    template_var 4),
                  template_app
                   (template_hole 16,
                    template_app
                     (template_app
                       (template_hole 15,
                        template_app (template_hole 14, template_var 3)),
                      template_app
                       (template_app
                         (template_hole 15,
                          template_app (template_hole 13, template_var 2)),
                        template_app
                         (template_app
                           (template_hole 15,
                            template_app
                             (template_hole 12, template_var 1)),
                          template_hole 11)))))),
              template_app (template_hole 10, template_var 0))
            ),
        template_predicate
         (
            template_app
             (template_app (template_hole 9, template_var 0),
              template_hole 8)
            ),
        template_predicate
         (
            template_app
             (template_app (template_hole 9, template_var 0),
              template_hole 7)
            ),
        template_negation
         (
            template_predicate
             (
                template_app
                 (template_app (template_hole 5, template_var 3),
                  template_app (template_hole 4, template_var 0))
                )
            )],
       template_predicate
        (
           template_app
            (template_app
              (template_hole 3,
               template_app
                (template_app (template_hole 2, template_var 3),
                 template_var 4)),
             template_app
              (template_hole 1,
               template_app (template_hole 0, template_var 0)))
           ))),
    ("m2_ds.m2_inv5_ikk_svD",
     "[| runs ?x ?R = Some (Serv, [?A, ?B], ?al); ?A : good; ?B : good;
         aKey (sesK (?R $ sk)) : extr ik0 (chan ?x); ?x : m2_inv5_ikk_sv |]
      ==> sesK (?R $ sk) : leak ?x",
     template_implication
      ([template_equation
         (template_app
           (template_app (template_hole 21, template_var 4),
            template_var 3),
          template_app
           (template_hole 20,
            template_app
             (template_app (template_hole 19, template_hole 18),
              template_app
               (template_app
                 (template_hole 17,
                  template_app
                   (template_app (template_hole 16, template_var 2),
                    template_app
                     (template_app (template_hole 16, template_var 1),
                      template_hole 15))),
                template_var 0)))),
        template_predicate
         (
            template_app
             (template_app (template_hole 14, template_var 2),
              template_app (template_hole 13, template_hole 12))
            ),
        template_predicate
         (
            template_app
             (template_app (template_hole 14, template_var 1),
              template_app (template_hole 13, template_hole 12))
            ),
        template_predicate
         (
            template_app
             (template_app
               (template_hole 11,
                template_app
                 (template_hole 10,
                  template_app
                   (template_hole 9,
                    template_app
                     (template_app (template_hole 8, template_var 3),
                      template_hole 7)))),
              template_app
               (template_app (template_hole 6, template_hole 5),
                template_app (template_hole 4, template_var 4)))
            ),
        template_predicate
         (
            template_app
             (template_app (template_hole 3, template_var 4),
              template_hole 2)
            )],
       template_predicate
        (
           template_app
            (template_app
              (template_hole 1,
               template_app
                (template_hole 9,
                 template_app
                  (template_app (template_hole 8, template_var 3),
                   template_hole 7))),
             template_app (template_hole 0, template_var 4))
           ))),
    ("m2_ds.m2_inv6_ikk_initD",
     "[| runs ?x ?Ra = Some (Init, [?A, ?B], aKey ?K # aNum ?Ts # ?nl);
         ?A : good; ?B : good; aKey ?K : extr ik0 (chan ?x);
         ?x : m2_inv6_ikk_init |]
      ==> ?K : leak ?x",
     template_implication
      ([template_equation
         (template_app
           (template_app (template_hole 20, template_var 6),
            template_var 5),
          template_app
           (template_hole 19,
            template_app
             (template_app (template_hole 18, template_hole 17),
              template_app
               (template_app
                 (template_hole 16,
                  template_app
                   (template_app (template_hole 15, template_var 4),
                    template_app
                     (template_app (template_hole 15, template_var 3),
                      template_hole 14))),
                template_app
                 (template_app
                   (template_hole 13,
                    template_app (template_hole 12, template_var 2)),
                  template_app
                   (template_app
                     (template_hole 13,
                      template_app (template_hole 11, template_var 1)),
                    template_var 0)))))),
        template_predicate
         (
            template_app
             (template_app (template_hole 10, template_var 4),
              template_app (template_hole 9, template_hole 8))
            ),
        template_predicate
         (
            template_app
             (template_app (template_hole 10, template_var 3),
              template_app (template_hole 9, template_hole 8))
            ),
        template_predicate
         (
            template_app
             (template_app
               (template_hole 7,
                template_app (template_hole 12, template_var 2)),
              template_app
               (template_app (template_hole 6, template_hole 5),
                template_app (template_hole 4, template_var 6)))
            ),
        template_predicate
         (
            template_app
             (template_app (template_hole 3, template_var 6),
              template_hole 2)
            )],
       template_predicate
        (
           template_app
            (template_app (template_hole 1, template_var 2),
             template_app (template_hole 0, template_var 6))
           ))),
    ("m2_ds.m2_inv7_ikk_respD",
     "[| runs ?x ?Rb = Some (Resp, [?A, ?B], aKey ?K # aNum ?Ts # ?nl);
         ?A : good; ?B : good; aKey ?K : extr ik0 (chan ?x);
         ?x : m2_inv7_ikk_resp |]
      ==> ?K : leak ?x",
     template_implication
      ([template_equation
         (template_app
           (template_app (template_hole 20, template_var 6),
            template_var 5),
          template_app
           (template_hole 19,
            template_app
             (template_app (template_hole 18, template_hole 17),
              template_app
               (template_app
                 (template_hole 16,
                  template_app
                   (template_app (template_hole 15, template_var 4),
                    template_app
                     (template_app (template_hole 15, template_var 3),
                      template_hole 14))),
                template_app
                 (template_app
                   (template_hole 13,
                    template_app (template_hole 12, template_var 2)),
                  template_app
                   (template_app
                     (template_hole 13,
                      template_app (template_hole 11, template_var 1)),
                    template_var 0)))))),
        template_predicate
         (
            template_app
             (template_app (template_hole 10, template_var 4),
              template_app (template_hole 9, template_hole 8))
            ),
        template_predicate
         (
            template_app
             (template_app (template_hole 10, template_var 3),
              template_app (template_hole 9, template_hole 8))
            ),
        template_predicate
         (
            template_app
             (template_app
               (template_hole 7,
                template_app (template_hole 12, template_var 2)),
              template_app
               (template_app (template_hole 6, template_hole 5),
                template_app (template_hole 4, template_var 6)))
            ),
        template_predicate
         (
            template_app
             (template_app (template_hole 3, template_var 6),
              template_hole 2)
            )],
       template_predicate
        (
           template_app
            (template_app (template_hole 1, template_var 2),
             template_app (template_hole 0, template_var 6))
           ))),
    ("m2_ds.m2_inv5_ikk_svI",
     "(!!R A B al.
          [| runs ?x R = Some (Serv, [A, B], al); A : good; B : good;
             aKey (sesK (R $ sk)) : extr ik0 (chan ?x) |]
          ==> sesK (R $ sk) : leak ?x) ==>
      ?x : m2_inv5_ikk_sv",
     template_implication
      ([template_predicate (template_app (template_hole 26, t_empty))],
       template_predicate
        (
           template_app
            (template_app (template_hole 1, template_var 0),
             template_hole 0)
           ))),
    ("m2_ds.m2_inv3_extrKeyD",
     "[| aKey ?K : extr ik0 (chan ?x); ?K ~: leak ?x;
         ?x : m2_inv3_extrKey |]
      ==> EX R A' B' Ts'.
             ?K = sesK (R $ sk) &
             runs ?x R = Some (Serv, [A', B'], [aNum Ts']) &
             (A' : bad | B' : bad)",
     template_implication
      ([template_predicate
         (
            template_app
             (template_app
               (template_hole 31,
                template_app (template_hole 30, template_var 1)),
              template_app
               (template_app (template_hole 29, template_hole 28),
                template_app (template_hole 27, template_var 0)))
            ),
        template_negation
         (
            template_predicate
             (
                template_app
                 (template_app (template_hole 25, template_var 1),
                  template_app (template_hole 24, template_var 0))
                )
            ),
        template_predicate
         (
            template_app
             (template_app (template_hole 23, template_var 0),
              template_hole 22)
            )],
       template_predicate (template_app (template_hole 21, t_empty)))),
    ("m2_ds.m2_inv4_M2aD",
     "[| StatCh secure Sv ?A (Msg [aAgt ?B, aKey ?Kab, aNum ?Ts]) : chan ?x;
         ?A : good; ?x : m2_inv4_M2a |]
      ==> EX Rs.
             ?Kab = sesK (Rs $ sk) &
             runs ?x Rs = Some (Serv, [?A, ?B], [aNum ?Ts])",
     template_implication
      ([template_predicate
         (
            template_app
             (template_app
               (template_hole 32,
                template_app
                 (template_app
                   (template_app
                     (template_app
                       (template_hole 31,
                        template_app
                         (template_app (template_hole 30, template_hole 29),
                          template_app
                           (template_app
                             (template_hole 30, template_hole 28),
                            template_hole 27))),
                      template_hole 26),
                    template_var 4),
                  template_app
                   (template_hole 25,
                    template_app
                     (template_app
                       (template_hole 24,
                        template_app (template_hole 23, template_var 3)),
                      template_app
                       (template_app
                         (template_hole 24,
                          template_app (template_hole 22, template_var 2)),
                        template_app
                         (template_app
                           (template_hole 24,
                            template_app
                             (template_hole 21, template_var 1)),
                          template_hole 20)))))),
              template_app (template_hole 19, template_var 0))
            ),
        template_predicate
         (
            template_app
             (template_app (template_hole 18, template_var 4),
              template_app (template_hole 17, template_hole 16))
            ),
        template_predicate
         (
            template_app
             (template_app (template_hole 15, template_var 0),
              template_hole 14)
            )],
       template_predicate (template_app (template_hole 13, t_empty)))),
    ("m2_ds.m2_inv4_M2bD",
     "[| StatCh secure Sv ?B (Msg [aKey ?Kab, aAgt ?A, aNum ?Ts]) : chan ?x;
         ?B : good; ?x : m2_inv4_M2b |]
      ==> EX Rs.
             ?Kab = sesK (Rs $ sk) &
             runs ?x Rs = Some (Serv, [?A, ?B], [aNum ?Ts])",
     template_implication
      ([template_predicate
         (
            template_app
             (template_app
               (template_hole 32,
                template_app
                 (template_app
                   (template_app
                     (template_app
                       (template_hole 31,
                        template_app
                         (template_app (template_hole 30, template_hole 29),
                          template_app
                           (template_app
                             (template_hole 30, template_hole 28),
                            template_hole 27))),
                      template_hole 26),
                    template_var 4),
                  template_app
                   (template_hole 25,
                    template_app
                     (template_app
                       (template_hole 24,
                        template_app (template_hole 23, template_var 3)),
                      template_app
                       (template_app
                         (template_hole 24,
                          template_app (template_hole 22, template_var 2)),
                        template_app
                         (template_app
                           (template_hole 24,
                            template_app
                             (template_hole 21, template_var 1)),
                          template_hole 20)))))),
              template_app (template_hole 19, template_var 0))
            ),
        template_predicate
         (
            template_app
             (template_app (template_hole 18, template_var 4),
              template_app (template_hole 17, template_hole 16))
            ),
        template_predicate
         (
            template_app
             (template_app (template_hole 15, template_var 0),
              template_hole 14)
            )],
       template_predicate (template_app (template_hole 13, t_empty)))),
    ("m2_ds.m2_inv3_extrKeyI",
     "(!!K. [| aKey K : extr ik0 (chan ?x); K ~: leak ?x |]
            ==> EX R A' B' Ts'.
                   K = sesK (R $ sk) &
                   runs ?x R = Some (Serv, [A', B'], [aNum Ts']) &
                   (A' : bad | B' : bad)) ==>
      ?x : m2_inv3_extrKey",
     template_implication
      ([template_predicate (template_app (template_hole 33, t_empty))],
       template_predicate
        (
           template_app
            (template_app (template_hole 1, template_var 0),
             template_hole 0)
           ))),
    ("m2_ds.m2_inv6_ikk_initI",
     "(!!A B Ra K Ts nl.
          [| runs ?x Ra = Some (Init, [A, B], aKey K # aNum Ts # nl);
             A : good; B : good; aKey K : extr ik0 (chan ?x) |]
          ==> K : leak ?x) ==>
      ?x : m2_inv6_ikk_init",
     template_implication
      ([template_predicate (template_app (template_hole 27, t_empty))],
       template_predicate
        (
           template_app
            (template_app (template_hole 1, template_var 0),
             template_hole 0)
           ))),
    ("m2_ds.m2_inv7_ikk_respI",
     "(!!A B Rb K Ts nl.
          [| runs ?x Rb = Some (Resp, [A, B], aKey K # aNum Ts # nl);
             A : good; B : good; aKey K : extr ik0 (chan ?x) |]
          ==> K : leak ?x) ==>
      ?x : m2_inv7_ikk_resp",
     template_implication
      ([template_predicate (template_app (template_hole 27, t_empty))],
       template_predicate
        (
           template_app
            (template_app (template_hole 1, template_var 0),
             template_hole 0)
           ))),
    ("m2_ds.m2_inv5_ikk_svE",
     "[| ?x : m2_inv5_ikk_sv;
         (!!R A B al.
             [| runs ?x R = Some (Serv, [A, B], al); A : good; B : good;
                aKey (sesK (R $ sk)) : extr ik0 (chan ?x) |]
             ==> sesK (R $ sk) : leak ?x) ==>
         PROP ?W |]
      ==> PROP ?W",
     template_implication
      ([template_predicate
         (
            template_app
             (template_app (template_hole 25, template_var 1),
              template_hole 24)
            ),
        template_implication
         ([template_predicate (template_app (template_hole 23, t_empty))],
          template_predicate (template_var 0))],
       template_predicate (template_var 0))),
    ("m2_ds.m2_inv3_extrKeyE",
     "[| ?x : m2_inv3_extrKey;
         (!!K. [| aKey K : extr ik0 (chan ?x); K ~: leak ?x |]
               ==> EX R A' B' Ts'.
                      K = sesK (R $ sk) &
                      runs ?x R = Some (Serv, [A', B'], [aNum Ts']) &
                      (A' : bad | B' : bad)) ==>
         PROP ?W |]
      ==> PROP ?W",
     template_implication
      ([template_predicate
         (
            template_app
             (template_app (template_hole 32, template_var 1),
              template_hole 31)
            ),
        template_implication
         ([template_predicate (template_app (template_hole 30, t_empty))],
          template_predicate (template_var 0))],
       template_predicate (template_var 0))),
    ("m2_ds.m2_inv6_ikk_initE",
     "[| ?x : m2_inv6_ikk_init;
         (!!A B Ra K Ts nl.
             [| runs ?x Ra = Some (Init, [A, B], aKey K # aNum Ts # nl);
                A : good; B : good; aKey K : extr ik0 (chan ?x) |]
             ==> K : leak ?x) ==>
         PROP ?W |]
      ==> PROP ?W",
     template_implication
      ([template_predicate
         (
            template_app
             (template_app (template_hole 26, template_var 1),
              template_hole 25)
            ),
        template_implication
         ([template_predicate (template_app (template_hole 24, t_empty))],
          template_predicate (template_var 0))],
       template_predicate (template_var 0))),
    ("m2_ds.m2_inv7_ikk_respE",
     "[| ?x : m2_inv7_ikk_resp;
         (!!A B Rb K Ts nl.
             [| runs ?x Rb = Some (Resp, [A, B], aKey K # aNum Ts # nl);
                A : good; B : good; aKey K : extr ik0 (chan ?x) |]
             ==> K : leak ?x) ==>
         PROP ?W |]
      ==> PROP ?W",
     template_implication
      ([template_predicate
         (
            template_app
             (template_app (template_hole 26, template_var 1),
              template_hole 25)
            ),
        template_implication
         ([template_predicate (template_app (template_hole 24, t_empty))],
          template_predicate (template_var 0))],
       template_predicate (template_var 0))),
    ("m2_ds.m2_inv4_M2bI",
     "(!!A B Kab Ts.
          [| StatCh secure Sv B (Msg [aKey Kab, aAgt A, aNum Ts]) : chan ?x;
             B : good |]
          ==> EX Rs.
                 Kab = sesK (Rs $ sk) &
                 runs ?x Rs = Some (Serv, [A, B], [aNum Ts])) ==>
      ?x : m2_inv4_M2b",
     template_implication
      ([template_predicate (template_app (template_hole 36, t_empty))],
       template_predicate
        (
           template_app
            (template_app (template_hole 1, template_var 0),
             template_hole 0)
           ))),
    ("m2_ds.m2_inv4_M2aI",
     "(!!A B Kab Ts.
          [| StatCh secure Sv A (Msg [aAgt B, aKey Kab, aNum Ts]) : chan ?x;
             A : good |]
          ==> EX Rs.
                 Kab = sesK (Rs $ sk) &
                 runs ?x Rs = Some (Serv, [A, B], [aNum Ts])) ==>
      ?x : m2_inv4_M2a",
     template_implication
      ([template_predicate (template_app (template_hole 36, t_empty))],
       template_predicate
        (
           template_app
            (template_app (template_hole 1, template_var 0),
             template_hole 0)
           ))),
    ("m2_ds.m2_inv4_M2aE",
     "[| ?x : m2_inv4_M2a;
         (!!A B Kab Ts.
             [| StatCh secure Sv A (Msg [aAgt B, aKey Kab, aNum Ts])
                : chan ?x;
                A : good |]
             ==> EX Rs.
                    Kab = sesK (Rs $ sk) &
                    runs ?x Rs = Some (Serv, [A, B], [aNum Ts])) ==>
         PROP ?W |]
      ==> PROP ?W",
     template_implication
      ([template_predicate
         (
            template_app
             (template_app (template_hole 35, template_var 1),
              template_hole 34)
            ),
        template_implication
         ([template_predicate (template_app (template_hole 33, t_empty))],
          template_predicate (template_var 0))],
       template_predicate (template_var 0))),
    ("m2_ds.m2_inv4_M2bE",
     "[| ?x : m2_inv4_M2b;
         (!!A B Kab Ts.
             [| StatCh secure Sv B (Msg [aKey Kab, aAgt A, aNum Ts])
                : chan ?x;
                B : good |]
             ==> EX Rs.
                    Kab = sesK (Rs $ sk) &
                    runs ?x Rs = Some (Serv, [A, B], [aNum Ts])) ==>
         PROP ?W |]
      ==> PROP ?W",
     template_implication
      ([template_predicate
         (
            template_app
             (template_app (template_hole 35, template_var 1),
              template_hole 34)
            ),
        template_implication
         ([template_predicate (template_app (template_hole 33, t_empty))],
          template_predicate (template_var 0))],
       template_predicate (template_var 0))),
    ("m2_ds.m2_inv4_M2a_M2b_match",
     "[| StatCh secure Sv ?A' (Msg [aAgt ?B', aKey ?Kab, aNum ?Ts'])
         : chan ?s;
         StatCh secure Sv ?B (Msg [aKey ?Kab, aAgt ?A, aNum ?Ts]) : chan ?s;
         aKey ?Kab ~: extr ik0 (chan ?s); ?s : m2_inv4_M2a;
         ?s : m2_inv4_M2b |]
      ==> ?A = ?A' & ?B = ?B' & ?Ts = ?Ts'",
     template_implication
      ([template_predicate
         (
            template_app
             (template_app
               (template_hole 23,
                template_app
                 (template_app
                   (template_app
                     (template_app
                       (template_hole 22,
                        template_app
                         (template_app (template_hole 21, template_hole 20),
                          template_app
                           (template_app
                             (template_hole 21, template_hole 19),
                            template_hole 18))),
                      template_hole 17),
                    template_var 7),
                  template_app
                   (template_hole 16,
                    template_app
                     (template_app
                       (template_hole 15,
                        template_app (template_hole 14, template_var 6)),
                      template_app
                       (template_app
                         (template_hole 15,
                          template_app (template_hole 13, template_var 5)),
                        template_app
                         (template_app
                           (template_hole 15,
                            template_app
                             (template_hole 12, template_var 4)),
                          template_hole 11)))))),
              template_app (template_hole 10, template_var 3))
            ),
        template_predicate
         (
            template_app
             (template_app
               (template_hole 23,
                template_app
                 (template_app
                   (template_app
                     (template_app
                       (template_hole 22,
                        template_app
                         (template_app (template_hole 21, template_hole 20),
                          template_app
                           (template_app
                             (template_hole 21, template_hole 19),
                            template_hole 18))),
                      template_hole 17),
                    template_var 2),
                  template_app
                   (template_hole 16,
                    template_app
                     (template_app
                       (template_hole 15,
                        template_app (template_hole 13, template_var 5)),
                      template_app
                       (template_app
                         (template_hole 15,
                          template_app (template_hole 14, template_var 1)),
                        template_app
                         (template_app
                           (template_hole 15,
                            template_app
                             (template_hole 12, template_var 0)),
                          template_hole 11)))))),
              template_app (template_hole 10, template_var 3))
            ),
        template_negation
         (
            template_predicate
             (
                template_app
                 (template_app
                   (template_hole 8,
                    template_app (template_hole 13, template_var 5)),
                  template_app
                   (template_app (template_hole 7, template_hole 6),
                    template_app (template_hole 10, template_var 3)))
                )
            ),
        template_predicate
         (
            template_app
             (template_app (template_hole 5, template_var 3),
              template_hole 4)
            ),
        template_predicate
         (
            template_app
             (template_app (template_hole 5, template_var 3),
              template_hole 3)
            )],
       template_predicate
        (
           template_app
            (template_app
              (template_hole 2,
               template_app
                (template_app (template_hole 1, template_var 1),
                 template_var 7)),
             template_app
              (template_app
                (template_hole 2,
                 template_app
                  (template_app (template_hole 1, template_var 2),
                   template_var 6)),
               template_app
                (template_app (template_hole 0, template_var 0),
                 template_var 4)))
           )))]
