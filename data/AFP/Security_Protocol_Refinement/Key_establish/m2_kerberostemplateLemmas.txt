   [("m2_kerberos.PO_m2_purge_refines_m1_purge",
     "{R12} m1_purge ?A, m2_purge ?A {> R12}",
     template_predicate
      (
         template_app
          (template_app
            (template_app
              (template_app (template_hole 3, template_hole 2),
               template_app (template_hole 1, template_var 0)),
             template_app (template_hole 0, template_var 0)),
           template_hole 2)
         )),
    ("m2_kerberos.PO_m2_tick_refines_m1_tick",
     "{R12} m1_tick ?T, m2_tick ?T {> R12}",
     template_predicate
      (
         template_app
          (template_app
            (template_app
              (template_app (template_hole 3, template_hole 2),
               template_app (template_hole 1, template_var 0)),
             template_app (template_hole 0, template_var 0)),
           template_hole 2)
         )),
    ("m2_kerberos.m2_inv5_ikk_sv_derived",
     "?s : m2_inv3_extrKey ==> ?s : m2_inv5_ikk_sv",
     template_implication
      ([template_predicate
         (
            template_app
             (template_app (template_hole 2, template_var 0),
              template_hole 1)
            )],
       template_predicate
        (
           template_app
            (template_app (template_hole 2, template_var 0),
             template_hole 0)
           ))),
    ("m2_kerberos.PO_m2_step2_refines_m1_step2",
     "{R12} m1_step2 ?Rb ?A ?B, m2_step2 ?Rb ?A ?B {> R12}",
     template_predicate
      (
         template_app
          (template_app
            (template_app
              (template_app (template_hole 3, template_hole 2),
               template_app
                (template_app
                  (template_app (template_hole 1, template_var 2),
                   template_var 1),
                 template_var 0)),
             template_app
              (template_app
                (template_app (template_hole 0, template_var 2),
                 template_var 1),
               template_var 0)),
           template_hole 2)
         )),
    ("m2_kerberos.insert_commute_aKey",
     "insert (aKey ?K) (insert ?y ?A) = insert ?y (insert (aKey ?K) ?A)",
     template_equation
      (template_app
        (template_app
          (template_hole 1, template_app (template_hole 0, template_var 2)),
         template_app
          (template_app (template_hole 1, template_var 1), template_var 0)),
       template_app
        (template_app (template_hole 1, template_var 1),
         template_app
          (template_app
            (template_hole 1,
             template_app (template_hole 0, template_var 2)),
           template_var 0)))),
    ("m2_kerberos.PO_m2_step1_refines_m1_step1",
     "{R12} m1_step1 ?Ra ?A ?B ?Na, m2_step1 ?Ra ?A ?B ?Na {> R12}",
     template_predicate
      (
         template_app
          (template_app
            (template_app
              (template_app (template_hole 3, template_hole 2),
               template_app
                (template_app
                  (template_app
                    (template_app (template_hole 1, template_var 3),
                     template_var 2),
                   template_var 1),
                 template_var 0)),
             template_app
              (template_app
                (template_app
                  (template_app (template_hole 0, template_var 3),
                   template_var 2),
                 template_var 1),
               template_var 0)),
           template_hole 2)
         )),
    ("m2_kerberos.PO_m2_leak_refines_leak",
     "{R12} m1_leak ?Rs ?A ?B ?Na ?Ts, m2_leak ?Rs ?A ?B ?Na ?Ts {> R12}",
     template_predicate
      (
         template_app
          (template_app
            (template_app
              (template_app (template_hole 3, template_hole 2),
               template_app
                (template_app
                  (template_app
                    (template_app
                      (template_app (template_hole 1, template_var 4),
                       template_var 3),
                     template_var 2),
                   template_var 1),
                 template_var 0)),
             template_app
              (template_app
                (template_app
                  (template_app
                    (template_app (template_hole 0, template_var 4),
                     template_var 3),
                   template_var 2),
                 template_var 1),
               template_var 0)),
           template_hole 2)
         )),
    ("m2_kerberos.PO_m2_step3_refines_m1_step3",
     "{R12} m1_step3 ?Rs ?A ?B ?Kab ?Na
             ?Ts, m2_step3 ?Rs ?A ?B ?Kab ?Na ?Ts {> R12}",
     template_predicate
      (
         template_app
          (template_app
            (template_app
              (template_app (template_hole 3, template_hole 2),
               template_app
                (template_app
                  (template_app
                    (template_app
                      (template_app
                        (template_app (template_hole 1, template_var 5),
                         template_var 4),
                       template_var 3),
                     template_var 2),
                   template_var 1),
                 template_var 0)),
             template_app
              (template_app
                (template_app
                  (template_app
                    (template_app
                      (template_app (template_hole 0, template_var 5),
                       template_var 4),
                     template_var 3),
                   template_var 2),
                 template_var 1),
               template_var 0)),
           template_hole 2)
         )),
    ("m2_kerberos.m2_inv2_keys_forD",
     "[| sesK (?R $ sk) : keys_for (chan ?x); ?x : m2_inv2_keys_for |]
      ==> ?R : dom (runs ?x)",
     template_implication
      ([template_predicate
         (
            template_app
             (template_app
               (template_hole 10,
                template_app
                 (template_hole 9,
                  template_app
                   (template_app (template_hole 8, template_var 1),
                    template_hole 7))),
              template_app
               (template_hole 6,
                template_app (template_hole 5, template_var 0)))
            ),
        template_predicate
         (
            template_app
             (template_app (template_hole 4, template_var 0),
              template_hole 3)
            )],
       template_predicate
        (
           template_app
            (template_app (template_hole 2, template_var 1),
             template_app
              (template_hole 1,
               template_app (template_hole 0, template_var 0)))
           ))),
    ("m2_kerberos.m2_inv2_keys_forI",
     "(!!R. sesK (R $ sk) : keys_for (chan ?x) ==> R : dom (runs ?x)) ==>
      ?x : m2_inv2_keys_for",
     template_implication
      ([template_predicate (template_app (template_hole 12, t_empty))],
       template_predicate
        (
           template_app
            (template_app (template_hole 1, template_var 0),
             template_hole 0)
           ))),
    ("m2_kerberos.PO_m2_step4_refines_m1_step4",
     "{R12 Int
       UNIV \<times>
       (m2_inv4_M2a Int
        m2_inv3_extrKey)} m1_step4 ?Ra ?A ?B ?Na ?Kab ?Ts
                           ?Ta, m2_step4 ?Ra ?A ?B ?Na ?Kab ?Ts
                                 ?Ta {> R12}",
     template_predicate
      (
         template_app
          (template_app
            (template_app
              (template_app
                (template_hole 9,
                 template_app
                  (template_app (template_hole 8, template_hole 7),
                   template_app
                    (template_app (template_hole 6, template_hole 5),
                     t_empty))),
               template_app
                (template_app
                  (template_app
                    (template_app
                      (template_app
                        (template_app
                          (template_app (template_hole 1, template_var 6),
                           template_var 5),
                         template_var 4),
                       template_var 3),
                     template_var 2),
                   template_var 1),
                 template_var 0)),
             template_app
              (template_app
                (template_app
                  (template_app
                    (template_app
                      (template_app
                        (template_app (template_hole 0, template_var 6),
                         template_var 5),
                       template_var 4),
                     template_var 3),
                   template_var 2),
                 template_var 1),
               template_var 0)),
           template_hole 7)
         )),
    ("m2_kerberos.m2_inv2_keys_forE",
     "[| ?x : m2_inv2_keys_for;
         (!!R. sesK (R $ sk) : keys_for (chan ?x) ==> R : dom (runs ?x)) ==>
         PROP ?W |]
      ==> PROP ?W",
     template_implication
      ([template_predicate
         (
            template_app
             (template_app (template_hole 11, template_var 1),
              template_hole 10)
            ),
        template_implication
         ([template_predicate (template_app (template_hole 9, t_empty))],
          template_predicate (template_var 0))],
       template_predicate (template_var 0))),
    ("m2_kerberos.m2_inv3a_sesK_compr_simps",
     "?x : m2_inv3a_sesK_compr ==>
      (aKey ?K : extr (insert (aKey ?Kab) ik0) (chan ?x)) =
      (?K = ?Kab | aKey ?K : extr ik0 (chan ?x))",
     template_implication
      ([template_predicate
         (
            template_app
             (template_app (template_hole 10, template_var 2),
              template_hole 9)
            )],
       template_implication
        ([template_predicate
           (
              template_app
               (template_app
                 (template_hole 7,
                  template_app (template_hole 6, template_var 1)),
                template_app
                 (template_app
                   (template_hole 5,
                    template_app
                     (template_app
                       (template_hole 4,
                        template_app (template_hole 6, template_var 0)),
                      template_hole 3)),
                  template_app (template_hole 2, template_var 2)))
              )],
         template_predicate
          (
             template_app
              (template_app
                (template_hole 1,
                 template_app
                  (template_app (template_hole 0, template_var 1),
                   template_var 0)),
               template_app
                (template_app
                  (template_hole 7,
                   template_app (template_hole 6, template_var 1)),
                 template_app
                  (template_app (template_hole 5, template_hole 3),
                   template_app (template_hole 2, template_var 2))))
             )))),
    ("m2_kerberos.m2_inv3a_sesK_comprD",
     "?x : m2_inv3a_sesK_compr ==>
      (aKey ?K : extr (aKey ` ?KK Un ik0) (chan ?x)) =
      (?K : ?KK | aKey ?K : extr ik0 (chan ?x))",
     template_implication
      ([template_predicate
         (
            template_app
             (template_app (template_hole 11, template_var 2),
              template_hole 10)
            )],
       template_equation
        (template_app
          (template_app
            (template_hole 8,
             template_app (template_hole 7, template_var 1)),
           template_app
            (template_app
              (template_hole 6,
               template_app
                (template_app
                  (template_hole 5,
                   template_app
                    (template_app (template_hole 4, template_hole 7),
                     template_var 0)),
                 template_hole 3)),
             template_app (template_hole 2, template_var 2))),
         template_app
          (template_app
            (template_hole 1,
             template_app
              (template_app (template_hole 0, template_var 1),
               template_var 0)),
           template_app
            (template_app
              (template_hole 8,
               template_app (template_hole 7, template_var 1)),
             template_app
              (template_app (template_hole 6, template_hole 3),
               template_app (template_hole 2, template_var 2))))))),
    ("m2_kerberos.m2_inv3b_leakD",
     "[| (sesK (?Rs $ sk), ?A, ?B, ?Na, ?Ts) : m1_state.leak ?x;
         ?x : m2_inv3b_leak |]
      ==> ?Ts + Ls <= clk ?x",
     template_implication
      ([template_predicate
         (
            template_app
             (template_app
               (template_hole 14,
                template_app
                 (template_app
                   (template_hole 13,
                    template_app
                     (template_hole 12,
                      template_app
                       (template_app (template_hole 11, template_var 5),
                        template_hole 10))),
                  template_app
                   (template_app (template_hole 9, template_var 4),
                    template_app
                     (template_app (template_hole 8, template_var 3),
                      template_app
                       (template_app (template_hole 7, template_var 2),
                        template_var 1))))),
              template_app (template_hole 6, template_var 0))
            ),
        template_predicate
         (
            template_app
             (template_app (template_hole 5, template_var 0),
              template_hole 4)
            )],
       template_inequation
        (less_equals,
         template_app
          (template_app (template_hole 2, template_var 1), template_hole 1),
         template_app (template_hole 0, template_var 0)))),
    ("m2_kerberos.PO_m2_step5_refines_m1_step5",
     "{R12 Int
       UNIV \<times>
       (m2_inv9_M3 Int m2_inv5_ikk_sv Int m2_inv4_M2b Int
        m2_inv3_extrKey Int
        m2_inv3b_leak)} m1_step5 ?Rb ?A ?B ?Kab ?Ts
                         ?Ta, m2_step5 ?Rb ?A ?B ?Kab ?Ts ?Ta {> R12}",
     template_predicate
      (
         template_app
          (template_app
            (template_app
              (template_app
                (template_hole 12,
                 template_app
                  (template_app (template_hole 11, template_hole 10),
                   template_app
                    (template_app (template_hole 9, template_hole 8),
                     t_empty))),
               template_app
                (template_app
                  (template_app
                    (template_app
                      (template_app
                        (template_app (template_hole 1, template_var 5),
                         template_var 4),
                       template_var 3),
                     template_var 2),
                   template_var 1),
                 template_var 0)),
             template_app
              (template_app
                (template_app
                  (template_app
                    (template_app
                      (template_app (template_hole 0, template_var 5),
                       template_var 4),
                     template_var 3),
                   template_var 2),
                 template_var 1),
               template_var 0)),
           template_hole 10)
         )),
    ("m2_kerberos.m2_inv1_keysD",
     "[| aKey (sesK (?R $ sk)) : atoms (chan ?x) |
         sesK (?R $ sk) : Domain (m1_state.leak ?x);
         ?x : m2_inv1_keys |]
      ==> ?R : dom (runs ?x)",
     template_implication
      ([template_predicate
         (
            template_app
             (template_app
               (template_hole 15,
                template_app
                 (template_app
                   (template_hole 14,
                    template_app
                     (template_hole 13,
                      template_app
                       (template_hole 12,
                        template_app
                         (template_app (template_hole 11, template_var 1),
                          template_hole 10)))),
                  template_app
                   (template_hole 9,
                    template_app (template_hole 8, template_var 0)))),
              template_app
               (template_app
                 (template_hole 7,
                  template_app
                   (template_hole 12,
                    template_app
                     (template_app (template_hole 11, template_var 1),
                      template_hole 10))),
                template_app
                 (template_hole 6,
                  template_app (template_hole 5, template_var 0))))
            ),
        template_predicate
         (
            template_app
             (template_app (template_hole 4, template_var 0),
              template_hole 3)
            )],
       template_predicate
        (
           template_app
            (template_app (template_hole 2, template_var 1),
             template_app
              (template_hole 1,
               template_app (template_hole 0, template_var 0)))
           ))),
    ("m2_kerberos.PO_m2_step6_refines_m1_step6",
     "{R12 Int
       UNIV \<times>
       (m2_inv9a_init_M2a Int m2_inv8_M4 Int m2_inv5_ikk_sv Int
        m2_inv4_M2a Int
        m2_inv3b_leak)} m1_step6 ?Ra ?A ?B ?Na ?Kab ?Ts
                         ?Ta, m2_step6 ?Ra ?A ?B ?Na ?Kab ?Ts ?Ta {> R12}",
     template_predicate
      (
         template_app
          (template_app
            (template_app
              (template_app
                (template_hole 12,
                 template_app
                  (template_app (template_hole 11, template_hole 10),
                   template_app
                    (template_app (template_hole 9, template_hole 8),
                     t_empty))),
               template_app
                (template_app
                  (template_app
                    (template_app
                      (template_app
                        (template_app
                          (template_app (template_hole 1, template_var 6),
                           template_var 5),
                         template_var 4),
                       template_var 3),
                     template_var 2),
                   template_var 1),
                 template_var 0)),
             template_app
              (template_app
                (template_app
                  (template_app
                    (template_app
                      (template_app
                        (template_app (template_hole 0, template_var 6),
                         template_var 5),
                       template_var 4),
                     template_var 3),
                   template_var 2),
                 template_var 1),
               template_var 0)),
           template_hole 10)
         )),
    ("m2_kerberos.m2_inv3a_sesK_comprI",
     "(!!K KK.
          (aKey K : extr (aKey ` KK Un ik0) (chan ?x)) =
          (K : KK | aKey K : extr ik0 (chan ?x))) ==>
      ?x : m2_inv3a_sesK_compr",
     template_implication
      ([template_predicate (template_app (template_hole 14, t_empty))],
       template_predicate
        (
           template_app
            (template_app (template_hole 1, template_var 0),
             template_hole 0)
           ))),
    ("m2_kerberos.m2_inv1_keysI",
     "(!!R. aKey (sesK (R $ sk)) : atoms (chan ?x) |
            sesK (R $ sk) : Domain (m1_state.leak ?x) ==>
            R : dom (runs ?x)) ==>
      ?x : m2_inv1_keys",
     template_implication
      ([template_predicate (template_app (template_hole 17, t_empty))],
       template_predicate
        (
           template_app
            (template_app (template_hole 1, template_var 0),
             template_hole 0)
           ))),
    ("m2_kerberos.m2_inv3a_sesK_compr_simps",
     "?x : m2_inv3a_sesK_compr ==>
      (aKey ?K : extr (insert (aKey ?Kab) (aKey ` ?KK Un ik0)) (chan ?x)) =
      (?K = ?Kab | ?K : ?KK | aKey ?K : extr ik0 (chan ?x))",
     template_implication
      ([template_predicate
         (
            template_app
             (template_app (template_hole 13, template_var 3),
              template_hole 12)
            )],
       template_implication
        ([template_predicate
           (
              template_app
               (template_app
                 (template_hole 10,
                  template_app (template_hole 9, template_var 2)),
                template_app
                 (template_app
                   (template_hole 8,
                    template_app
                     (template_app
                       (template_hole 7,
                        template_app (template_hole 9, template_var 1)),
                      template_app
                       (template_app
                         (template_hole 6,
                          template_app
                           (template_app (template_hole 5, template_hole 9),
                            template_var 0)),
                        template_hole 4))),
                  template_app (template_hole 3, template_var 3)))
              )],
         template_predicate
          (
             template_app
              (template_app
                (template_hole 2,
                 template_app
                  (template_app (template_hole 1, template_var 2),
                   template_var 1)),
               template_app
                (template_app
                  (template_hole 2,
                   template_app
                    (template_app (template_hole 0, template_var 2),
                     template_var 0)),
                 template_app
                  (template_app
                    (template_hole 10,
                     template_app (template_hole 9, template_var 2)),
                   template_app
                    (template_app (template_hole 8, template_hole 4),
                     template_app (template_hole 3, template_var 3)))))
             )))),
    ("m2_kerberos.m2_inv1_keysE",
     "[| ?x : m2_inv1_keys;
         (!!R. aKey (sesK (R $ sk)) : atoms (chan ?x) |
               sesK (R $ sk) : Domain (m1_state.leak ?x) ==>
               R : dom (runs ?x)) ==>
         PROP ?W |]
      ==> PROP ?W",
     template_implication
      ([template_predicate
         (
            template_app
             (template_app (template_hole 16, template_var 1),
              template_hole 15)
            ),
        template_implication
         ([template_predicate (template_app (template_hole 14, t_empty))],
          template_predicate (template_var 0))],
       template_predicate (template_var 0))),
    ("m2_kerberos.m2_inv3a_sesK_comprE",
     "[| ?x : m2_inv3a_sesK_compr;
         (!!K KK.
             (aKey K : extr (aKey ` KK Un ik0) (chan ?x)) =
             (K : KK | aKey K : extr ik0 (chan ?x))) ==>
         PROP ?W |]
      ==> PROP ?W",
     template_implication
      ([template_predicate
         (
            template_app
             (template_app (template_hole 13, template_var 1),
              template_hole 12)
            ),
        template_implication
         ([template_predicate (template_app (template_hole 11, t_empty))],
          template_predicate (template_var 0))],
       template_predicate (template_var 0))),
    ("m2_kerberos.m2_inv3b_leakI",
     "(!!Rs A B Na Ts.
          (sesK (Rs $ sk), A, B, Na, Ts) : m1_state.leak ?x ==>
          Ts + Ls <= clk ?x) ==>
      ?x : m2_inv3b_leak",
     template_implication
      ([template_predicate (template_app (template_hole 19, t_empty))],
       template_predicate
        (
           template_app
            (template_app (template_hole 1, template_var 0),
             template_hole 0)
           ))),
    ("m2_kerberos.m2_inv3b_leakE",
     "[| ?x : m2_inv3b_leak;
         (!!Rs A B Na Ts.
             (sesK (Rs $ sk), A, B, Na, Ts) : m1_state.leak ?x ==>
             Ts + Ls <= clk ?x) ==>
         PROP ?W |]
      ==> PROP ?W",
     template_implication
      ([template_predicate
         (
            template_app
             (template_app (template_hole 18, template_var 1),
              template_hole 17)
            ),
        template_implication
         ([template_predicate (template_app (template_hole 16, t_empty))],
          template_predicate (template_var 0))],
       template_predicate (template_var 0))),
    ("m2_kerberos.m2_inv34_M2b_authorized",
     "[| StatCh secure Sv ?B (Msg [aKey ?K, aAgt ?A, aNum ?T]) : chan ?s;
         ?s : m2_inv4_M2b; ?s : m2_inv3_extrKey;
         ?K ~: Domain (m1_state.leak ?s) |]
      ==> (?K, ?B) : azC (runs ?s)",
     template_implication
      ([template_predicate
         (
            template_app
             (template_app
               (template_hole 24,
                template_app
                 (template_app
                   (template_app
                     (template_app
                       (template_hole 23,
                        template_app
                         (template_app (template_hole 22, template_hole 21),
                          template_app
                           (template_app
                             (template_hole 22, template_hole 20),
                            template_hole 19))),
                      template_hole 18),
                    template_var 4),
                  template_app
                   (template_hole 17,
                    template_app
                     (template_app
                       (template_hole 16,
                        template_app (template_hole 15, template_var 3)),
                      template_app
                       (template_app
                         (template_hole 16,
                          template_app (template_hole 14, template_var 2)),
                        template_app
                         (template_app
                           (template_hole 16,
                            template_app
                             (template_hole 13, template_var 1)),
                          template_hole 12)))))),
              template_app (template_hole 11, template_var 0))
            ),
        template_predicate
         (
            template_app
             (template_app (template_hole 10, template_var 0),
              template_hole 9)
            ),
        template_predicate
         (
            template_app
             (template_app (template_hole 10, template_var 0),
              template_hole 8)
            ),
        template_negation
         (
            template_predicate
             (
                template_app
                 (template_app (template_hole 6, template_var 3),
                  template_app
                   (template_hole 5,
                    template_app (template_hole 4, template_var 0)))
                )
            )],
       template_predicate
        (
           template_app
            (template_app
              (template_hole 3,
               template_app
                (template_app (template_hole 2, template_var 3),
                 template_var 4)),
             template_app
              (template_hole 1,
               template_app (template_hole 0, template_var 0)))
           ))),
    ("m2_kerberos.m2_inv34_M2a_authorized",
     "[| StatCh secure Sv ?A (Msg [aKey ?K, aAgt ?B, aNum ?T, aNon ?N])
         : chan ?s;
         ?s : m2_inv4_M2a; ?s : m2_inv3_extrKey;
         ?K ~: Domain (m1_state.leak ?s) |]
      ==> (?K, ?A) : azC (runs ?s)",
     template_implication
      ([template_predicate
         (
            template_app
             (template_app
               (template_hole 25,
                template_app
                 (template_app
                   (template_app
                     (template_app
                       (template_hole 24,
                        template_app
                         (template_app (template_hole 23, template_hole 22),
                          template_app
                           (template_app
                             (template_hole 23, template_hole 21),
                            template_hole 20))),
                      template_hole 19),
                    template_var 5),
                  template_app
                   (template_hole 18,
                    template_app
                     (template_app
                       (template_hole 17,
                        template_app (template_hole 16, template_var 4)),
                      template_app
                       (template_app
                         (template_hole 17,
                          template_app (template_hole 15, template_var 3)),
                        template_app
                         (template_app
                           (template_hole 17,
                            template_app
                             (template_hole 14, template_var 2)),
                          template_app
                           (template_app
                             (template_hole 17,
                              template_app
                               (template_hole 13, template_var 1)),
                            template_hole 12))))))),
              template_app (template_hole 11, template_var 0))
            ),
        template_predicate
         (
            template_app
             (template_app (template_hole 10, template_var 0),
              template_hole 9)
            ),
        template_predicate
         (
            template_app
             (template_app (template_hole 10, template_var 0),
              template_hole 8)
            ),
        template_negation
         (
            template_predicate
             (
                template_app
                 (template_app (template_hole 6, template_var 4),
                  template_app
                   (template_hole 5,
                    template_app (template_hole 4, template_var 0)))
                )
            )],
       template_predicate
        (
           template_app
            (template_app
              (template_hole 3,
               template_app
                (template_app (template_hole 2, template_var 4),
                 template_var 5)),
             template_app
              (template_hole 1,
               template_app (template_hole 0, template_var 0)))
           ))),
    ("m2_kerberos.m2_inv9a_init_M2aD",
     "[| runs ?x ?Ra = Some (Init, [?A, ?B], aKey ?Kab # aNum ?Ts # ?z);
         ?x : m2_inv9a_init_M2a |]
      ==> StatCh secure Sv ?A
           (Msg [aKey ?Kab, aAgt ?B, aNum ?Ts, aNon (?Ra $ na)])
          : chan ?x",
     template_implication
      ([template_equation
         (template_app
           (template_app (template_hole 25, template_var 6),
            template_var 5),
          template_app
           (template_hole 24,
            template_app
             (template_app (template_hole 23, template_hole 22),
              template_app
               (template_app
                 (template_hole 21,
                  template_app
                   (template_app (template_hole 20, template_var 4),
                    template_app
                     (template_app (template_hole 20, template_var 3),
                      template_hole 19))),
                template_app
                 (template_app
                   (template_hole 18,
                    template_app (template_hole 17, template_var 2)),
                  template_app
                   (template_app
                     (template_hole 18,
                      template_app (template_hole 16, template_var 1)),
                    template_var 0)))))),
        template_predicate
         (
            template_app
             (template_app (template_hole 15, template_var 6),
              template_hole 14)
            )],
       template_predicate
        (
           template_app
            (template_app
              (template_hole 13,
               template_app
                (template_app
                  (template_app
                    (template_app
                      (template_hole 12,
                       template_app
                        (template_app (template_hole 11, template_hole 10),
                         template_app
                          (template_app (template_hole 11, template_hole 9),
                           template_hole 8))),
                     template_hole 7),
                   template_var 4),
                 template_app
                  (template_hole 6,
                   template_app
                    (template_app
                      (template_hole 18,
                       template_app (template_hole 17, template_var 2)),
                     template_app
                      (template_app
                        (template_hole 18,
                         template_app (template_hole 5, template_var 3)),
                       template_app
                        (template_app
                          (template_hole 18,
                           template_app (template_hole 16, template_var 1)),
                         template_app
                          (template_app
                            (template_hole 18,
                             template_app
                              (template_hole 4,
                               template_app
                                (template_app
                                  (template_hole 3, template_var 5),
                                 template_hole 2))),
                           template_hole 1))))))),
             template_app (template_hole 0, template_var 6))
           ))),
    ("m2_kerberos.m2_inv6_ikk_initD",
     "[| runs ?x ?Ra = Some (Init, [?A, ?B], aKey ?K # aNum ?Ts # ?nl);
         ?A : good; ?B : good; aKey ?K : extr ik0 (chan ?x);
         ?x : m2_inv6_ikk_init |]
      ==> (?K, ?A, ?B, ?Ra $ na, ?Ts) : m1_state.leak ?x",
     template_implication
      ([template_equation
         (template_app
           (template_app (template_hole 26, template_var 6),
            template_var 5),
          template_app
           (template_hole 25,
            template_app
             (template_app (template_hole 24, template_hole 23),
              template_app
               (template_app
                 (template_hole 22,
                  template_app
                   (template_app (template_hole 21, template_var 4),
                    template_app
                     (template_app (template_hole 21, template_var 3),
                      template_hole 20))),
                template_app
                 (template_app
                   (template_hole 19,
                    template_app (template_hole 18, template_var 2)),
                  template_app
                   (template_app
                     (template_hole 19,
                      template_app (template_hole 17, template_var 1)),
                    template_var 0)))))),
        template_predicate
         (
            template_app
             (template_app (template_hole 16, template_var 4),
              template_app (template_hole 15, template_hole 14))
            ),
        template_predicate
         (
            template_app
             (template_app (template_hole 16, template_var 3),
              template_app (template_hole 15, template_hole 14))
            ),
        template_predicate
         (
            template_app
             (template_app
               (template_hole 13,
                template_app (template_hole 18, template_var 2)),
              template_app
               (template_app (template_hole 12, template_hole 11),
                template_app (template_hole 10, template_var 6)))
            ),
        template_predicate
         (
            template_app
             (template_app (template_hole 9, template_var 6),
              template_hole 8)
            )],
       template_predicate
        (
           template_app
            (template_app
              (template_hole 7,
               template_app
                (template_app (template_hole 6, template_var 2),
                 template_app
                  (template_app (template_hole 5, template_var 4),
                   template_app
                    (template_app (template_hole 4, template_var 3),
                     template_app
                      (template_app
                        (template_hole 3,
                         template_app
                          (template_app (template_hole 2, template_var 5),
                           template_hole 1)),
                       template_var 1))))),
             template_app (template_hole 0, template_var 6))
           ))),
    ("m2_kerberos.m2_inv7_ikk_respD",
     "[| runs ?x ?Rb = Some (Resp, [?A, ?B], aKey ?K # aNum ?Ts # ?nl);
         ?A : good; ?B : good; aKey ?K : extr ik0 (chan ?x);
         ?x : m2_inv7_ikk_resp |]
      ==> EX Na. (?K, ?A, ?B, Na, ?Ts) : m1_state.leak ?x",
     template_implication
      ([template_equation
         (template_app
           (template_app (template_hole 25, template_var 6),
            template_var 5),
          template_app
           (template_hole 24,
            template_app
             (template_app (template_hole 23, template_hole 22),
              template_app
               (template_app
                 (template_hole 21,
                  template_app
                   (template_app (template_hole 20, template_var 4),
                    template_app
                     (template_app (template_hole 20, template_var 3),
                      template_hole 19))),
                template_app
                 (template_app
                   (template_hole 18,
                    template_app (template_hole 17, template_var 2)),
                  template_app
                   (template_app
                     (template_hole 18,
                      template_app (template_hole 16, template_var 1)),
                    template_var 0)))))),
        template_predicate
         (
            template_app
             (template_app (template_hole 15, template_var 4),
              template_app (template_hole 14, template_hole 13))
            ),
        template_predicate
         (
            template_app
             (template_app (template_hole 15, template_var 3),
              template_app (template_hole 14, template_hole 13))
            ),
        template_predicate
         (
            template_app
             (template_app
               (template_hole 12,
                template_app (template_hole 17, template_var 2)),
              template_app
               (template_app (template_hole 11, template_hole 10),
                template_app (template_hole 9, template_var 6)))
            ),
        template_predicate
         (
            template_app
             (template_app (template_hole 8, template_var 6),
              template_hole 7)
            )],
       template_predicate (template_app (template_hole 6, t_empty)))),
    ("m2_kerberos.m2_inv9a_init_M2aI",
     "(!!A B Ra Kab Ts z.
          runs ?x Ra = Some (Init, [A, B], aKey Kab # aNum Ts # z) ==>
          StatCh secure Sv A
           (Msg [aKey Kab, aAgt B, aNum Ts, aNon (Ra $ na)])
          : chan ?x) ==>
      ?x : m2_inv9a_init_M2a",
     template_implication
      ([template_predicate (template_app (template_hole 32, t_empty))],
       template_predicate
        (
           template_app
            (template_app (template_hole 1, template_var 0),
             template_hole 0)
           ))),
    ("m2_kerberos.m2_inv4_M2bD",
     "[| StatCh secure Sv ?B (Msg [aKey ?Kab, aAgt ?A, aNum ?Ts]) : chan ?x;
         ?B : good; ?x : m2_inv4_M2b |]
      ==> EX Rs Na.
             ?Kab = sesK (Rs $ sk) &
             runs ?x Rs = Some (Serv, [?A, ?B], [aNon Na, aNum ?Ts])",
     template_implication
      ([template_predicate
         (
            template_app
             (template_app
               (template_hole 34,
                template_app
                 (template_app
                   (template_app
                     (template_app
                       (template_hole 33,
                        template_app
                         (template_app (template_hole 32, template_hole 31),
                          template_app
                           (template_app
                             (template_hole 32, template_hole 30),
                            template_hole 29))),
                      template_hole 28),
                    template_var 4),
                  template_app
                   (template_hole 27,
                    template_app
                     (template_app
                       (template_hole 26,
                        template_app (template_hole 25, template_var 3)),
                      template_app
                       (template_app
                         (template_hole 26,
                          template_app (template_hole 24, template_var 2)),
                        template_app
                         (template_app
                           (template_hole 26,
                            template_app
                             (template_hole 23, template_var 1)),
                          template_hole 22)))))),
              template_app (template_hole 21, template_var 0))
            ),
        template_predicate
         (
            template_app
             (template_app (template_hole 20, template_var 4),
              template_app (template_hole 19, template_hole 18))
            ),
        template_predicate
         (
            template_app
             (template_app (template_hole 17, template_var 0),
              template_hole 16)
            )],
       template_predicate (template_app (template_hole 15, t_empty)))),
    ("m2_kerberos.m2_inv5_ikk_svD",
     "[| runs ?x ?R = Some (Serv, [?A, ?B], [aNon ?Na, aNum ?Ts]);
         ?A : good; ?B : good; aKey (sesK (?R $ sk)) : extr ik0 (chan ?x);
         ?x : m2_inv5_ikk_sv |]
      ==> (sesK (?R $ sk), ?A, ?B, ?Na, ?Ts) : m1_state.leak ?x",
     template_implication
      ([template_equation
         (template_app
           (template_app (template_hole 29, template_var 5),
            template_var 4),
          template_app
           (template_hole 28,
            template_app
             (template_app (template_hole 27, template_hole 26),
              template_app
               (template_app
                 (template_hole 25,
                  template_app
                   (template_app (template_hole 24, template_var 3),
                    template_app
                     (template_app (template_hole 24, template_var 2),
                      template_hole 23))),
                template_app
                 (template_app
                   (template_hole 22,
                    template_app (template_hole 21, template_var 1)),
                  template_app
                   (template_app
                     (template_hole 22,
                      template_app (template_hole 20, template_var 0)),
                    template_hole 19)))))),
        template_predicate
         (
            template_app
             (template_app (template_hole 18, template_var 3),
              template_app (template_hole 17, template_hole 16))
            ),
        template_predicate
         (
            template_app
             (template_app (template_hole 18, template_var 2),
              template_app (template_hole 17, template_hole 16))
            ),
        template_predicate
         (
            template_app
             (template_app
               (template_hole 15,
                template_app
                 (template_hole 14,
                  template_app
                   (template_hole 13,
                    template_app
                     (template_app (template_hole 12, template_var 4),
                      template_hole 11)))),
              template_app
               (template_app (template_hole 10, template_hole 9),
                template_app (template_hole 8, template_var 5)))
            ),
        template_predicate
         (
            template_app
             (template_app (template_hole 7, template_var 5),
              template_hole 6)
            )],
       template_predicate
        (
           template_app
            (template_app
              (template_hole 5,
               template_app
                (template_app
                  (template_hole 4,
                   template_app
                    (template_hole 13,
                     template_app
                      (template_app (template_hole 12, template_var 4),
                       template_hole 11))),
                 template_app
                  (template_app (template_hole 3, template_var 3),
                   template_app
                    (template_app (template_hole 2, template_var 2),
                     template_app
                      (template_app (template_hole 1, template_var 1),
                       template_var 0))))),
             template_app (template_hole 0, template_var 5))
           ))),
    ("m2_kerberos.m2_inv4_M2aD",
     "[| StatCh secure Sv ?A (Msg [aKey ?Kab, aAgt ?B, aNum ?Ts, aNon ?Na])
         : chan ?x;
         ?A : good; ?x : m2_inv4_M2a |]
      ==> EX Rs.
             ?Kab = sesK (Rs $ sk) &
             runs ?x Rs = Some (Serv, [?A, ?B], [aNon ?Na, aNum ?Ts])",
     template_implication
      ([template_predicate
         (
            template_app
             (template_app
               (template_hole 33,
                template_app
                 (template_app
                   (template_app
                     (template_app
                       (template_hole 32,
                        template_app
                         (template_app (template_hole 31, template_hole 30),
                          template_app
                           (template_app
                             (template_hole 31, template_hole 29),
                            template_hole 28))),
                      template_hole 27),
                    template_var 5),
                  template_app
                   (template_hole 26,
                    template_app
                     (template_app
                       (template_hole 25,
                        template_app (template_hole 24, template_var 4)),
                      template_app
                       (template_app
                         (template_hole 25,
                          template_app (template_hole 23, template_var 3)),
                        template_app
                         (template_app
                           (template_hole 25,
                            template_app
                             (template_hole 22, template_var 2)),
                          template_app
                           (template_app
                             (template_hole 25,
                              template_app
                               (template_hole 21, template_var 1)),
                            template_hole 20))))))),
              template_app (template_hole 19, template_var 0))
            ),
        template_predicate
         (
            template_app
             (template_app (template_hole 18, template_var 5),
              template_app (template_hole 17, template_hole 16))
            ),
        template_predicate
         (
            template_app
             (template_app (template_hole 15, template_var 0),
              template_hole 14)
            )],
       template_predicate (template_app (template_hole 13, t_empty)))),
    ("m2_kerberos.m2_inv9a_init_M2aE",
     "[| ?x : m2_inv9a_init_M2a;
         (!!A B Ra Kab Ts z.
             runs ?x Ra = Some (Init, [A, B], aKey Kab # aNum Ts # z) ==>
             StatCh secure Sv A
              (Msg [aKey Kab, aAgt B, aNum Ts, aNon (Ra $ na)])
             : chan ?x) ==>
         PROP ?W |]
      ==> PROP ?W",
     template_implication
      ([template_predicate
         (
            template_app
             (template_app (template_hole 31, template_var 1),
              template_hole 30)
            ),
        template_implication
         ([template_predicate (template_app (template_hole 29, t_empty))],
          template_predicate (template_var 0))],
       template_predicate (template_var 0))),
    ("m2_kerberos.m2_inv4_M2bI",
     "(!!A B Kab Ts.
          [| StatCh secure Sv B (Msg [aKey Kab, aAgt A, aNum Ts]) : chan ?x;
             B : good |]
          ==> EX Rs Na.
                 Kab = sesK (Rs $ sk) &
                 runs ?x Rs = Some (Serv, [A, B], [aNon Na, aNum Ts])) ==>
      ?x : m2_inv4_M2b",
     template_implication
      ([template_predicate (template_app (template_hole 38, t_empty))],
       template_predicate
        (
           template_app
            (template_app (template_hole 1, template_var 0),
             template_hole 0)
           ))),
    ("m2_kerberos.m2_inv6_ikk_initI",
     "(!!A B Ra K Ts nl.
          [| runs ?x Ra = Some (Init, [A, B], aKey K # aNum Ts # nl);
             A : good; B : good; aKey K : extr ik0 (chan ?x) |]
          ==> (K, A, B, Ra $ na, Ts) : m1_state.leak ?x) ==>
      ?x : m2_inv6_ikk_init",
     template_implication
      ([template_predicate (template_app (template_hole 33, t_empty))],
       template_predicate
        (
           template_app
            (template_app (template_hole 1, template_var 0),
             template_hole 0)
           ))),
    ("m2_kerberos.m2_inv7_ikk_respI",
     "(!!A B Rb K Ts nl.
          [| runs ?x Rb = Some (Resp, [A, B], aKey K # aNum Ts # nl);
             A : good; B : good; aKey K : extr ik0 (chan ?x) |]
          ==> EX Na. (K, A, B, Na, Ts) : m1_state.leak ?x) ==>
      ?x : m2_inv7_ikk_resp",
     template_implication
      ([template_predicate (template_app (template_hole 32, t_empty))],
       template_predicate
        (
           template_app
            (template_app (template_hole 1, template_var 0),
             template_hole 0)
           ))),
    ("m2_kerberos.m2_inv5_ikk_svI",
     "(!!R A B Na Ts.
          [| runs ?x R = Some (Serv, [A, B], [aNon Na, aNum Ts]); A : good;
             B : good; aKey (sesK (R $ sk)) : extr ik0 (chan ?x) |]
          ==> (sesK (R $ sk), A, B, Na, Ts) : m1_state.leak ?x) ==>
      ?x : m2_inv5_ikk_sv",
     template_implication
      ([template_predicate (template_app (template_hole 35, t_empty))],
       template_predicate
        (
           template_app
            (template_app (template_hole 1, template_var 0),
             template_hole 0)
           ))),
    ("m2_kerberos.m2_inv4_M2aI",
     "(!!A B Kab Ts Na.
          [| StatCh secure Sv A (Msg [aKey Kab, aAgt B, aNum Ts, aNon Na])
             : chan ?x;
             A : good |]
          ==> EX Rs.
                 Kab = sesK (Rs $ sk) &
                 runs ?x Rs = Some (Serv, [A, B], [aNon Na, aNum Ts])) ==>
      ?x : m2_inv4_M2a",
     template_implication
      ([template_predicate (template_app (template_hole 38, t_empty))],
       template_predicate
        (
           template_app
            (template_app (template_hole 1, template_var 0),
             template_hole 0)
           ))),
    ("m2_kerberos.m2_inv4_M2bE",
     "[| ?x : m2_inv4_M2b;
         (!!A B Kab Ts.
             [| StatCh secure Sv B (Msg [aKey Kab, aAgt A, aNum Ts])
                : chan ?x;
                B : good |]
             ==> EX Rs Na.
                    Kab = sesK (Rs $ sk) &
                    runs ?x Rs =
                    Some (Serv, [A, B], [aNon Na, aNum Ts])) ==>
         PROP ?W |]
      ==> PROP ?W",
     template_implication
      ([template_predicate
         (
            template_app
             (template_app (template_hole 37, template_var 1),
              template_hole 36)
            ),
        template_implication
         ([template_predicate (template_app (template_hole 35, t_empty))],
          template_predicate (template_var 0))],
       template_predicate (template_var 0))),
    ("m2_kerberos.m2_inv6_ikk_initE",
     "[| ?x : m2_inv6_ikk_init;
         (!!A B Ra K Ts nl.
             [| runs ?x Ra = Some (Init, [A, B], aKey K # aNum Ts # nl);
                A : good; B : good; aKey K : extr ik0 (chan ?x) |]
             ==> (K, A, B, Ra $ na, Ts) : m1_state.leak ?x) ==>
         PROP ?W |]
      ==> PROP ?W",
     template_implication
      ([template_predicate
         (
            template_app
             (template_app (template_hole 32, template_var 1),
              template_hole 31)
            ),
        template_implication
         ([template_predicate (template_app (template_hole 30, t_empty))],
          template_predicate (template_var 0))],
       template_predicate (template_var 0))),
    ("m2_kerberos.m2_inv7_ikk_respE",
     "[| ?x : m2_inv7_ikk_resp;
         (!!A B Rb K Ts nl.
             [| runs ?x Rb = Some (Resp, [A, B], aKey K # aNum Ts # nl);
                A : good; B : good; aKey K : extr ik0 (chan ?x) |]
             ==> EX Na. (K, A, B, Na, Ts) : m1_state.leak ?x) ==>
         PROP ?W |]
      ==> PROP ?W",
     template_implication
      ([template_predicate
         (
            template_app
             (template_app (template_hole 31, template_var 1),
              template_hole 30)
            ),
        template_implication
         ([template_predicate (template_app (template_hole 29, t_empty))],
          template_predicate (template_var 0))],
       template_predicate (template_var 0))),
    ("m2_kerberos.m2_inv5_ikk_svE",
     "[| ?x : m2_inv5_ikk_sv;
         (!!R A B Na Ts.
             [| runs ?x R = Some (Serv, [A, B], [aNon Na, aNum Ts]);
                A : good; B : good;
                aKey (sesK (R $ sk)) : extr ik0 (chan ?x) |]
             ==> (sesK (R $ sk), A, B, Na, Ts) : m1_state.leak ?x) ==>
         PROP ?W |]
      ==> PROP ?W",
     template_implication
      ([template_predicate
         (
            template_app
             (template_app (template_hole 34, template_var 1),
              template_hole 33)
            ),
        template_implication
         ([template_predicate (template_app (template_hole 32, t_empty))],
          template_predicate (template_var 0))],
       template_predicate (template_var 0))),
    ("m2_kerberos.m2_inv4_M2aE",
     "[| ?x : m2_inv4_M2a;
         (!!A B Kab Ts Na.
             [| StatCh secure Sv A
                 (Msg [aKey Kab, aAgt B, aNum Ts, aNon Na])
                : chan ?x;
                A : good |]
             ==> EX Rs.
                    Kab = sesK (Rs $ sk) &
                    runs ?x Rs =
                    Some (Serv, [A, B], [aNon Na, aNum Ts])) ==>
         PROP ?W |]
      ==> PROP ?W",
     template_implication
      ([template_predicate
         (
            template_app
             (template_app (template_hole 37, template_var 1),
              template_hole 36)
            ),
        template_implication
         ([template_predicate (template_app (template_hole 35, t_empty))],
          template_predicate (template_var 0))],
       template_predicate (template_var 0))),
    ("m2_kerberos.m2_inv3_extrKeyD",
     "[| aKey ?K : extr ik0 (chan ?x); ?x : m2_inv3_extrKey |]
      ==> ?K : corrKey & ?K : Domain (m1_state.leak ?x) |
          (EX R A' B' Na' Ts'.
              ?K = sesK (R $ sk) &
              runs ?x R = Some (Serv, [A', B'], [aNon Na', aNum Ts']) &
              (A' : bad |
               B' : bad | (?K, A', B', Na', Ts') : m1_state.leak ?x))",
     template_implication
      ([template_predicate
         (
            template_app
             (template_app
               (template_hole 39,
                template_app (template_hole 38, template_var 1)),
              template_app
               (template_app (template_hole 37, template_hole 36),
                template_app (template_hole 35, template_var 0)))
            ),
        template_predicate
         (
            template_app
             (template_app (template_hole 34, template_var 0),
              template_hole 33)
            )],
       template_predicate
        (
           template_app
            (template_app
              (template_hole 32,
               template_app
                (template_app
                  (template_hole 31,
                   template_app
                    (template_app (template_hole 30, template_var 1),
                     template_hole 29)),
                 template_app
                  (template_app (template_hole 30, template_var 1),
                   template_app
                    (template_hole 28,
                     template_app (template_hole 27, template_var 0))))),
             template_app (template_hole 26, t_empty))
           ))),
    ("m2_kerberos.m2_inv8_M4D",
     "[| StatCh secure Sv ?A (Msg [aKey ?Kab, aAgt ?B, aNum ?Ts, aNon ?N])
         : chan ?x;
         dAuth ?Kab (Msg [aNum ?Ta]) : chan ?x;
         aKey ?Kab ~: extr ik0 (chan ?x); ?x : m2_inv8_M4 |]
      ==> EX Rb.
             runs ?x Rb =
             Some (Resp, [?A, ?B], [aKey ?Kab, aNum ?Ts, aNum ?Ta])",
     template_implication
      ([template_predicate
         (
            template_app
             (template_app
               (template_hole 30,
                template_app
                 (template_app
                   (template_app
                     (template_app
                       (template_hole 29,
                        template_app
                         (template_app (template_hole 28, template_hole 27),
                          template_app
                           (template_app
                             (template_hole 28, template_hole 26),
                            template_hole 25))),
                      template_hole 24),
                    template_var 6),
                  template_app
                   (template_hole 23,
                    template_app
                     (template_app
                       (template_hole 22,
                        template_app (template_hole 21, template_var 5)),
                      template_app
                       (template_app
                         (template_hole 22,
                          template_app (template_hole 20, template_var 4)),
                        template_app
                         (template_app
                           (template_hole 22,
                            template_app
                             (template_hole 19, template_var 3)),
                          template_app
                           (template_app
                             (template_hole 22,
                              template_app
                               (template_hole 18, template_var 2)),
                            template_hole 17))))))),
              template_app (template_hole 16, template_var 1))
            ),
        template_predicate
         (
            template_app
             (template_app
               (template_hole 30,
                template_app
                 (template_app
                   (template_app
                     (template_hole 15,
                      template_app
                       (template_app (template_hole 28, template_hole 27),
                        template_hole 25)),
                    template_var 5),
                  template_app
                   (template_hole 23,
                    template_app
                     (template_app
                       (template_hole 22,
                        template_app (template_hole 19, template_var 0)),
                      template_hole 17)))),
              template_app (template_hole 16, template_var 1))
            ),
        template_negation
         (
            template_predicate
             (
                template_app
                 (template_app
                   (template_hole 13,
                    template_app (template_hole 21, template_var 5)),
                  template_app
                   (template_app (template_hole 12, template_hole 11),
                    template_app (template_hole 16, template_var 1)))
                )
            ),
        template_predicate
         (
            template_app
             (template_app (template_hole 10, template_var 1),
              template_hole 9)
            )],
       template_predicate (template_app (template_hole 8, t_empty)))),
    ("m2_kerberos.m2_inv4_M2a_M2b_match",
     "[| StatCh secure Sv ?A'
          (Msg [aKey ?Kab, aAgt ?B', aNum ?Ts', aNon ?N])
         : chan ?s;
         StatCh secure Sv ?B (Msg [aKey ?Kab, aAgt ?A, aNum ?Ts]) : chan ?s;
         aKey ?Kab ~: extr ik0 (chan ?s); ?s : m2_inv4_M2a;
         ?s : m2_inv4_M2b |]
      ==> ?A = ?A' & ?B = ?B' & ?Ts = ?Ts'",
     template_implication
      ([template_predicate
         (
            template_app
             (template_app
               (template_hole 24,
                template_app
                 (template_app
                   (template_app
                     (template_app
                       (template_hole 23,
                        template_app
                         (template_app (template_hole 22, template_hole 21),
                          template_app
                           (template_app
                             (template_hole 22, template_hole 20),
                            template_hole 19))),
                      template_hole 18),
                    template_var 8),
                  template_app
                   (template_hole 17,
                    template_app
                     (template_app
                       (template_hole 16,
                        template_app (template_hole 15, template_var 7)),
                      template_app
                       (template_app
                         (template_hole 16,
                          template_app (template_hole 14, template_var 6)),
                        template_app
                         (template_app
                           (template_hole 16,
                            template_app
                             (template_hole 13, template_var 5)),
                          template_app
                           (template_app
                             (template_hole 16,
                              template_app
                               (template_hole 12, template_var 4)),
                            template_hole 11))))))),
              template_app (template_hole 10, template_var 3))
            ),
        template_predicate
         (
            template_app
             (template_app
               (template_hole 24,
                template_app
                 (template_app
                   (template_app
                     (template_app
                       (template_hole 23,
                        template_app
                         (template_app (template_hole 22, template_hole 21),
                          template_app
                           (template_app
                             (template_hole 22, template_hole 20),
                            template_hole 19))),
                      template_hole 18),
                    template_var 2),
                  template_app
                   (template_hole 17,
                    template_app
                     (template_app
                       (template_hole 16,
                        template_app (template_hole 15, template_var 7)),
                      template_app
                       (template_app
                         (template_hole 16,
                          template_app (template_hole 14, template_var 1)),
                        template_app
                         (template_app
                           (template_hole 16,
                            template_app
                             (template_hole 13, template_var 0)),
                          template_hole 11)))))),
              template_app (template_hole 10, template_var 3))
            ),
        template_negation
         (
            template_predicate
             (
                template_app
                 (template_app
                   (template_hole 8,
                    template_app (template_hole 15, template_var 7)),
                  template_app
                   (template_app (template_hole 7, template_hole 6),
                    template_app (template_hole 10, template_var 3)))
                )
            ),
        template_predicate
         (
            template_app
             (template_app (template_hole 5, template_var 3),
              template_hole 4)
            ),
        template_predicate
         (
            template_app
             (template_app (template_hole 5, template_var 3),
              template_hole 3)
            )],
       template_predicate
        (
           template_app
            (template_app
              (template_hole 2,
               template_app
                (template_app (template_hole 1, template_var 1),
                 template_var 8)),
             template_app
              (template_app
                (template_hole 2,
                 template_app
                  (template_app (template_hole 1, template_var 2),
                   template_var 6)),
               template_app
                (template_app (template_hole 0, template_var 0),
                 template_var 5)))
           ))),
    ("m2_kerberos.m2_inv3_extrKeyI",
     "(!!K. aKey K : extr ik0 (chan ?x) ==>
            K : corrKey & K : Domain (m1_state.leak ?x) |
            (EX R A' B' Na' Ts'.
                K = sesK (R $ sk) &
                runs ?x R = Some (Serv, [A', B'], [aNon Na', aNum Ts']) &
                (A' : bad |
                 B' : bad | (K, A', B', Na', Ts') : m1_state.leak ?x))) ==>
      ?x : m2_inv3_extrKey",
     template_implication
      ([template_predicate (template_app (template_hole 41, t_empty))],
       template_predicate
        (
           template_app
            (template_app (template_hole 1, template_var 0),
             template_hole 0)
           ))),
    ("m2_kerberos.m2_inv9_M3D",
     "[| StatCh secure Sv ?B (Msg [aKey ?Kab, aAgt ?A, aNum ?Ts]) : chan ?x;
         dAuth ?Kab (Msg [aAgt ?A, aNum ?Ta]) : chan ?x;
         aKey ?Kab ~: extr ik0 (chan ?x); ?x : m2_inv9_M3 |]
      ==> EX Ra nl.
             runs ?x Ra =
             Some (Init, [?A, ?B], aKey ?Kab # aNum ?Ts # aNum ?Ta # nl)",
     template_implication
      ([template_predicate
         (
            template_app
             (template_app
               (template_hole 30,
                template_app
                 (template_app
                   (template_app
                     (template_app
                       (template_hole 29,
                        template_app
                         (template_app (template_hole 28, template_hole 27),
                          template_app
                           (template_app
                             (template_hole 28, template_hole 26),
                            template_hole 25))),
                      template_hole 24),
                    template_var 5),
                  template_app
                   (template_hole 23,
                    template_app
                     (template_app
                       (template_hole 22,
                        template_app (template_hole 21, template_var 4)),
                      template_app
                       (template_app
                         (template_hole 22,
                          template_app (template_hole 20, template_var 3)),
                        template_app
                         (template_app
                           (template_hole 22,
                            template_app
                             (template_hole 19, template_var 2)),
                          template_hole 18)))))),
              template_app (template_hole 17, template_var 1))
            ),
        template_predicate
         (
            template_app
             (template_app
               (template_hole 30,
                template_app
                 (template_app
                   (template_app
                     (template_hole 16,
                      template_app
                       (template_app (template_hole 28, template_hole 27),
                        template_hole 25)),
                    template_var 4),
                  template_app
                   (template_hole 23,
                    template_app
                     (template_app
                       (template_hole 22,
                        template_app (template_hole 20, template_var 3)),
                      template_app
                       (template_app
                         (template_hole 22,
                          template_app (template_hole 19, template_var 0)),
                        template_hole 18))))),
              template_app (template_hole 17, template_var 1))
            ),
        template_negation
         (
            template_predicate
             (
                template_app
                 (template_app
                   (template_hole 14,
                    template_app (template_hole 21, template_var 4)),
                  template_app
                   (template_app (template_hole 13, template_hole 12),
                    template_app (template_hole 17, template_var 1)))
                )
            ),
        template_predicate
         (
            template_app
             (template_app (template_hole 11, template_var 1),
              template_hole 10)
            )],
       template_predicate (template_app (template_hole 9, t_empty)))),
    ("m2_kerberos.m2_inv3_extrKeyE",
     "[| ?x : m2_inv3_extrKey;
         (!!K. aKey K : extr ik0 (chan ?x) ==>
               K : corrKey & K : Domain (m1_state.leak ?x) |
               (EX R A' B' Na' Ts'.
                   K = sesK (R $ sk) &
                   runs ?x R = Some (Serv, [A', B'], [aNon Na', aNum Ts']) &
                   (A' : bad |
                    B' : bad |
                    (K, A', B', Na', Ts') : m1_state.leak ?x))) ==>
         PROP ?W |]
      ==> PROP ?W",
     template_implication
      ([template_predicate
         (
            template_app
             (template_app (template_hole 40, template_var 1),
              template_hole 39)
            ),
        template_implication
         ([template_predicate (template_app (template_hole 38, t_empty))],
          template_predicate (template_var 0))],
       template_predicate (template_var 0))),
    ("m2_kerberos.m2_inv8_M4I",
     "(!!Kab A B Ts Ta N.
          [| StatCh secure Sv A (Msg [aKey Kab, aAgt B, aNum Ts, aNon N])
             : chan ?x;
             dAuth Kab (Msg [aNum Ta]) : chan ?x;
             aKey Kab ~: extr ik0 (chan ?x) |]
          ==> EX Rb.
                 runs ?x Rb =
                 Some (Resp, [A, B], [aKey Kab, aNum Ts, aNum Ta])) ==>
      ?x : m2_inv8_M4",
     template_implication
      ([template_predicate (template_app (template_hole 35, t_empty))],
       template_predicate
        (
           template_app
            (template_app (template_hole 1, template_var 0),
             template_hole 0)
           ))),
    ("m2_kerberos.m2_inv9_M3I",
     "(!!Kab A B Ts Ta.
          [| StatCh secure Sv B (Msg [aKey Kab, aAgt A, aNum Ts]) : chan ?x;
             dAuth Kab (Msg [aAgt A, aNum Ta]) : chan ?x;
             aKey Kab ~: extr ik0 (chan ?x) |]
          ==> EX Ra nl.
                 runs ?x Ra =
                 Some (Init, [A, B], aKey Kab # aNum Ts # aNum Ta # nl)) ==>
      ?x : m2_inv9_M3",
     template_implication
      ([template_predicate (template_app (template_hole 34, t_empty))],
       template_predicate
        (
           template_app
            (template_app (template_hole 1, template_var 0),
             template_hole 0)
           ))),
    ("m2_kerberos.m2_inv8_M4E",
     "[| ?x : m2_inv8_M4;
         (!!Kab A B Ts Ta N.
             [| StatCh secure Sv A (Msg [aKey Kab, aAgt B, aNum Ts, aNon N])
                : chan ?x;
                dAuth Kab (Msg [aNum Ta]) : chan ?x;
                aKey Kab ~: extr ik0 (chan ?x) |]
             ==> EX Rb.
                    runs ?x Rb =
                    Some (Resp, [A, B], [aKey Kab, aNum Ts, aNum Ta])) ==>
         PROP ?W |]
      ==> PROP ?W",
     template_implication
      ([template_predicate
         (
            template_app
             (template_app (template_hole 34, template_var 1),
              template_hole 33)
            ),
        template_implication
         ([template_predicate (template_app (template_hole 32, t_empty))],
          template_predicate (template_var 0))],
       template_predicate (template_var 0))),
    ("m2_kerberos.m2_inv9_M3E",
     "[| ?x : m2_inv9_M3;
         (!!Kab A B Ts Ta.
             [| StatCh secure Sv B (Msg [aKey Kab, aAgt A, aNum Ts])
                : chan ?x;
                dAuth Kab (Msg [aAgt A, aNum Ta]) : chan ?x;
                aKey Kab ~: extr ik0 (chan ?x) |]
             ==> EX Ra nl.
                    runs ?x Ra =
                    Some
                     (Init, [A, B], aKey Kab # aNum Ts # aNum Ta # nl)) ==>
         PROP ?W |]
      ==> PROP ?W",
     template_implication
      ([template_predicate
         (
            template_app
             (template_app (template_hole 33, template_var 1),
              template_hole 32)
            ),
        template_implication
         ([template_predicate (template_app (template_hole 31, t_empty))],
          template_predicate (template_var 0))],
       template_predicate (template_var 0)))]
