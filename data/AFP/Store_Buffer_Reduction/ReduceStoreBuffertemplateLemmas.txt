   [("ReduceStoreBuffer.causal_program_history_empty",
     "causal_program_history ?is []",
     template_predicate
      (
         template_app
          (template_app (template_hole 1, template_var 0), template_hole 0)
         )),
    ("ReduceStoreBuffer.restrict_map_UNIV", "?S |` UNIV = ?S",
     template_equation
      (template_app
        (template_app (template_hole 1, template_var 0), template_hole 0),
       template_var 0)),
    ("ReduceStoreBuffer.read_only_dom", "read_only ?\<S> <= dom ?\<S>",
     template_inequation
      (less_equals, template_app (template_hole 1, template_var 0),
       template_app (template_hole 0, template_var 0))),
    ("ReduceStoreBuffer.restrict_map_id", "?m |` dom ?m = ?m",
     template_equation
      (template_app
        (template_app (template_hole 1, template_var 0),
         template_app (template_hole 0, template_var 0)),
       template_var 0)),
    ("ReduceStoreBuffer.augment_empty",
     "?S \<oplus>\<^bsub>?x\<^esub> {} = ?S",
     template_equation
      (template_app
        (template_app
          (template_app (template_hole 1, template_var 1), template_var 0),
         template_hole 0),
       template_var 1)),
    ("ReduceStoreBuffer.restrict_shared_empty_set",
     "?S \<ominus>\<^bsub>{}\<^esub> {} = ?S",
     template_equation
      (template_app
        (template_app
          (template_app (template_hole 1, template_var 0), template_hole 0),
         template_hole 0),
       template_var 0)),
    ("ReduceStoreBuffer.rev_load_tmps",
     "load_tmps (rev ?xs) = load_tmps ?xs",
     template_equation
      (template_app
        (template_hole 1, template_app (template_hole 0, template_var 0)),
       template_app (template_hole 1, template_var 0))),
    ("ReduceStoreBuffer.rev_read_tmps",
     "read_tmps (rev ?xs) = read_tmps ?xs",
     template_equation
      (template_app
        (template_hole 1, template_app (template_hole 0, template_var 0)),
       template_app (template_hole 1, template_var 0))),
    ("ReduceStoreBuffer.restrict_shared_UNIV",
     "?m \<ominus>\<^bsub>?A\<^esub> UNIV = Map.empty",
     template_equation
      (template_app
        (template_app
          (template_app (template_hole 2, template_var 1), template_var 0),
         template_hole 1),
       t_empty)),
    ("ReduceStoreBuffer.address_of_simps",
     "address_of (Prog\<^sub>s\<^sub>b ?p ?p' ?is) = {}",
     template_equation
      (template_app
        (template_hole 2,
         template_app
          (template_app
            (template_app (template_hole 1, template_var 2),
             template_var 1),
           template_var 0)),
       template_hole 0)),
    ("ReduceStoreBuffer.is_Ghost\<^sub>s\<^sub>b_simps",
     "is_Ghost\<^sub>s\<^sub>b (Prog\<^sub>s\<^sub>b ?p ?p' ?is) = False",
     template_equation
      (template_app
        (template_hole 2,
         template_app
          (template_app
            (template_app (template_hole 1, template_var 2),
             template_var 1),
           template_var 0)),
       template_hole 0)),
    ("ReduceStoreBuffer.is_Prog\<^sub>s\<^sub>b_simps",
     "is_Prog\<^sub>s\<^sub>b (Prog\<^sub>s\<^sub>b ?p ?p' ?is) = True",
     template_equation
      (template_app
        (template_hole 2,
         template_app
          (template_app
            (template_app (template_hole 1, template_var 2),
             template_var 1),
           template_var 0)),
       template_hole 0)),
    ("ReduceStoreBuffer.is_Read\<^sub>s\<^sub>b_simps",
     "is_Read\<^sub>s\<^sub>b (Prog\<^sub>s\<^sub>b ?p ?p' ?is) = False",
     template_equation
      (template_app
        (template_hole 2,
         template_app
          (template_app
            (template_app (template_hole 1, template_var 2),
             template_var 1),
           template_var 0)),
       template_hole 0)),
    ("ReduceStoreBuffer.is_Write\<^sub>s\<^sub>b_simps",
     "is_Write\<^sub>s\<^sub>b (Prog\<^sub>s\<^sub>b ?p ?p' ?is) = False",
     template_equation
      (template_app
        (template_hole 2,
         template_app
          (template_app
            (template_app (template_hole 1, template_var 2),
             template_var 1),
           template_var 0)),
       template_hole 0)),
    ("ReduceStoreBuffer.is_non_volatile_Read\<^sub>s\<^sub>b_simps",
     "is_non_volatile_Read\<^sub>s\<^sub>b
       (Prog\<^sub>s\<^sub>b ?p ?p' ?is) =
      False",
     template_equation
      (template_app
        (template_hole 2,
         template_app
          (template_app
            (template_app (template_hole 1, template_var 2),
             template_var 1),
           template_var 0)),
       template_hole 0)),
    ("ReduceStoreBuffer.is_non_volatile_Write\<^sub>s\<^sub>b_simps",
     "is_non_volatile_Write\<^sub>s\<^sub>b
       (Prog\<^sub>s\<^sub>b ?p ?p' ?is) =
      False",
     template_equation
      (template_app
        (template_hole 2,
         template_app
          (template_app
            (template_app (template_hole 1, template_var 2),
             template_var 1),
           template_var 0)),
       template_hole 0)),
    ("ReduceStoreBuffer.is_volatile_simps",
     "is_volatile (Prog\<^sub>s\<^sub>b ?p ?p' ?is) = False",
     template_equation
      (template_app
        (template_hole 2,
         template_app
          (template_app
            (template_app (template_hole 1, template_var 2),
             template_var 1),
           template_var 0)),
       template_hole 0)),
    ("ReduceStoreBuffer.is_volatile_Read\<^sub>s\<^sub>b_simps",
     "is_volatile_Read\<^sub>s\<^sub>b (Prog\<^sub>s\<^sub>b ?p ?p' ?is) =
      False",
     template_equation
      (template_app
        (template_hole 2,
         template_app
          (template_app
            (template_app (template_hole 1, template_var 2),
             template_var 1),
           template_var 0)),
       template_hole 0)),
    ("ReduceStoreBuffer.is_volatile_Write\<^sub>s\<^sub>b_simps",
     "is_volatile_Write\<^sub>s\<^sub>b (Prog\<^sub>s\<^sub>b ?p ?p' ?is) =
      False",
     template_equation
      (template_app
        (template_hole 2,
         template_app
          (template_app
            (template_app (template_hole 1, template_var 2),
             template_var 1),
           template_var 0)),
       template_hole 0)),
    ("ReduceStoreBuffer.prog_instrs_filter_is_Prog\<^sub>s\<^sub>b",
     "prog_instrs (filter is_Prog\<^sub>s\<^sub>b ?xs) = prog_instrs ?xs",
     template_equation
      (template_app
        (template_hole 2,
         template_app
          (template_app (template_hole 1, template_hole 0),
           template_var 0)),
       template_app (template_hole 2, template_var 0))),
    ("ReduceStoreBuffer.length_dropWhile",
     "length (dropWhile ?P ?xs) <= length ?xs",
     template_inequation
      (less_equals,
       template_app
        (template_hole 1,
         template_app
          (template_app (template_hole 0, template_var 1), template_var 0)),
       template_app (template_hole 1, template_var 0))),
    ("ReduceStoreBuffer.outstanding_refs_subsets",
     "outstanding_refs is_non_volatile_Read\<^sub>s\<^sub>b ?sb
      <= outstanding_refs is_Read\<^sub>s\<^sub>b ?sb",
     template_inequation
      (less_equals,
       template_app
        (template_app (template_hole 2, template_hole 1), template_var 0),
       template_app
        (template_app (template_hole 2, template_hole 0), template_var 0))),
    ("ReduceStoreBuffer.outstanding_refs_subsets",
     "outstanding_refs is_non_volatile_Write\<^sub>s\<^sub>b ?sb
      <= outstanding_refs is_Write\<^sub>s\<^sub>b ?sb",
     template_inequation
      (less_equals,
       template_app
        (template_app (template_hole 2, template_hole 1), template_var 0),
       template_app
        (template_app (template_hole 2, template_hole 0), template_var 0))),
    ("ReduceStoreBuffer.outstanding_refs_subsets",
     "outstanding_refs is_volatile_Read\<^sub>s\<^sub>b ?sb
      <= outstanding_refs is_Read\<^sub>s\<^sub>b ?sb",
     template_inequation
      (less_equals,
       template_app
        (template_app (template_hole 2, template_hole 1), template_var 0),
       template_app
        (template_app (template_hole 2, template_hole 0), template_var 0))),
    ("ReduceStoreBuffer.outstanding_refs_subsets",
     "outstanding_refs is_volatile_Read\<^sub>s\<^sub>b ?sb
      <= outstanding_refs is_volatile ?sb",
     template_inequation
      (less_equals,
       template_app
        (template_app (template_hole 2, template_hole 1), template_var 0),
       template_app
        (template_app (template_hole 2, template_hole 0), template_var 0))),
    ("ReduceStoreBuffer.outstanding_refs_subsets",
     "outstanding_refs is_volatile_Write\<^sub>s\<^sub>b ?sb
      <= outstanding_refs is_Write\<^sub>s\<^sub>b ?sb",
     template_inequation
      (less_equals,
       template_app
        (template_app (template_hole 2, template_hole 1), template_var 0),
       template_app
        (template_app (template_hole 2, template_hole 0), template_var 0))),
    ("ReduceStoreBuffer.outstanding_refs_subsets",
     "outstanding_refs is_volatile_Write\<^sub>s\<^sub>b ?sb
      <= outstanding_refs is_volatile ?sb",
     template_inequation
      (less_equals,
       template_app
        (template_app (template_hole 2, template_hole 1), template_var 0),
       template_app
        (template_app (template_hole 2, template_hole 0), template_var 0))),
    ("ReduceStoreBuffer.unforwarded_non_volatile_reads_non_volatile_Read\<^sub>s\<^sub>b",
     "unforwarded_non_volatile_reads ?sb ?W
      <= outstanding_refs is_non_volatile_Read\<^sub>s\<^sub>b ?sb",
     template_inequation
      (less_equals,
       template_app
        (template_app (template_hole 2, template_var 1), template_var 0),
       template_app
        (template_app (template_hole 1, template_hole 0), template_var 1))),
    ("ReduceStoreBuffer.all_acquired_dropWhile",
     "all_acquired (dropWhile ?P ?sb) <= all_acquired ?sb",
     template_inequation
      (less_equals,
       template_app
        (template_hole 1,
         template_app
          (template_app (template_hole 0, template_var 1), template_var 0)),
       template_app (template_hole 1, template_var 0))),
    ("ReduceStoreBuffer.all_acquired_takeWhile",
     "all_acquired (takeWhile ?P ?sb) <= all_acquired ?sb",
     template_inequation
      (less_equals,
       template_app
        (template_hole 1,
         template_app
          (template_app (template_hole 0, template_var 1), template_var 0)),
       template_app (template_hole 1, template_var 0))),
    ("ReduceStoreBuffer.all_shared_dropWhile_subset",
     "all_shared (dropWhile ?P ?sb) <= all_shared ?sb",
     template_inequation
      (less_equals,
       template_app
        (template_hole 1,
         template_app
          (template_app (template_hole 0, template_var 1), template_var 0)),
       template_app (template_hole 1, template_var 0))),
    ("ReduceStoreBuffer.all_shared_takeWhile_subset",
     "all_shared (takeWhile ?P ?sb) <= all_shared ?sb",
     template_inequation
      (less_equals,
       template_app
        (template_hole 1,
         template_app
          (template_app (template_hole 0, template_var 1), template_var 0)),
       template_app (template_hole 1, template_var 0))),
    ("ReduceStoreBuffer.all_unshared_dropWhile_subset",
     "all_unshared (dropWhile ?P ?sb) <= all_unshared ?sb",
     template_inequation
      (less_equals,
       template_app
        (template_hole 1,
         template_app
          (template_app (template_hole 0, template_var 1), template_var 0)),
       template_app (template_hole 1, template_var 0))),
    ("ReduceStoreBuffer.all_unshared_takeWhile_subset",
     "all_unshared (takeWhile ?P ?sb) <= all_unshared ?sb",
     template_inequation
      (less_equals,
       template_app
        (template_hole 1,
         template_app
          (template_app (template_hole 0, template_var 1), template_var 0)),
       template_app (template_hole 1, template_var 0))),
    ("ReduceStoreBuffer.restrict_shared_empty",
     "Map.empty \<ominus>\<^bsub>?A\<^esub> ?L = Map.empty",
     template_equation
      (template_app
        (template_app
          (template_app (template_hole 1, t_empty), template_var 1),
         template_var 0),
       t_empty)),
    ("ReduceStoreBuffer.inter_neg", "?X Int - ?L = ?X - ?L",
     template_equation
      (template_app
        (template_app (template_hole 2, template_var 1),
         template_app (template_hole 1, template_var 0)),
       template_app
        (template_app (template_hole 0, template_var 1), template_var 0))),
    ("ReduceStoreBuffer.address_of_simps",
     "address_of (Ghost\<^sub>s\<^sub>b ?A ?L ?R ?W) = {}",
     template_equation
      (template_app
        (template_hole 2,
         template_app
          (template_app
            (template_app
              (template_app (template_hole 1, template_var 3),
               template_var 2),
             template_var 1),
           template_var 0)),
       template_hole 0)),
    ("ReduceStoreBuffer.is_volatile_split",
     "is_volatile ?r =
      (is_volatile_Read\<^sub>s\<^sub>b ?r |
       is_volatile_Write\<^sub>s\<^sub>b ?r)",
     template_equation
      (template_app (template_hole 3, template_var 0),
       template_app
        (template_app
          (template_hole 2, template_app (template_hole 1, template_var 0)),
         template_app (template_hole 0, template_var 0)))),
    ("ReduceStoreBuffer.is_Ghost\<^sub>s\<^sub>b_simps",
     "is_Ghost\<^sub>s\<^sub>b (Read\<^sub>s\<^sub>b ?volatile ?a ?t ?v) =
      False",
     template_equation
      (template_app
        (template_hole 2,
         template_app
          (template_app
            (template_app
              (template_app (template_hole 1, template_var 3),
               template_var 2),
             template_var 1),
           template_var 0)),
       template_hole 0)),
    ("ReduceStoreBuffer.is_Ghost\<^sub>s\<^sub>b_simps",
     "is_Ghost\<^sub>s\<^sub>b (Ghost\<^sub>s\<^sub>b ?A ?L ?R ?W) = True",
     template_equation
      (template_app
        (template_hole 2,
         template_app
          (template_app
            (template_app
              (template_app (template_hole 1, template_var 3),
               template_var 2),
             template_var 1),
           template_var 0)),
       template_hole 0)),
    ("ReduceStoreBuffer.is_Prog\<^sub>s\<^sub>b_simps",
     "is_Prog\<^sub>s\<^sub>b (Read\<^sub>s\<^sub>b ?volatile ?a ?t ?v) =
      False",
     template_equation
      (template_app
        (template_hole 2,
         template_app
          (template_app
            (template_app
              (template_app (template_hole 1, template_var 3),
               template_var 2),
             template_var 1),
           template_var 0)),
       template_hole 0)),
    ("ReduceStoreBuffer.is_Prog\<^sub>s\<^sub>b_simps",
     "is_Prog\<^sub>s\<^sub>b (Ghost\<^sub>s\<^sub>b ?A ?L ?R ?W) = False",
     template_equation
      (template_app
        (template_hole 2,
         template_app
          (template_app
            (template_app
              (template_app (template_hole 1, template_var 3),
               template_var 2),
             template_var 1),
           template_var 0)),
       template_hole 0)),
    ("ReduceStoreBuffer.is_Read\<^sub>s\<^sub>b_simps",
     "is_Read\<^sub>s\<^sub>b (Read\<^sub>s\<^sub>b ?volatile ?a ?t ?v) =
      True",
     template_equation
      (template_app
        (template_hole 2,
         template_app
          (template_app
            (template_app
              (template_app (template_hole 1, template_var 3),
               template_var 2),
             template_var 1),
           template_var 0)),
       template_hole 0)),
    ("ReduceStoreBuffer.is_Read\<^sub>s\<^sub>b_simps",
     "is_Read\<^sub>s\<^sub>b (Ghost\<^sub>s\<^sub>b ?A ?L ?R ?W) = False",
     template_equation
      (template_app
        (template_hole 2,
         template_app
          (template_app
            (template_app
              (template_app (template_hole 1, template_var 3),
               template_var 2),
             template_var 1),
           template_var 0)),
       template_hole 0)),
    ("ReduceStoreBuffer.is_Write\<^sub>s\<^sub>b_simps",
     "is_Write\<^sub>s\<^sub>b (Read\<^sub>s\<^sub>b ?volatile ?a ?t ?v) =
      False",
     template_equation
      (template_app
        (template_hole 2,
         template_app
          (template_app
            (template_app
              (template_app (template_hole 1, template_var 3),
               template_var 2),
             template_var 1),
           template_var 0)),
       template_hole 0)),
    ("ReduceStoreBuffer.is_Write\<^sub>s\<^sub>b_simps",
     "is_Write\<^sub>s\<^sub>b (Ghost\<^sub>s\<^sub>b ?A ?L ?R ?W) = False",
     template_equation
      (template_app
        (template_hole 2,
         template_app
          (template_app
            (template_app
              (template_app (template_hole 1, template_var 3),
               template_var 2),
             template_var 1),
           template_var 0)),
       template_hole 0)),
    ("ReduceStoreBuffer.is_non_volatile_Read\<^sub>s\<^sub>b_simps",
     "is_non_volatile_Read\<^sub>s\<^sub>b
       (Ghost\<^sub>s\<^sub>b ?A ?L ?R ?W) =
      False",
     template_equation
      (template_app
        (template_hole 2,
         template_app
          (template_app
            (template_app
              (template_app (template_hole 1, template_var 3),
               template_var 2),
             template_var 1),
           template_var 0)),
       template_hole 0)),
    ("ReduceStoreBuffer.is_non_volatile_Write\<^sub>s\<^sub>b_simps",
     "is_non_volatile_Write\<^sub>s\<^sub>b
       (Read\<^sub>s\<^sub>b ?volatile ?a ?t ?v) =
      False",
     template_equation
      (template_app
        (template_hole 2,
         template_app
          (template_app
            (template_app
              (template_app (template_hole 1, template_var 3),
               template_var 2),
             template_var 1),
           template_var 0)),
       template_hole 0)),
    ("ReduceStoreBuffer.is_non_volatile_Write\<^sub>s\<^sub>b_simps",
     "is_non_volatile_Write\<^sub>s\<^sub>b
       (Ghost\<^sub>s\<^sub>b ?A ?L ?R ?W) =
      False",
     template_equation
      (template_app
        (template_hole 2,
         template_app
          (template_app
            (template_app
              (template_app (template_hole 1, template_var 3),
               template_var 2),
             template_var 1),
           template_var 0)),
       template_hole 0)),
    ("ReduceStoreBuffer.is_volatile_simps",
     "is_volatile (Read\<^sub>s\<^sub>b ?volatile ?a ?t ?v) = ?volatile",
     template_equation
      (template_app
        (template_hole 1,
         template_app
          (template_app
            (template_app
              (template_app (template_hole 0, template_var 3),
               template_var 2),
             template_var 1),
           template_var 0)),
       template_var 3)),
    ("ReduceStoreBuffer.is_volatile_simps",
     "is_volatile (Ghost\<^sub>s\<^sub>b ?A ?L ?R ?W) = False",
     template_equation
      (template_app
        (template_hole 2,
         template_app
          (template_app
            (template_app
              (template_app (template_hole 1, template_var 3),
               template_var 2),
             template_var 1),
           template_var 0)),
       template_hole 0)),
    ("ReduceStoreBuffer.is_volatile_Read\<^sub>s\<^sub>b_simps",
     "is_volatile_Read\<^sub>s\<^sub>b
       (Read\<^sub>s\<^sub>b ?volatile ?a ?t ?v) =
      ?volatile",
     template_equation
      (template_app
        (template_hole 1,
         template_app
          (template_app
            (template_app
              (template_app (template_hole 0, template_var 3),
               template_var 2),
             template_var 1),
           template_var 0)),
       template_var 3)),
    ("ReduceStoreBuffer.is_volatile_Read\<^sub>s\<^sub>b_simps",
     "is_volatile_Read\<^sub>s\<^sub>b (Ghost\<^sub>s\<^sub>b ?A ?L ?R ?W) =
      False",
     template_equation
      (template_app
        (template_hole 2,
         template_app
          (template_app
            (template_app
              (template_app (template_hole 1, template_var 3),
               template_var 2),
             template_var 1),
           template_var 0)),
       template_hole 0)),
    ("ReduceStoreBuffer.is_volatile_Write\<^sub>s\<^sub>b_simps",
     "is_volatile_Write\<^sub>s\<^sub>b
       (Read\<^sub>s\<^sub>b ?volatile ?a ?t ?v) =
      False",
     template_equation
      (template_app
        (template_hole 2,
         template_app
          (template_app
            (template_app
              (template_app (template_hole 1, template_var 3),
               template_var 2),
             template_var 1),
           template_var 0)),
       template_hole 0)),
    ("ReduceStoreBuffer.is_volatile_Write\<^sub>s\<^sub>b_simps",
     "is_volatile_Write\<^sub>s\<^sub>b
       (Ghost\<^sub>s\<^sub>b ?A ?L ?R ?W) =
      False",
     template_equation
      (template_app
        (template_hole 2,
         template_app
          (template_app
            (template_app
              (template_app (template_hole 1, template_var 3),
               template_var 2),
             template_var 1),
           template_var 0)),
       template_hole 0)),
    ("ReduceStoreBuffer.shared_le_map_le",
     "?m\<^sub>1 \<subseteq>\<^sub>s ?m\<^sub>2 ==>
      ?m\<^sub>1 \<subseteq>\<^sub>m ?m\<^sub>2",
     template_implication
      ([template_predicate
         (
            template_app
             (template_app (template_hole 1, template_var 1),
              template_var 0)
            )],
       template_predicate
        (
           template_app
            (template_app (template_hole 0, template_var 1), template_var 0)
           ))),
    ("ReduceStoreBuffer.outstanding_volatile_writes_unowned_by_others_tl",
     "outstanding_volatile_writes_unowned_by_others (?t # ?ts) ==>
      outstanding_volatile_writes_unowned_by_others ?ts",
     template_implication
      ([template_predicate
         (
            template_app
             (template_hole 1,
              template_app
               (template_app (template_hole 0, template_var 1),
                template_var 0))
            )],
       template_predicate
        (template_app (template_hole 1, template_var 0)))),
    ("ReduceStoreBuffer.ownership_distinct_tl",
     "ownership_distinct (?t # ?ts) ==> ownership_distinct ?ts",
     template_implication
      ([template_predicate
         (
            template_app
             (template_hole 1,
              template_app
               (template_app (template_hole 0, template_var 1),
                template_var 0))
            )],
       template_predicate
        (template_app (template_hole 1, template_var 0)))),
    ("ReduceStoreBuffer.read_only_reads_unowned_tl",
     "read_only_reads_unowned (?t # ?ts) ==> read_only_reads_unowned ?ts",
     template_implication
      ([template_predicate
         (
            template_app
             (template_hole 1,
              template_app
               (template_app (template_hole 0, template_var 1),
                template_var 0))
            )],
       template_predicate
        (template_app (template_hole 1, template_var 0)))),
    ("ReduceStoreBuffer.safe_reach_safe_refl",
     "safe_reach ?step ?safe ?cfg ==> ?safe ?cfg",
     template_implication
      ([template_predicate
         (
            template_app
             (template_app
               (template_app (template_hole 0, template_var 2),
                template_var 1),
              template_var 0)
            )],
       template_predicate (template_app (template_var 1, template_var 0)))),
    ("ReduceStoreBuffer.weak_sharing_consis_tl",
     "weak_sharing_consis (?t # ?ts) ==> weak_sharing_consis ?ts",
     template_implication
      ([template_predicate
         (
            template_app
             (template_hole 1,
              template_app
               (template_app (template_hole 0, template_var 1),
                template_var 0))
            )],
       template_predicate
        (template_app (template_hole 1, template_var 0)))),
    ("ReduceStoreBuffer.takeWhile_prefix",
     "EX ys. takeWhile ?P ?xs @ ys = ?xs",
     template_predicate (template_app (template_hole 3, t_empty))),
    ("ReduceStoreBuffer.hd_prog_idem",
     "hd_prog (hd_prog ?p ?xs) ?xs = hd_prog ?p ?xs",
     template_equation
      (template_app
        (template_app
          (template_hole 0,
           template_app
            (template_app (template_hole 0, template_var 1),
             template_var 0)),
         template_var 0),
       template_app
        (template_app (template_hole 0, template_var 1), template_var 0))),
    ("ReduceStoreBuffer.last_prog_hd_prog",
     "last_prog (hd_prog ?p ?xs) ?xs = last_prog ?p ?xs",
     template_equation
      (template_app
        (template_app
          (template_hole 1,
           template_app
            (template_app (template_hole 0, template_var 1),
             template_var 0)),
         template_var 0),
       template_app
        (template_app (template_hole 1, template_var 1), template_var 0))),
    ("ReduceStoreBuffer.last_prog_idem",
     "last_prog (last_prog ?p ?sb) ?sb = last_prog ?p ?sb",
     template_equation
      (template_app
        (template_app
          (template_hole 0,
           template_app
            (template_app (template_hole 0, template_var 1),
             template_var 0)),
         template_var 0),
       template_app
        (template_app (template_hole 0, template_var 1), template_var 0))),
    ("ReduceStoreBuffer.acquired_no_pending_write",
     "acquired False ?xs ?A = acquired False ?xs ?B",
     template_equation
      (template_app
        (template_app
          (template_app (template_hole 1, template_hole 0), template_var 2),
         template_var 1),
       template_app
        (template_app
          (template_app (template_hole 1, template_hole 0), template_var 2),
         template_var 0))),
    ("ReduceStoreBuffer.acquired_reads_no_pending_write",
     "acquired_reads False ?xs ?A = acquired_reads False ?xs ?B",
     template_equation
      (template_app
        (template_app
          (template_app (template_hole 1, template_hole 0), template_var 2),
         template_var 1),
       template_app
        (template_app
          (template_app (template_hole 1, template_hole 0), template_var 2),
         template_var 0))),
    ("ReduceStoreBuffer.outstanding_refs_takeWhile_opposite",
     "outstanding_refs ?P (takeWhile (Not o ?P) ?xs) = {}",
     template_equation
      (template_app
        (template_app (template_hole 4, template_var 1),
         template_app
          (template_app
            (template_hole 3,
             template_app
              (template_app (template_hole 2, template_hole 1),
               template_var 1)),
           template_var 0)),
       template_hole 0)),
    ("ReduceStoreBuffer.takeWhile_not_vol_write_outstanding_refs",
     "outstanding_refs is_volatile_Write\<^sub>s\<^sub>b
       (takeWhile (Not o is_volatile_Write\<^sub>s\<^sub>b) ?sb) =
      {}",
     template_equation
      (template_app
        (template_app (template_hole 5, template_hole 4),
         template_app
          (template_app
            (template_hole 3,
             template_app
              (template_app (template_hole 2, template_hole 1),
               template_hole 4)),
           template_var 0)),
       template_hole 0)),
    ("ReduceStoreBuffer.is_non_volatile_Read\<^sub>s\<^sub>b_simps",
     "is_non_volatile_Read\<^sub>s\<^sub>b
       (Read\<^sub>s\<^sub>b ?volatile ?a ?t ?v) =
      (~ ?volatile)",
     template_equation
      (template_app
        (template_hole 2,
         template_app
          (template_app
            (template_app
              (template_app (template_hole 1, template_var 3),
               template_var 2),
             template_var 1),
           template_var 0)),
       template_app (template_hole 0, template_var 3))),
    ("ReduceStoreBuffer.outstanding_refs_subsets",
     "outstanding_refs is_Read\<^sub>s\<^sub>b ?sb
      <= outstanding_refs (Not o is_volatile_Write\<^sub>s\<^sub>b) ?sb",
     template_inequation
      (less_equals,
       template_app
        (template_app (template_hole 4, template_hole 3), template_var 0),
       template_app
        (template_app
          (template_hole 4,
           template_app
            (template_app (template_hole 2, template_hole 1),
             template_hole 0)),
         template_var 0))),
    ("ReduceStoreBuffer.outstanding_refs_subsets",
     "outstanding_refs is_non_volatile_Read\<^sub>s\<^sub>b ?sb
      <= outstanding_refs (Not o is_volatile) ?sb",
     template_inequation
      (less_equals,
       template_app
        (template_app (template_hole 4, template_hole 3), template_var 0),
       template_app
        (template_app
          (template_hole 4,
           template_app
            (template_app (template_hole 2, template_hole 1),
             template_hole 0)),
         template_var 0))),
    ("ReduceStoreBuffer.outstanding_refs_subsets",
     "outstanding_refs is_non_volatile_Read\<^sub>s\<^sub>b ?sb
      <= outstanding_refs (Not o is_volatile_Write\<^sub>s\<^sub>b) ?sb",
     template_inequation
      (less_equals,
       template_app
        (template_app (template_hole 4, template_hole 3), template_var 0),
       template_app
        (template_app
          (template_hole 4,
           template_app
            (template_app (template_hole 2, template_hole 1),
             template_hole 0)),
         template_var 0))),
    ("ReduceStoreBuffer.outstanding_refs_subsets",
     "outstanding_refs is_non_volatile_Write\<^sub>s\<^sub>b ?sb
      <= outstanding_refs (Not o is_volatile) ?sb",
     template_inequation
      (less_equals,
       template_app
        (template_app (template_hole 4, template_hole 3), template_var 0),
       template_app
        (template_app
          (template_hole 4,
           template_app
            (template_app (template_hole 2, template_hole 1),
             template_hole 0)),
         template_var 0))),
    ("ReduceStoreBuffer.outstanding_refs_subsets",
     "outstanding_refs is_non_volatile_Write\<^sub>s\<^sub>b ?sb
      <= outstanding_refs (Not o is_volatile_Write\<^sub>s\<^sub>b) ?sb",
     template_inequation
      (less_equals,
       template_app
        (template_app (template_hole 4, template_hole 3), template_var 0),
       template_app
        (template_app
          (template_hole 4,
           template_app
            (template_app (template_hole 2, template_hole 1),
             template_hole 0)),
         template_var 0))),
    ("ReduceStoreBuffer.outstanding_refs_subsets",
     "outstanding_refs is_volatile_Read\<^sub>s\<^sub>b ?sb
      <= outstanding_refs (Not o is_volatile_Write\<^sub>s\<^sub>b) ?sb",
     template_inequation
      (less_equals,
       template_app
        (template_app (template_hole 4, template_hole 3), template_var 0),
       template_app
        (template_app
          (template_hole 4,
           template_app
            (template_app (template_hole 2, template_hole 1),
             template_hole 0)),
         template_var 0))),
    ("ReduceStoreBuffer.acquired_pending_write_mono",
     "acquired False ?xs ?A <= acquired True ?xs ?B",
     template_inequation
      (less_equals,
       template_app
        (template_app
          (template_app (template_hole 2, template_hole 1), template_var 2),
         template_var 1),
       template_app
        (template_app
          (template_app (template_hole 2, template_hole 0), template_var 2),
         template_var 0))),
    ("ReduceStoreBuffer.acquired_all_acquired",
     "acquired ?pending_write ?xs ?A <= ?A Un all_acquired ?xs",
     template_inequation
      (less_equals,
       template_app
        (template_app
          (template_app (template_hole 2, template_var 2), template_var 1),
         template_var 0),
       template_app
        (template_app (template_hole 1, template_var 0),
         template_app (template_hole 0, template_var 1)))),
    ("ReduceStoreBuffer.acquired_reads_pending_write_mono",
     "acquired_reads False ?xs ?A <= acquired_reads True ?xs ?A",
     template_inequation
      (less_equals,
       template_app
        (template_app
          (template_app (template_hole 2, template_hole 1), template_var 1),
         template_var 0),
       template_app
        (template_app
          (template_app (template_hole 2, template_hole 0), template_var 1),
         template_var 0))),
    ("ReduceStoreBuffer.acquired_reads_all_acquired",
     "acquired_reads ?pending_write ?sb ?\<O> <= ?\<O> Un all_acquired ?sb",
     template_inequation
      (less_equals,
       template_app
        (template_app
          (template_app (template_hole 2, template_var 2), template_var 1),
         template_var 0),
       template_app
        (template_app (template_hole 1, template_var 0),
         template_app (template_hole 0, template_var 1)))),
    ("ReduceStoreBuffer.outstanding_refs_takeWhile",
     "outstanding_refs ?P (takeWhile ?P' ?sb) <= outstanding_refs ?P ?sb",
     template_inequation
      (less_equals,
       template_app
        (template_app (template_hole 1, template_var 2),
         template_app
          (template_app (template_hole 0, template_var 1), template_var 0)),
       template_app
        (template_app (template_hole 1, template_var 2), template_var 0))),
    ("ReduceStoreBuffer.is_volatile_Write\<^sub>s\<^sub>b_address_of",
     "is_volatile_Write\<^sub>s\<^sub>b ?x ==> address_of ?x ~= {}",
     template_implication
      ([template_predicate
         (template_app (template_hole 4, template_var 0))],
       template_negation
        (
           template_equation
            (template_app (template_hole 1, template_var 0),
             template_hole 0)
           ))),
    ("ReduceStoreBuffer.refl'", "?x = ?y ==> ?r^** ?x ?y",
     template_implication
      ([template_equation (template_var 2, template_var 1)],
       template_predicate
        (
           template_app
            (template_app
              (template_app (template_hole 0, template_var 0),
               template_var 2),
             template_var 1)
           ))),
    ("ReduceStoreBuffer.sharing_consistent_weak_sharing_consistent",
     "sharing_consistent ?\<S> ?\<O> ?sb ==>
      weak_sharing_consistent ?\<O> ?sb",
     template_implication
      ([template_predicate
         (
            template_app
             (template_app
               (template_app (template_hole 1, template_var 2),
                template_var 1),
              template_var 0)
            )],
       template_predicate
        (
           template_app
            (template_app (template_hole 0, template_var 1), template_var 0)
           ))),
    ("ReduceStoreBuffer.all_acquired_append",
     "all_acquired (?xs @ ?ys) = all_acquired ?xs Un all_acquired ?ys",
     template_equation
      (template_app
        (template_hole 2,
         template_app
          (template_app (template_hole 1, template_var 1), template_var 0)),
       template_app
        (template_app
          (template_hole 0, template_app (template_hole 2, template_var 1)),
         template_app (template_hole 2, template_var 0)))),
    ("ReduceStoreBuffer.all_shared_append",
     "all_shared (?xs @ ?ys) = all_shared ?xs Un all_shared ?ys",
     template_equation
      (template_app
        (template_hole 2,
         template_app
          (template_app (template_hole 1, template_var 1), template_var 0)),
       template_app
        (template_app
          (template_hole 0, template_app (template_hole 2, template_var 1)),
         template_app (template_hole 2, template_var 0)))),
    ("ReduceStoreBuffer.all_unshared_append",
     "all_unshared (?xs @ ?ys) = all_unshared ?xs Un all_unshared ?ys",
     template_equation
      (template_app
        (template_hole 2,
         template_app
          (template_app (template_hole 1, template_var 1), template_var 0)),
       template_app
        (template_app
          (template_hole 0, template_app (template_hole 2, template_var 1)),
         template_app (template_hole 2, template_var 0)))),
    ("ReduceStoreBuffer.load_tmps_append",
     "load_tmps (?xs @ ?ys) = load_tmps ?xs Un load_tmps ?ys",
     template_equation
      (template_app
        (template_hole 2,
         template_app
          (template_app (template_hole 1, template_var 1), template_var 0)),
       template_app
        (template_app
          (template_hole 0, template_app (template_hole 2, template_var 1)),
         template_app (template_hole 2, template_var 0)))),
    ("ReduceStoreBuffer.read_tmps_append",
     "read_tmps (?xs @ ?ys) = read_tmps ?xs Un read_tmps ?ys",
     template_equation
      (template_app
        (template_hole 2,
         template_app
          (template_app (template_hole 1, template_var 1), template_var 0)),
       template_app
        (template_app
          (template_hole 0, template_app (template_hole 2, template_var 1)),
         template_app (template_hole 2, template_var 0)))),
    ("ReduceStoreBuffer.dom_augment",
     "dom (?m \<oplus>\<^bsub>?W\<^esub> ?S) = dom ?m Un ?S",
     template_equation
      (template_app
        (template_hole 2,
         template_app
          (template_app
            (template_app (template_hole 1, template_var 2),
             template_var 1),
           template_var 0)),
       template_app
        (template_app
          (template_hole 0, template_app (template_hole 2, template_var 2)),
         template_var 0))),
    ("ReduceStoreBuffer.dom_restrict_shared",
     "dom (?m \<ominus>\<^bsub>?A\<^esub> ?L) = dom ?m - ?L",
     template_equation
      (template_app
        (template_hole 2,
         template_app
          (template_app
            (template_app (template_hole 1, template_var 2),
             template_var 1),
           template_var 0)),
       template_app
        (template_app
          (template_hole 0, template_app (template_hole 2, template_var 2)),
         template_var 0))),
    ("ReduceStoreBuffer.address_of_simps",
     "address_of (Read\<^sub>s\<^sub>b ?volatile ?a ?t ?v) = {?a}",
     template_equation
      (template_app
        (template_hole 3,
         template_app
          (template_app
            (template_app
              (template_app (template_hole 2, template_var 3),
               template_var 2),
             template_var 1),
           template_var 0)),
       template_app
        (template_app (template_hole 1, template_var 2), template_hole 0))),
    ("ReduceStoreBuffer.acquired_False_takeWhile_non_volatile_Write\<^sub>s\<^sub>b",
     "acquired False
       (takeWhile (Not o is_volatile_Write\<^sub>s\<^sub>b) ?sb) ?A =
      {}",
     template_equation
      (template_app
        (template_app
          (template_app (template_hole 6, template_hole 5),
           template_app
            (template_app
              (template_hole 4,
               template_app
                (template_app (template_hole 3, template_hole 2),
                 template_hole 1)),
             template_var 1)),
         template_var 0),
       template_hole 0)),
    ("ReduceStoreBuffer.store_sops_append",
     "store_sops (?xs @ ?ys) = store_sops ?xs Un store_sops ?ys",
     template_equation
      (template_app
        (template_hole 2,
         template_app
          (template_app (template_hole 1, template_var 1), template_var 0)),
       template_app
        (template_app
          (template_hole 0, template_app (template_hole 2, template_var 1)),
         template_app (template_hole 2, template_var 0)))),
    ("ReduceStoreBuffer.write_sops_append",
     "write_sops (?xs @ ?ys) = write_sops ?xs Un write_sops ?ys",
     template_equation
      (template_app
        (template_hole 2,
         template_app
          (template_app (template_hole 1, template_var 1), template_var 0)),
       template_app
        (template_app
          (template_hole 0, template_app (template_hole 2, template_var 1)),
         template_app (template_hole 2, template_var 0)))),
    ("ReduceStoreBuffer.instrs_append",
     "instrs (?xs @ ?ys) = instrs ?xs @ instrs ?ys",
     template_equation
      (template_app
        (template_hole 2,
         template_app
          (template_app (template_hole 1, template_var 1), template_var 0)),
       template_app
        (template_app
          (template_hole 0, template_app (template_hole 2, template_var 1)),
         template_app (template_hole 2, template_var 0)))),
    ("ReduceStoreBuffer.prog_instrs_append",
     "prog_instrs (?xs @ ?ys) = prog_instrs ?xs @ prog_instrs ?ys",
     template_equation
      (template_app
        (template_hole 2,
         template_app
          (template_app (template_hole 1, template_var 1), template_var 0)),
       template_app
        (template_app
          (template_hole 0, template_app (template_hole 2, template_var 1)),
         template_app (template_hole 2, template_var 0)))),
    ("ReduceStoreBuffer.sharing_consistent_share_all_shared",
     "dom (share ?sb ?\<S>) <= dom ?\<S> Un all_shared ?sb",
     template_inequation
      (less_equals,
       template_app
        (template_hole 3,
         template_app
          (template_app (template_hole 2, template_var 1), template_var 0)),
       template_app
        (template_app
          (template_hole 1, template_app (template_hole 3, template_var 0)),
         template_app (template_hole 0, template_var 1)))),
    ("ReduceStoreBuffer.shared_le_read_only_le",
     "?m\<^sub>1 \<subseteq>\<^sub>s ?m\<^sub>2 ==>
      read_only ?m\<^sub>1 <= read_only ?m\<^sub>2",
     template_implication
      ([template_predicate
         (
            template_app
             (template_app (template_hole 2, template_var 1),
              template_var 0)
            )],
       template_inequation
        (less_equals, template_app (template_hole 0, template_var 1),
         template_app (template_hole 0, template_var 0)))),
    ("ReduceStoreBuffer.no_volatile_Read\<^sub>s\<^sub>b_volatile_reads_consistent",
     "outstanding_refs is_volatile_Read\<^sub>s\<^sub>b ?sb = {} ==>
      volatile_reads_consistent ?m ?sb",
     template_implication
      ([template_equation
         (template_app
           (template_app (template_hole 3, template_hole 2),
            template_var 1),
          template_hole 1)],
       template_predicate
        (
           template_app
            (template_app (template_hole 0, template_var 0), template_var 1)
           ))),
    ("ReduceStoreBuffer.causal_program_history_suffix",
     "causal_program_history ?is\<^sub>s\<^sub>b (?sb @ ?sb') ==>
      causal_program_history ?is\<^sub>s\<^sub>b ?sb'",
     template_implication
      ([template_predicate
         (
            template_app
             (template_app (template_hole 1, template_var 2),
              template_app
               (template_app (template_hole 0, template_var 1),
                template_var 0))
            )],
       template_predicate
        (
           template_app
            (template_app (template_hole 1, template_var 2), template_var 0)
           ))),
    ("ReduceStoreBuffer.no_outstanding_write_to_read_only_memory_tl",
     "no_outstanding_write_to_read_only_memory ?\<S> (?t # ?ts) ==>
      no_outstanding_write_to_read_only_memory ?\<S> ?ts",
     template_implication
      ([template_predicate
         (
            template_app
             (template_app (template_hole 1, template_var 2),
              template_app
               (template_app (template_hole 0, template_var 1),
                template_var 0))
            )],
       template_predicate
        (
           template_app
            (template_app (template_hole 1, template_var 2), template_var 0)
           ))),
    ("ReduceStoreBuffer.outstanding_non_volatile_refs_owned_or_read_only_tl",
     "outstanding_non_volatile_refs_owned_or_read_only ?\<S> (?t # ?ts) ==>
      outstanding_non_volatile_refs_owned_or_read_only ?\<S> ?ts",
     template_implication
      ([template_predicate
         (
            template_app
             (template_app (template_hole 1, template_var 2),
              template_app
               (template_app (template_hole 0, template_var 1),
                template_var 0))
            )],
       template_predicate
        (
           template_app
            (template_app (template_hole 1, template_var 2), template_var 0)
           ))),
    ("ReduceStoreBuffer.outstanding_non_volatile_writes_unshared_tl",
     "outstanding_non_volatile_writes_unshared ?\<S> (?t # ?ts) ==>
      outstanding_non_volatile_writes_unshared ?\<S> ?ts",
     template_implication
      ([template_predicate
         (
            template_app
             (template_app (template_hole 1, template_var 2),
              template_app
               (template_app (template_hole 0, template_var 1),
                template_var 0))
            )],
       template_predicate
        (
           template_app
            (template_app (template_hole 1, template_var 2), template_var 0)
           ))),
    ("ReduceStoreBuffer.sharing_consis_tl",
     "sharing_consis ?\<S> (?t # ?ts) ==> sharing_consis ?\<S> ?ts",
     template_implication
      ([template_predicate
         (
            template_app
             (template_app (template_hole 1, template_var 2),
              template_app
               (template_app (template_hole 0, template_var 1),
                template_var 0))
            )],
       template_predicate
        (
           template_app
            (template_app (template_hole 1, template_var 2), template_var 0)
           ))),
    ("ReduceStoreBuffer.valid_ownership_tl",
     "valid_ownership ?\<S> (?t # ?ts) ==> valid_ownership ?\<S> ?ts",
     template_implication
      ([template_predicate
         (
            template_app
             (template_app (template_hole 1, template_var 2),
              template_app
               (template_app (template_hole 0, template_var 1),
                template_var 0))
            )],
       template_predicate
        (
           template_app
            (template_app (template_hole 1, template_var 2), template_var 0)
           ))),
    ("ReduceStoreBuffer.valid_ownership_and_sharing_tl",
     "valid_ownership_and_sharing ?\<S> (?t # ?ts) ==>
      valid_ownership_and_sharing ?\<S> ?ts",
     template_implication
      ([template_predicate
         (
            template_app
             (template_app (template_hole 1, template_var 2),
              template_app
               (template_app (template_hole 0, template_var 1),
                template_var 0))
            )],
       template_predicate
        (
           template_app
            (template_app (template_hole 1, template_var 2), template_var 0)
           ))),
    ("ReduceStoreBuffer.initial_safe_free_flowing_implies_safe_delayed",
     "[| initial ?c; safe_free_flowing ?c |] ==> safe_delayed ?c",
     template_implication
      ([template_predicate (template_app (template_hole 2, template_var 0)),
        template_predicate
         (template_app (template_hole 1, template_var 0))],
       template_predicate
        (template_app (template_hole 0, template_var 0)))),
    ("ReduceStoreBuffer.share_append",
     "share (?xs @ ?ys) ?S = share ?ys (share ?xs ?S)",
     template_equation
      (template_app
        (template_app
          (template_hole 1,
           template_app
            (template_app (template_hole 0, template_var 2),
             template_var 1)),
         template_var 0),
       template_app
        (template_app (template_hole 1, template_var 1),
         template_app
          (template_app (template_hole 1, template_var 2),
           template_var 0)))),
    ("ReduceStoreBuffer.outstanding_is_Read\<^sub>s\<^sub>b_refs_conv",
     "outstanding_refs is_Read\<^sub>s\<^sub>b ?sb =
      outstanding_refs is_non_volatile_Read\<^sub>s\<^sub>b ?sb Un
      outstanding_refs is_volatile_Read\<^sub>s\<^sub>b ?sb",
     template_equation
      (template_app
        (template_app (template_hole 4, template_hole 3), template_var 0),
       template_app
        (template_app
          (template_hole 2,
           template_app
            (template_app (template_hole 4, template_hole 1),
             template_var 0)),
         template_app
          (template_app (template_hole 4, template_hole 0),
           template_var 0)))),
    ("ReduceStoreBuffer.outstanding_is_Write\<^sub>s\<^sub>b_refs_conv",
     "outstanding_refs is_Write\<^sub>s\<^sub>b ?sb =
      outstanding_refs is_non_volatile_Write\<^sub>s\<^sub>b ?sb Un
      outstanding_refs is_volatile_Write\<^sub>s\<^sub>b ?sb",
     template_equation
      (template_app
        (template_app (template_hole 4, template_hole 3), template_var 0),
       template_app
        (template_app
          (template_hole 2,
           template_app
            (template_app (template_hole 4, template_hole 1),
             template_var 0)),
         template_app
          (template_app (template_hole 4, template_hole 0),
           template_var 0)))),
    ("ReduceStoreBuffer.outstanding_refs_is_Write\<^sub>s\<^sub>b_union",
     "outstanding_refs is_Write\<^sub>s\<^sub>b ?xs =
      outstanding_refs is_volatile_Write\<^sub>s\<^sub>b ?xs Un
      outstanding_refs is_non_volatile_Write\<^sub>s\<^sub>b ?xs",
     template_equation
      (template_app
        (template_app (template_hole 4, template_hole 3), template_var 0),
       template_app
        (template_app
          (template_hole 2,
           template_app
            (template_app (template_hole 4, template_hole 1),
             template_var 0)),
         template_app
          (template_app (template_hole 4, template_hole 0),
           template_var 0)))),
    ("ReduceStoreBuffer.outstanding_volatile_refs_conv",
     "outstanding_refs is_volatile ?sb =
      outstanding_refs is_volatile_Write\<^sub>s\<^sub>b ?sb Un
      outstanding_refs is_volatile_Read\<^sub>s\<^sub>b ?sb",
     template_equation
      (template_app
        (template_app (template_hole 4, template_hole 3), template_var 0),
       template_app
        (template_app
          (template_hole 2,
           template_app
            (template_app (template_hole 4, template_hole 1),
             template_var 0)),
         template_app
          (template_app (template_hole 4, template_hole 0),
           template_var 0)))),
    ("ReduceStoreBuffer.dom_augment_rels_shared_eq",
     "dom (augment_rels ?S ?R ?\<R>) = dom (augment_rels ?S' ?R ?\<R>)",
     template_equation
      (template_app
        (template_hole 1,
         template_app
          (template_app
            (template_app (template_hole 0, template_var 3),
             template_var 2),
           template_var 1)),
       template_app
        (template_hole 1,
         template_app
          (template_app
            (template_app (template_hole 0, template_var 0),
             template_var 2),
           template_var 1)))),
    ("ReduceStoreBuffer.dom_release_shared_eq",
     "dom (release ?sb ?\<S>' ?\<R>) = dom (release ?sb ?\<S> ?\<R>)",
     template_equation
      (template_app
        (template_hole 1,
         template_app
          (template_app
            (template_app (template_hole 0, template_var 3),
             template_var 2),
           template_var 1)),
       template_app
        (template_hole 1,
         template_app
          (template_app
            (template_app (template_hole 0, template_var 3),
             template_var 0),
           template_var 1)))),
    ("ReduceStoreBuffer.unforwarded_not_written",
     "?a : unforwarded_non_volatile_reads ?sb ?W ==> ?a ~: ?W",
     template_implication
      ([template_predicate
         (
            template_app
             (template_app (template_hole 2, template_var 2),
              template_app
               (template_app (template_hole 1, template_var 1),
                template_var 0))
            )],
       template_negation
        (
           template_predicate
            (
               template_app
                (template_app (template_hole 2, template_var 2),
                 template_var 0)
               )
           ))),
    ("ReduceStoreBuffer.initial_unowned_shared",
     "initial (?ts, ?m, ?\<S>) ==> unowned_shared ?\<S> ?ts",
     template_implication
      ([template_predicate
         (
            template_app
             (template_hole 3,
              template_app
               (template_app (template_hole 2, template_var 2),
                template_app
                 (template_app (template_hole 1, template_var 1),
                  template_var 0)))
            )],
       template_predicate
        (
           template_app
            (template_app (template_hole 0, template_var 0), template_var 2)
           ))),
    ("ReduceStoreBuffer.last_prog_append_Prog\<^sub>s\<^sub>b",
     "last_prog ?x (?sb @ [Prog\<^sub>s\<^sub>b ?p ?p' ?mis]) = ?p'",
     template_equation
      (template_app
        (template_app (template_hole 4, template_var 4),
         template_app
          (template_app (template_hole 3, template_var 3),
           template_app
            (template_app
              (template_hole 2,
               template_app
                (template_app
                  (template_app (template_hole 1, template_var 2),
                   template_var 1),
                 template_var 0)),
             template_hole 0))),
       template_var 1)),
    ("ReduceStoreBuffer.is_Ghost\<^sub>s\<^sub>b_simps",
     "is_Ghost\<^sub>s\<^sub>b
       (Write\<^sub>s\<^sub>b ?volatile ?a ?sop ?v ?A ?L ?R ?W) =
      False",
     template_equation
      (template_app
        (template_hole 2,
         template_app
          (template_app
            (template_app
              (template_app
                (template_app
                  (template_app
                    (template_app
                      (template_app (template_hole 1, template_var 7),
                       template_var 6),
                     template_var 5),
                   template_var 4),
                 template_var 3),
               template_var 2),
             template_var 1),
           template_var 0)),
       template_hole 0)),
    ("ReduceStoreBuffer.is_Prog\<^sub>s\<^sub>b_simps",
     "is_Prog\<^sub>s\<^sub>b
       (Write\<^sub>s\<^sub>b ?volatile ?a ?sop ?v ?A ?L ?R ?W) =
      False",
     template_equation
      (template_app
        (template_hole 2,
         template_app
          (template_app
            (template_app
              (template_app
                (template_app
                  (template_app
                    (template_app
                      (template_app (template_hole 1, template_var 7),
                       template_var 6),
                     template_var 5),
                   template_var 4),
                 template_var 3),
               template_var 2),
             template_var 1),
           template_var 0)),
       template_hole 0)),
    ("ReduceStoreBuffer.is_Read\<^sub>s\<^sub>b_simps",
     "is_Read\<^sub>s\<^sub>b
       (Write\<^sub>s\<^sub>b ?volatile ?a ?sop ?v ?A ?L ?R ?W) =
      False",
     template_equation
      (template_app
        (template_hole 2,
         template_app
          (template_app
            (template_app
              (template_app
                (template_app
                  (template_app
                    (template_app
                      (template_app (template_hole 1, template_var 7),
                       template_var 6),
                     template_var 5),
                   template_var 4),
                 template_var 3),
               template_var 2),
             template_var 1),
           template_var 0)),
       template_hole 0)),
    ("ReduceStoreBuffer.is_Write\<^sub>s\<^sub>b_simps",
     "is_Write\<^sub>s\<^sub>b
       (Write\<^sub>s\<^sub>b ?volatile ?a ?sop ?v ?A ?L ?R ?W) =
      True",
     template_equation
      (template_app
        (template_hole 2,
         template_app
          (template_app
            (template_app
              (template_app
                (template_app
                  (template_app
                    (template_app
                      (template_app (template_hole 1, template_var 7),
                       template_var 6),
                     template_var 5),
                   template_var 4),
                 template_var 3),
               template_var 2),
             template_var 1),
           template_var 0)),
       template_hole 0)),
    ("ReduceStoreBuffer.is_non_volatile_Read\<^sub>s\<^sub>b_simps",
     "is_non_volatile_Read\<^sub>s\<^sub>b
       (Write\<^sub>s\<^sub>b ?volatile ?a ?sop ?v ?A ?L ?R ?W) =
      False",
     template_equation
      (template_app
        (template_hole 2,
         template_app
          (template_app
            (template_app
              (template_app
                (template_app
                  (template_app
                    (template_app
                      (template_app (template_hole 1, template_var 7),
                       template_var 6),
                     template_var 5),
                   template_var 4),
                 template_var 3),
               template_var 2),
             template_var 1),
           template_var 0)),
       template_hole 0)),
    ("ReduceStoreBuffer.is_volatile_simps",
     "is_volatile (Write\<^sub>s\<^sub>b ?volatile ?a ?sop ?v ?A ?L ?R ?W) =
      ?volatile",
     template_equation
      (template_app
        (template_hole 1,
         template_app
          (template_app
            (template_app
              (template_app
                (template_app
                  (template_app
                    (template_app
                      (template_app (template_hole 0, template_var 7),
                       template_var 6),
                     template_var 5),
                   template_var 4),
                 template_var 3),
               template_var 2),
             template_var 1),
           template_var 0)),
       template_var 7)),
    ("ReduceStoreBuffer.is_volatile_Read\<^sub>s\<^sub>b_simps",
     "is_volatile_Read\<^sub>s\<^sub>b
       (Write\<^sub>s\<^sub>b ?volatile ?a ?sop ?v ?A ?L ?R ?W) =
      False",
     template_equation
      (template_app
        (template_hole 2,
         template_app
          (template_app
            (template_app
              (template_app
                (template_app
                  (template_app
                    (template_app
                      (template_app (template_hole 1, template_var 7),
                       template_var 6),
                     template_var 5),
                   template_var 4),
                 template_var 3),
               template_var 2),
             template_var 1),
           template_var 0)),
       template_hole 0)),
    ("ReduceStoreBuffer.is_volatile_Write\<^sub>s\<^sub>b_simps",
     "is_volatile_Write\<^sub>s\<^sub>b
       (Write\<^sub>s\<^sub>b ?volatile ?a ?sop ?v ?A ?L ?R ?W) =
      ?volatile",
     template_equation
      (template_app
        (template_hole 1,
         template_app
          (template_app
            (template_app
              (template_app
                (template_app
                  (template_app
                    (template_app
                      (template_app (template_hole 0, template_var 7),
                       template_var 6),
                     template_var 5),
                   template_var 4),
                 template_var 3),
               template_var 2),
             template_var 1),
           template_var 0)),
       template_var 7)),
    ("ReduceStoreBuffer.instrs_takeWhile_dropWhile_conv",
     "instrs ?xs = instrs (takeWhile ?P ?xs) @ instrs (dropWhile ?P ?xs)",
     template_equation
      (template_app (template_hole 3, template_var 1),
       template_app
        (template_app
          (template_hole 2,
           template_app
            (template_hole 3,
             template_app
              (template_app (template_hole 1, template_var 0),
               template_var 1))),
         template_app
          (template_hole 3,
           template_app
            (template_app (template_hole 0, template_var 0),
             template_var 1))))),
    ("ReduceStoreBuffer.set_minus_mono_aux",
     "?A <= ?B ==> ?A - ?C <= ?B - ?C",
     template_implication
      ([template_inequation (less_equals, template_var 2, template_var 1)],
       template_inequation
        (less_equals,
         template_app
          (template_app (template_hole 0, template_var 2), template_var 0),
         template_app
          (template_app (template_hole 0, template_var 1),
           template_var 0)))),
    ("ReduceStoreBuffer.union_mono_aux",
     "?A <= ?B ==> ?A Un ?C <= ?B Un ?C",
     template_implication
      ([template_inequation (less_equals, template_var 2, template_var 1)],
       template_inequation
        (less_equals,
         template_app
          (template_app (template_hole 0, template_var 2), template_var 0),
         template_app
          (template_app (template_hole 0, template_var 1),
           template_var 0)))),
    ("ReduceStoreBuffer.insert_monoD",
     "?W <= ?W' ==> insert ?a ?W <= insert ?a ?W'",
     template_implication
      ([template_inequation (less_equals, template_var 2, template_var 1)],
       template_inequation
        (less_equals,
         template_app
          (template_app (template_hole 0, template_var 0), template_var 2),
         template_app
          (template_app (template_hole 0, template_var 0),
           template_var 1)))),
    ("ReduceStoreBuffer.acquired_by_instrs_mono",
     "?A <= ?B ==> acquired_by_instrs ?is ?A <= acquired_by_instrs ?is ?B",
     template_implication
      ([template_inequation (less_equals, template_var 2, template_var 1)],
       template_inequation
        (less_equals,
         template_app
          (template_app (template_hole 0, template_var 0), template_var 2),
         template_app
          (template_app (template_hole 0, template_var 0),
           template_var 1)))),
    ("ReduceStoreBuffer.unforwarded_non_volatile_reads_antimono",
     "?W <= ?W' ==>
      unforwarded_non_volatile_reads ?xs ?W'
      <= unforwarded_non_volatile_reads ?xs ?W",
     template_implication
      ([template_inequation (less_equals, template_var 2, template_var 1)],
       template_inequation
        (less_equals,
         template_app
          (template_app (template_hole 0, template_var 0), template_var 1),
         template_app
          (template_app (template_hole 0, template_var 0),
           template_var 2)))),
    ("ReduceStoreBuffer.read_only_reads_antimono",
     "?\<O> <= ?\<O>' ==>
      read_only_reads ?\<O>' ?sb <= read_only_reads ?\<O> ?sb",
     template_implication
      ([template_inequation (less_equals, template_var 2, template_var 1)],
       template_inequation
        (less_equals,
         template_app
          (template_app (template_hole 0, template_var 1), template_var 0),
         template_app
          (template_app (template_hole 0, template_var 2),
           template_var 0)))),
    ("ReduceStoreBuffer.restrict_shared_in",
     "?a : ?L ==> (?m \<ominus>\<^bsub>?A\<^esub> ?L) ?a = None",
     template_implication
      ([template_predicate
         (
            template_app
             (template_app (template_hole 3, template_var 3),
              template_var 2)
            )],
       template_equation
        (template_app
          (template_app
            (template_app
              (template_app (template_hole 1, template_var 1),
               template_var 0),
             template_var 2),
           template_var 3),
         template_hole 0))),
    ("ReduceStoreBuffer.sharing_consistent_takeWhile",
     "sharing_consistent ?\<S> ?\<O> ?sb ==>
      sharing_consistent ?\<S> ?\<O> (takeWhile ?P ?sb)",
     template_implication
      ([template_predicate
         (
            template_app
             (template_app
               (template_app (template_hole 1, template_var 3),
                template_var 2),
              template_var 1)
            )],
       template_predicate
        (
           template_app
            (template_app
              (template_app (template_hole 1, template_var 3),
               template_var 2),
             template_app
              (template_app (template_hole 0, template_var 0),
               template_var 1))
           ))),
    ("ReduceStoreBuffer.last_prog_to_last_prog_same",
     "last_prog ?p' ?sb = ?p ==> last_prog ?p ?sb = ?p",
     template_implication
      ([template_equation
         (template_app
           (template_app (template_hole 0, template_var 2), template_var 1),
          template_var 0)],
       template_equation
        (template_app
          (template_app (template_hole 0, template_var 0), template_var 1),
         template_var 0))),
    ("ReduceStoreBuffer.load_tmps_mono",
     "set ?xs <= set ?ys ==> load_tmps ?xs <= load_tmps ?ys",
     template_implication
      ([template_inequation
         (less_equals, template_app (template_hole 2, template_var 1),
          template_app (template_hole 2, template_var 0))],
       template_inequation
        (less_equals, template_app (template_hole 0, template_var 1),
         template_app (template_hole 0, template_var 0)))),
    ("ReduceStoreBuffer.store_sops_mono",
     "set ?xs <= set ?ys ==> store_sops ?xs <= store_sops ?ys",
     template_implication
      ([template_inequation
         (less_equals, template_app (template_hole 2, template_var 1),
          template_app (template_hole 2, template_var 0))],
       template_inequation
        (less_equals, template_app (template_hole 0, template_var 1),
         template_app (template_hole 0, template_var 0)))),
    ("ReduceStoreBuffer.read_tmps_mono",
     "set ?xs <= set ?ys ==> read_tmps ?xs <= read_tmps ?ys",
     template_implication
      ([template_inequation
         (less_equals, template_app (template_hole 2, template_var 1),
          template_app (template_hole 2, template_var 0))],
       template_inequation
        (less_equals, template_app (template_hole 0, template_var 1),
         template_app (template_hole 0, template_var 0)))),
    ("ReduceStoreBuffer.write_sops_mono",
     "set ?xs <= set ?ys ==> write_sops ?xs <= write_sops ?ys",
     template_implication
      ([template_inequation
         (less_equals, template_app (template_hole 2, template_var 1),
          template_app (template_hole 2, template_var 0))],
       template_inequation
        (less_equals, template_app (template_hole 0, template_var 1),
         template_app (template_hole 0, template_var 0)))),
    ("ReduceStoreBuffer.non_volatile_owned_or_read_only_pending_write_antimono",
     "non_volatile_owned_or_read_only True ?\<S> ?\<O> ?xs ==>
      non_volatile_owned_or_read_only False ?\<S> ?\<O> ?xs",
     template_implication
      ([template_predicate
         (
            template_app
             (template_app
               (template_app
                 (template_app (template_hole 2, template_hole 1),
                  template_var 2),
                template_var 1),
              template_var 0)
            )],
       template_predicate
        (
           template_app
            (template_app
              (template_app
                (template_app (template_hole 2, template_hole 0),
                 template_var 2),
               template_var 1),
             template_var 0)
           ))),
    ("ReduceStoreBuffer.reads_consistent_pending_write_antimono",
     "reads_consistent True ?\<O> ?m ?sb ==>
      reads_consistent False ?\<O> ?m ?sb",
     template_implication
      ([template_predicate
         (
            template_app
             (template_app
               (template_app
                 (template_app (template_hole 2, template_hole 1),
                  template_var 2),
                template_var 1),
              template_var 0)
            )],
       template_predicate
        (
           template_app
            (template_app
              (template_app
                (template_app (template_hole 2, template_hole 0),
                 template_var 2),
               template_var 1),
             template_var 0)
           ))),
    ("ReduceStoreBuffer.in_unforwarded_non_volatile_reads_non_volatile_Read\<^sub>s\<^sub>b",
     "?a : unforwarded_non_volatile_reads ?sb ?W ==>
      ?a : outstanding_refs is_non_volatile_Read\<^sub>s\<^sub>b ?sb",
     template_implication
      ([template_predicate
         (
            template_app
             (template_app (template_hole 3, template_var 2),
              template_app
               (template_app (template_hole 2, template_var 1),
                template_var 0))
            )],
       template_predicate
        (
           template_app
            (template_app (template_hole 3, template_var 2),
             template_app
              (template_app (template_hole 1, template_hole 0),
               template_var 1))
           ))),
    ("ReduceStoreBuffer.set_dropWhileD",
     "?x : set (dropWhile ?P ?xs) ==> ?x : set ?xs",
     template_implication
      ([template_predicate
         (
            template_app
             (template_app (template_hole 2, template_var 2),
              template_app
               (template_hole 1,
                template_app
                 (template_app (template_hole 0, template_var 1),
                  template_var 0)))
            )],
       template_predicate
        (
           template_app
            (template_app (template_hole 2, template_var 2),
             template_app (template_hole 1, template_var 0))
           ))),
    ("ReduceStoreBuffer.all_acquired_dropWhile_in",
     "?x : all_acquired (dropWhile ?P ?sb) ==> ?x : all_acquired ?sb",
     template_implication
      ([template_predicate
         (
            template_app
             (template_app (template_hole 2, template_var 2),
              template_app
               (template_hole 1,
                template_app
                 (template_app (template_hole 0, template_var 1),
                  template_var 0)))
            )],
       template_predicate
        (
           template_app
            (template_app (template_hole 2, template_var 2),
             template_app (template_hole 1, template_var 0))
           ))),
    ("ReduceStoreBuffer.all_acquired_takeWhile_in",
     "?x : all_acquired (takeWhile ?P ?sb) ==> ?x : all_acquired ?sb",
     template_implication
      ([template_predicate
         (
            template_app
             (template_app (template_hole 2, template_var 2),
              template_app
               (template_hole 1,
                template_app
                 (template_app (template_hole 0, template_var 1),
                  template_var 0)))
            )],
       template_predicate
        (
           template_app
            (template_app (template_hole 2, template_var 2),
             template_app (template_hole 1, template_var 0))
           ))),
    ("ReduceStoreBuffer.dropWhile_Cons",
     "dropWhile ?P ?xs = ?x # ?ys ==> ~ ?P ?x",
     template_implication
      ([template_equation
         (template_app
           (template_app (template_hole 2, template_var 3), template_var 2),
          template_app
           (template_app (template_hole 1, template_var 1),
            template_var 0))],
       template_negation
        (
           template_predicate
            (template_app (template_var 3, template_var 1))
           ))),
    ("ReduceStoreBuffer.dropWhile_ConsD",
     "dropWhile ?P ?xs = ?y # ?ys ==> ~ ?P ?y",
     template_implication
      ([template_equation
         (template_app
           (template_app (template_hole 2, template_var 3), template_var 2),
          template_app
           (template_app (template_hole 1, template_var 1),
            template_var 0))],
       template_negation
        (
           template_predicate
            (template_app (template_var 3, template_var 1))
           ))),
    ("ReduceStoreBuffer.Cons_to_snoc", "EX ys y. ?x # ?xs = ys @ [y]",
     template_predicate (template_app (template_hole 5, t_empty))),
    ("ReduceStoreBuffer.last_prog_hd_prog_append",
     "last_prog (hd_prog ?p\<^sub>s\<^sub>b (?sb @ ?sb')) ?sb =
      last_prog (hd_prog ?p\<^sub>s\<^sub>b ?sb') ?sb",
     template_equation
      (template_app
        (template_app
          (template_hole 2,
           template_app
            (template_app (template_hole 1, template_var 2),
             template_app
              (template_app (template_hole 0, template_var 1),
               template_var 0))),
         template_var 1),
       template_app
        (template_app
          (template_hole 2,
           template_app
            (template_app (template_hole 1, template_var 2),
             template_var 0)),
         template_var 1))),
    ("ReduceStoreBuffer.flush_buffered_val_conv",
     "flush ?sb ?m ?a =
      (case buffered_val ?sb ?a of None => ?m ?a | Some v => v)",
     template_equation
      (template_app
        (template_app
          (template_app (template_hole 2, template_var 2), template_var 1),
         template_var 0),
       template_app
        (template_app
          (template_app
            (template_hole 1,
             template_app (template_var 1, template_var 0)),
           t_empty),
         template_app
          (template_app (template_hole 0, template_var 2),
           template_var 0)))),
    ("ReduceStoreBuffer.outstanding_refs_append",
     "outstanding_refs ?vol (?xs @ ?ys) =
      outstanding_refs ?vol ?xs Un outstanding_refs ?vol ?ys",
     template_equation
      (template_app
        (template_app (template_hole 2, template_var 2),
         template_app
          (template_app (template_hole 1, template_var 1), template_var 0)),
       template_app
        (template_app
          (template_hole 0,
           template_app
            (template_app (template_hole 2, template_var 2),
             template_var 1)),
         template_app
          (template_app (template_hole 2, template_var 2),
           template_var 0)))),
    ("ReduceStoreBuffer.outstanding_non_volatile_refs_conv",
     "outstanding_refs (Not o is_volatile) ?sb =
      outstanding_refs is_non_volatile_Write\<^sub>s\<^sub>b ?sb Un
      outstanding_refs is_non_volatile_Read\<^sub>s\<^sub>b ?sb",
     template_equation
      (template_app
        (template_app
          (template_hole 6,
           template_app
            (template_app (template_hole 5, template_hole 4),
             template_hole 3)),
         template_var 0),
       template_app
        (template_app
          (template_hole 2,
           template_app
            (template_app (template_hole 6, template_hole 1),
             template_var 0)),
         template_app
          (template_app (template_hole 6, template_hole 0),
           template_var 0)))),
    ("ReduceStoreBuffer.outstanding_not_volatile_Read\<^sub>s\<^sub>b_refs_conv",
     "outstanding_refs (Not o is_volatile_Read\<^sub>s\<^sub>b) ?sb =
      outstanding_refs is_Write\<^sub>s\<^sub>b ?sb Un
      outstanding_refs is_non_volatile_Read\<^sub>s\<^sub>b ?sb",
     template_equation
      (template_app
        (template_app
          (template_hole 6,
           template_app
            (template_app (template_hole 5, template_hole 4),
             template_hole 3)),
         template_var 0),
       template_app
        (template_app
          (template_hole 2,
           template_app
            (template_app (template_hole 6, template_hole 1),
             template_var 0)),
         template_app
          (template_app (template_hole 6, template_hole 0),
           template_var 0)))),
    ("ReduceStoreBuffer.is_non_volatile_Write\<^sub>s\<^sub>b_simps",
     "is_non_volatile_Write\<^sub>s\<^sub>b
       (Write\<^sub>s\<^sub>b ?volatile ?a ?sop ?v ?A ?L ?R ?W) =
      (~ ?volatile)",
     template_equation
      (template_app
        (template_hole 2,
         template_app
          (template_app
            (template_app
              (template_app
                (template_app
                  (template_app
                    (template_app
                      (template_app (template_hole 1, template_var 7),
                       template_var 6),
                     template_var 5),
                   template_var 4),
                 template_var 3),
               template_var 2),
             template_var 1),
           template_var 0)),
       template_app (template_hole 0, template_var 7))),
    ("ReduceStoreBuffer.prog_instrs_append_Ghost\<^sub>s\<^sub>b",
     "prog_instrs (?sb @ [Ghost\<^sub>s\<^sub>b ?A ?L ?R ?W]) =
      prog_instrs ?sb",
     template_equation
      (template_app
        (template_hole 4,
         template_app
          (template_app (template_hole 3, template_var 4),
           template_app
            (template_app
              (template_hole 2,
               template_app
                (template_app
                  (template_app
                    (template_app (template_hole 1, template_var 3),
                     template_var 2),
                   template_var 1),
                 template_var 0)),
             template_hole 0))),
       template_app (template_hole 4, template_var 4))),
    ("ReduceStoreBuffer.prog_instrs_append_Read\<^sub>s\<^sub>b",
     "prog_instrs (?sb @ [Read\<^sub>s\<^sub>b ?volatile ?a ?t ?v]) =
      prog_instrs ?sb",
     template_equation
      (template_app
        (template_hole 4,
         template_app
          (template_app (template_hole 3, template_var 4),
           template_app
            (template_app
              (template_hole 2,
               template_app
                (template_app
                  (template_app
                    (template_app (template_hole 1, template_var 3),
                     template_var 2),
                   template_var 1),
                 template_var 0)),
             template_hole 0))),
       template_app (template_hole 4, template_var 4))),
    ("ReduceStoreBuffer.sharing_consistent_all_acquired",
     "sharing_consistent ?\<S> ?\<O> ?sb ==>
      all_acquired ?sb <= dom ?\<S> Un ?\<O>",
     template_implication
      ([template_predicate
         (
            template_app
             (template_app
               (template_app (template_hole 4, template_var 2),
                template_var 1),
              template_var 0)
            )],
       template_inequation
        (less_equals, template_app (template_hole 2, template_var 0),
         template_app
          (template_app
            (template_hole 1,
             template_app (template_hole 0, template_var 2)),
           template_var 1)))),
    ("ReduceStoreBuffer.sharing_consistent_all_shared",
     "sharing_consistent ?\<S> ?\<O> ?sb ==>
      all_shared ?sb <= dom ?\<S> Un ?\<O>",
     template_implication
      ([template_predicate
         (
            template_app
             (template_app
               (template_app (template_hole 4, template_var 2),
                template_var 1),
              template_var 0)
            )],
       template_inequation
        (less_equals, template_app (template_hole 2, template_var 0),
         template_app
          (template_app
            (template_hole 1,
             template_app (template_hole 0, template_var 2)),
           template_var 1)))),
    ("ReduceStoreBuffer.all_shared_acquired_or_owned",
     "sharing_consistent ?\<S> ?\<O> ?sb ==>
      all_shared ?sb <= all_acquired ?sb Un ?\<O>",
     template_implication
      ([template_predicate
         (
            template_app
             (template_app
               (template_app (template_hole 4, template_var 2),
                template_var 1),
              template_var 0)
            )],
       template_inequation
        (less_equals, template_app (template_hole 2, template_var 0),
         template_app
          (template_app
            (template_hole 1,
             template_app (template_hole 0, template_var 0)),
           template_var 1)))),
    ("ReduceStoreBuffer.unshared_acquired_or_owned",
     "sharing_consistent ?\<S> ?\<O> ?sb ==>
      all_unshared ?sb <= all_acquired ?sb Un ?\<O>",
     template_implication
      ([template_predicate
         (
            template_app
             (template_app
               (template_app (template_hole 4, template_var 2),
                template_var 1),
              template_var 0)
            )],
       template_inequation
        (less_equals, template_app (template_hole 2, template_var 0),
         template_app
          (template_app
            (template_hole 1,
             template_app (template_hole 0, template_var 0)),
           template_var 1)))),
    ("ReduceStoreBuffer.list_update_id'",
     "?v = ?xs ! ?i ==> ?xs[?i := ?v] = ?xs",
     template_implication
      ([template_equation
         (template_var 2,
          template_app
           (template_app (template_hole 2, template_var 1),
            template_var 0))],
       template_equation
        (template_app
          (template_app
            (template_app (template_hole 0, template_var 1),
             template_var 0),
           template_var 2),
         template_var 1))),
    ("ReduceStoreBuffer.no_outstanding_volatile_Write\<^sub>s\<^sub>b_acquired",
     "outstanding_refs is_volatile_Write\<^sub>s\<^sub>b ?sb = {} ==>
      acquired False ?sb ?A = {}",
     template_implication
      ([template_equation
         (template_app
           (template_app (template_hole 4, template_hole 3),
            template_var 1),
          template_hole 2)],
       template_equation
        (template_app
          (template_app
            (template_app (template_hole 1, template_hole 0),
             template_var 1),
           template_var 0),
         template_hole 2))),
    ("ReduceStoreBuffer.prog_instrs_empty",
     "ALL r:set ?xs. ~ is_Prog\<^sub>s\<^sub>b r ==> prog_instrs ?xs = []",
     template_implication
      ([template_predicate
         (
            template_app
             (template_app
               (template_hole 6,
                template_app (template_hole 5, template_var 0)),
              t_empty)
            )],
       template_equation
        (template_app (template_hole 1, template_var 0), template_hole 0))),
    ("ReduceStoreBuffer.data_dependency_consistent_mono",
     "[| data_dependency_consistent_instrs ?T ?is; ?T <= ?T' |]
      ==> data_dependency_consistent_instrs ?T' ?is",
     template_implication
      ([template_predicate
         (
            template_app
             (template_app (template_hole 1, template_var 2),
              template_var 1)
            ),
        template_inequation (less_equals, template_var 2, template_var 0)],
       template_predicate
        (
           template_app
            (template_app (template_hole 1, template_var 0), template_var 1)
           ))),
    ("ReduceStoreBuffer.no_write_to_read_only_memory_antimono",
     "[| ?\<S> \<subseteq>\<^sub>s ?\<S>';
         no_write_to_read_only_memory ?\<S>' ?xs |]
      ==> no_write_to_read_only_memory ?\<S> ?xs",
     template_implication
      ([template_predicate
         (
            template_app
             (template_app (template_hole 1, template_var 2),
              template_var 1)
            ),
        template_predicate
         (
            template_app
             (template_app (template_hole 0, template_var 1),
              template_var 0)
            )],
       template_predicate
        (
           template_app
            (template_app (template_hole 0, template_var 2), template_var 0)
           ))),
    ("ReduceStoreBuffer.hd_prog_append_Prog\<^sub>s\<^sub>b",
     "hd_prog ?x (?sb @ [Prog\<^sub>s\<^sub>b ?p ?p' ?mis]) =
      hd_prog ?p ?sb",
     template_equation
      (template_app
        (template_app (template_hole 4, template_var 4),
         template_app
          (template_app (template_hole 3, template_var 3),
           template_app
            (template_app
              (template_hole 2,
               template_app
                (template_app
                  (template_app (template_hole 1, template_var 2),
                   template_var 1),
                 template_var 0)),
             template_hole 0))),
       template_app
        (template_app (template_hole 4, template_var 2), template_var 3))),
    ("ReduceStoreBuffer.address_of_simps",
     "address_of (Write\<^sub>s\<^sub>b ?volatile ?a ?sop ?v ?A ?L ?R ?W) =
      {?a}",
     template_equation
      (template_app
        (template_hole 3,
         template_app
          (template_app
            (template_app
              (template_app
                (template_app
                  (template_app
                    (template_app
                      (template_app (template_hole 2, template_var 7),
                       template_var 6),
                     template_var 5),
                   template_var 4),
                 template_var 3),
               template_var 2),
             template_var 1),
           template_var 0)),
       template_app
        (template_app (template_hole 1, template_var 6), template_hole 0))),
    ("ReduceStoreBuffer.augment_mono_map'",
     "?A \<subseteq>\<^sub>m ?B ==>
      ?A \<oplus>\<^bsub>?x\<^esub> ?C \<subseteq>\<^sub>m
      ?B \<oplus>\<^bsub>?x\<^esub> ?C",
     template_implication
      ([template_predicate
         (
            template_app
             (template_app (template_hole 1, template_var 3),
              template_var 2)
            )],
       template_predicate
        (
           template_app
            (template_app
              (template_hole 1,
               template_app
                (template_app
                  (template_app (template_hole 0, template_var 3),
                   template_var 1),
                 template_var 0)),
             template_app
              (template_app
                (template_app (template_hole 0, template_var 2),
                 template_var 1),
               template_var 0))
           ))),
    ("ReduceStoreBuffer.acquired_mono",
     "?A <= ?B ==>
      acquired ?pending_write ?xs ?A <= acquired ?pending_write ?xs ?B",
     template_implication
      ([template_inequation (less_equals, template_var 3, template_var 2)],
       template_inequation
        (less_equals,
         template_app
          (template_app
            (template_app (template_hole 0, template_var 1),
             template_var 0),
           template_var 3),
         template_app
          (template_app
            (template_app (template_hole 0, template_var 1),
             template_var 0),
           template_var 2)))),
    ("ReduceStoreBuffer.acquired_reads_mono",
     "?A <= ?B ==>
      acquired_reads ?pending_write ?xs ?A
      <= acquired_reads ?pending_write ?xs ?B",
     template_implication
      ([template_inequation (less_equals, template_var 3, template_var 2)],
       template_inequation
        (less_equals,
         template_app
          (template_app
            (template_app (template_hole 0, template_var 1),
             template_var 0),
           template_var 3),
         template_app
          (template_app
            (template_app (template_hole 0, template_var 1),
             template_var 0),
           template_var 2)))),
    ("ReduceStoreBuffer.augment_mono_map",
     "?A \<subseteq>\<^sub>s ?B ==>
      ?A \<oplus>\<^bsub>?x\<^esub> ?C \<subseteq>\<^sub>s
      ?B \<oplus>\<^bsub>?x\<^esub> ?C",
     template_implication
      ([template_predicate
         (
            template_app
             (template_app (template_hole 1, template_var 3),
              template_var 2)
            )],
       template_predicate
        (
           template_app
            (template_app
              (template_hole 1,
               template_app
                (template_app
                  (template_app (template_hole 0, template_var 3),
                   template_var 1),
                 template_var 0)),
             template_app
              (template_app
                (template_app (template_hole 0, template_var 2),
                 template_var 1),
               template_var 0))
           ))),
    ("ReduceStoreBuffer.restrict_mono_map",
     "?A \<subseteq>\<^sub>s ?B ==>
      ?A \<ominus>\<^bsub>?x\<^esub> ?C \<subseteq>\<^sub>s
      ?B \<ominus>\<^bsub>?x\<^esub> ?C",
     template_implication
      ([template_predicate
         (
            template_app
             (template_app (template_hole 1, template_var 3),
              template_var 2)
            )],
       template_predicate
        (
           template_app
            (template_app
              (template_hole 1,
               template_app
                (template_app
                  (template_app (template_hole 0, template_var 3),
                   template_var 1),
                 template_var 0)),
             template_app
              (template_app
                (template_app (template_hole 0, template_var 2),
                 template_var 1),
               template_var 0))
           ))),
    ("ReduceStoreBuffer.shared_leD",
     "?m\<^sub>1 \<subseteq>\<^sub>s ?m\<^sub>2 ==>
      ?m\<^sub>1 \<subseteq>\<^sub>m ?m\<^sub>2 &
      read_only ?m\<^sub>1 <= read_only ?m\<^sub>2",
     template_implication
      ([template_predicate
         (
            template_app
             (template_app (template_hole 4, template_var 1),
              template_var 0)
            )],
       template_predicate
        (
           template_app
            (template_app
              (template_hole 3,
               template_app
                (template_app (template_hole 2, template_var 1),
                 template_var 0)),
             template_app
              (template_app
                (template_hole 1,
                 template_app (template_hole 0, template_var 1)),
               template_app (template_hole 0, template_var 0)))
           ))),
    ("ReduceStoreBuffer.dropWhile_not_vol_write_empty",
     "outstanding_refs is_volatile_Write\<^sub>s\<^sub>b ?sb = {} ==>
      dropWhile (Not o is_volatile_Write\<^sub>s\<^sub>b) ?sb = []",
     template_implication
      ([template_equation
         (template_app
           (template_app (template_hole 7, template_hole 6),
            template_var 0),
          template_hole 5)],
       template_equation
        (template_app
          (template_app
            (template_hole 3,
             template_app
              (template_app (template_hole 2, template_hole 1),
               template_hole 6)),
           template_var 0),
         template_hole 0))),
    ("ReduceStoreBuffer.outstanding_refs_mono_set",
     "set ?sb <= set ?sb' ==>
      outstanding_refs ?P ?sb <= outstanding_refs ?P ?sb'",
     template_implication
      ([template_inequation
         (less_equals, template_app (template_hole 2, template_var 2),
          template_app (template_hole 2, template_var 1))],
       template_inequation
        (less_equals,
         template_app
          (template_app (template_hole 0, template_var 0), template_var 2),
         template_app
          (template_app (template_hole 0, template_var 0),
           template_var 1)))),
    ("ReduceStoreBuffer.reads_consistent_takeWhile",
     "reads_consistent ?pending_write ?\<O> ?m ?sb ==>
      reads_consistent ?pending_write ?\<O> ?m (takeWhile ?P ?sb)",
     template_implication
      ([template_predicate
         (
            template_app
             (template_app
               (template_app
                 (template_app (template_hole 1, template_var 4),
                  template_var 3),
                template_var 2),
              template_var 1)
            )],
       template_predicate
        (
           template_app
            (template_app
              (template_app
                (template_app (template_hole 1, template_var 4),
                 template_var 3),
               template_var 2),
             template_app
              (template_app (template_hole 0, template_var 0),
               template_var 1))
           ))),
    ("ReduceStoreBuffer.in_acquired_no_pending_write_outstanding_write",
     "?a : acquired False ?sb ?A ==>
      outstanding_refs is_volatile_Write\<^sub>s\<^sub>b ?sb ~= {}",
     template_implication
      ([template_predicate
         (
            template_app
             (template_app (template_hole 7, template_var 2),
              template_app
               (template_app
                 (template_app (template_hole 6, template_hole 5),
                  template_var 1),
                template_var 0))
            )],
       template_negation
        (
           template_equation
            (template_app
              (template_app (template_hole 2, template_hole 1),
               template_var 1),
             template_hole 0)
           ))),
    ("ReduceStoreBuffer.in_acquired_reads_no_pending_write_outstanding_write",
     "?a : acquired_reads False ?xs ?A ==>
      outstanding_refs is_volatile_Write\<^sub>s\<^sub>b ?xs ~= {}",
     template_implication
      ([template_predicate
         (
            template_app
             (template_app (template_hole 7, template_var 2),
              template_app
               (template_app
                 (template_app (template_hole 6, template_hole 5),
                  template_var 1),
                template_var 0))
            )],
       template_negation
        (
           template_equation
            (template_app
              (template_app (template_hole 2, template_hole 1),
               template_var 1),
             template_hole 0)
           ))),
    ("ReduceStoreBuffer.acquired_no_pending_write_in",
     "?x : acquired False ?xs ?A ==> ?x : acquired False ?xs ?B",
     template_implication
      ([template_predicate
         (
            template_app
             (template_app (template_hole 2, template_var 3),
              template_app
               (template_app
                 (template_app (template_hole 1, template_hole 0),
                  template_var 2),
                template_var 1))
            )],
       template_predicate
        (
           template_app
            (template_app (template_hole 2, template_var 3),
             template_app
              (template_app
                (template_app (template_hole 1, template_hole 0),
                 template_var 2),
               template_var 0))
           ))),
    ("ReduceStoreBuffer.acquired_pending_write_mono_in",
     "?x : acquired False ?xs ?A ==> ?x : acquired True ?xs ?B",
     template_implication
      ([template_predicate
         (
            template_app
             (template_app (template_hole 3, template_var 3),
              template_app
               (template_app
                 (template_app (template_hole 2, template_hole 1),
                  template_var 2),
                template_var 1))
            )],
       template_predicate
        (
           template_app
            (template_app (template_hole 3, template_var 3),
             template_app
              (template_app
                (template_app (template_hole 2, template_hole 0),
                 template_var 2),
               template_var 0))
           ))),
    ("ReduceStoreBuffer.acquired_all_acquired_in",
     "?x : acquired ?pending_write ?xs ?A ==> ?x : ?A Un all_acquired ?xs",
     template_implication
      ([template_predicate
         (
            template_app
             (template_app (template_hole 3, template_var 3),
              template_app
               (template_app
                 (template_app (template_hole 2, template_var 2),
                  template_var 1),
                template_var 0))
            )],
       template_predicate
        (
           template_app
            (template_app (template_hole 3, template_var 3),
             template_app
              (template_app (template_hole 1, template_var 0),
               template_app (template_hole 0, template_var 1)))
           ))),
    ("ReduceStoreBuffer.acquired_reads_no_pending_write_in",
     "?x : acquired_reads False ?xs ?A ==>
      ?x : acquired_reads False ?xs ?B",
     template_implication
      ([template_predicate
         (
            template_app
             (template_app (template_hole 2, template_var 3),
              template_app
               (template_app
                 (template_app (template_hole 1, template_hole 0),
                  template_var 2),
                template_var 1))
            )],
       template_predicate
        (
           template_app
            (template_app (template_hole 2, template_var 3),
             template_app
              (template_app
                (template_app (template_hole 1, template_hole 0),
                 template_var 2),
               template_var 0))
           ))),
    ("ReduceStoreBuffer.acquired_reads_pending_write_mono_in",
     "?x : acquired_reads False ?xs ?A ==> ?x : acquired_reads True ?xs ?A",
     template_implication
      ([template_predicate
         (
            template_app
             (template_app (template_hole 3, template_var 2),
              template_app
               (template_app
                 (template_app (template_hole 2, template_hole 1),
                  template_var 1),
                template_var 0))
            )],
       template_predicate
        (
           template_app
            (template_app (template_hole 3, template_var 2),
             template_app
              (template_app
                (template_app (template_hole 2, template_hole 0),
                 template_var 1),
               template_var 0))
           ))),
    ("ReduceStoreBuffer.last_prog_same_append",
     "last_prog ?p\<^sub>s\<^sub>b (?sb @ ?xs) = ?p\<^sub>s\<^sub>b ==>
      last_prog ?p\<^sub>s\<^sub>b ?xs = ?p\<^sub>s\<^sub>b",
     template_implication
      ([template_equation
         (template_app
           (template_app (template_hole 1, template_var 2),
            template_app
             (template_app (template_hole 0, template_var 1),
              template_var 0)),
          template_var 2)],
       template_equation
        (template_app
          (template_app (template_hole 1, template_var 2), template_var 0),
         template_var 2))),
    ("ReduceStoreBuffer.reads_consistent_append_first",
     "reads_consistent ?pending_write ?\<O> ?m (?xs @ ?ys) ==>
      reads_consistent ?pending_write ?\<O> ?m ?xs",
     template_implication
      ([template_predicate
         (
            template_app
             (template_app
               (template_app
                 (template_app (template_hole 1, template_var 4),
                  template_var 3),
                template_var 2),
              template_app
               (template_app (template_hole 0, template_var 1),
                template_var 0))
            )],
       template_predicate
        (
           template_app
            (template_app
              (template_app
                (template_app (template_hole 1, template_var 4),
                 template_var 3),
               template_var 2),
             template_var 1)
           ))),
    ("ReduceStoreBuffer.dropWhile_all_False_conv",
     "ALL x:set ?xs. ~ ?P x ==> dropWhile ?P ?xs = ?xs",
     template_implication
      ([template_predicate
         (
            template_app
             (template_app
               (template_hole 4,
                template_app (template_hole 3, template_var 1)),
              t_empty)
            )],
       template_equation
        (template_app
          (template_app (template_hole 0, template_var 0), template_var 1),
         template_var 1))),
    ("ReduceStoreBuffer.outstanding_refs_dropWhileD",
     "?x : outstanding_refs ?P (dropWhile ?P' ?sb) ==>
      ?x : outstanding_refs ?P ?sb",
     template_implication
      ([template_predicate
         (
            template_app
             (template_app (template_hole 2, template_var 3),
              template_app
               (template_app (template_hole 1, template_var 2),
                template_app
                 (template_app (template_hole 0, template_var 1),
                  template_var 0)))
            )],
       template_predicate
        (
           template_app
            (template_app (template_hole 2, template_var 3),
             template_app
              (template_app (template_hole 1, template_var 2),
               template_var 0))
           ))),
    ("ReduceStoreBuffer.outstanding_refs_takeWhileD",
     "?x : outstanding_refs ?P (takeWhile ?P' ?sb) ==>
      ?x : outstanding_refs ?P ?sb",
     template_implication
      ([template_predicate
         (
            template_app
             (template_app (template_hole 2, template_var 3),
              template_app
               (template_app (template_hole 1, template_var 2),
                template_app
                 (template_app (template_hole 0, template_var 1),
                  template_var 0)))
            )],
       template_predicate
        (
           template_app
            (template_app (template_hole 2, template_var 3),
             template_app
              (template_app (template_hole 1, template_var 2),
               template_var 0))
           ))),
    ("ReduceStoreBuffer.safe_reach_safe_rtrancl",
     "[| safe_reach ?step ?safe ?cfg; ?step^** ?cfg ?cfg' |]
      ==> ?safe ?cfg'",
     template_implication
      ([template_predicate
         (
            template_app
             (template_app
               (template_app (template_hole 1, template_var 3),
                template_var 2),
              template_var 1)
            ),
        template_predicate
         (
            template_app
             (template_app
               (template_app (template_hole 0, template_var 3),
                template_var 1),
              template_var 0)
            )],
       template_predicate (template_app (template_var 2, template_var 0)))),
    ("ReduceStoreBuffer.is_non_volatile_split",
     "is_volatile ?r ~=
      (is_non_volatile_Read\<^sub>s\<^sub>b ?r |
       is_non_volatile_Write\<^sub>s\<^sub>b ?r |
       is_Prog\<^sub>s\<^sub>b ?r | is_Ghost\<^sub>s\<^sub>b ?r)",
     template_negation
      (
         template_equation
          (template_app (template_hole 5, template_var 0),
           template_app
            (template_app
              (template_hole 4,
               template_app (template_hole 3, template_var 0)),
             template_app
              (template_app
                (template_hole 4,
                 template_app (template_hole 2, template_var 0)),
               template_app
                (template_app
                  (template_hole 4,
                   template_app (template_hole 1, template_var 0)),
                 template_app (template_hole 0, template_var 0)))))
         )),
    ("ReduceStoreBuffer.hd_prog_append_Ghost\<^sub>s\<^sub>b",
     "hd_prog ?p (?sb @ [Ghost\<^sub>s\<^sub>b ?A ?R ?L ?W]) =
      hd_prog ?p ?sb",
     template_equation
      (template_app
        (template_app (template_hole 4, template_var 5),
         template_app
          (template_app (template_hole 3, template_var 4),
           template_app
            (template_app
              (template_hole 2,
               template_app
                (template_app
                  (template_app
                    (template_app (template_hole 1, template_var 3),
                     template_var 2),
                   template_var 1),
                 template_var 0)),
             template_hole 0))),
       template_app
        (template_app (template_hole 4, template_var 5), template_var 4))),
    ("ReduceStoreBuffer.hd_prog_append_Read\<^sub>s\<^sub>b",
     "hd_prog ?p (?sb @ [Read\<^sub>s\<^sub>b ?volatile ?a ?t ?v]) =
      hd_prog ?p ?sb",
     template_equation
      (template_app
        (template_app (template_hole 4, template_var 5),
         template_app
          (template_app (template_hole 3, template_var 4),
           template_app
            (template_app
              (template_hole 2,
               template_app
                (template_app
                  (template_app
                    (template_app (template_hole 1, template_var 3),
                     template_var 2),
                   template_var 1),
                 template_var 0)),
             template_hole 0))),
       template_app
        (template_app (template_hole 4, template_var 5), template_var 4))),
    ("ReduceStoreBuffer.last_prog_append_Ghost\<^sub>s\<^sub>b",
     "last_prog ?p (?sb @ [Ghost\<^sub>s\<^sub>b ?A ?L ?R ?W]) =
      last_prog ?p ?sb",
     template_equation
      (template_app
        (template_app (template_hole 4, template_var 5),
         template_app
          (template_app (template_hole 3, template_var 4),
           template_app
            (template_app
              (template_hole 2,
               template_app
                (template_app
                  (template_app
                    (template_app (template_hole 1, template_var 3),
                     template_var 2),
                   template_var 1),
                 template_var 0)),
             template_hole 0))),
       template_app
        (template_app (template_hole 4, template_var 5), template_var 4))),
    ("ReduceStoreBuffer.last_prog_append_Read\<^sub>s\<^sub>b",
     "last_prog ?p (?sb @ [Read\<^sub>s\<^sub>b ?volatile ?a ?t ?v]) =
      last_prog ?p ?sb",
     template_equation
      (template_app
        (template_app (template_hole 4, template_var 5),
         template_app
          (template_app (template_hole 3, template_var 4),
           template_app
            (template_app
              (template_hole 2,
               template_app
                (template_app
                  (template_app
                    (template_app (template_hole 1, template_var 3),
                     template_var 2),
                   template_var 1),
                 template_var 0)),
             template_hole 0))),
       template_app
        (template_app (template_hole 4, template_var 5), template_var 4))),
    ("ReduceStoreBuffer.outstanding_refs_is_non_volatile_Write\<^sub>s\<^sub>b_takeWhile_conv",
     "outstanding_refs is_non_volatile_Write\<^sub>s\<^sub>b
       (takeWhile (Not o is_volatile_Write\<^sub>s\<^sub>b) ?sb) =
      outstanding_refs is_Write\<^sub>s\<^sub>b
       (takeWhile (Not o is_volatile_Write\<^sub>s\<^sub>b) ?sb)",
     template_equation
      (template_app
        (template_app (template_hole 6, template_hole 5),
         template_app
          (template_app
            (template_hole 4,
             template_app
              (template_app (template_hole 3, template_hole 2),
               template_hole 1)),
           template_var 0)),
       template_app
        (template_app (template_hole 6, template_hole 0),
         template_app
          (template_app
            (template_hole 4,
             template_app
              (template_app (template_hole 3, template_hole 2),
               template_hole 1)),
           template_var 0)))),
    ("ReduceStoreBuffer.no_write_to_read_only_memory_append",
     "no_write_to_read_only_memory ?\<S> (?xs @ ?ys) =
      (no_write_to_read_only_memory ?\<S> ?xs &
       no_write_to_read_only_memory (share ?xs ?\<S>) ?ys)",
     template_equation
      (template_app
        (template_app (template_hole 3, template_var 2),
         template_app
          (template_app (template_hole 2, template_var 1), template_var 0)),
       template_app
        (template_app
          (template_hole 1,
           template_app
            (template_app (template_hole 3, template_var 2),
             template_var 1)),
         template_app
          (template_app
            (template_hole 3,
             template_app
              (template_app (template_hole 0, template_var 1),
               template_var 2)),
           template_var 0)))),
    ("ReduceStoreBuffer.non_volatile_writes_unshared_append",
     "non_volatile_writes_unshared ?\<S> (?xs @ ?ys) =
      (non_volatile_writes_unshared ?\<S> ?xs &
       non_volatile_writes_unshared (share ?xs ?\<S>) ?ys)",
     template_equation
      (template_app
        (template_app (template_hole 3, template_var 2),
         template_app
          (template_app (template_hole 2, template_var 1), template_var 0)),
       template_app
        (template_app
          (template_hole 1,
           template_app
            (template_app (template_hole 3, template_var 2),
             template_var 1)),
         template_app
          (template_app
            (template_hole 3,
             template_app
              (template_app (template_hole 0, template_var 1),
               template_var 2)),
           template_var 0)))),
    ("ReduceStoreBuffer.share_owns_shared",
     "sharing_consistent ?\<S> ?\<O> ?sb ==>
      dom (share ?sb ?\<S>) <= ?\<O> Un dom ?\<S>",
     template_implication
      ([template_predicate
         (
            template_app
             (template_app
               (template_app (template_hole 4, template_var 2),
                template_var 1),
              template_var 0)
            )],
       template_inequation
        (less_equals,
         template_app
          (template_hole 2,
           template_app
            (template_app (template_hole 1, template_var 0),
             template_var 2)),
         template_app
          (template_app (template_hole 0, template_var 1),
           template_app (template_hole 2, template_var 2))))),
    ("ReduceStoreBuffer.acquired_owns_shared",
     "sharing_consistent ?\<S> ?\<O> ?sb ==>
      acquired True ?sb ?\<O> <= ?\<O> Un dom ?\<S>",
     template_implication
      ([template_predicate
         (
            template_app
             (template_app
               (template_app (template_hole 5, template_var 2),
                template_var 1),
              template_var 0)
            )],
       template_inequation
        (less_equals,
         template_app
          (template_app
            (template_app (template_hole 3, template_hole 2),
             template_var 0),
           template_var 1),
         template_app
          (template_app (template_hole 1, template_var 1),
           template_app (template_hole 0, template_var 2))))),
    ("ReduceStoreBuffer.freshly_shared_owned",
     "sharing_consistent ?\<S> ?\<O> ?sb ==>
      dom (share ?sb ?\<S>) - dom ?\<S> <= ?\<O>",
     template_implication
      ([template_predicate
         (
            template_app
             (template_app
               (template_app (template_hole 4, template_var 2),
                template_var 1),
              template_var 0)
            )],
       template_inequation
        (less_equals,
         template_app
          (template_app
            (template_hole 2,
             template_app
              (template_hole 1,
               template_app
                (template_app (template_hole 0, template_var 0),
                 template_var 2))),
           template_app (template_hole 1, template_var 2)),
         template_var 1))),
    ("ReduceStoreBuffer.non_volatile_owned_or_read_only_outstanding_non_volatile_writes",
     "non_volatile_owned_or_read_only ?pending_write ?\<S> ?\<O> ?sb ==>
      outstanding_refs is_non_volatile_Write\<^sub>s\<^sub>b ?sb
      <= ?\<O> Un all_acquired ?sb",
     template_implication
      ([template_predicate
         (
            template_app
             (template_app
               (template_app
                 (template_app (template_hole 5, template_var 3),
                  template_var 2),
                template_var 1),
              template_var 0)
            )],
       template_inequation
        (less_equals,
         template_app
          (template_app (template_hole 3, template_hole 2), template_var 0),
         template_app
          (template_app (template_hole 1, template_var 1),
           template_app (template_hole 0, template_var 0))))),
    ("ReduceStoreBuffer.flush_unchanged_addresses",
     "?a ~: outstanding_refs is_Write\<^sub>s\<^sub>b ?sb ==>
      flush ?sb ?m ?a = ?m ?a",
     template_implication
      ([template_negation
         (
            template_predicate
             (
                template_app
                 (template_app (template_hole 4, template_var 2),
                  template_app
                   (template_app (template_hole 3, template_hole 2),
                    template_var 1))
                )
            )],
       template_equation
        (template_app
          (template_app
            (template_app (template_hole 0, template_var 1),
             template_var 0),
           template_var 2),
         template_app (template_var 0, template_var 2)))),
    ("ReduceStoreBuffer.read_only_mono",
     "[| ?S \<subseteq>\<^sub>m ?S'; ?a : read_only ?S |]
      ==> ?a : read_only ?S'",
     template_implication
      ([template_predicate
         (
            template_app
             (template_app (template_hole 2, template_var 2),
              template_var 1)
            ),
        template_predicate
         (
            template_app
             (template_app (template_hole 1, template_var 0),
              template_app (template_hole 0, template_var 2))
            )],
       template_predicate
        (
           template_app
            (template_app (template_hole 1, template_var 0),
             template_app (template_hole 0, template_var 1))
           ))),
    ("ReduceStoreBuffer.sharing_consistent_mono_owns",
     "[| ?\<O> <= ?\<O>'; sharing_consistent ?\<S> ?\<O> ?sb |]
      ==> sharing_consistent ?\<S> ?\<O>' ?sb",
     template_implication
      ([template_inequation (less_equals, template_var 3, template_var 2),
        template_predicate
         (
            template_app
             (template_app
               (template_app (template_hole 0, template_var 1),
                template_var 3),
              template_var 0)
            )],
       template_predicate
        (
           template_app
            (template_app
              (template_app (template_hole 0, template_var 1),
               template_var 2),
             template_var 0)
           ))),
    ("ReduceStoreBuffer.r_rtranclp_rtranclp",
     "[| ?r ?x ?y; ?r^** ?y ?z |] ==> ?r^** ?x ?z",
     template_implication
      ([template_predicate
         (
            template_app
             (template_app (template_var 3, template_var 2), template_var 1)
            ),
        template_predicate
         (
            template_app
             (template_app
               (template_app (template_hole 0, template_var 3),
                template_var 1),
              template_var 0)
            )],
       template_predicate
        (
           template_app
            (template_app
              (template_app (template_hole 0, template_var 3),
               template_var 2),
             template_var 0)
           ))),
    ("ReduceStoreBuffer.safe_reach_step",
     "[| safe_reach ?step ?safe ?cfg; ?step ?cfg ?cfg' |]
      ==> safe_reach ?step ?safe ?cfg'",
     template_implication
      ([template_predicate
         (
            template_app
             (template_app
               (template_app (template_hole 0, template_var 3),
                template_var 2),
              template_var 1)
            ),
        template_predicate
         (
            template_app
             (template_app (template_var 3, template_var 1), template_var 0)
            )],
       template_predicate
        (
           template_app
            (template_app
              (template_app (template_hole 0, template_var 3),
               template_var 2),
             template_var 0)
           ))),
    ("ReduceStoreBuffer.rtranclp_r_rtranclp",
     "[| ?r^** ?x ?y; ?r ?y ?z |] ==> ?r^** ?x ?z",
     template_implication
      ([template_predicate
         (
            template_app
             (template_app
               (template_app (template_hole 0, template_var 3),
                template_var 2),
              template_var 1)
            ),
        template_predicate
         (
            template_app
             (template_app (template_var 3, template_var 1), template_var 0)
            )],
       template_predicate
        (
           template_app
            (template_app
              (template_app (template_hole 0, template_var 3),
               template_var 2),
             template_var 0)
           ))),
    ("ReduceStoreBuffer.non_volatile_writes_unshared_antimono",
     "[| dom ?\<S> <= dom ?\<S>'; non_volatile_writes_unshared ?\<S>' ?xs |]
      ==> non_volatile_writes_unshared ?\<S> ?xs",
     template_implication
      ([template_inequation
         (less_equals, template_app (template_hole 1, template_var 2),
          template_app (template_hole 1, template_var 1)),
        template_predicate
         (
            template_app
             (template_app (template_hole 0, template_var 1),
              template_var 0)
            )],
       template_predicate
        (
           template_app
            (template_app (template_hole 0, template_var 2), template_var 0)
           ))),
    ("ReduceStoreBuffer.owned_simp",
     "owned (?p, ?instrs, ?\<theta>, ?sb, ?\<D>, ?\<O>, ?\<R>) = ?\<O>",
     template_equation
      (template_app
        (template_hole 6,
         template_app
          (template_app (template_hole 5, template_var 6),
           template_app
            (template_app (template_hole 4, template_var 5),
             template_app
              (template_app (template_hole 3, template_var 4),
               template_app
                (template_app (template_hole 2, template_var 3),
                 template_app
                  (template_app (template_hole 1, template_var 2),
                   template_app
                    (template_app (template_hole 0, template_var 1),
                     template_var 0))))))),
       template_var 1)),
    ("ReduceStoreBuffer.released_simp",
     "released (?p, ?instrs, ?\<theta>, ?sb, ?\<D>, ?\<O>, ?\<R>) = ?\<R>",
     template_equation
      (template_app
        (template_hole 6,
         template_app
          (template_app (template_hole 5, template_var 6),
           template_app
            (template_app (template_hole 4, template_var 5),
             template_app
              (template_app (template_hole 3, template_var 4),
               template_app
                (template_app (template_hole 2, template_var 3),
                 template_app
                  (template_app (template_hole 1, template_var 2),
                   template_app
                    (template_app (template_hole 0, template_var 1),
                     template_var 0))))))),
       template_var 0)),
    ("ReduceStoreBuffer.restrict_shared_fuse",
     "?S \<ominus>\<^bsub>?A\<^esub> ?L \<ominus>\<^bsub>?B\<^esub> ?M =
      ?S \<ominus>\<^bsub>(?A Un ?B)\<^esub> ?L Un ?M",
     template_equation
      (template_app
        (template_app
          (template_app
            (template_hole 1,
             template_app
              (template_app
                (template_app (template_hole 1, template_var 4),
                 template_var 3),
               template_var 2)),
           template_var 1),
         template_var 0),
       template_app
        (template_app
          (template_app (template_hole 1, template_var 4),
           template_app
            (template_app (template_hole 0, template_var 3),
             template_var 1)),
         template_app
          (template_app (template_hole 0, template_var 2),
           template_var 0)))),
    ("ReduceStoreBuffer.outstanding_refs_conv",
     "outstanding_refs ?P ?sb = \<Union> (address_of ` {r: set ?sb. ?P r})",
     template_equation
      (template_app
        (template_app (template_hole 7, template_var 1), template_var 0),
       template_app
        (template_hole 6,
         template_app
          (template_app (template_hole 5, template_hole 4),
           template_app (template_hole 3, t_empty))))),
    ("ReduceStoreBuffer.read_only_reads_append",
     "read_only_reads ?\<O> (?xs @ ?ys) =
      read_only_reads ?\<O> ?xs Un
      read_only_reads (acquired True ?xs ?\<O>) ?ys",
     template_equation
      (template_app
        (template_app (template_hole 4, template_var 2),
         template_app
          (template_app (template_hole 3, template_var 1), template_var 0)),
       template_app
        (template_app
          (template_hole 2,
           template_app
            (template_app (template_hole 4, template_var 2),
             template_var 1)),
         template_app
          (template_app
            (template_hole 4,
             template_app
              (template_app
                (template_app (template_hole 1, template_hole 0),
                 template_var 1),
               template_var 2)),
           template_var 0)))),
    ("ReduceStoreBuffer.weak_sharing_consistent_append",
     "weak_sharing_consistent ?\<O> (?xs @ ?ys) =
      (weak_sharing_consistent ?\<O> ?xs &
       weak_sharing_consistent (acquired True ?xs ?\<O>) ?ys)",
     template_equation
      (template_app
        (template_app (template_hole 4, template_var 2),
         template_app
          (template_app (template_hole 3, template_var 1), template_var 0)),
       template_app
        (template_app
          (template_hole 2,
           template_app
            (template_app (template_hole 4, template_var 2),
             template_var 1)),
         template_app
          (template_app
            (template_hole 4,
             template_app
              (template_app
                (template_app (template_hole 1, template_hole 0),
                 template_var 1),
               template_var 2)),
           template_var 0)))),
    ("ReduceStoreBuffer.unshared_all_unshared",
     "sharing_consistent ?\<S> ?\<O> ?sb ==>
      dom ?\<S> - dom (share ?sb ?\<S>) <= all_unshared ?sb",
     template_implication
      ([template_predicate
         (
            template_app
             (template_app
               (template_app (template_hole 5, template_var 2),
                template_var 1),
              template_var 0)
            )],
       template_inequation
        (less_equals,
         template_app
          (template_app
            (template_hole 3,
             template_app (template_hole 2, template_var 2)),
           template_app
            (template_hole 2,
             template_app
              (template_app (template_hole 1, template_var 0),
               template_var 2))),
         template_app (template_hole 0, template_var 0)))),
    ("ReduceStoreBuffer.dom_eq_dom_share_eq",
     "dom ?S = dom ?S' ==> dom (share ?sb ?S) = dom (share ?sb ?S')",
     template_implication
      ([template_equation
         (template_app (template_hole 1, template_var 2),
          template_app (template_hole 1, template_var 1))],
       template_equation
        (template_app
          (template_hole 1,
           template_app
            (template_app (template_hole 0, template_var 0),
             template_var 2)),
         template_app
          (template_hole 1,
           template_app
            (template_app (template_hole 0, template_var 0),
             template_var 1))))),
    ("ReduceStoreBuffer.share_shared_eq",
     "?\<S>' ?a = ?\<S> ?a ==> share ?sb ?\<S>' ?a = share ?sb ?\<S> ?a",
     template_implication
      ([template_equation
         (template_app (template_var 3, template_var 2),
          template_app (template_var 1, template_var 2))],
       template_equation
        (template_app
          (template_app
            (template_app (template_hole 0, template_var 0),
             template_var 3),
           template_var 2),
         template_app
          (template_app
            (template_app (template_hole 0, template_var 0),
             template_var 1),
           template_var 2)))),
    ("ReduceStoreBuffer.share_mono",
     "dom ?A <= dom ?B ==> dom (share ?xs ?A) <= dom (share ?xs ?B)",
     template_implication
      ([template_inequation
         (less_equals, template_app (template_hole 1, template_var 2),
          template_app (template_hole 1, template_var 1))],
       template_inequation
        (less_equals,
         template_app
          (template_hole 1,
           template_app
            (template_app (template_hole 0, template_var 0),
             template_var 2)),
         template_app
          (template_hole 1,
           template_app
            (template_app (template_hole 0, template_var 0),
             template_var 1))))),
    ("ReduceStoreBuffer.share_read_only_mono",
     "read_only ?\<S> <= read_only ?\<S>' ==>
      read_only (share ?sb ?\<S>) <= read_only (share ?sb ?\<S>')",
     template_implication
      ([template_inequation
         (less_equals, template_app (template_hole 1, template_var 2),
          template_app (template_hole 1, template_var 1))],
       template_inequation
        (less_equals,
         template_app
          (template_hole 1,
           template_app
            (template_app (template_hole 0, template_var 0),
             template_var 2)),
         template_app
          (template_hole 1,
           template_app
            (template_app (template_hole 0, template_var 0),
             template_var 1))))),
    ("ReduceStoreBuffer.reads_consistent_drop_volatile_writes_no_volatile_reads",
     "reads_consistent ?pending_write ?\<O> ?m ?sb ==>
      outstanding_refs is_volatile_Read\<^sub>s\<^sub>b
       (dropWhile (Not o is_volatile_Write\<^sub>s\<^sub>b) ?sb) =
      {}",
     template_implication
      ([template_predicate
         (
            template_app
             (template_app
               (template_app
                 (template_app (template_hole 8, template_var 3),
                  template_var 2),
                template_var 1),
              template_var 0)
            )],
       template_equation
        (template_app
          (template_app (template_hole 6, template_hole 5),
           template_app
            (template_app
              (template_hole 4,
               template_app
                (template_app (template_hole 3, template_hole 2),
                 template_hole 1)),
             template_var 0)),
         template_hole 0))),
    ("ReduceStoreBuffer.flushed_values_mem_independent",
     "?a : outstanding_refs is_Write\<^sub>s\<^sub>b ?sb ==>
      flush ?sb ?m' ?a = flush ?sb ?m ?a",
     template_implication
      ([template_predicate
         (
            template_app
             (template_app (template_hole 4, template_var 3),
              template_app
               (template_app (template_hole 3, template_hole 2),
                template_var 2))
            )],
       template_equation
        (template_app
          (template_app
            (template_app (template_hole 0, template_var 2),
             template_var 1),
           template_var 3),
         template_app
          (template_app
            (template_app (template_hole 0, template_var 2),
             template_var 0),
           template_var 3)))),
    ("ReduceStoreBuffer.outstanding_refs_mono_pred",
     "ALL r. ?P r --> ?P' r ==>
      outstanding_refs ?P ?sb <= outstanding_refs ?P' ?sb",
     template_implication
      ([template_predicate (template_app (template_hole 3, t_empty))],
       template_inequation
        (less_equals,
         template_app
          (template_app (template_hole 0, template_var 2), template_var 0),
         template_app
          (template_app (template_hole 0, template_var 1),
           template_var 0)))),
    ("ReduceStoreBuffer.safe_reach_steps",
     "[| safe_reach ?step ?safe ?cfg; ?step^** ?cfg ?cfg' |]
      ==> safe_reach ?step ?safe ?cfg'",
     template_implication
      ([template_predicate
         (
            template_app
             (template_app
               (template_app (template_hole 1, template_var 3),
                template_var 2),
              template_var 1)
            ),
        template_predicate
         (
            template_app
             (template_app
               (template_app (template_hole 0, template_var 3),
                template_var 1),
              template_var 0)
            )],
       template_predicate
        (
           template_app
            (template_app
              (template_app (template_hole 1, template_var 3),
               template_var 2),
             template_var 0)
           ))),
    ("ReduceStoreBuffer.unforwarded_non_volatile_reads_append",
     "unforwarded_non_volatile_reads (?xs @ ?ys) ?W =
      unforwarded_non_volatile_reads ?xs ?W Un
      unforwarded_non_volatile_reads ?ys
       (?W Un outstanding_refs is_Write\<^sub>s\<^sub>b ?xs)",
     template_equation
      (template_app
        (template_app
          (template_hole 4,
           template_app
            (template_app (template_hole 3, template_var 2),
             template_var 1)),
         template_var 0),
       template_app
        (template_app
          (template_hole 2,
           template_app
            (template_app (template_hole 4, template_var 2),
             template_var 0)),
         template_app
          (template_app (template_hole 4, template_var 1),
           template_app
            (template_app (template_hole 2, template_var 0),
             template_app
              (template_app (template_hole 1, template_hole 0),
               template_var 2)))))),
    ("ReduceStoreBuffer.prog_instrs_append_Write\<^sub>s\<^sub>b",
     "prog_instrs
       (?sb @ [Write\<^sub>s\<^sub>b ?volatile ?a ?sop ?v ?A ?L ?R ?W]) =
      prog_instrs ?sb",
     template_equation
      (template_app
        (template_hole 4,
         template_app
          (template_app (template_hole 3, template_var 8),
           template_app
            (template_app
              (template_hole 2,
               template_app
                (template_app
                  (template_app
                    (template_app
                      (template_app
                        (template_app
                          (template_app
                            (template_app (template_hole 1, template_var 7),
                             template_var 6),
                           template_var 5),
                         template_var 4),
                       template_var 3),
                     template_var 2),
                   template_var 1),
                 template_var 0)),
             template_hole 0))),
       template_app (template_hole 4, template_var 8))),
    ("ReduceStoreBuffer.acquired_takeWhile_non_volatile_Write\<^sub>s\<^sub>b",
     "acquired True
       (takeWhile (Not o is_volatile_Write\<^sub>s\<^sub>b) ?sb) ?A
      <= ?A Un
         all_acquired
          (takeWhile (Not o is_volatile_Write\<^sub>s\<^sub>b) ?sb)",
     template_inequation
      (less_equals,
       template_app
        (template_app
          (template_app (template_hole 7, template_hole 6),
           template_app
            (template_app
              (template_hole 5,
               template_app
                (template_app (template_hole 4, template_hole 3),
                 template_hole 2)),
             template_var 1)),
         template_var 0),
       template_app
        (template_app (template_hole 1, template_var 0),
         template_app
          (template_hole 0,
           template_app
            (template_app
              (template_hole 5,
               template_app
                (template_app (template_hole 4, template_hole 3),
                 template_hole 2)),
             template_var 1))))),
    ("ReduceStoreBuffer.causal_program_history_Prog\<^sub>s\<^sub>b",
     "causal_program_history ?is\<^sub>s\<^sub>b ?sb ==>
      causal_program_history (?is\<^sub>s\<^sub>b @ ?mis)
       (?sb @ [Prog\<^sub>s\<^sub>b ?p\<^sub>1 ?p\<^sub>2 ?mis])",
     template_implication
      ([template_predicate
         (
            template_app
             (template_app (template_hole 5, template_var 4),
              template_var 3)
            )],
       template_predicate
        (
           template_app
            (template_app
              (template_hole 5,
               template_app
                (template_app (template_hole 4, template_var 4),
                 template_var 2)),
             template_app
              (template_app (template_hole 3, template_var 3),
               template_app
                (template_app
                  (template_hole 2,
                   template_app
                    (template_app
                      (template_app (template_hole 1, template_var 1),
                       template_var 0),
                     template_var 2)),
                 template_hole 0)))
           ))),
    ("ReduceStoreBuffer.share_all_shared_in",
     "?a : dom (share ?sb ?\<S>) ==> ?a : dom ?\<S> | ?a : all_shared ?sb",
     template_implication
      ([template_predicate
         (
            template_app
             (template_app (template_hole 4, template_var 2),
              template_app
               (template_hole 3,
                template_app
                 (template_app (template_hole 2, template_var 1),
                  template_var 0)))
            )],
       template_predicate
        (
           template_app
            (template_app
              (template_hole 1,
               template_app
                (template_app (template_hole 4, template_var 2),
                 template_app (template_hole 3, template_var 0))),
             template_app
              (template_app (template_hole 4, template_var 2),
               template_app (template_hole 0, template_var 1)))
           ))),
    ("ReduceStoreBuffer.non_volatile_owned_or_read_only_mono",
     "[| ?\<O> <= ?\<O>';
         non_volatile_owned_or_read_only ?pending_write ?\<S> ?\<O> ?xs |]
      ==> non_volatile_owned_or_read_only ?pending_write ?\<S> ?\<O>' ?xs",
     template_implication
      ([template_inequation (less_equals, template_var 4, template_var 3),
        template_predicate
         (
            template_app
             (template_app
               (template_app
                 (template_app (template_hole 0, template_var 2),
                  template_var 1),
                template_var 4),
              template_var 0)
            )],
       template_predicate
        (
           template_app
            (template_app
              (template_app
                (template_app (template_hole 0, template_var 2),
                 template_var 1),
               template_var 3),
             template_var 0)
           ))),
    ("ReduceStoreBuffer.reads_consistent_owns_antimono",
     "[| ?\<O> <= ?\<O>'; reads_consistent ?pending_write ?\<O>' ?m ?sb |]
      ==> reads_consistent ?pending_write ?\<O> ?m ?sb",
     template_implication
      ([template_inequation (less_equals, template_var 4, template_var 3),
        template_predicate
         (
            template_app
             (template_app
               (template_app
                 (template_app (template_hole 0, template_var 2),
                  template_var 3),
                template_var 1),
              template_var 0)
            )],
       template_predicate
        (
           template_app
            (template_app
              (template_app
                (template_app (template_hole 0, template_var 2),
                 template_var 4),
               template_var 1),
             template_var 0)
           ))),
    ("ReduceStoreBuffer.non_volatile_owned_or_read_only_shared_mono",
     "[| ?\<S> \<subseteq>\<^sub>s ?\<S>';
         non_volatile_owned_or_read_only ?pending_write ?\<S> ?\<O> ?xs |]
      ==> non_volatile_owned_or_read_only ?pending_write ?\<S>' ?\<O> ?xs",
     template_implication
      ([template_predicate
         (
            template_app
             (template_app (template_hole 1, template_var 4),
              template_var 3)
            ),
        template_predicate
         (
            template_app
             (template_app
               (template_app
                 (template_app (template_hole 0, template_var 2),
                  template_var 4),
                template_var 1),
              template_var 0)
            )],
       template_predicate
        (
           template_app
            (template_app
              (template_app
                (template_app (template_hole 0, template_var 2),
                 template_var 3),
               template_var 1),
             template_var 0)
           ))),
    ("ReduceStoreBuffer.sharing_consistent_mono_shared",
     "[| dom ?\<S> <= dom ?\<S>'; sharing_consistent ?\<S> ?\<O> ?sb |]
      ==> sharing_consistent ?\<S>' ?\<O> ?sb",
     template_implication
      ([template_inequation
         (less_equals, template_app (template_hole 1, template_var 3),
          template_app (template_hole 1, template_var 2)),
        template_predicate
         (
            template_app
             (template_app
               (template_app (template_hole 0, template_var 3),
                template_var 1),
              template_var 0)
            )],
       template_predicate
        (
           template_app
            (template_app
              (template_app (template_hole 0, template_var 2),
               template_var 1),
             template_var 0)
           ))),
    ("ReduceStoreBuffer.acquired_by_instrs_mono_in",
     "[| ?x : acquired_by_instrs ?is ?A; ?A <= ?B |]
      ==> ?x : acquired_by_instrs ?is ?B",
     template_implication
      ([template_predicate
         (
            template_app
             (template_app (template_hole 2, template_var 3),
              template_app
               (template_app (template_hole 1, template_var 2),
                template_var 1))
            ),
        template_inequation (less_equals, template_var 1, template_var 0)],
       template_predicate
        (
           template_app
            (template_app (template_hole 2, template_var 3),
             template_app
              (template_app (template_hole 1, template_var 2),
               template_var 0))
           ))),
    ("ReduceStoreBuffer.unforwarded_non_volatile_reads_antimono_in",
     "[| ?x : unforwarded_non_volatile_reads ?xs ?W'; ?W <= ?W' |]
      ==> ?x : unforwarded_non_volatile_reads ?xs ?W",
     template_implication
      ([template_predicate
         (
            template_app
             (template_app (template_hole 2, template_var 3),
              template_app
               (template_app (template_hole 1, template_var 2),
                template_var 1))
            ),
        template_inequation (less_equals, template_var 0, template_var 1)],
       template_predicate
        (
           template_app
            (template_app (template_hole 2, template_var 3),
             template_app
              (template_app (template_hole 1, template_var 2),
               template_var 0))
           ))),
    ("ReduceStoreBuffer.distinct_load_tmps_append",
     "distinct_load_tmps (?xs @ ?ys) =
      (distinct_load_tmps ?xs &
       distinct_load_tmps ?ys & load_tmps ?xs Int load_tmps ?ys = {})",
     template_implication
      ([template_predicate
         (
            template_app
             (template_hole 6,
              template_app
               (template_app (template_hole 5, template_var 1),
                template_var 0))
            )],
       template_predicate
        (
           template_app
            (template_app
              (template_hole 4,
               template_app (template_hole 6, template_var 1)),
             template_app
              (template_app
                (template_hole 4,
                 template_app (template_hole 6, template_var 0)),
               template_app
                (template_app
                  (template_hole 3,
                   template_app
                    (template_app
                      (template_hole 2,
                       template_app (template_hole 1, template_var 1)),
                     template_app (template_hole 1, template_var 0))),
                 template_hole 0)))
           ))),
    ("ReduceStoreBuffer.distinct_read_tmps_append",
     "distinct_read_tmps (?xs @ ?ys) =
      (distinct_read_tmps ?xs &
       distinct_read_tmps ?ys & read_tmps ?xs Int read_tmps ?ys = {})",
     template_implication
      ([template_predicate
         (
            template_app
             (template_hole 6,
              template_app
               (template_app (template_hole 5, template_var 1),
                template_var 0))
            )],
       template_predicate
        (
           template_app
            (template_app
              (template_hole 4,
               template_app (template_hole 6, template_var 1)),
             template_app
              (template_app
                (template_hole 4,
                 template_app (template_hole 6, template_var 0)),
               template_app
                (template_app
                  (template_hole 3,
                   template_app
                    (template_app
                      (template_hole 2,
                       template_app (template_hole 1, template_var 1)),
                     template_app (template_hole 1, template_var 0))),
                 template_hole 0)))
           ))),
    ("ReduceStoreBuffer.\<O>_sb_simp",
     "\<O>_sb (?p, ?instrs, ?\<theta>, ?sb, ?\<D>, ?\<O>, ?\<R>) =
      (?\<O>, ?sb)",
     template_equation
      (template_app
        (template_hole 7,
         template_app
          (template_app (template_hole 6, template_var 6),
           template_app
            (template_app (template_hole 5, template_var 5),
             template_app
              (template_app (template_hole 4, template_var 4),
               template_app
                (template_app (template_hole 3, template_var 3),
                 template_app
                  (template_app (template_hole 2, template_var 2),
                   template_app
                    (template_app (template_hole 1, template_var 1),
                     template_var 0))))))),
       template_app
        (template_app (template_hole 0, template_var 1), template_var 3))),
    ("ReduceStoreBuffer.read_only_share",
     "sharing_consistent ?\<S> ?\<O> ?sb ==>
      read_only (share ?sb ?\<S>)
      <= read_only ?\<S> Un ?\<O> Un all_acquired ?sb",
     template_implication
      ([template_predicate
         (
            template_app
             (template_app
               (template_app (template_hole 5, template_var 2),
                template_var 1),
              template_var 0)
            )],
       template_inequation
        (less_equals,
         template_app
          (template_hole 3,
           template_app
            (template_app (template_hole 2, template_var 0),
             template_var 2)),
         template_app
          (template_app
            (template_hole 1,
             template_app
              (template_app
                (template_hole 1,
                 template_app (template_hole 3, template_var 2)),
               template_var 1)),
           template_app (template_hole 0, template_var 0))))),
    ("ReduceStoreBuffer.dom_augment_rels_rels_eq",
     "dom ?\<R>' = dom ?\<R> ==>
      dom (augment_rels ?S ?R ?\<R>') = dom (augment_rels ?S ?R ?\<R>)",
     template_implication
      ([template_equation
         (template_app (template_hole 1, template_var 3),
          template_app (template_hole 1, template_var 2))],
       template_equation
        (template_app
          (template_hole 1,
           template_app
            (template_app
              (template_app (template_hole 0, template_var 1),
               template_var 0),
             template_var 3)),
         template_app
          (template_hole 1,
           template_app
            (template_app
              (template_app (template_hole 0, template_var 1),
               template_var 0),
             template_var 2))))),
    ("ReduceStoreBuffer.dom_release_rels_eq",
     "dom ?\<R>' = dom ?\<R> ==>
      dom (release ?sb ?\<S> ?\<R>') = dom (release ?sb ?\<S> ?\<R>)",
     template_implication
      ([template_equation
         (template_app (template_hole 1, template_var 3),
          template_app (template_hole 1, template_var 2))],
       template_equation
        (template_app
          (template_hole 1,
           template_app
            (template_app
              (template_app (template_hole 0, template_var 1),
               template_var 0),
             template_var 3)),
         template_app
          (template_hole 1,
           template_app
            (template_app
              (template_app (template_hole 0, template_var 1),
               template_var 0),
             template_var 2))))),
    ("ReduceStoreBuffer.outstanding_refs_empty_negate",
     "outstanding_refs ?P ?sb = {} ==>
      outstanding_refs (Not o ?P) ?sb = \<Union> (address_of ` set ?sb)",
     template_implication
      ([template_equation
         (template_app
           (template_app (template_hole 7, template_var 1), template_var 0),
          template_hole 6)],
       template_equation
        (template_app
          (template_app
            (template_hole 7,
             template_app
              (template_app (template_hole 5, template_hole 4),
               template_var 1)),
           template_var 0),
         template_app
          (template_hole 3,
           template_app
            (template_app (template_hole 2, template_hole 1),
             template_app (template_hole 0, template_var 0)))))),
    ("ReduceStoreBuffer.augment_mono_aux",
     "dom ?A <= dom ?B ==>
      dom (?A \<oplus>\<^bsub>?x\<^esub> ?C)
      <= dom (?B \<oplus>\<^bsub>?x\<^esub> ?C)",
     template_implication
      ([template_inequation
         (less_equals, template_app (template_hole 1, template_var 3),
          template_app (template_hole 1, template_var 2))],
       template_inequation
        (less_equals,
         template_app
          (template_hole 1,
           template_app
            (template_app
              (template_app (template_hole 0, template_var 3),
               template_var 1),
             template_var 0)),
         template_app
          (template_hole 1,
           template_app
            (template_app
              (template_app (template_hole 0, template_var 2),
               template_var 1),
             template_var 0))))),
    ("ReduceStoreBuffer.restrict_mono_aux",
     "dom ?A <= dom ?B ==>
      dom (?A \<ominus>\<^bsub>?x\<^esub> ?C)
      <= dom (?B \<ominus>\<^bsub>?x\<^esub> ?C)",
     template_implication
      ([template_inequation
         (less_equals, template_app (template_hole 1, template_var 3),
          template_app (template_hole 1, template_var 2))],
       template_inequation
        (less_equals,
         template_app
          (template_hole 1,
           template_app
            (template_app
              (template_app (template_hole 0, template_var 3),
               template_var 1),
             template_var 0)),
         template_app
          (template_hole 1,
           template_app
            (template_app
              (template_app (template_hole 0, template_var 2),
               template_var 1),
             template_var 0))))),
    ("ReduceStoreBuffer.augment_read_only_mono",
     "read_only ?\<S> <= read_only ?\<S>' ==>
      read_only (?\<S> \<oplus>\<^bsub>?W\<^esub> ?R)
      <= read_only (?\<S>' \<oplus>\<^bsub>?W\<^esub> ?R)",
     template_implication
      ([template_inequation
         (less_equals, template_app (template_hole 1, template_var 3),
          template_app (template_hole 1, template_var 2))],
       template_inequation
        (less_equals,
         template_app
          (template_hole 1,
           template_app
            (template_app
              (template_app (template_hole 0, template_var 3),
               template_var 1),
             template_var 0)),
         template_app
          (template_hole 1,
           template_app
            (template_app
              (template_app (template_hole 0, template_var 2),
               template_var 1),
             template_var 0))))),
    ("ReduceStoreBuffer.restrict_read_only_mono",
     "read_only ?\<S> <= read_only ?\<S>' ==>
      read_only (?\<S> \<ominus>\<^bsub>?A\<^esub> ?L)
      <= read_only (?\<S>' \<ominus>\<^bsub>?A\<^esub> ?L)",
     template_implication
      ([template_inequation
         (less_equals, template_app (template_hole 1, template_var 3),
          template_app (template_hole 1, template_var 2))],
       template_inequation
        (less_equals,
         template_app
          (template_hole 1,
           template_app
            (template_app
              (template_app (template_hole 0, template_var 3),
               template_var 1),
             template_var 0)),
         template_app
          (template_hole 1,
           template_app
            (template_app
              (template_app (template_hole 0, template_var 2),
               template_var 1),
             template_var 0))))),
    ("ReduceStoreBuffer.outstanding_refs_non_empty_dropWhile",
     "outstanding_refs ?P ?xs ~= {} ==>
      outstanding_refs ?P (dropWhile (Not o ?P) ?xs) ~= {}",
     template_implication
      ([template_negation
         (
            template_equation
             (template_app
               (template_app (template_hole 3, template_var 1),
                template_var 0),
              template_hole 2)
            )],
       template_negation
        (
           template_equation
            (template_app
              (template_app (template_hole 3, template_var 1),
               template_app
                (template_app
                  (template_hole 1,
                   template_app
                    (template_app (template_hole 0, template_hole 5),
                     template_var 1)),
                 template_var 0)),
             template_hole 2)
           ))),
    ("ReduceStoreBuffer.notin_outstanding_non_volatile_takeWhile_lem'",
     "?a ~: outstanding_refs is_non_volatile_Write\<^sub>s\<^sub>b ?sb ==>
      ?a ~: outstanding_refs is_Write\<^sub>s\<^sub>b
             (takeWhile (Not o is_volatile_Write\<^sub>s\<^sub>b) ?sb)",
     template_implication
      ([template_negation
         (
            template_predicate
             (
                template_app
                 (template_app (template_hole 6, template_var 1),
                  template_app
                   (template_app (template_hole 5, template_hole 4),
                    template_var 0))
                )
            )],
       template_negation
        (
           template_predicate
            (
               template_app
                (template_app (template_hole 6, template_var 1),
                 template_app
                  (template_app (template_hole 5, template_hole 3),
                   template_app
                    (template_app
                      (template_hole 2,
                       template_app
                        (template_app (template_hole 1, template_hole 7),
                         template_hole 0)),
                     template_var 0)))
               )
           ))),
    ("ReduceStoreBuffer.initial_empty_rels",
     "initial (?ts, ?m, ?\<S>) ==>
      ALL \<R>:set (map released ?ts). \<R> = Map.empty",
     template_implication
      ([template_predicate
         (
            template_app
             (template_hole 8,
              template_app
               (template_app (template_hole 7, template_var 2),
                template_app
                 (template_app (template_hole 6, template_var 1),
                  template_var 0)))
            )],
       template_predicate
        (
           template_app
            (template_app
              (template_hole 5,
               template_app
                (template_hole 4,
                 template_app
                  (template_app (template_hole 3, template_hole 2),
                   template_var 2))),
             t_empty)
           ))),
    ("ReduceStoreBuffer.share_domain_changes",
     "?a : all_shared ?sb Un all_unshared ?sb ==>
      share ?sb ?\<S>' ?a = share ?sb ?\<S> ?a",
     template_implication
      ([template_predicate
         (
            template_app
             (template_app (template_hole 5, template_var 3),
              template_app
               (template_app
                 (template_hole 4,
                  template_app (template_hole 3, template_var 2)),
                template_app (template_hole 2, template_var 2)))
            )],
       template_equation
        (template_app
          (template_app
            (template_app (template_hole 0, template_var 2),
             template_var 1),
           template_var 3),
         template_app
          (template_app
            (template_app (template_hole 0, template_var 2),
             template_var 0),
           template_var 3)))),
    ("ReduceStoreBuffer.all_shared_acquired_in",
     "[| ?a : ?A; ?a ~: all_shared ?sb |] ==> ?a : acquired True ?sb ?A",
     template_implication
      ([template_predicate
         (
            template_app
             (template_app (template_hole 4, template_var 2),
              template_var 1)
            ),
        template_negation
         (
            template_predicate
             (
                template_app
                 (template_app (template_hole 4, template_var 2),
                  template_app (template_hole 2, template_var 0))
                )
            )],
       template_predicate
        (
           template_app
            (template_app (template_hole 4, template_var 2),
             template_app
              (template_app
                (template_app (template_hole 1, template_hole 0),
                 template_var 0),
               template_var 1))
           ))),
    ("ReduceStoreBuffer.unforwarded_empty_extend",
     "[| ?x : unforwarded_non_volatile_reads ?sb {}; ?x ~: ?W |]
      ==> ?x : unforwarded_non_volatile_reads ?sb ?W",
     template_implication
      ([template_predicate
         (
            template_app
             (template_app (template_hole 3, template_var 2),
              template_app
               (template_app (template_hole 2, template_var 1),
                template_hole 1))
            ),
        template_negation
         (
            template_predicate
             (
                template_app
                 (template_app (template_hole 3, template_var 2),
                  template_var 0)
                )
            )],
       template_predicate
        (
           template_app
            (template_app (template_hole 3, template_var 2),
             template_app
              (template_app (template_hole 2, template_var 1),
               template_var 0))
           ))),
    ("ReduceStoreBuffer.hd_prog_append_Write\<^sub>s\<^sub>b",
     "hd_prog ?p
       (?sb @ [Write\<^sub>s\<^sub>b ?volatile ?a ?sop ?v ?A ?L ?R ?W]) =
      hd_prog ?p ?sb",
     template_equation
      (template_app
        (template_app (template_hole 4, template_var 9),
         template_app
          (template_app (template_hole 3, template_var 8),
           template_app
            (template_app
              (template_hole 2,
               template_app
                (template_app
                  (template_app
                    (template_app
                      (template_app
                        (template_app
                          (template_app
                            (template_app (template_hole 1, template_var 7),
                             template_var 6),
                           template_var 5),
                         template_var 4),
                       template_var 3),
                     template_var 2),
                   template_var 1),
                 template_var 0)),
             template_hole 0))),
       template_app
        (template_app (template_hole 4, template_var 9), template_var 8))),
    ("ReduceStoreBuffer.last_prog_append_Write\<^sub>s\<^sub>b",
     "last_prog ?p
       (?sb @ [Write\<^sub>s\<^sub>b ?volatile ?a ?sop ?v ?A ?L ?R ?W]) =
      last_prog ?p ?sb",
     template_equation
      (template_app
        (template_app (template_hole 4, template_var 9),
         template_app
          (template_app (template_hole 3, template_var 8),
           template_app
            (template_app
              (template_hole 2,
               template_app
                (template_app
                  (template_app
                    (template_app
                      (template_app
                        (template_app
                          (template_app
                            (template_app (template_hole 1, template_var 7),
                             template_var 6),
                           template_var 5),
                         template_var 4),
                       template_var 3),
                     template_var 2),
                   template_var 1),
                 template_var 0)),
             template_hole 0))),
       template_app
        (template_app (template_hole 4, template_var 9), template_var 8))),
    ("ReduceStoreBuffer.release_append",
     "release (?sb @ ?xs) (dom ?\<S>) ?\<R> =
      release ?xs (dom (share ?sb ?\<S>)) (release ?sb (dom ?\<S>) ?\<R>)",
     template_equation
      (template_app
        (template_app
          (template_app
            (template_hole 3,
             template_app
              (template_app (template_hole 2, template_var 3),
               template_var 2)),
           template_app (template_hole 1, template_var 1)),
         template_var 0),
       template_app
        (template_app
          (template_app (template_hole 3, template_var 2),
           template_app
            (template_hole 1,
             template_app
              (template_app (template_hole 0, template_var 3),
               template_var 1))),
         template_app
          (template_app
            (template_app (template_hole 3, template_var 3),
             template_app (template_hole 1, template_var 1)),
           template_var 0)))),
    ("ReduceStoreBuffer.dom_release_takeWhile",
     "dom (release (takeWhile (Not o is_volatile_Write\<^sub>s\<^sub>b) ?sb)
            ?S ?\<R>) =
      dom ?\<R> Un
      all_shared (takeWhile (Not o is_volatile_Write\<^sub>s\<^sub>b) ?sb)",
     template_equation
      (template_app
        (template_hole 7,
         template_app
          (template_app
            (template_app
              (template_hole 6,
               template_app
                (template_app
                  (template_hole 5,
                   template_app
                    (template_app (template_hole 4, template_hole 3),
                     template_hole 2)),
                 template_var 2)),
             template_var 1),
           template_var 0)),
       template_app
        (template_app
          (template_hole 1, template_app (template_hole 7, template_var 0)),
         template_app
          (template_hole 0,
           template_app
            (template_app
              (template_hole 5,
               template_app
                (template_app (template_hole 4, template_hole 3),
                 template_hole 2)),
             template_var 2))))),
    ("ReduceStoreBuffer.in_read_tmps_conv",
     "(?t : read_tmps ?xs) =
      (EX volatile a v. Read\<^sub>s\<^sub>b volatile a ?t v : set ?xs)",
     template_equation
      (template_app
        (template_app (template_hole 6, template_var 1),
         template_app (template_hole 5, template_var 0)),
       template_app (template_hole 4, t_empty))),
    ("ReduceStoreBuffer.reads_consistent_dropWhile",
     "reads_consistent ?pending_write ?\<O> ?m
       (dropWhile (Not o is_volatile_Write\<^sub>s\<^sub>b) ?sb) =
      reads_consistent True ?\<O> ?m
       (dropWhile (Not o is_volatile_Write\<^sub>s\<^sub>b) ?sb)",
     template_equation
      (template_app
        (template_app
          (template_app
            (template_app (template_hole 5, template_var 3),
             template_var 2),
           template_var 1),
         template_app
          (template_app
            (template_hole 4,
             template_app
              (template_app (template_hole 3, template_hole 2),
               template_hole 1)),
           template_var 0)),
       template_app
        (template_app
          (template_app
            (template_app (template_hole 5, template_hole 0),
             template_var 2),
           template_var 1),
         template_app
          (template_app
            (template_hole 4,
             template_app
              (template_app (template_hole 3, template_hole 2),
               template_hole 1)),
           template_var 0)))),
    ("ReduceStoreBuffer.non_volatile_reads_acquired_or_read_only_reads",
     "non_volatile_owned_or_read_only ?pending_write ?\<S> ?\<O> ?sb ==>
      outstanding_refs is_non_volatile_Read\<^sub>s\<^sub>b ?sb
      <= ?\<O> Un all_acquired ?sb Un read_only_reads ?\<O> ?sb",
     template_implication
      ([template_predicate
         (
            template_app
             (template_app
               (template_app
                 (template_app (template_hole 6, template_var 3),
                  template_var 2),
                template_var 1),
              template_var 0)
            )],
       template_inequation
        (less_equals,
         template_app
          (template_app (template_hole 4, template_hole 3), template_var 0),
         template_app
          (template_app
            (template_hole 2,
             template_app
              (template_app (template_hole 2, template_var 1),
               template_app (template_hole 1, template_var 0))),
           template_app
            (template_app (template_hole 0, template_var 1),
             template_var 0))))),
    ("ReduceStoreBuffer.reads_consistent_snoc_Prog\<^sub>s\<^sub>b",
     "reads_consistent ?pending_write ?\<O> ?m ?sb ==>
      reads_consistent ?pending_write ?\<O> ?m
       (?sb @ [Prog\<^sub>s\<^sub>b ?p\<^sub>1 ?p\<^sub>2 ?mis])",
     template_implication
      ([template_predicate
         (
            template_app
             (template_app
               (template_app
                 (template_app (template_hole 4, template_var 6),
                  template_var 5),
                template_var 4),
              template_var 3)
            )],
       template_predicate
        (
           template_app
            (template_app
              (template_app
                (template_app (template_hole 4, template_var 6),
                 template_var 5),
               template_var 4),
             template_app
              (template_app (template_hole 3, template_var 3),
               template_app
                (template_app
                  (template_hole 2,
                   template_app
                    (template_app
                      (template_app (template_hole 1, template_var 2),
                       template_var 1),
                     template_var 0)),
                 template_hole 0)))
           ))),
    ("ReduceStoreBuffer.Write\<^sub>s\<^sub>b_in_outstanding_refs",
     "Write\<^sub>s\<^sub>b True ?a ?sop ?v ?A ?L ?R ?W : set ?xs ==>
      ?a : outstanding_refs is_volatile_Write\<^sub>s\<^sub>b ?xs",
     template_implication
      ([template_predicate
         (
            template_app
             (template_app
               (template_hole 6,
                template_app
                 (template_app
                   (template_app
                     (template_app
                       (template_app
                         (template_app
                           (template_app
                             (template_app
                               (template_hole 5, template_hole 4),
                              template_var 7),
                            template_var 6),
                          template_var 5),
                        template_var 4),
                      template_var 3),
                    template_var 2),
                  template_var 1)),
              template_app (template_hole 3, template_var 0))
            )],
       template_predicate
        (
           template_app
            (template_app (template_hole 2, template_var 7),
             template_app
              (template_app (template_hole 1, template_hole 0),
               template_var 0))
           ))),
    ("ReduceStoreBuffer.unshared_share_in",
     "[| ?a : dom ?S; ?a ~: all_unshared ?sb |]
      ==> ?a : dom (share ?sb ?S)",
     template_implication
      ([template_predicate
         (
            template_app
             (template_app (template_hole 4, template_var 2),
              template_app (template_hole 3, template_var 1))
            ),
        template_negation
         (
            template_predicate
             (
                template_app
                 (template_app (template_hole 4, template_var 2),
                  template_app (template_hole 1, template_var 0))
                )
            )],
       template_predicate
        (
           template_app
            (template_app (template_hole 4, template_var 2),
             template_app
              (template_hole 3,
               template_app
                (template_app (template_hole 0, template_var 0),
                 template_var 1)))
           ))),
    ("ReduceStoreBuffer.hd_prog_last_prog_end",
     "[| ?p = hd_prog ?p ?sb; last_prog ?p ?sb = ?p\<^sub>s\<^sub>b |]
      ==> ?p = hd_prog ?p\<^sub>s\<^sub>b ?sb",
     template_implication
      ([template_equation
         (template_var 2,
          template_app
           (template_app (template_hole 1, template_var 2),
            template_var 1)),
        template_equation
         (template_app
           (template_app (template_hole 0, template_var 2), template_var 1),
          template_var 0)],
       template_equation
        (template_var 2,
         template_app
          (template_app (template_hole 1, template_var 0),
           template_var 1)))),
    ("ReduceStoreBuffer.last_prog_hd_prog_same",
     "[| last_prog ?p' ?sb = ?p; hd_prog ?p' ?sb = ?p' |]
      ==> hd_prog ?p ?sb = ?p'",
     template_implication
      ([template_equation
         (template_app
           (template_app (template_hole 1, template_var 2), template_var 1),
          template_var 0),
        template_equation
         (template_app
           (template_app (template_hole 0, template_var 2), template_var 1),
          template_var 2)],
       template_equation
        (template_app
          (template_app (template_hole 0, template_var 0), template_var 1),
         template_var 2))),
    ("ReduceStoreBuffer.dom_eq_SomeD1",
     "[| dom ?m = dom ?n; ?m ?x = Some ?y |] ==> ?n ?x ~= None",
     template_implication
      ([template_equation
         (template_app (template_hole 6, template_var 3),
          template_app (template_hole 5, template_var 2)),
        template_equation
         (template_app (template_var 3, template_var 1),
          template_app (template_hole 3, template_var 0))],
       template_negation
        (
           template_equation
            (template_app (template_var 2, template_var 1), template_hole 0)
           ))),
    ("ReduceStoreBuffer.dom_eq_SomeD2",
     "[| dom ?m = dom ?n; ?n ?x = Some ?y |] ==> ?m ?x ~= None",
     template_implication
      ([template_equation
         (template_app (template_hole 6, template_var 3),
          template_app (template_hole 5, template_var 2)),
        template_equation
         (template_app (template_var 2, template_var 1),
          template_app (template_hole 3, template_var 0))],
       template_negation
        (
           template_equation
            (template_app (template_var 3, template_var 1), template_hole 0)
           ))),
    ("ReduceStoreBuffer.acquired_mono_in",
     "[| ?x : acquired ?pending_write ?xs ?A; ?A <= ?B |]
      ==> ?x : acquired ?pending_write ?xs ?B",
     template_implication
      ([template_predicate
         (
            template_app
             (template_app (template_hole 2, template_var 4),
              template_app
               (template_app
                 (template_app (template_hole 1, template_var 3),
                  template_var 2),
                template_var 1))
            ),
        template_inequation (less_equals, template_var 1, template_var 0)],
       template_predicate
        (
           template_app
            (template_app (template_hole 2, template_var 4),
             template_app
              (template_app
                (template_app (template_hole 1, template_var 3),
                 template_var 2),
               template_var 0))
           ))),
    ("ReduceStoreBuffer.acquired_reads_mono_in",
     "[| ?x : acquired_reads ?pending_write ?xs ?A; ?A <= ?B |]
      ==> ?x : acquired_reads ?pending_write ?xs ?B",
     template_implication
      ([template_predicate
         (
            template_app
             (template_app (template_hole 2, template_var 4),
              template_app
               (template_app
                 (template_app (template_hole 1, template_var 3),
                  template_var 2),
                template_var 1))
            ),
        template_inequation (less_equals, template_var 1, template_var 0)],
       template_predicate
        (
           template_app
            (template_app (template_hole 2, template_var 4),
             template_app
              (template_app
                (template_app (template_hole 1, template_var 3),
                 template_var 2),
               template_var 0))
           ))),
    ("ReduceStoreBuffer.in_read_only_augment_conv",
     "(?a : read_only (?\<S> \<oplus>\<^bsub>?W\<^esub> ?R)) =
      (if ?a : ?R then ?a ~: ?W else ?a : read_only ?\<S>)",
     template_equation
      (template_app
        (template_app (template_hole 4, template_var 3),
         template_app
          (template_hole 3,
           template_app
            (template_app
              (template_app (template_hole 2, template_var 2),
               template_var 1),
             template_var 0))),
       template_app
        (template_app
          (template_app
            (template_hole 1,
             template_app
              (template_app (template_hole 4, template_var 3),
               template_var 0)),
           template_app
            (template_hole 0,
             template_app
              (template_app (template_hole 4, template_var 3),
               template_var 1))),
         template_app
          (template_app (template_hole 4, template_var 3),
           template_app (template_hole 3, template_var 2))))),
    ("ReduceStoreBuffer.instrs_append_Read\<^sub>s\<^sub>b",
     "instrs (?sb @ [Read\<^sub>s\<^sub>b ?volatile ?a ?t ?v]) =
      instrs ?sb @ [Read ?volatile ?a ?t]",
     template_equation
      (template_app
        (template_hole 8,
         template_app
          (template_app (template_hole 7, template_var 4),
           template_app
            (template_app
              (template_hole 6,
               template_app
                (template_app
                  (template_app
                    (template_app (template_hole 5, template_var 3),
                     template_var 2),
                   template_var 1),
                 template_var 0)),
             template_hole 4))),
       template_app
        (template_app
          (template_hole 3, template_app (template_hole 8, template_var 4)),
         template_app
          (template_app
            (template_hole 2,
             template_app
              (template_app
                (template_app (template_hole 1, template_var 3),
                 template_var 2),
               template_var 1)),
           template_hole 0)))),
    ("ReduceStoreBuffer.acquired_share_owns_shared",
     "sharing_consistent ?\<S> ?\<O> ?sb ==>
      acquired ?pending_write ?sb ?\<O> Un dom (share ?sb ?\<S>)
      <= ?\<O> Un dom ?\<S>",
     template_implication
      ([template_predicate
         (
            template_app
             (template_app
               (template_app (template_hole 5, template_var 3),
                template_var 2),
              template_var 1)
            )],
       template_inequation
        (less_equals,
         template_app
          (template_app
            (template_hole 3,
             template_app
              (template_app
                (template_app (template_hole 2, template_var 0),
                 template_var 1),
               template_var 2)),
           template_app
            (template_hole 1,
             template_app
              (template_app (template_hole 0, template_var 1),
               template_var 3))),
         template_app
          (template_app (template_hole 3, template_var 2),
           template_app (template_hole 1, template_var 3))))),
    ("ReduceStoreBuffer.no_outstanding_vol_write_dropWhile_append",
     "outstanding_refs is_volatile_Write\<^sub>s\<^sub>b ?sb = {} ==>
      dropWhile (Not o is_volatile_Write\<^sub>s\<^sub>b) (?sb @ ?xs) =
      dropWhile (Not o is_volatile_Write\<^sub>s\<^sub>b) ?xs",
     template_implication
      ([template_equation
         (template_app
           (template_app (template_hole 7, template_hole 6),
            template_var 1),
          template_hole 5)],
       template_equation
        (template_app
          (template_app
            (template_hole 3,
             template_app
              (template_app (template_hole 2, template_hole 1),
               template_hole 6)),
           template_app
            (template_app (template_hole 0, template_var 1),
             template_var 0)),
         template_app
          (template_app
            (template_hole 3,
             template_app
              (template_app (template_hole 2, template_hole 1),
               template_hole 6)),
           template_var 0)))),
    ("ReduceStoreBuffer.reads_consistent_snoc_Ghost\<^sub>s\<^sub>b",
     "reads_consistent ?pending_write ?\<O> ?m ?sb ==>
      reads_consistent ?pending_write ?\<O> ?m
       (?sb @ [Ghost\<^sub>s\<^sub>b ?A ?L ?R ?W])",
     template_implication
      ([template_predicate
         (
            template_app
             (template_app
               (template_app
                 (template_app (template_hole 4, template_var 7),
                  template_var 6),
                template_var 5),
              template_var 4)
            )],
       template_predicate
        (
           template_app
            (template_app
              (template_app
                (template_app (template_hole 4, template_var 7),
                 template_var 6),
               template_var 5),
             template_app
              (template_app (template_hole 3, template_var 4),
               template_app
                (template_app
                  (template_hole 2,
                   template_app
                    (template_app
                      (template_app
                        (template_app (template_hole 1, template_var 3),
                         template_var 2),
                       template_var 1),
                     template_var 0)),
                 template_hole 0)))
           ))),
    ("ReduceStoreBuffer.dropWhile_append_all_False",
     "ALL y:set ?ys. ~ ?P y ==>
      dropWhile ?P (?xs @ ?ys) = dropWhile ?P ?xs @ ?ys",
     template_implication
      ([template_predicate
         (
            template_app
             (template_app
               (template_hole 5,
                template_app (template_hole 4, template_var 2)),
              t_empty)
            )],
       template_equation
        (template_app
          (template_app (template_hole 1, template_var 1),
           template_app
            (template_app (template_hole 0, template_var 0),
             template_var 2)),
         template_app
          (template_app
            (template_hole 0,
             template_app
              (template_app (template_hole 1, template_var 1),
               template_var 0)),
           template_var 2)))),
    ("ReduceStoreBuffer.notin_outstanding_non_volatile_takeWhile_lem",
     "?a ~: outstanding_refs (Not o is_volatile) ?sb ==>
      ?a ~: outstanding_refs is_Write\<^sub>s\<^sub>b
             (takeWhile (Not o is_volatile_Write\<^sub>s\<^sub>b) ?sb)",
     template_implication
      ([template_negation
         (
            template_predicate
             (
                template_app
                 (template_app (template_hole 6, template_var 1),
                  template_app
                   (template_app
                     (template_hole 5,
                      template_app
                       (template_app (template_hole 4, template_hole 7),
                        template_hole 3)),
                    template_var 0))
                )
            )],
       template_negation
        (
           template_predicate
            (
               template_app
                (template_app (template_hole 6, template_var 1),
                 template_app
                  (template_app (template_hole 5, template_hole 2),
                   template_app
                    (template_app
                      (template_hole 1,
                       template_app
                        (template_app (template_hole 4, template_hole 7),
                         template_hole 0)),
                     template_var 0)))
               )
           ))),
    ("ReduceStoreBuffer.share_unchanged",
     "?a ~: all_shared ?sb Un all_unshared ?sb Un all_acquired ?sb ==>
      share ?sb ?\<S> ?a = ?\<S> ?a",
     template_implication
      ([template_negation
         (
            template_predicate
             (
                template_app
                 (template_app (template_hole 6, template_var 2),
                  template_app
                   (template_app
                     (template_hole 5,
                      template_app
                       (template_app
                         (template_hole 5,
                          template_app (template_hole 4, template_var 1)),
                        template_app (template_hole 3, template_var 1))),
                    template_app (template_hole 2, template_var 1)))
                )
            )],
       template_equation
        (template_app
          (template_app
            (template_app (template_hole 0, template_var 1),
             template_var 0),
           template_var 2),
         template_app (template_var 0, template_var 2)))),
    ("ReduceStoreBuffer.notin_unforwarded_empty",
     "[| ?a ~: unforwarded_non_volatile_reads ?sb ?W; ?a ~: ?W |]
      ==> ?a ~: unforwarded_non_volatile_reads ?sb {}",
     template_implication
      ([template_negation
         (
            template_predicate
             (
                template_app
                 (template_app (template_hole 2, template_var 2),
                  template_app
                   (template_app (template_hole 1, template_var 1),
                    template_var 0))
                )
            ),
        template_negation
         (
            template_predicate
             (
                template_app
                 (template_app (template_hole 2, template_var 2),
                  template_var 0)
                )
            )],
       template_negation
        (
           template_predicate
            (
               template_app
                (template_app (template_hole 2, template_var 2),
                 template_app
                  (template_app (template_hole 1, template_var 1),
                   template_hole 0))
               )
           ))),
    ("ReduceStoreBuffer.acquired_append",
     "acquired ?pending_write (?xs @ ?ys) ?A =
      acquired
       (?pending_write |
        outstanding_refs is_volatile_Write\<^sub>s\<^sub>b ?xs ~= {})
       ?ys (acquired ?pending_write ?xs ?A)",
     template_implication
      ([template_predicate
         (
            template_app
             (template_app
               (template_app (template_hole 6, template_var 3),
                template_app
                 (template_app (template_hole 5, template_var 2),
                  template_var 1)),
              template_var 0)
            )],
       template_predicate
        (
           template_app
            (template_app
              (template_app
                (template_hole 6,
                 template_app
                  (template_app (template_hole 4, template_var 3),
                   template_app
                    (template_hole 3,
                     template_app
                      (template_app
                        (template_hole 7,
                         template_app
                          (template_app (template_hole 2, template_hole 1),
                           template_var 2)),
                       template_hole 0)))),
               template_var 1),
             template_app
              (template_app
                (template_app (template_hole 6, template_var 3),
                 template_var 2),
               template_var 0))
           ))),
    ("ReduceStoreBuffer.sharing_consistent_append",
     "sharing_consistent ?\<S> ?\<O> (?xs @ ?ys) =
      (sharing_consistent ?\<S> ?\<O> ?xs &
       sharing_consistent (share ?xs ?\<S>) (acquired True ?xs ?\<O>) ?ys)",
     template_equation
      (template_app
        (template_app
          (template_app (template_hole 5, template_var 3), template_var 2),
         template_app
          (template_app (template_hole 4, template_var 1), template_var 0)),
       template_app
        (template_app
          (template_hole 3,
           template_app
            (template_app
              (template_app (template_hole 5, template_var 3),
               template_var 2),
             template_var 1)),
         template_app
          (template_app
            (template_app
              (template_hole 5,
               template_app
                (template_app (template_hole 2, template_var 1),
                 template_var 3)),
             template_app
              (template_app
                (template_app (template_hole 1, template_hole 0),
                 template_var 1),
               template_var 2)),
           template_var 0)))),
    ("ReduceStoreBuffer.in_Inter_image_nth_conv",
     "(?a : \<Inter> (?f ` set ?xs)) =
      (ALL i<length ?xs. ?a : ?f (?xs ! i))",
     template_equation
      (template_app
        (template_app (template_hole 8, template_var 2),
         template_app
          (template_hole 7,
           template_app
            (template_app (template_hole 6, template_var 1),
             template_app (template_hole 5, template_var 0)))),
       template_app (template_hole 4, t_empty))),
    ("ReduceStoreBuffer.split_less_Suc",
     "(ALL x<Suc ?k. ?P x) = (?P ?k & (ALL x<?k. ?P x))",
     template_equation
      (template_app (template_hole 4, t_empty),
       template_app
        (template_app
          (template_hole 0, template_app (template_var 0, template_var 1)),
         template_app (template_hole 4, t_empty)))),
    ("ReduceStoreBuffer.instrs_append_Ghost\<^sub>s\<^sub>b",
     "instrs (?sb @ [Ghost\<^sub>s\<^sub>b ?A ?L ?R ?W]) =
      instrs ?sb @ [Ghost ?A ?L ?R ?W]",
     template_equation
      (template_app
        (template_hole 8,
         template_app
          (template_app (template_hole 7, template_var 4),
           template_app
            (template_app
              (template_hole 6,
               template_app
                (template_app
                  (template_app
                    (template_app (template_hole 5, template_var 3),
                     template_var 2),
                   template_var 1),
                 template_var 0)),
             template_hole 4))),
       template_app
        (template_app
          (template_hole 3, template_app (template_hole 8, template_var 4)),
         template_app
          (template_app
            (template_hole 2,
             template_app
              (template_app
                (template_app
                  (template_app (template_hole 1, template_var 3),
                   template_var 2),
                 template_var 1),
               template_var 0)),
           template_hole 0)))),
    ("ReduceStoreBuffer.restrict_shared_out",
     "?a ~: ?L ==>
      (?m \<ominus>\<^bsub>?A\<^esub> ?L) ?a =
      map_option ((|) (?a : ?A)) (?m ?a)",
     template_implication
      ([template_negation
         (
            template_predicate
             (
                template_app
                 (template_app (template_hole 4, template_var 3),
                  template_var 2)
                )
            )],
       template_equation
        (template_app
          (template_app
            (template_app
              (template_app (template_hole 2, template_var 1),
               template_var 0),
             template_var 2),
           template_var 3),
         template_app
          (template_app (template_hole 1, t_empty),
           template_app (template_var 1, template_var 3))))),
    ("ReduceStoreBuffer.non_volatile_owned_or_read_only_outstanding_refs",
     "non_volatile_owned_or_read_only ?pending_write ?\<S> ?\<O> ?sb ==>
      outstanding_refs (Not o is_volatile) ?sb
      <= ?\<O> Un all_acquired ?sb Un read_only_reads ?\<O> ?sb",
     template_implication
      ([template_predicate
         (
            template_app
             (template_app
               (template_app
                 (template_app (template_hole 8, template_var 3),
                  template_var 2),
                template_var 1),
              template_var 0)
            )],
       template_inequation
        (less_equals,
         template_app
          (template_app
            (template_hole 6,
             template_app
              (template_app (template_hole 5, template_hole 4),
               template_hole 3)),
           template_var 0),
         template_app
          (template_app
            (template_hole 2,
             template_app
              (template_app (template_hole 2, template_var 1),
               template_app (template_hole 1, template_var 0))),
           template_app
            (template_app (template_hole 0, template_var 1),
             template_var 0))))),
    ("ReduceStoreBuffer.outstanding_vol_write_takeWhile_append",
     "outstanding_refs is_volatile_Write\<^sub>s\<^sub>b ?sb ~= {} ==>
      takeWhile (Not o is_volatile_Write\<^sub>s\<^sub>b) (?sb @ ?xs) =
      takeWhile (Not o is_volatile_Write\<^sub>s\<^sub>b) ?sb",
     template_implication
      ([template_negation
         (
            template_equation
             (template_app
               (template_app (template_hole 6, template_hole 5),
                template_var 1),
              template_hole 4)
            )],
       template_equation
        (template_app
          (template_app
            (template_hole 2,
             template_app
              (template_app (template_hole 1, template_hole 8),
               template_hole 5)),
           template_app
            (template_app (template_hole 0, template_var 1),
             template_var 0)),
         template_app
          (template_app
            (template_hole 2,
             template_app
              (template_app (template_hole 1, template_hole 8),
               template_hole 5)),
           template_var 1)))),
    ("ReduceStoreBuffer.causal_program_history_Read",
     "causal_program_history (Read ?volatile ?a ?t # ?is\<^sub>s\<^sub>b)
       ?sb ==>
      causal_program_history ?is\<^sub>s\<^sub>b
       (?sb @ [Read\<^sub>s\<^sub>b ?volatile ?a ?t ?v])",
     template_implication
      ([template_predicate
         (
            template_app
             (template_app
               (template_hole 6,
                template_app
                 (template_app
                   (template_hole 5,
                    template_app
                     (template_app
                       (template_app (template_hole 4, template_var 5),
                        template_var 4),
                      template_var 3)),
                  template_var 2)),
              template_var 1)
            )],
       template_predicate
        (
           template_app
            (template_app (template_hole 6, template_var 2),
             template_app
              (template_app (template_hole 3, template_var 1),
               template_app
                (template_app
                  (template_hole 2,
                   template_app
                    (template_app
                      (template_app
                        (template_app (template_hole 1, template_var 5),
                         template_var 4),
                       template_var 3),
                     template_var 0)),
                 template_hole 0)))
           ))),
    ("ReduceStoreBuffer.augment_rels_shared_exchange",
     "ALL a:?R. (a : ?S') = (a : ?S) ==>
      augment_rels ?S ?R ?\<R> = augment_rels ?S' ?R ?\<R>",
     template_implication
      ([template_predicate
         (
            template_app
             (template_app (template_hole 4, template_var 3), t_empty)
            )],
       template_equation
        (template_app
          (template_app
            (template_app (template_hole 0, template_var 1),
             template_var 3),
           template_var 0),
         template_app
          (template_app
            (template_app (template_hole 0, template_var 2),
             template_var 3),
           template_var 0)))),
    ("ReduceStoreBuffer.share_read_only_mono_in",
     "[| ?a : read_only (share ?sb ?\<S>);
         read_only ?\<S> <= read_only ?\<S>' |]
      ==> ?a : read_only (share ?sb ?\<S>')",
     template_implication
      ([template_predicate
         (
            template_app
             (template_app (template_hole 3, template_var 3),
              template_app
               (template_hole 2,
                template_app
                 (template_app (template_hole 1, template_var 2),
                  template_var 1)))
            ),
        template_inequation
         (less_equals, template_app (template_hole 2, template_var 1),
          template_app (template_hole 2, template_var 0))],
       template_predicate
        (
           template_app
            (template_app (template_hole 3, template_var 3),
             template_app
              (template_hole 2,
               template_app
                (template_app (template_hole 1, template_var 2),
                 template_var 0)))
           ))),
    ("ReduceStoreBuffer.share_mono_in",
     "[| ?x : dom (share ?xs ?A); dom ?A <= dom ?B |]
      ==> ?x : dom (share ?xs ?B)",
     template_implication
      ([template_predicate
         (
            template_app
             (template_app (template_hole 3, template_var 3),
              template_app
               (template_hole 2,
                template_app
                 (template_app (template_hole 1, template_var 2),
                  template_var 1)))
            ),
        template_inequation
         (less_equals, template_app (template_hole 2, template_var 1),
          template_app (template_hole 2, template_var 0))],
       template_predicate
        (
           template_app
            (template_app (template_hole 3, template_var 3),
             template_app
              (template_hole 2,
               template_app
                (template_app (template_hole 1, template_var 2),
                 template_var 0)))
           ))),
    ("ReduceStoreBuffer.sharing_consistent_shared_exchange",
     "[| ALL a:all_acquired ?sb. ?\<S>' a = ?\<S> a;
         sharing_consistent ?\<S> ?\<O> ?sb |]
      ==> sharing_consistent ?\<S>' ?\<O> ?sb",
     template_implication
      ([template_predicate
         (
            template_app
             (template_app
               (template_hole 3,
                template_app (template_hole 2, template_var 3)),
              t_empty)
            ),
        template_predicate
         (
            template_app
             (template_app
               (template_app (template_hole 0, template_var 1),
                template_var 0),
              template_var 3)
            )],
       template_predicate
        (
           template_app
            (template_app
              (template_app (template_hole 0, template_var 2),
               template_var 0),
             template_var 3)
           ))),
    ("ReduceStoreBuffer.flush_append_Prog\<^sub>s\<^sub>b",
     "flush
       (takeWhile (Not o is_volatile_Write\<^sub>s\<^sub>b)
         (?sb @ [Prog\<^sub>s\<^sub>b ?p\<^sub>1 ?p\<^sub>2 ?mis]))
       ?m =
      flush (takeWhile (Not o is_volatile_Write\<^sub>s\<^sub>b) ?sb) ?m",
     template_equation
      (template_app
        (template_app
          (template_hole 8,
           template_app
            (template_app
              (template_hole 7,
               template_app
                (template_app (template_hole 6, template_hole 5),
                 template_hole 4)),
             template_app
              (template_app (template_hole 3, template_var 4),
               template_app
                (template_app
                  (template_hole 2,
                   template_app
                    (template_app
                      (template_app (template_hole 1, template_var 3),
                       template_var 2),
                     template_var 1)),
                 template_hole 0)))),
         template_var 0),
       template_app
        (template_app
          (template_hole 8,
           template_app
            (template_app
              (template_hole 7,
               template_app
                (template_app (template_hole 6, template_hole 5),
                 template_hole 4)),
             template_var 4)),
         template_var 0))),
    ("ReduceStoreBuffer.flush_append_write",
     "flush (?sb @ [Write\<^sub>s\<^sub>b ?volatile ?a ?sop ?v ?A ?L ?R ?W])
       ?m =
      (flush ?sb ?m)(?a := ?v)",
     template_equation
      (template_app
        (template_app
          (template_hole 5,
           template_app
            (template_app (template_hole 4, template_var 9),
             template_app
              (template_app
                (template_hole 3,
                 template_app
                  (template_app
                    (template_app
                      (template_app
                        (template_app
                          (template_app
                            (template_app
                              (template_app
                                (template_hole 2, template_var 8),
                               template_var 7),
                             template_var 6),
                           template_var 5),
                         template_var 4),
                       template_var 3),
                     template_var 2),
                   template_var 1)),
               template_hole 1))),
         template_var 0),
       template_app
        (template_app
          (template_app
            (template_hole 0,
             template_app
              (template_app (template_hole 5, template_var 9),
               template_var 0)),
           template_var 7),
         template_var 5))),
    ("ReduceStoreBuffer.share_append_Prog\<^sub>s\<^sub>b",
     "share
       (takeWhile (Not o is_volatile_Write\<^sub>s\<^sub>b)
         (?sb @ [Prog\<^sub>s\<^sub>b ?p\<^sub>1 ?p\<^sub>2 ?mis]))
       ?S =
      share (takeWhile (Not o is_volatile_Write\<^sub>s\<^sub>b) ?sb) ?S",
     template_equation
      (template_app
        (template_app
          (template_hole 8,
           template_app
            (template_app
              (template_hole 7,
               template_app
                (template_app (template_hole 6, template_hole 5),
                 template_hole 4)),
             template_app
              (template_app (template_hole 3, template_var 4),
               template_app
                (template_app
                  (template_hole 2,
                   template_app
                    (template_app
                      (template_app (template_hole 1, template_var 3),
                       template_var 2),
                     template_var 1)),
                 template_hole 0)))),
         template_var 0),
       template_app
        (template_app
          (template_hole 8,
           template_app
            (template_app
              (template_hole 7,
               template_app
                (template_app (template_hole 6, template_hole 5),
                 template_hole 4)),
             template_var 4)),
         template_var 0))),
    ("ReduceStoreBuffer.in_read_only_restrict_conv",
     "(?a : read_only (?\<S> \<ominus>\<^bsub>?A\<^esub> ?L)) =
      (?a : read_only ?\<S> & ?a ~: ?L & ?a ~: ?A)",
     template_equation
      (template_app
        (template_app (template_hole 4, template_var 3),
         template_app
          (template_hole 3,
           template_app
            (template_app
              (template_app (template_hole 2, template_var 2),
               template_var 1),
             template_var 0))),
       template_app
        (template_app
          (template_hole 1,
           template_app
            (template_app (template_hole 4, template_var 3),
             template_app (template_hole 3, template_var 2))),
         template_app
          (template_app
            (template_hole 1,
             template_app
              (template_hole 0,
               template_app
                (template_app (template_hole 4, template_var 3),
                 template_var 0))),
           template_app
            (template_hole 0,
             template_app
              (template_app (template_hole 4, template_var 3),
               template_var 1)))))),
    ("ReduceStoreBuffer.split_le_Suc",
     "(ALL x<=Suc ?k. ?P x) = (?P (Suc ?k) & (ALL x<=?k. ?P x))",
     template_equation
      (template_app (template_hole 4, t_empty),
       template_app
        (template_app
          (template_hole 0,
           template_app
            (template_var 0,
             template_app (template_hole 1, template_var 1))),
         template_app (template_hole 4, t_empty)))),
    ("ReduceStoreBuffer.no_outstanding_vol_write_takeWhile_append",
     "outstanding_refs is_volatile_Write\<^sub>s\<^sub>b ?sb = {} ==>
      takeWhile (Not o is_volatile_Write\<^sub>s\<^sub>b) (?sb @ ?xs) =
      ?sb @ takeWhile (Not o is_volatile_Write\<^sub>s\<^sub>b) ?xs",
     template_implication
      ([template_equation
         (template_app
           (template_app (template_hole 7, template_hole 6),
            template_var 1),
          template_hole 5)],
       template_equation
        (template_app
          (template_app
            (template_hole 3,
             template_app
              (template_app (template_hole 2, template_hole 1),
               template_hole 6)),
           template_app
            (template_app (template_hole 0, template_var 1),
             template_var 0)),
         template_app
          (template_app (template_hole 0, template_var 1),
           template_app
            (template_app
              (template_hole 3,
               template_app
                (template_app (template_hole 2, template_hole 1),
                 template_hole 6)),
             template_var 0))))),
    ("ReduceStoreBuffer.in_Union_image_nth_conv",
     "?a : \<Union> (?f ` set ?xs) ==> EX i<length ?xs. ?a : ?f (?xs ! i)",
     template_implication
      ([template_predicate
         (
            template_app
             (template_app (template_hole 8, template_var 2),
              template_app
               (template_hole 7,
                template_app
                 (template_app (template_hole 6, template_var 1),
                  template_app (template_hole 5, template_var 0))))
            )],
       template_predicate (template_app (template_hole 4, t_empty)))),
    ("ReduceStoreBuffer.causal_program_history_Ghost",
     "causal_program_history (Ghost ?A ?L ?R ?W # ?is\<^sub>s\<^sub>b)
       ?sb ==>
      causal_program_history ?is\<^sub>s\<^sub>b
       (?sb @ [Ghost\<^sub>s\<^sub>b ?A ?L ?R ?W])",
     template_implication
      ([template_predicate
         (
            template_app
             (template_app
               (template_hole 6,
                template_app
                 (template_app
                   (template_hole 5,
                    template_app
                     (template_app
                       (template_app
                         (template_app (template_hole 4, template_var 5),
                          template_var 4),
                        template_var 3),
                      template_var 2)),
                  template_var 1)),
              template_var 0)
            )],
       template_predicate
        (
           template_app
            (template_app (template_hole 6, template_var 1),
             template_app
              (template_app (template_hole 3, template_var 0),
               template_app
                (template_app
                  (template_hole 2,
                   template_app
                    (template_app
                      (template_app
                        (template_app (template_hole 1, template_var 5),
                         template_var 4),
                       template_var 3),
                     template_var 2)),
                 template_hole 0)))
           ))),
    ("ReduceStoreBuffer.no_unacquired_write_to_read_only''",
     "[| no_write_to_read_only_memory ?\<S> ?sb;
         sharing_consistent ?\<S> ?\<O> ?sb |]
      ==> read_only ?\<S> Int outstanding_refs is_Write\<^sub>s\<^sub>b ?sb
          <= ?\<O> Un all_acquired ?sb",
     template_implication
      ([template_predicate
         (
            template_app
             (template_app (template_hole 8, template_var 2),
              template_var 1)
            ),
        template_predicate
         (
            template_app
             (template_app
               (template_app (template_hole 7, template_var 2),
                template_var 0),
              template_var 1)
            )],
       template_inequation
        (less_equals,
         template_app
          (template_app
            (template_hole 5,
             template_app (template_hole 4, template_var 2)),
           template_app
            (template_app (template_hole 3, template_hole 2),
             template_var 1)),
         template_app
          (template_app (template_hole 1, template_var 0),
           template_app (template_hole 0, template_var 1))))),
    ("ReduceStoreBuffer.no_unacquired_non_volatile_write_to_read_only_reads",
     "[| no_write_to_read_only_memory ?\<S> ?sb;
         sharing_consistent ?\<S> ?\<O> ?sb |]
      ==> read_only ?\<S> Int
          outstanding_refs is_non_volatile_Write\<^sub>s\<^sub>b ?sb
          <= ?\<O> Un all_acquired ?sb",
     template_implication
      ([template_predicate
         (
            template_app
             (template_app (template_hole 8, template_var 2),
              template_var 1)
            ),
        template_predicate
         (
            template_app
             (template_app
               (template_app (template_hole 7, template_var 2),
                template_var 0),
              template_var 1)
            )],
       template_inequation
        (less_equals,
         template_app
          (template_app
            (template_hole 5,
             template_app (template_hole 4, template_var 2)),
           template_app
            (template_app (template_hole 3, template_hole 2),
             template_var 1)),
         template_app
          (template_app (template_hole 1, template_var 0),
           template_app (template_hole 0, template_var 1))))),
    ("ReduceStoreBuffer.no_unacquired_volatile_write_to_read_only",
     "[| no_write_to_read_only_memory ?\<S> ?sb;
         sharing_consistent ?\<S> ?\<O> ?sb |]
      ==> read_only ?\<S> Int
          outstanding_refs is_volatile_Write\<^sub>s\<^sub>b ?sb
          <= ?\<O> Un all_acquired ?sb",
     template_implication
      ([template_predicate
         (
            template_app
             (template_app (template_hole 8, template_var 2),
              template_var 1)
            ),
        template_predicate
         (
            template_app
             (template_app
               (template_app (template_hole 7, template_var 2),
                template_var 0),
              template_var 1)
            )],
       template_inequation
        (less_equals,
         template_app
          (template_app
            (template_hole 5,
             template_app (template_hole 4, template_var 2)),
           template_app
            (template_app (template_hole 3, template_hole 2),
             template_var 1)),
         template_app
          (template_app (template_hole 1, template_var 0),
           template_app (template_hole 0, template_var 1))))),
    ("ReduceStoreBuffer.read_only_share_unowned_in",
     "[| weak_sharing_consistent ?\<O> ?sb;
         ?a : read_only (share ?sb ?\<S>) |]
      ==> ?a : read_only ?\<S> Un ?\<O> Un all_acquired ?sb",
     template_implication
      ([template_predicate
         (
            template_app
             (template_app (template_hole 5, template_var 3),
              template_var 2)
            ),
        template_predicate
         (
            template_app
             (template_app (template_hole 4, template_var 1),
              template_app
               (template_hole 3,
                template_app
                 (template_app (template_hole 2, template_var 2),
                  template_var 0)))
            )],
       template_predicate
        (
           template_app
            (template_app (template_hole 4, template_var 1),
             template_app
              (template_app
                (template_hole 1,
                 template_app
                  (template_app
                    (template_hole 1,
                     template_app (template_hole 3, template_var 0)),
                   template_var 3)),
               template_app (template_hole 0, template_var 2)))
           ))),
    ("ReduceStoreBuffer.owned_share_acquired",
     "[| sharing_consistent ?\<S> ?\<O> ?sb; ?a : ?\<O> |]
      ==> ?a : dom (share ?sb ?\<S>) Un acquired True ?sb ?\<O>",
     template_implication
      ([template_predicate
         (
            template_app
             (template_app
               (template_app (template_hole 6, template_var 3),
                template_var 2),
              template_var 1)
            ),
        template_predicate
         (
            template_app
             (template_app (template_hole 5, template_var 0),
              template_var 2)
            )],
       template_predicate
        (
           template_app
            (template_app (template_hole 5, template_var 0),
             template_app
              (template_app
                (template_hole 4,
                 template_app
                  (template_hole 3,
                   template_app
                    (template_app (template_hole 2, template_var 1),
                     template_var 3))),
               template_app
                (template_app
                  (template_app (template_hole 1, template_hole 0),
                   template_var 1),
                 template_var 2)))
           ))),
    ("ReduceStoreBuffer.share_other_untouched",
     "[| sharing_consistent ?\<S> ?\<O> ?sb;
         ?a ~: ?\<O> Un all_acquired ?sb |]
      ==> share ?sb ?\<S> ?a = ?\<S> ?a",
     template_implication
      ([template_predicate
         (
            template_app
             (template_app
               (template_app (template_hole 6, template_var 3),
                template_var 2),
              template_var 1)
            ),
        template_negation
         (
            template_predicate
             (
                template_app
                 (template_app (template_hole 4, template_var 0),
                  template_app
                   (template_app (template_hole 3, template_var 2),
                    template_app (template_hole 2, template_var 1)))
                )
            )],
       template_equation
        (template_app
          (template_app
            (template_app (template_hole 0, template_var 1),
             template_var 3),
           template_var 0),
         template_app (template_var 3, template_var 0)))),
    ("ReduceStoreBuffer.acquired_union_notin_first",
     "[| ?a : acquired ?pending_write ?sb (?A Un ?B); ?a ~: ?A |]
      ==> ?a : acquired ?pending_write ?sb ?B",
     template_implication
      ([template_predicate
         (
            template_app
             (template_app (template_hole 3, template_var 4),
              template_app
               (template_app
                 (template_app (template_hole 2, template_var 3),
                  template_var 2),
                template_app
                 (template_app (template_hole 1, template_var 1),
                  template_var 0)))
            ),
        template_negation
         (
            template_predicate
             (
                template_app
                 (template_app (template_hole 3, template_var 4),
                  template_var 1)
                )
            )],
       template_predicate
        (
           template_app
            (template_app (template_hole 3, template_var 4),
             template_app
              (template_app
                (template_app (template_hole 2, template_var 3),
                 template_var 2),
               template_var 0))
           ))),
    ("ReduceStoreBuffer.acquired_reads_union",
     "[| ?a : acquired_reads ?pending_writes ?sb (?A Un ?B); ?a ~: ?A |]
      ==> ?a : acquired_reads ?pending_writes ?sb ?B",
     template_implication
      ([template_predicate
         (
            template_app
             (template_app (template_hole 3, template_var 4),
              template_app
               (template_app
                 (template_app (template_hole 2, template_var 3),
                  template_var 2),
                template_app
                 (template_app (template_hole 1, template_var 1),
                  template_var 0)))
            ),
        template_negation
         (
            template_predicate
             (
                template_app
                 (template_app (template_hole 3, template_var 4),
                  template_var 1)
                )
            )],
       template_predicate
        (
           template_app
            (template_app (template_hole 3, template_var 4),
             template_app
              (template_app
                (template_app (template_hole 2, template_var 3),
                 template_var 2),
               template_var 0))
           ))),
    ("ReduceStoreBuffer.acquired_reads_mono'",
     "[| ?x : acquired_reads ?b ?xs ?A; acquired_reads ?b ?xs ?B = {};
         ?A <= ?B |]
      ==> False",
     template_implication
      ([template_predicate
         (
            template_app
             (template_app (template_hole 5, template_var 4),
              template_app
               (template_app
                 (template_app (template_hole 4, template_var 3),
                  template_var 2),
                template_var 1))
            ),
        template_equation
         (template_app
           (template_app
             (template_app (template_hole 4, template_var 3),
              template_var 2),
            template_var 0),
          template_hole 2),
        template_inequation (less_equals, template_var 1, template_var 0)],
       template_predicate (template_hole 0))),
    ("ReduceStoreBuffer.flush_append_Ghost\<^sub>s\<^sub>b",
     "flush
       (takeWhile (Not o is_volatile_Write\<^sub>s\<^sub>b)
         (?sb @ [Ghost\<^sub>s\<^sub>b ?A ?L ?R ?W]))
       ?m =
      flush (takeWhile (Not o is_volatile_Write\<^sub>s\<^sub>b) ?sb) ?m",
     template_equation
      (template_app
        (template_app
          (template_hole 8,
           template_app
            (template_app
              (template_hole 7,
               template_app
                (template_app (template_hole 6, template_hole 5),
                 template_hole 4)),
             template_app
              (template_app (template_hole 3, template_var 5),
               template_app
                (template_app
                  (template_hole 2,
                   template_app
                    (template_app
                      (template_app
                        (template_app (template_hole 1, template_var 4),
                         template_var 3),
                       template_var 2),
                     template_var 1)),
                 template_hole 0)))),
         template_var 0),
       template_app
        (template_app
          (template_hole 8,
           template_app
            (template_app
              (template_hole 7,
               template_app
                (template_app (template_hole 6, template_hole 5),
                 template_hole 4)),
             template_var 5)),
         template_var 0))),
    ("ReduceStoreBuffer.flush_append_Read\<^sub>s\<^sub>b",
     "flush
       (takeWhile (Not o is_volatile_Write\<^sub>s\<^sub>b)
         (?sb @ [Read\<^sub>s\<^sub>b ?volatile ?a ?t ?v]))
       ?m =
      flush (takeWhile (Not o is_volatile_Write\<^sub>s\<^sub>b) ?sb) ?m",
     template_equation
      (template_app
        (template_app
          (template_hole 8,
           template_app
            (template_app
              (template_hole 7,
               template_app
                (template_app (template_hole 6, template_hole 5),
                 template_hole 4)),
             template_app
              (template_app (template_hole 3, template_var 5),
               template_app
                (template_app
                  (template_hole 2,
                   template_app
                    (template_app
                      (template_app
                        (template_app (template_hole 1, template_var 4),
                         template_var 3),
                       template_var 2),
                     template_var 1)),
                 template_hole 0)))),
         template_var 0),
       template_app
        (template_app
          (template_hole 8,
           template_app
            (template_app
              (template_hole 7,
               template_app
                (template_app (template_hole 6, template_hole 5),
                 template_hole 4)),
             template_var 5)),
         template_var 0))),
    ("ReduceStoreBuffer.share_append_Read\<^sub>s\<^sub>b",
     "share
       (takeWhile (Not o is_volatile_Write\<^sub>s\<^sub>b)
         (?sb @ [Read\<^sub>s\<^sub>b ?volatile ?a ?t ?v]))
       ?S =
      share (takeWhile (Not o is_volatile_Write\<^sub>s\<^sub>b) ?sb) ?S",
     template_equation
      (template_app
        (template_app
          (template_hole 8,
           template_app
            (template_app
              (template_hole 7,
               template_app
                (template_app (template_hole 6, template_hole 5),
                 template_hole 4)),
             template_app
              (template_app (template_hole 3, template_var 5),
               template_app
                (template_app
                  (template_hole 2,
                   template_app
                    (template_app
                      (template_app
                        (template_app (template_hole 1, template_var 4),
                         template_var 3),
                       template_var 2),
                     template_var 1)),
                 template_hole 0)))),
         template_var 0),
       template_app
        (template_app
          (template_hole 8,
           template_app
            (template_app
              (template_hole 7,
               template_app
                (template_app (template_hole 6, template_hole 5),
                 template_hole 4)),
             template_var 5)),
         template_var 0))),
    ("ReduceStoreBuffer.outstanding_vol_write_dropWhile_append",
     "outstanding_refs is_volatile_Write\<^sub>s\<^sub>b ?sb ~= {} ==>
      dropWhile (Not o is_volatile_Write\<^sub>s\<^sub>b) (?sb @ ?xs) =
      dropWhile (Not o is_volatile_Write\<^sub>s\<^sub>b) ?sb @ ?xs",
     template_implication
      ([template_negation
         (
            template_equation
             (template_app
               (template_app (template_hole 6, template_hole 5),
                template_var 1),
              template_hole 4)
            )],
       template_equation
        (template_app
          (template_app
            (template_hole 2,
             template_app
              (template_app (template_hole 1, template_hole 8),
               template_hole 5)),
           template_app
            (template_app (template_hole 0, template_var 1),
             template_var 0)),
         template_app
          (template_app
            (template_hole 0,
             template_app
              (template_app
                (template_hole 2,
                 template_app
                  (template_app (template_hole 1, template_hole 8),
                   template_hole 5)),
               template_var 1)),
           template_var 0)))),
    ("ReduceStoreBuffer.non_volatile_writes_unshared_no_outstanding_non_volatile_Write\<^sub>s\<^sub>b",
     "[| non_volatile_writes_unshared ?\<S> ?sb;
         ALL a:dom ?\<S>' - dom ?\<S>.
            a ~: outstanding_refs is_non_volatile_Write\<^sub>s\<^sub>b
                  ?sb |]
      ==> non_volatile_writes_unshared ?\<S>' ?sb",
     template_implication
      ([template_predicate
         (
            template_app
             (template_app (template_hole 7, template_var 2),
              template_var 1)
            ),
        template_predicate
         (
            template_app
             (template_app
               (template_hole 6,
                template_app
                 (template_app
                   (template_hole 5,
                    template_app (template_hole 4, template_var 0)),
                  template_app (template_hole 4, template_var 2))),
              t_empty)
            )],
       template_predicate
        (
           template_app
            (template_app (template_hole 7, template_var 0), template_var 1)
           ))),
    ("ReduceStoreBuffer.shared_share_acquired",
     "[| sharing_consistent ?\<S> ?\<O> ?sb; ?a : dom ?\<S> |]
      ==> ?a : dom (share ?sb ?\<S>) Un acquired True ?sb ?\<O>",
     template_implication
      ([template_predicate
         (
            template_app
             (template_app
               (template_app (template_hole 6, template_var 3),
                template_var 2),
              template_var 1)
            ),
        template_predicate
         (
            template_app
             (template_app (template_hole 5, template_var 0),
              template_app (template_hole 4, template_var 3))
            )],
       template_predicate
        (
           template_app
            (template_app (template_hole 5, template_var 0),
             template_app
              (template_app
                (template_hole 3,
                 template_app
                  (template_hole 4,
                   template_app
                    (template_app (template_hole 2, template_var 1),
                     template_var 3))),
               template_app
                (template_app
                  (template_app (template_hole 1, template_hole 0),
                   template_var 1),
                 template_var 2)))
           ))),
    ("ReduceStoreBuffer.all_shared_share_acquired",
     "[| sharing_consistent ?\<S> ?\<O> ?sb; ?a : all_shared ?sb |]
      ==> ?a : dom (share ?sb ?\<S>) Un acquired True ?sb ?\<O>",
     template_implication
      ([template_predicate
         (
            template_app
             (template_app
               (template_app (template_hole 7, template_var 3),
                template_var 2),
              template_var 1)
            ),
        template_predicate
         (
            template_app
             (template_app (template_hole 6, template_var 0),
              template_app (template_hole 5, template_var 1))
            )],
       template_predicate
        (
           template_app
            (template_app (template_hole 6, template_var 0),
             template_app
              (template_app
                (template_hole 4,
                 template_app
                  (template_hole 3,
                   template_app
                    (template_app (template_hole 2, template_var 1),
                     template_var 3))),
               template_app
                (template_app
                  (template_app (template_hole 1, template_hole 0),
                   template_var 1),
                 template_var 2)))
           ))),
    ("ReduceStoreBuffer.acquired_append_Prog\<^sub>s\<^sub>b",
     "acquired ?pending_write
       (takeWhile (Not o is_volatile_Write\<^sub>s\<^sub>b)
         (?sb @ [Prog\<^sub>s\<^sub>b ?p\<^sub>1 ?p\<^sub>2 ?mis]))
       ?S =
      acquired ?pending_write
       (takeWhile (Not o is_volatile_Write\<^sub>s\<^sub>b) ?sb) ?S",
     template_equation
      (template_app
        (template_app
          (template_app (template_hole 8, template_var 5),
           template_app
            (template_app
              (template_hole 7,
               template_app
                (template_app (template_hole 6, template_hole 5),
                 template_hole 4)),
             template_app
              (template_app (template_hole 3, template_var 4),
               template_app
                (template_app
                  (template_hole 2,
                   template_app
                    (template_app
                      (template_app (template_hole 1, template_var 3),
                       template_var 2),
                     template_var 1)),
                 template_hole 0)))),
         template_var 0),
       template_app
        (template_app
          (template_app (template_hole 8, template_var 5),
           template_app
            (template_app
              (template_hole 7,
               template_app
                (template_app (template_hole 6, template_hole 5),
                 template_hole 4)),
             template_var 4)),
         template_var 0))),
    ("ReduceStoreBuffer.no_volatile_Read\<^sub>s\<^sub>bs_conv",
     "(outstanding_refs is_volatile_Read\<^sub>s\<^sub>b ?sb = {}) =
      (ALL r:set ?sb.
          ALL v' t' a'. r ~= Read\<^sub>s\<^sub>b True a' t' v')",
     template_equation
      (template_app
        (template_app
          (template_hole 10,
           template_app
            (template_app (template_hole 9, template_hole 8),
             template_var 0)),
         template_hole 7),
       template_app
        (template_app
          (template_hole 6, template_app (template_hole 5, template_var 0)),
         t_empty))),
    ("ReduceStoreBuffer.reads_consistent_snoc_Write\<^sub>s\<^sub>b",
     "reads_consistent ?pending_write ?\<O> ?m ?sb ==>
      reads_consistent ?pending_write ?\<O> ?m
       (?sb @ [Write\<^sub>s\<^sub>b ?volatile ?a ?sop ?v ?A ?L ?R ?W])",
     template_implication
      ([template_predicate
         (
            template_app
             (template_app
               (template_app
                 (template_app (template_hole 4, template_var 11),
                  template_var 10),
                template_var 9),
              template_var 8)
            )],
       template_predicate
        (
           template_app
            (template_app
              (template_app
                (template_app (template_hole 4, template_var 11),
                 template_var 10),
               template_var 9),
             template_app
              (template_app (template_hole 3, template_var 8),
               template_app
                (template_app
                  (template_hole 2,
                   template_app
                    (template_app
                      (template_app
                        (template_app
                          (template_app
                            (template_app
                              (template_app
                                (template_app
                                  (template_hole 1, template_var 7),
                                 template_var 6),
                               template_var 5),
                             template_var 4),
                           template_var 3),
                         template_var 2),
                       template_var 1),
                     template_var 0)),
                 template_hole 0)))
           ))),
    ("ReduceStoreBuffer.acquired_all_shared_in",
     "?a : acquired True ?sb ?A ==>
      ?a : acquired True ?sb {} | ?a : ?A & ?a ~: all_shared ?sb",
     template_implication
      ([template_predicate
         (
            template_app
             (template_app (template_hole 7, template_var 2),
              template_app
               (template_app
                 (template_app (template_hole 6, template_hole 5),
                  template_var 1),
                template_var 0))
            )],
       template_predicate
        (
           template_app
            (template_app
              (template_hole 4,
               template_app
                (template_app (template_hole 7, template_var 2),
                 template_app
                  (template_app
                    (template_app (template_hole 6, template_hole 5),
                     template_var 1),
                   template_hole 3))),
             template_app
              (template_app
                (template_hole 2,
                 template_app
                  (template_app (template_hole 7, template_var 2),
                   template_var 0)),
               template_app
                (template_hole 1,
                 template_app
                  (template_app (template_hole 7, template_var 2),
                   template_app (template_hole 0, template_var 1)))))
           ))),
    ("ReduceStoreBuffer.no_write_to_read_only_memory_read_only_reads_eq",
     "[| no_write_to_read_only_memory ?\<S> ?sb;
         ALL a:outstanding_refs is_Write\<^sub>s\<^sub>b ?sb.
            a : read_only ?\<S>' --> a : read_only ?\<S> |]
      ==> no_write_to_read_only_memory ?\<S>' ?sb",
     template_implication
      ([template_predicate
         (
            template_app
             (template_app (template_hole 6, template_var 2),
              template_var 1)
            ),
        template_predicate
         (
            template_app
             (template_app
               (template_hole 5,
                template_app
                 (template_app (template_hole 4, template_hole 3),
                  template_var 1)),
              t_empty)
            )],
       template_predicate
        (
           template_app
            (template_app (template_hole 6, template_var 0), template_var 1)
           ))),
    ("ReduceStoreBuffer.weak_sharing_consistent_preserves_distinct",
     "[| weak_sharing_consistent ?\<O> ?sb;
         ?\<O> Int read_only ?\<S> = {} |]
      ==> acquired True ?sb ?\<O> Int read_only (share ?sb ?\<S>) = {}",
     template_implication
      ([template_predicate
         (
            template_app
             (template_app (template_hole 7, template_var 2),
              template_var 1)
            ),
        template_equation
         (template_app
           (template_app (template_hole 5, template_var 2),
            template_app (template_hole 4, template_var 0)),
          template_hole 3)],
       template_equation
        (template_app
          (template_app
            (template_hole 5,
             template_app
              (template_app
                (template_app (template_hole 2, template_hole 1),
                 template_var 1),
               template_var 2)),
           template_app
            (template_hole 4,
             template_app
              (template_app (template_hole 0, template_var 1),
               template_var 0))),
         template_hole 3))),
    ("ReduceStoreBuffer.non_volatile_reads_acquired_or_read_only",
     "[| non_volatile_owned_or_read_only True ?\<S> ?\<O> ?sb;
         sharing_consistent ?\<S> ?\<O> ?sb |]
      ==> outstanding_refs is_non_volatile_Read\<^sub>s\<^sub>b ?sb
          <= ?\<O> Un all_acquired ?sb Un read_only ?\<S>",
     template_implication
      ([template_predicate
         (
            template_app
             (template_app
               (template_app
                 (template_app (template_hole 8, template_hole 7),
                  template_var 2),
                template_var 1),
              template_var 0)
            ),
        template_predicate
         (
            template_app
             (template_app
               (template_app (template_hole 6, template_var 2),
                template_var 1),
              template_var 0)
            )],
       template_inequation
        (less_equals,
         template_app
          (template_app (template_hole 4, template_hole 3), template_var 0),
         template_app
          (template_app
            (template_hole 2,
             template_app
              (template_app (template_hole 2, template_var 1),
               template_app (template_hole 1, template_var 0))),
           template_app (template_hole 0, template_var 2))))),
    ("ReduceStoreBuffer.read_only_reads_read_only",
     "[| non_volatile_owned_or_read_only True ?\<S> ?\<O> ?sb;
         sharing_consistent ?\<S> ?\<O> ?sb |]
      ==> read_only_reads ?\<O> ?sb
          <= ?\<O> Un all_acquired ?sb Un read_only ?\<S>",
     template_implication
      ([template_predicate
         (
            template_app
             (template_app
               (template_app
                 (template_app (template_hole 7, template_hole 6),
                  template_var 2),
                template_var 1),
              template_var 0)
            ),
        template_predicate
         (
            template_app
             (template_app
               (template_app (template_hole 5, template_var 2),
                template_var 1),
              template_var 0)
            )],
       template_inequation
        (less_equals,
         template_app
          (template_app (template_hole 3, template_var 1), template_var 0),
         template_app
          (template_app
            (template_hole 2,
             template_app
              (template_app (template_hole 2, template_var 1),
               template_app (template_hole 1, template_var 0))),
           template_app (template_hole 0, template_var 2))))),
    ("ReduceStoreBuffer.unshared_is_non_volatile_Write\<^sub>s\<^sub>b",
     "[| non_volatile_writes_unshared ?\<S> ?sb; ?a : dom ?\<S>;
         ?a ~: all_unshared ?sb |]
      ==> ?a ~: outstanding_refs is_non_volatile_Write\<^sub>s\<^sub>b ?sb",
     template_implication
      ([template_predicate
         (
            template_app
             (template_app (template_hole 6, template_var 2),
              template_var 1)
            ),
        template_predicate
         (
            template_app
             (template_app (template_hole 5, template_var 0),
              template_app (template_hole 4, template_var 2))
            ),
        template_negation
         (
            template_predicate
             (
                template_app
                 (template_app (template_hole 5, template_var 0),
                  template_app (template_hole 2, template_var 1))
                )
            )],
       template_negation
        (
           template_predicate
            (
               template_app
                (template_app (template_hole 5, template_var 0),
                 template_app
                  (template_app (template_hole 1, template_hole 0),
                   template_var 1))
               )
           ))),
    ("ReduceStoreBuffer.acquired_take_drop",
     "acquired
       (?pending_write |
        outstanding_refs is_volatile_Write\<^sub>s\<^sub>b
         (takeWhile ?P ?xs) ~=
        {})
       (dropWhile ?P ?xs) (acquired ?pending_write (takeWhile ?P ?xs) ?A) =
      acquired ?pending_write ?xs ?A",
     template_equation
      (template_app
        (template_app
          (template_app
            (template_hole 7,
             template_app
              (template_app (template_hole 6, template_var 3),
               template_app
                (template_hole 5,
                 template_app
                  (template_app
                    (template_hole 8,
                     template_app
                      (template_app (template_hole 4, template_hole 3),
                       template_app
                        (template_app (template_hole 2, template_var 2),
                         template_var 1))),
                   template_hole 1)))),
           template_app
            (template_app (template_hole 0, template_var 2),
             template_var 1)),
         template_app
          (template_app
            (template_app (template_hole 7, template_var 3),
             template_app
              (template_app (template_hole 2, template_var 2),
               template_var 1)),
           template_var 0)),
       template_app
        (template_app
          (template_app (template_hole 7, template_var 3), template_var 1),
         template_var 0))),
    ("ReduceStoreBuffer.restrict_shared_out'",
     "[| ?a ~: ?L; ?m ?a = Some ?writeable |]
      ==> (?m \<ominus>\<^bsub>?A\<^esub> ?L) ?a =
          Some (?a : ?A | ?writeable)",
     template_implication
      ([template_negation
         (
            template_predicate
             (
                template_app
                 (template_app (template_hole 4, template_var 4),
                  template_var 3)
                )
            ),
        template_equation
         (template_app (template_var 2, template_var 4),
          template_app (template_hole 2, template_var 1))],
       template_equation
        (template_app
          (template_app
            (template_app
              (template_app (template_hole 1, template_var 2),
               template_var 0),
             template_var 3),
           template_var 4),
         template_app
          (template_hole 2,
           template_app
            (template_app
              (template_hole 0,
               template_app
                (template_app (template_hole 4, template_var 4),
                 template_var 0)),
             template_var 1))))),
    ("ReduceStoreBuffer.reads_consistent_update",
     "[| reads_consistent ?pending_write ?\<O> ?m ?sb;
         ?a ~: outstanding_refs (Not o is_volatile) ?sb |]
      ==> reads_consistent ?pending_write ?\<O> (?m(?a := ?v)) ?sb",
     template_implication
      ([template_predicate
         (
            template_app
             (template_app
               (template_app
                 (template_app (template_hole 6, template_var 5),
                  template_var 4),
                template_var 3),
              template_var 2)
            ),
        template_negation
         (
            template_predicate
             (
                template_app
                 (template_app (template_hole 4, template_var 1),
                  template_app
                   (template_app
                     (template_hole 3,
                      template_app
                       (template_app (template_hole 2, template_hole 5),
                        template_hole 1)),
                    template_var 2))
                )
            )],
       template_predicate
        (
           template_app
            (template_app
              (template_app
                (template_app (template_hole 6, template_var 5),
                 template_var 4),
               template_app
                (template_app
                  (template_app (template_hole 0, template_var 3),
                   template_var 1),
                 template_var 0)),
             template_var 2)
           ))),
    ("ReduceStoreBuffer.reads_consistent_flush_independent",
     "[| outstanding_refs is_Write\<^sub>s\<^sub>b ?sb Int
         outstanding_refs is_non_volatile_Read\<^sub>s\<^sub>b ?xs =
         {};
         reads_consistent ?pending_write ?\<O> ?m ?xs |]
      ==> reads_consistent ?pending_write ?\<O> (flush ?sb ?m) ?xs",
     template_implication
      ([template_equation
         (template_app
           (template_app
             (template_hole 7,
              template_app
               (template_app (template_hole 6, template_hole 5),
                template_var 4)),
            template_app
             (template_app (template_hole 4, template_hole 3),
              template_var 3)),
          template_hole 2),
        template_predicate
         (
            template_app
             (template_app
               (template_app
                 (template_app (template_hole 1, template_var 2),
                  template_var 1),
                template_var 0),
              template_var 3)
            )],
       template_predicate
        (
           template_app
            (template_app
              (template_app
                (template_app (template_hole 1, template_var 2),
                 template_var 1),
               template_app
                (template_app (template_hole 0, template_var 4),
                 template_var 0)),
             template_var 3)
           ))),
    ("ReduceStoreBuffer.volatile_reads_consistent_mem_eq_on_volatile_reads",
     "[| ALL a:?A. ?m' a = ?m a;
         outstanding_refs is_volatile_Read\<^sub>s\<^sub>b ?sb <= ?A;
         volatile_reads_consistent ?m ?sb |]
      ==> volatile_reads_consistent ?m' ?sb",
     template_implication
      ([template_predicate
         (
            template_app
             (template_app (template_hole 5, template_var 3), t_empty)
            ),
        template_inequation
         (less_equals,
          template_app
           (template_app (template_hole 2, template_hole 1),
            template_var 0),
          template_var 3),
        template_predicate
         (
            template_app
             (template_app (template_hole 0, template_var 1),
              template_var 0)
            )],
       template_predicate
        (
           template_app
            (template_app (template_hole 0, template_var 2), template_var 0)
           ))),
    ("ReduceStoreBuffer.acquired_reads_append",
     "acquired_reads ?pending_write (?xs @ ?ys) ?A =
      acquired_reads ?pending_write ?xs ?A Un
      acquired_reads
       (?pending_write |
        outstanding_refs is_volatile_Write\<^sub>s\<^sub>b ?xs ~= {})
       ?ys (acquired ?pending_write ?xs ?A)",
     template_implication
      ([template_predicate
         (
            template_app
             (template_app
               (template_app (template_hole 8, template_var 3),
                template_app
                 (template_app (template_hole 7, template_var 2),
                  template_var 1)),
              template_var 0)
            )],
       template_predicate
        (
           template_app
            (template_app
              (template_hole 6,
               template_app
                (template_app
                  (template_app (template_hole 8, template_var 3),
                   template_var 2),
                 template_var 0)),
             template_app
              (template_app
                (template_app
                  (template_hole 8,
                   template_app
                    (template_app (template_hole 5, template_var 3),
                     template_app
                      (template_hole 4,
                       template_app
                        (template_app
                          (template_hole 9,
                           template_app
                            (template_app
                              (template_hole 3, template_hole 2),
                             template_var 2)),
                         template_hole 1)))),
                 template_var 1),
               template_app
                (template_app
                  (template_app (template_hole 0, template_var 3),
                   template_var 2),
                 template_var 0)))
           ))),
    ("ReduceStoreBuffer.share_unshared_in",
     "?a : dom (share ?sb ?S) ==>
      ?a : dom (share ?sb Map.empty) |
      ?a : dom ?S & ?a ~: all_unshared ?sb",
     template_implication
      ([template_predicate
         (
            template_app
             (template_app (template_hole 7, template_var 2),
              template_app
               (template_hole 6,
                template_app
                 (template_app (template_hole 5, template_var 1),
                  template_var 0)))
            )],
       template_predicate
        (
           template_app
            (template_app
              (template_hole 4,
               template_app
                (template_app (template_hole 7, template_var 2),
                 template_app
                  (template_hole 6,
                   template_app
                    (template_app (template_hole 5, template_var 1),
                     t_empty)))),
             template_app
              (template_app
                (template_hole 2,
                 template_app
                  (template_app (template_hole 7, template_var 2),
                   template_app (template_hole 6, template_var 0))),
               template_app
                (template_hole 1,
                 template_app
                  (template_app (template_hole 7, template_var 2),
                   template_app (template_hole 0, template_var 1)))))
           ))),
    ("ReduceStoreBuffer.hd_prog_last_prog_append_Prog\<^sub>s\<^sub>b",
     "[| hd_prog ?p' ?xs = ?p'; last_prog ?p' ?xs = ?p\<^sub>1 |]
      ==> hd_prog ?p'
           (?xs @ [Prog\<^sub>s\<^sub>b ?p\<^sub>1 ?p\<^sub>2 ?mis]) =
          ?p'",
     template_implication
      ([template_equation
         (template_app
           (template_app (template_hole 5, template_var 4), template_var 3),
          template_var 4),
        template_equation
         (template_app
           (template_app (template_hole 4, template_var 4), template_var 3),
          template_var 2)],
       template_equation
        (template_app
          (template_app (template_hole 5, template_var 4),
           template_app
            (template_app (template_hole 3, template_var 3),
             template_app
              (template_app
                (template_hole 2,
                 template_app
                  (template_app
                    (template_app (template_hole 1, template_var 2),
                     template_var 1),
                   template_var 0)),
               template_hole 0))),
         template_var 4))),
    ("ReduceStoreBuffer.outstanding_non_volatile_Read\<^sub>s\<^sub>b_acquired_or_read_only_reads",
     "[| non_volatile_owned_or_read_only ?pending_write ?\<S> ?\<O> ?sb;
         ?a : outstanding_refs is_non_volatile_Read\<^sub>s\<^sub>b ?sb |]
      ==> ?a : acquired_reads True ?sb ?\<O> |
          ?a : read_only_reads ?\<O> ?sb",
     template_implication
      ([template_predicate
         (
            template_app
             (template_app
               (template_app
                 (template_app (template_hole 7, template_var 4),
                  template_var 3),
                template_var 2),
              template_var 1)
            ),
        template_predicate
         (
            template_app
             (template_app (template_hole 6, template_var 0),
              template_app
               (template_app (template_hole 5, template_hole 4),
                template_var 1))
            )],
       template_predicate
        (
           template_app
            (template_app
              (template_hole 3,
               template_app
                (template_app (template_hole 6, template_var 0),
                 template_app
                  (template_app
                    (template_app (template_hole 2, template_hole 1),
                     template_var 1),
                   template_var 2))),
             template_app
              (template_app (template_hole 6, template_var 0),
               template_app
                (template_app (template_hole 0, template_var 2),
                 template_var 1)))
           ))),
    ("ReduceStoreBuffer.read_only_share_unowned",
     "[| weak_sharing_consistent ?\<O> ?sb; ?a ~: ?\<O> Un all_acquired ?sb;
         ?a : read_only (share ?sb ?\<S>) |]
      ==> ?a : read_only ?\<S>",
     template_implication
      ([template_predicate
         (
            template_app
             (template_app (template_hole 6, template_var 3),
              template_var 2)
            ),
        template_negation
         (
            template_predicate
             (
                template_app
                 (template_app (template_hole 4, template_var 1),
                  template_app
                   (template_app (template_hole 3, template_var 3),
                    template_app (template_hole 2, template_var 2)))
                )
            ),
        template_predicate
         (
            template_app
             (template_app (template_hole 4, template_var 1),
              template_app
               (template_hole 1,
                template_app
                 (template_app (template_hole 0, template_var 2),
                  template_var 0)))
            )],
       template_predicate
        (
           template_app
            (template_app (template_hole 4, template_var 1),
             template_app (template_hole 1, template_var 0))
           ))),
    ("ReduceStoreBuffer.share_append_Write\<^sub>s\<^sub>b",
     "share
       (takeWhile (Not o is_volatile_Write\<^sub>s\<^sub>b)
         (?sb @ [Write\<^sub>s\<^sub>b ?volatile ?a ?sop ?v ?A ?L ?R ?W]))
       ?S =
      share (takeWhile (Not o is_volatile_Write\<^sub>s\<^sub>b) ?sb) ?S",
     template_equation
      (template_app
        (template_app
          (template_hole 8,
           template_app
            (template_app
              (template_hole 7,
               template_app
                (template_app (template_hole 6, template_hole 5),
                 template_hole 4)),
             template_app
              (template_app (template_hole 3, template_var 9),
               template_app
                (template_app
                  (template_hole 2,
                   template_app
                    (template_app
                      (template_app
                        (template_app
                          (template_app
                            (template_app
                              (template_app
                                (template_app
                                  (template_hole 1, template_var 8),
                                 template_var 7),
                               template_var 6),
                             template_var 5),
                           template_var 4),
                         template_var 3),
                       template_var 2),
                     template_var 1)),
                 template_hole 0)))),
         template_var 0),
       template_app
        (template_app
          (template_hole 8,
           template_app
            (template_app
              (template_hole 7,
               template_app
                (template_app (template_hole 6, template_hole 5),
                 template_hole 4)),
             template_var 9)),
         template_var 0))),
    ("ReduceStoreBuffer.data_dependency_consistent_instrs_append",
     "data_dependency_consistent_instrs ?T (?xs @ ?ys) =
      (data_dependency_consistent_instrs ?T ?xs &
       data_dependency_consistent_instrs (?T Un load_tmps ?xs) ?ys &
       load_tmps ?ys Int \<Union> (fst ` store_sops ?xs) = {})",
     template_implication
      ([template_predicate
         (
            template_app
             (template_app (template_hole 11, template_var 2),
              template_app
               (template_app (template_hole 10, template_var 1),
                template_var 0))
            )],
       template_predicate
        (
           template_app
            (template_app
              (template_hole 9,
               template_app
                (template_app (template_hole 11, template_var 2),
                 template_var 1)),
             template_app
              (template_app
                (template_hole 9,
                 template_app
                  (template_app
                    (template_hole 11,
                     template_app
                      (template_app (template_hole 8, template_var 2),
                       template_app (template_hole 7, template_var 1))),
                   template_var 0)),
               template_app
                (template_app
                  (template_hole 6,
                   template_app
                    (template_app
                      (template_hole 5,
                       template_app (template_hole 7, template_var 0)),
                     template_app
                      (template_hole 4,
                       template_app
                        (template_app (template_hole 3, template_hole 2),
                         template_app (template_hole 1, template_var 1))))),
                 template_hole 0)))
           ))),
    ("ReduceStoreBuffer.last_prog_hd_prog_last_prog",
     "[| last_prog ?p' (?sb @ ?sb') = ?p; hd_prog ?p' (?sb @ ?sb') = ?p' |]
      ==> last_prog (hd_prog ?p ?sb') ?sb = last_prog ?p' ?sb",
     template_implication
      ([template_equation
         (template_app
           (template_app (template_hole 2, template_var 3),
            template_app
             (template_app (template_hole 1, template_var 2),
              template_var 1)),
          template_var 0),
        template_equation
         (template_app
           (template_app (template_hole 0, template_var 3),
            template_app
             (template_app (template_hole 1, template_var 2),
              template_var 1)),
          template_var 3)],
       template_equation
        (template_app
          (template_app
            (template_hole 2,
             template_app
              (template_app (template_hole 0, template_var 0),
               template_var 1)),
           template_var 2),
         template_app
          (template_app (template_hole 2, template_var 3),
           template_var 2)))),
    ("ReduceStoreBuffer.shared_owned",
     "[| sharing_consistent ?\<S> ?\<O> ?sb; ?a ~: dom ?\<S>;
         ?a : dom (share ?sb ?\<S>) |]
      ==> ?a : ?\<O> Un all_acquired ?sb",
     template_implication
      ([template_predicate
         (
            template_app
             (template_app
               (template_app (template_hole 6, template_var 3),
                template_var 2),
              template_var 1)
            ),
        template_negation
         (
            template_predicate
             (
                template_app
                 (template_app (template_hole 4, template_var 0),
                  template_app (template_hole 3, template_var 3))
                )
            ),
        template_predicate
         (
            template_app
             (template_app (template_hole 4, template_var 0),
              template_app
               (template_hole 3,
                template_app
                 (template_app (template_hole 2, template_var 1),
                  template_var 3)))
            )],
       template_predicate
        (
           template_app
            (template_app (template_hole 4, template_var 0),
             template_app
              (template_app (template_hole 1, template_var 2),
               template_app (template_hole 0, template_var 1)))
           ))),
    ("ReduceStoreBuffer.instrs_append_Write\<^sub>s\<^sub>b",
     "instrs
       (?sb @ [Write\<^sub>s\<^sub>b ?volatile ?a ?sop ?v ?A ?L ?R ?W]) =
      instrs ?sb @ [Write ?volatile ?a ?sop ?A ?L ?R ?W]",
     template_equation
      (template_app
        (template_hole 8,
         template_app
          (template_app (template_hole 7, template_var 8),
           template_app
            (template_app
              (template_hole 6,
               template_app
                (template_app
                  (template_app
                    (template_app
                      (template_app
                        (template_app
                          (template_app
                            (template_app (template_hole 5, template_var 7),
                             template_var 6),
                           template_var 5),
                         template_var 4),
                       template_var 3),
                     template_var 2),
                   template_var 1),
                 template_var 0)),
             template_hole 4))),
       template_app
        (template_app
          (template_hole 3, template_app (template_hole 8, template_var 8)),
         template_app
          (template_app
            (template_hole 2,
             template_app
              (template_app
                (template_app
                  (template_app
                    (template_app
                      (template_app
                        (template_app (template_hole 1, template_var 7),
                         template_var 6),
                       template_var 5),
                     template_var 3),
                   template_var 2),
                 template_var 1),
               template_var 0)),
           template_hole 0)))),
    ("ReduceStoreBuffer.share_append_Ghost\<^sub>s\<^sub>b",
     "outstanding_refs is_volatile_Write\<^sub>s\<^sub>b ?sb = {} ==>
      share (?sb @ [Ghost\<^sub>s\<^sub>b ?A ?L ?R ?W]) ?\<S> =
      share ?sb
       ?\<S> \<oplus>\<^bsub>?W\<^esub> ?R \<ominus>\<^bsub>?A\<^esub> ?L",
     template_implication
      ([template_equation
         (template_app
           (template_app (template_hole 10, template_hole 9),
            template_var 5),
          template_hole 8)],
       template_equation
        (template_app
          (template_app
            (template_hole 6,
             template_app
              (template_app (template_hole 5, template_var 5),
               template_app
                (template_app
                  (template_hole 4,
                   template_app
                    (template_app
                      (template_app
                        (template_app (template_hole 3, template_var 4),
                         template_var 3),
                       template_var 2),
                     template_var 1)),
                 template_hole 2))),
           template_var 0),
         template_app
          (template_app
            (template_app
              (template_hole 1,
               template_app
                (template_app
                  (template_app
                    (template_hole 0,
                     template_app
                      (template_app (template_hole 6, template_var 5),
                       template_var 0)),
                   template_var 1),
                 template_var 2)),
             template_var 4),
           template_var 3)))),
    ("ReduceStoreBuffer.sharing_consis_Cons",
     "[| sharing_consis ?\<S> ?ts; sharing_consistent ?\<S> ?\<O> ?sb |]
      ==> sharing_consis ?\<S>
           ((?p, ?is, ?\<theta>, ?sb, ?\<D>, ?\<O>, ?\<R>) # ?ts)",
     template_implication
      ([template_predicate
         (
            template_app
             (template_app (template_hole 8, template_var 8),
              template_var 7)
            ),
        template_predicate
         (
            template_app
             (template_app
               (template_app (template_hole 7, template_var 8),
                template_var 6),
              template_var 5)
            )],
       template_predicate
        (
           template_app
            (template_app (template_hole 8, template_var 8),
             template_app
              (template_app
                (template_hole 6,
                 template_app
                  (template_app (template_hole 5, template_var 4),
                   template_app
                    (template_app (template_hole 4, template_var 3),
                     template_app
                      (template_app (template_hole 3, template_var 2),
                       template_app
                        (template_app (template_hole 2, template_var 5),
                         template_app
                          (template_app (template_hole 1, template_var 1),
                           template_app
                            (template_app (template_hole 0, template_var 6),
                             template_var 0))))))),
               template_var 7))
           ))),
    ("ReduceStoreBuffer.non_volatile_owned_or_read_only_read_only_reads_eq",
     "[| non_volatile_owned_or_read_only ?pending_write ?\<S> ?\<O> ?sb;
         ALL a:read_only_reads ?\<O> ?sb.
            a : read_only ?\<S> --> a : read_only ?\<S>' |]
      ==> non_volatile_owned_or_read_only ?pending_write ?\<S>' ?\<O> ?sb",
     template_implication
      ([template_predicate
         (
            template_app
             (template_app
               (template_app
                 (template_app (template_hole 5, template_var 4),
                  template_var 3),
                template_var 2),
              template_var 1)
            ),
        template_predicate
         (
            template_app
             (template_app
               (template_hole 4,
                template_app
                 (template_app (template_hole 3, template_var 2),
                  template_var 1)),
              t_empty)
            )],
       template_predicate
        (
           template_app
            (template_app
              (template_app
                (template_app (template_hole 5, template_var 4),
                 template_var 0),
               template_var 2),
             template_var 1)
           ))),
    ("ReduceStoreBuffer.flush_update_other'",
     "[| ?a ~: outstanding_refs is_non_volatile_Write\<^sub>s\<^sub>b ?sb;
         outstanding_refs is_volatile_Write\<^sub>s\<^sub>b ?sb = {} |]
      ==> flush ?sb (?m(?a := ?v)) = (flush ?sb ?m)(?a := ?v)",
     template_implication
      ([template_negation
         (
            template_predicate
             (
                template_app
                 (template_app (template_hole 8, template_var 3),
                  template_app
                   (template_app (template_hole 7, template_hole 6),
                    template_var 2))
                )
            ),
        template_equation
         (template_app
           (template_app (template_hole 7, template_hole 4),
            template_var 2),
          template_hole 3)],
       template_equation
        (template_app
          (template_app (template_hole 1, template_var 2),
           template_app
            (template_app
              (template_app (template_hole 0, template_var 1),
               template_var 3),
             template_var 0)),
         template_app
          (template_app
            (template_app
              (template_hole 0,
               template_app
                (template_app (template_hole 1, template_var 2),
                 template_var 1)),
             template_var 3),
           template_var 0)))),
    ("ReduceStoreBuffer.share_union",
     "[| ?a : dom (share ?sb (?A \<oplus>\<^bsub>?z\<^esub> ?B));
         ?a ~: dom ?A |]
      ==> ?a : dom (share ?sb (Map.empty \<oplus>\<^bsub>?z\<^esub> ?B))",
     template_implication
      ([template_predicate
         (
            template_app
             (template_app (template_hole 5, template_var 4),
              template_app
               (template_hole 4,
                template_app
                 (template_app (template_hole 3, template_var 3),
                  template_app
                   (template_app
                     (template_app (template_hole 2, template_var 2),
                      template_var 1),
                    template_var 0))))
            ),
        template_negation
         (
            template_predicate
             (
                template_app
                 (template_app (template_hole 5, template_var 4),
                  template_app (template_hole 4, template_var 2))
                )
            )],
       template_predicate
        (
           template_app
            (template_app (template_hole 5, template_var 4),
             template_app
              (template_hole 4,
               template_app
                (template_app (template_hole 3, template_var 3),
                 template_app
                  (template_app
                    (template_app (template_hole 2, t_empty),
                     template_var 1),
                   template_var 0))))
           ))),
    ("ReduceStoreBuffer.read_only_share_unacquired",
     "[| ?\<O> Int read_only ?S = {}; weak_sharing_consistent ?\<O> ?sb;
         ?a : read_only (share ?sb ?S) |]
      ==> ?a ~: acquired True ?sb ?\<O>",
     template_implication
      ([template_equation
         (template_app
           (template_app (template_hole 8, template_var 3),
            template_app (template_hole 7, template_var 2)),
          template_hole 6),
        template_predicate
         (
            template_app
             (template_app (template_hole 5, template_var 3),
              template_var 1)
            ),
        template_predicate
         (
            template_app
             (template_app (template_hole 4, template_var 0),
              template_app
               (template_hole 7,
                template_app
                 (template_app (template_hole 3, template_var 1),
                  template_var 2)))
            )],
       template_negation
        (
           template_predicate
            (
               template_app
                (template_app (template_hole 4, template_var 0),
                 template_app
                  (template_app
                    (template_app (template_hole 1, template_hole 0),
                     template_var 1),
                   template_var 3))
               )
           ))),
    ("ReduceStoreBuffer.non_volatile_owned_or_read_only_drop",
     "non_volatile_owned_or_read_only False ?\<S> ?\<O> ?sb ==>
      non_volatile_owned_or_read_only True
       (share (takeWhile (Not o is_volatile_Write\<^sub>s\<^sub>b) ?sb)
         ?\<S>)
       (acquired True
         (takeWhile (Not o is_volatile_Write\<^sub>s\<^sub>b) ?sb) ?\<O>)
       (dropWhile (Not o is_volatile_Write\<^sub>s\<^sub>b) ?sb)",
     template_implication
      ([template_predicate
         (
            template_app
             (template_app
               (template_app
                 (template_app (template_hole 9, template_hole 8),
                  template_var 2),
                template_var 1),
              template_var 0)
            )],
       template_predicate
        (
           template_app
            (template_app
              (template_app
                (template_app (template_hole 9, template_hole 7),
                 template_app
                  (template_app
                    (template_hole 6,
                     template_app
                      (template_app
                        (template_hole 5,
                         template_app
                          (template_app (template_hole 4, template_hole 3),
                           template_hole 2)),
                       template_var 0)),
                   template_var 2)),
               template_app
                (template_app
                  (template_app (template_hole 1, template_hole 7),
                   template_app
                    (template_app
                      (template_hole 5,
                       template_app
                        (template_app (template_hole 4, template_hole 3),
                         template_hole 2)),
                     template_var 0)),
                 template_var 1)),
             template_app
              (template_app
                (template_hole 0,
                 template_app
                  (template_app (template_hole 4, template_hole 3),
                   template_hole 2)),
               template_var 0))
           ))),
    ("ReduceStoreBuffer.reads_consistent_drop",
     "reads_consistent False ?\<O> ?m ?sb ==>
      reads_consistent True
       (acquired True
         (takeWhile (Not o is_volatile_Write\<^sub>s\<^sub>b) ?sb) ?\<O>)
       (flush (takeWhile (Not o is_volatile_Write\<^sub>s\<^sub>b) ?sb) ?m)
       (dropWhile (Not o is_volatile_Write\<^sub>s\<^sub>b) ?sb)",
     template_implication
      ([template_predicate
         (
            template_app
             (template_app
               (template_app
                 (template_app (template_hole 9, template_hole 8),
                  template_var 2),
                template_var 1),
              template_var 0)
            )],
       template_predicate
        (
           template_app
            (template_app
              (template_app
                (template_app (template_hole 9, template_hole 7),
                 template_app
                  (template_app
                    (template_app (template_hole 6, template_hole 7),
                     template_app
                      (template_app
                        (template_hole 5,
                         template_app
                          (template_app (template_hole 4, template_hole 3),
                           template_hole 2)),
                       template_var 0)),
                   template_var 2)),
               template_app
                (template_app
                  (template_hole 1,
                   template_app
                    (template_app
                      (template_hole 5,
                       template_app
                        (template_app (template_hole 4, template_hole 3),
                         template_hole 2)),
                     template_var 0)),
                 template_var 1)),
             template_app
              (template_app
                (template_hole 0,
                 template_app
                  (template_app (template_hole 4, template_hole 3),
                   template_hole 2)),
               template_var 0))
           ))),
    ("ReduceStoreBuffer.causal_program_history_Write",
     "causal_program_history
       (Write ?volatile ?a ?sop ?A ?L ?R ?W # ?is\<^sub>s\<^sub>b) ?sb ==>
      causal_program_history ?is\<^sub>s\<^sub>b
       (?sb @ [Write\<^sub>s\<^sub>b ?volatile ?a ?sop ?v ?A ?L ?R ?W])",
     template_implication
      ([template_predicate
         (
            template_app
             (template_app
               (template_hole 6,
                template_app
                 (template_app
                   (template_hole 5,
                    template_app
                     (template_app
                       (template_app
                         (template_app
                           (template_app
                             (template_app
                               (template_app
                                 (template_hole 4, template_var 9),
                                template_var 8),
                              template_var 7),
                            template_var 6),
                          template_var 5),
                        template_var 4),
                      template_var 3)),
                  template_var 2)),
              template_var 1)
            )],
       template_predicate
        (
           template_app
            (template_app (template_hole 6, template_var 2),
             template_app
              (template_app (template_hole 3, template_var 1),
               template_app
                (template_app
                  (template_hole 2,
                   template_app
                    (template_app
                      (template_app
                        (template_app
                          (template_app
                            (template_app
                              (template_app
                                (template_app
                                  (template_hole 1, template_var 9),
                                 template_var 8),
                               template_var 7),
                             template_var 0),
                           template_var 6),
                         template_var 5),
                       template_var 4),
                     template_var 3)),
                 template_hole 0)))
           ))),
    ("ReduceStoreBuffer.flush_update_other''",
     "[| ?a ~: outstanding_refs is_non_volatile_Write\<^sub>s\<^sub>b ?sb;
         ?a ~: outstanding_refs is_volatile_Write\<^sub>s\<^sub>b ?sb |]
      ==> flush ?sb (?m(?a := ?v)) = (flush ?sb ?m)(?a := ?v)",
     template_implication
      ([template_negation
         (
            template_predicate
             (
                template_app
                 (template_app (template_hole 6, template_var 3),
                  template_app
                   (template_app (template_hole 5, template_hole 4),
                    template_var 2))
                )
            ),
        template_negation
         (
            template_predicate
             (
                template_app
                 (template_app (template_hole 6, template_var 3),
                  template_app
                   (template_app (template_hole 5, template_hole 3),
                    template_var 2))
                )
            )],
       template_equation
        (template_app
          (template_app (template_hole 1, template_var 2),
           template_app
            (template_app
              (template_app (template_hole 0, template_var 1),
               template_var 3),
             template_var 0)),
         template_app
          (template_app
            (template_app
              (template_hole 0,
               template_app
                (template_app (template_hole 1, template_var 2),
                 template_var 1)),
             template_var 3),
           template_var 0)))),
    ("ReduceStoreBuffer.owns_unshared_share_acquired",
     "[| sharing_consistent ?\<S> ?\<O> ?sb; ?a : ?\<O>;
         ?a ~: all_unshared ?sb |]
      ==> ?a : dom (share ?sb ?\<S>) Un acquired True ?sb ?\<O>",
     template_implication
      ([template_predicate
         (
            template_app
             (template_app
               (template_app (template_hole 8, template_var 3),
                template_var 2),
              template_var 1)
            ),
        template_predicate
         (
            template_app
             (template_app (template_hole 7, template_var 0),
              template_var 2)
            ),
        template_negation
         (
            template_predicate
             (
                template_app
                 (template_app (template_hole 7, template_var 0),
                  template_app (template_hole 5, template_var 1))
                )
            )],
       template_predicate
        (
           template_app
            (template_app (template_hole 7, template_var 0),
             template_app
              (template_app
                (template_hole 4,
                 template_app
                  (template_hole 3,
                   template_app
                    (template_app (template_hole 2, template_var 1),
                     template_var 3))),
               template_app
                (template_app
                  (template_app (template_hole 1, template_hole 0),
                   template_var 1),
                 template_var 2)))
           ))),
    ("ReduceStoreBuffer.reads_consistent_mem_eq_on_non_volatile_reads",
     "[| ALL a:?A. ?m' a = ?m a;
         outstanding_refs is_non_volatile_Read\<^sub>s\<^sub>b ?sb <= ?A;
         reads_consistent ?pending_write ?\<O> ?m ?sb |]
      ==> reads_consistent ?pending_write ?\<O> ?m' ?sb",
     template_implication
      ([template_predicate
         (
            template_app
             (template_app (template_hole 5, template_var 5), t_empty)
            ),
        template_inequation
         (less_equals,
          template_app
           (template_app (template_hole 2, template_hole 1),
            template_var 2),
          template_var 5),
        template_predicate
         (
            template_app
             (template_app
               (template_app
                 (template_app (template_hole 0, template_var 1),
                  template_var 0),
                template_var 3),
              template_var 2)
            )],
       template_predicate
        (
           template_app
            (template_app
              (template_app
                (template_app (template_hole 0, template_var 1),
                 template_var 0),
               template_var 4),
             template_var 2)
           ))),
    ("ReduceStoreBuffer.valid_reads_Cons",
     "valid_reads ?m (?t # ?ts) =
      (let (uu_, uu_, uu_, sb, uu_, \<O>, uu_) = ?t
       in reads_consistent False \<O> ?m sb & valid_reads ?m ?ts)",
     template_equation
      (template_app
        (template_app (template_hole 11, template_var 2),
         template_app
          (template_app (template_hole 10, template_var 1),
           template_var 0)),
       template_app
        (template_app (template_hole 9, template_var 1),
         template_app (template_hole 8, t_empty)))),
    ("ReduceStoreBuffer.flush_update_other",
     "[| ?a ~: outstanding_refs (Not o is_volatile) ?sb;
         outstanding_refs is_volatile_Write\<^sub>s\<^sub>b ?sb = {} |]
      ==> flush ?sb (?m(?a := ?v)) = (flush ?sb ?m)(?a := ?v)",
     template_implication
      ([template_negation
         (
            template_predicate
             (
                template_app
                 (template_app (template_hole 9, template_var 3),
                  template_app
                   (template_app
                     (template_hole 8,
                      template_app
                       (template_app (template_hole 7, template_hole 10),
                        template_hole 6)),
                    template_var 2))
                )
            ),
        template_equation
         (template_app
           (template_app (template_hole 8, template_hole 4),
            template_var 2),
          template_hole 3)],
       template_equation
        (template_app
          (template_app (template_hole 1, template_var 2),
           template_app
            (template_app
              (template_app (template_hole 0, template_var 1),
               template_var 3),
             template_var 0)),
         template_app
          (template_app
            (template_app
              (template_hole 0,
               template_app
                (template_app (template_hole 1, template_var 2),
                 template_var 1)),
             template_var 3),
           template_var 0)))),
    ("ReduceStoreBuffer.share_domain_changesX",
     "[| ALL a:?X. ?\<S>' a = ?\<S> a;
         ?a : all_shared ?sb Un all_unshared ?sb Un ?X |]
      ==> share ?sb ?\<S>' ?a = share ?sb ?\<S> ?a",
     template_implication
      ([template_predicate
         (
            template_app
             (template_app (template_hole 6, template_var 4), t_empty)
            ),
        template_predicate
         (
            template_app
             (template_app (template_hole 4, template_var 1),
              template_app
               (template_app
                 (template_hole 3,
                  template_app
                   (template_app
                     (template_hole 3,
                      template_app (template_hole 2, template_var 0)),
                    template_app (template_hole 1, template_var 0))),
                template_var 4))
            )],
       template_equation
        (template_app
          (template_app
            (template_app (template_hole 0, template_var 0),
             template_var 3),
           template_var 1),
         template_app
          (template_app
            (template_app (template_hole 0, template_var 0),
             template_var 2),
           template_var 1)))),
    ("ReduceStoreBuffer.release_shared_exchange",
     "[| ALL a:?\<O> Un all_acquired ?sb. ?\<S>' a = ?\<S> a;
         sharing_consistent ?\<S> ?\<O> ?sb |]
      ==> release ?sb (dom ?\<S>') ?\<R> = release ?sb (dom ?\<S>) ?\<R>",
     template_implication
      ([template_predicate
         (
            template_app
             (template_app
               (template_hole 7,
                template_app
                 (template_app (template_hole 6, template_var 4),
                  template_app (template_hole 5, template_var 3))),
              t_empty)
            ),
        template_predicate
         (
            template_app
             (template_app
               (template_app (template_hole 3, template_var 1),
                template_var 4),
              template_var 3)
            )],
       template_equation
        (template_app
          (template_app
            (template_app (template_hole 1, template_var 3),
             template_app (template_hole 0, template_var 2)),
           template_var 0),
         template_app
          (template_app
            (template_app (template_hole 1, template_var 3),
             template_app (template_hole 0, template_var 1)),
           template_var 0)))),
    ("ReduceStoreBuffer.no_unacquired_write_to_read_only_reads'",
     "[| no_write_to_read_only_memory ?\<S> ?sb;
         non_volatile_owned_or_read_only True ?\<S> ?\<O> ?sb;
         sharing_consistent ?\<S> ?\<O> ?sb |]
      ==> read_only_reads ?\<O> ?sb Int
          outstanding_refs is_Write\<^sub>s\<^sub>b ?sb
          <= ?\<O> Un all_acquired ?sb",
     template_implication
      ([template_predicate
         (
            template_app
             (template_app (template_hole 10, template_var 2),
              template_var 1)
            ),
        template_predicate
         (
            template_app
             (template_app
               (template_app
                 (template_app (template_hole 9, template_hole 8),
                  template_var 2),
                template_var 0),
              template_var 1)
            ),
        template_predicate
         (
            template_app
             (template_app
               (template_app (template_hole 7, template_var 2),
                template_var 0),
              template_var 1)
            )],
       template_inequation
        (less_equals,
         template_app
          (template_app
            (template_hole 5,
             template_app
              (template_app (template_hole 4, template_var 0),
               template_var 1)),
           template_app
            (template_app (template_hole 3, template_hole 2),
             template_var 1)),
         template_app
          (template_app (template_hole 1, template_var 0),
           template_app (template_hole 0, template_var 1))))),
    ("ReduceStoreBuffer.no_unacquired_non_volatile_write_to_read_only",
     "[| no_write_to_read_only_memory ?\<S> ?sb;
         non_volatile_owned_or_read_only True ?\<S> ?\<O> ?sb;
         sharing_consistent ?\<S> ?\<O> ?sb |]
      ==> read_only_reads ?\<O> ?sb Int
          outstanding_refs is_non_volatile_Write\<^sub>s\<^sub>b ?sb
          <= ?\<O> Un all_acquired ?sb",
     template_implication
      ([template_predicate
         (
            template_app
             (template_app (template_hole 10, template_var 2),
              template_var 1)
            ),
        template_predicate
         (
            template_app
             (template_app
               (template_app
                 (template_app (template_hole 9, template_hole 8),
                  template_var 2),
                template_var 0),
              template_var 1)
            ),
        template_predicate
         (
            template_app
             (template_app
               (template_app (template_hole 7, template_var 2),
                template_var 0),
              template_var 1)
            )],
       template_inequation
        (less_equals,
         template_app
          (template_app
            (template_hole 5,
             template_app
              (template_app (template_hole 4, template_var 0),
               template_var 1)),
           template_app
            (template_app (template_hole 3, template_hole 2),
             template_var 1)),
         template_app
          (template_app (template_hole 1, template_var 0),
           template_app (template_hole 0, template_var 1))))),
    ("ReduceStoreBuffer.no_unacquired_volatile_write_to_read_only_reads",
     "[| no_write_to_read_only_memory ?\<S> ?sb;
         non_volatile_owned_or_read_only True ?\<S> ?\<O> ?sb;
         sharing_consistent ?\<S> ?\<O> ?sb |]
      ==> read_only_reads ?\<O> ?sb Int
          outstanding_refs is_volatile_Write\<^sub>s\<^sub>b ?sb
          <= ?\<O> Un all_acquired ?sb",
     template_implication
      ([template_predicate
         (
            template_app
             (template_app (template_hole 10, template_var 2),
              template_var 1)
            ),
        template_predicate
         (
            template_app
             (template_app
               (template_app
                 (template_app (template_hole 9, template_hole 8),
                  template_var 2),
                template_var 0),
              template_var 1)
            ),
        template_predicate
         (
            template_app
             (template_app
               (template_app (template_hole 7, template_var 2),
                template_var 0),
              template_var 1)
            )],
       template_inequation
        (less_equals,
         template_app
          (template_app
            (template_hole 5,
             template_app
              (template_app (template_hole 4, template_var 0),
               template_var 1)),
           template_app
            (template_app (template_hole 3, template_hole 2),
             template_var 1)),
         template_app
          (template_app (template_hole 1, template_var 0),
           template_app (template_hole 0, template_var 1))))),
    ("ReduceStoreBuffer.in_write_sops_conv",
     "(?sop : write_sops ?xs) =
      (EX volatile a v A L R W.
          Write\<^sub>s\<^sub>b volatile a ?sop v A L R W : set ?xs)",
     template_equation
      (template_app
        (template_app (template_hole 7, template_var 1),
         template_app (template_hole 6, template_var 0)),
       template_app (template_hole 5, t_empty))),
    ("ReduceStoreBuffer.non_volatile_owned_or_read_only_append",
     "non_volatile_owned_or_read_only ?pending_write ?\<S> ?\<O>
       (?xs @ ?ys) =
      (non_volatile_owned_or_read_only ?pending_write ?\<S> ?\<O> ?xs &
       non_volatile_owned_or_read_only
        (?pending_write |
         outstanding_refs is_volatile_Write\<^sub>s\<^sub>b ?xs ~= {})
        (share ?xs ?\<S>) (acquired True ?xs ?\<O>) ?ys)",
     template_implication
      ([template_predicate
         (
            template_app
             (template_app
               (template_app
                 (template_app (template_hole 11, template_var 4),
                  template_var 3),
                template_var 2),
              template_app
               (template_app (template_hole 10, template_var 1),
                template_var 0))
            )],
       template_predicate
        (
           template_app
            (template_app
              (template_hole 9,
               template_app
                (template_app
                  (template_app
                    (template_app (template_hole 11, template_var 4),
                     template_var 3),
                   template_var 2),
                 template_var 1)),
             template_app
              (template_app
                (template_app
                  (template_app
                    (template_hole 11,
                     template_app
                      (template_app (template_hole 8, template_var 4),
                       template_app
                        (template_hole 7,
                         template_app
                          (template_app
                            (template_hole 6,
                             template_app
                              (template_app
                                (template_hole 5, template_hole 4),
                               template_var 1)),
                           template_hole 3)))),
                   template_app
                    (template_app (template_hole 2, template_var 1),
                     template_var 3)),
                 template_app
                  (template_app
                    (template_app (template_hole 1, template_hole 0),
                     template_var 1),
                   template_var 2)),
               template_var 0))
           ))),
    ("ReduceStoreBuffer.share_append_Ghost\<^sub>s\<^sub>b'",
     "outstanding_refs is_volatile_Write\<^sub>s\<^sub>b ?sb ~= {} ==>
      share
       (takeWhile (Not o is_volatile_Write\<^sub>s\<^sub>b)
         (?sb @ [Ghost\<^sub>s\<^sub>b ?A ?L ?R ?W]))
       ?\<S> =
      share (takeWhile (Not o is_volatile_Write\<^sub>s\<^sub>b) ?sb)
       ?\<S>",
     template_implication
      ([template_negation
         (
            template_equation
             (template_app
               (template_app (template_hole 10, template_hole 9),
                template_var 5),
              template_hole 8)
            )],
       template_equation
        (template_app
          (template_app
            (template_hole 6,
             template_app
              (template_app
                (template_hole 5,
                 template_app
                  (template_app (template_hole 4, template_hole 12),
                   template_hole 9)),
               template_app
                (template_app (template_hole 3, template_var 5),
                 template_app
                  (template_app
                    (template_hole 2,
                     template_app
                      (template_app
                        (template_app
                          (template_app (template_hole 1, template_var 4),
                           template_var 3),
                         template_var 2),
                       template_var 1)),
                   template_hole 0)))),
           template_var 0),
         template_app
          (template_app
            (template_hole 6,
             template_app
              (template_app
                (template_hole 5,
                 template_app
                  (template_app (template_hole 4, template_hole 12),
                   template_hole 9)),
               template_var 5)),
           template_var 0)))),
    ("ReduceStoreBuffer.memop_safe_delayed_implies_safe_free_flowing",
     "?\<O>s,?\<R>s,?i\<turnstile> (?is, ?\<theta>, ?m, ?\<D>, ?\<O>,
                                    ?\<S>) \<surd> ==>
      ?\<O>s,?i\<turnstile> (?is, ?\<theta>, ?m, ?\<D>, ?\<O>,
                             ?\<S>) \<surd>",
     template_implication
      ([template_predicate
         (
            template_app
             (template_app
               (template_app
                 (template_app (template_hole 6, template_var 8),
                  template_var 7),
                template_var 6),
              template_app
               (template_app (template_hole 5, template_var 5),
                template_app
                 (template_app (template_hole 4, template_var 4),
                  template_app
                   (template_app (template_hole 3, template_var 3),
                    template_app
                     (template_app (template_hole 2, template_var 2),
                      template_app
                       (template_app (template_hole 1, template_var 1),
                        template_var 0))))))
            )],
       template_predicate
        (
           template_app
            (template_app
              (template_app (template_hole 0, template_var 8),
               template_var 6),
             template_app
              (template_app (template_hole 5, template_var 5),
               template_app
                (template_app (template_hole 4, template_var 4),
                 template_app
                  (template_app (template_hole 3, template_var 3),
                   template_app
                    (template_app (template_hole 2, template_var 2),
                     template_app
                      (template_app (template_hole 1, template_var 1),
                       template_var 0))))))
           ))),
    ("ReduceStoreBuffer.reads_consistent_mem_eq_on_unforwarded_non_volatile_reads",
     "[| ALL a:?A Un ?W. ?m' a = ?m a;
         unforwarded_non_volatile_reads ?sb ?W <= ?A;
         reads_consistent ?pending_write ?\<O> ?m ?sb |]
      ==> reads_consistent ?pending_write ?\<O> ?m' ?sb",
     template_implication
      ([template_predicate
         (
            template_app
             (template_app
               (template_hole 5,
                template_app
                 (template_app (template_hole 4, template_var 6),
                  template_var 5)),
              t_empty)
            ),
        template_inequation
         (less_equals,
          template_app
           (template_app (template_hole 1, template_var 2), template_var 5),
          template_var 6),
        template_predicate
         (
            template_app
             (template_app
               (template_app
                 (template_app (template_hole 0, template_var 1),
                  template_var 0),
                template_var 3),
              template_var 2)
            )],
       template_predicate
        (
           template_app
            (template_app
              (template_app
                (template_app (template_hole 0, template_var 1),
                 template_var 0),
               template_var 4),
             template_var 2)
           ))),
    ("ReduceStoreBuffer.buffered_val_witness",
     "buffered_val ?sb ?a = Some ?v ==>
      EX volatile sop A L R W.
         Write\<^sub>s\<^sub>b volatile ?a sop ?v A L R W : set ?sb",
     template_implication
      ([template_equation
         (template_app
           (template_app (template_hole 7, template_var 2), template_var 1),
          template_app (template_hole 6, template_var 0))],
       template_predicate (template_app (template_hole 5, t_empty)))),
    ("ReduceStoreBuffer.share_append_commute'",
     "(all_shared ?xs Un all_unshared ?xs Un all_acquired ?xs) Int
      (all_shared ?ys Un all_unshared ?ys Un all_acquired ?ys) =
      {} ==>
      share (?ys @ ?xs) ?\<S> = share (?xs @ ?ys) ?\<S>",
     template_implication
      ([template_equation
         (template_app
           (template_app
             (template_hole 8,
              template_app
               (template_app
                 (template_hole 7,
                  template_app
                   (template_app
                     (template_hole 7,
                      template_app (template_hole 6, template_var 2)),
                    template_app (template_hole 5, template_var 2))),
                template_app (template_hole 4, template_var 2))),
            template_app
             (template_app
               (template_hole 7,
                template_app
                 (template_app
                   (template_hole 7,
                    template_app (template_hole 6, template_var 1)),
                  template_app (template_hole 5, template_var 1))),
              template_app (template_hole 4, template_var 1))),
          template_hole 3)],
       template_equation
        (template_app
          (template_app
            (template_hole 1,
             template_app
              (template_app (template_hole 0, template_var 1),
               template_var 2)),
           template_var 0),
         template_app
          (template_app
            (template_hole 1,
             template_app
              (template_app (template_hole 0, template_var 2),
               template_var 1)),
           template_var 0)))),
    ("ReduceStoreBuffer.share_append_commute",
     "(all_shared ?xs Un all_unshared ?xs Un all_acquired ?xs) Int
      (all_shared ?ys Un all_unshared ?ys Un all_acquired ?ys) =
      {} ==>
      share ?xs (share ?ys ?\<S>) = share ?ys (share ?xs ?\<S>)",
     template_implication
      ([template_equation
         (template_app
           (template_app
             (template_hole 11,
              template_app
               (template_app
                 (template_hole 10,
                  template_app
                   (template_app
                     (template_hole 10,
                      template_app (template_hole 9, template_var 2)),
                    template_app (template_hole 8, template_var 2))),
                template_app (template_hole 7, template_var 2))),
            template_app
             (template_app
               (template_hole 10,
                template_app
                 (template_app
                   (template_hole 10,
                    template_app (template_hole 6, template_var 1)),
                  template_app (template_hole 5, template_var 1))),
              template_app (template_hole 4, template_var 1))),
          template_hole 3)],
       template_equation
        (template_app
          (template_app (template_hole 1, template_var 2),
           template_app
            (template_app (template_hole 0, template_var 1),
             template_var 0)),
         template_app
          (template_app (template_hole 0, template_var 1),
           template_app
            (template_app (template_hole 1, template_var 2),
             template_var 0))))),
    ("ReduceStoreBuffer.no_unacquired_write_to_read_only",
     "[| no_write_to_read_only_memory ?\<S> ?sb;
         sharing_consistent ?\<S> ?\<O> ?sb; ?a : read_only ?\<S>;
         ?a ~: ?\<O> Un all_acquired ?sb |]
      ==> ?a ~: outstanding_refs is_Write\<^sub>s\<^sub>b ?sb",
     template_implication
      ([template_predicate
         (
            template_app
             (template_app (template_hole 8, template_var 3),
              template_var 2)
            ),
        template_predicate
         (
            template_app
             (template_app
               (template_app (template_hole 7, template_var 3),
                template_var 1),
              template_var 2)
            ),
        template_predicate
         (
            template_app
             (template_app (template_hole 6, template_var 0),
              template_app (template_hole 5, template_var 3))
            ),
        template_negation
         (
            template_predicate
             (
                template_app
                 (template_app (template_hole 6, template_var 0),
                  template_app
                   (template_app (template_hole 3, template_var 1),
                    template_app (template_hole 2, template_var 2)))
                )
            )],
       template_negation
        (
           template_predicate
            (
               template_app
                (template_app (template_hole 6, template_var 0),
                 template_app
                  (template_app (template_hole 1, template_hole 0),
                   template_var 2))
               )
           ))),
    ("ReduceStoreBuffer.read_only_unacquired_share",
     "[| ?\<O> Int read_only ?S = {}; weak_sharing_consistent ?\<O> ?sb;
         ?a : read_only ?S; ?a ~: all_acquired ?sb |]
      ==> ?a : read_only (share ?sb ?S)",
     template_implication
      ([template_equation
         (template_app
           (template_app (template_hole 7, template_var 3),
            template_app (template_hole 6, template_var 2)),
          template_hole 5),
        template_predicate
         (
            template_app
             (template_app (template_hole 4, template_var 3),
              template_var 1)
            ),
        template_predicate
         (
            template_app
             (template_app (template_hole 3, template_var 0),
              template_app (template_hole 6, template_var 2))
            ),
        template_negation
         (
            template_predicate
             (
                template_app
                 (template_app (template_hole 3, template_var 0),
                  template_app (template_hole 1, template_var 1))
                )
            )],
       template_predicate
        (
           template_app
            (template_app (template_hole 3, template_var 0),
             template_app
              (template_hole 6,
               template_app
                (template_app (template_hole 0, template_var 1),
                 template_var 2)))
           ))),
    ("ReduceStoreBuffer.unforwarded_witness",
     "?a : unforwarded_non_volatile_reads ?sb ?X ==>
      EX xs ys t v.
         ?sb = xs @ Read\<^sub>s\<^sub>b False ?a t v # ys &
         ?a ~: outstanding_refs is_Write\<^sub>s\<^sub>b xs",
     template_implication
      ([template_predicate
         (
            template_app
             (template_app (template_hole 12, template_var 2),
              template_app
               (template_app (template_hole 11, template_var 1),
                template_var 0))
            )],
       template_predicate (template_app (template_hole 10, t_empty)))),
    ("ReduceStoreBuffer.split_in_read_only_reads",
     "?a : read_only_reads ?\<O> ?xs ==>
      EX t v ys zs.
         ?xs = ys @ Read\<^sub>s\<^sub>b False ?a t v # zs &
         ?a ~: acquired True ys ?\<O>",
     template_implication
      ([template_predicate
         (
            template_app
             (template_app (template_hole 12, template_var 2),
              template_app
               (template_app (template_hole 11, template_var 1),
                template_var 0))
            )],
       template_predicate (template_app (template_hole 10, t_empty)))),
    ("ReduceStoreBuffer.flush_all_until_volatile_write_unchanged_addresses'",
     "?a ~: (UN (uu_, uu_, uu_, sb, uu_, uu_, uu_):set ?ls.
                outstanding_refs (Not o is_volatile) sb) ==>
      flush_all_until_volatile_write ?ls ?m ?a = ?m ?a",
     template_implication
      ([template_negation
         (
            template_predicate
             (
                template_app
                 (template_app (template_hole 14, template_var 2),
                  template_app
                   (template_hole 13,
                    template_app
                     (template_app
                       (template_hole 12,
                        template_app (template_hole 11, t_empty)),
                      template_app (template_hole 2, template_var 1))))
                )
            )],
       template_equation
        (template_app
          (template_app
            (template_app (template_hole 0, template_var 1),
             template_var 0),
           template_var 2),
         template_app (template_var 0, template_var 2)))),
    ("ReduceStoreBuffer.sharing_consistent_preservation",
     "[| sharing_consistent ?\<S> ?\<O> ?sb;
         all_acquired ?sb Int dom ?\<S> - dom ?\<S>' = {};
         all_unshared ?sb Int dom ?\<S>' - dom ?\<S> = {} |]
      ==> sharing_consistent ?\<S>' ?\<O> ?sb",
     template_implication
      ([template_predicate
         (
            template_app
             (template_app
               (template_app (template_hole 7, template_var 3),
                template_var 2),
              template_var 1)
            ),
        template_equation
         (template_app
           (template_app
             (template_hole 5,
              template_app
               (template_app
                 (template_hole 4,
                  template_app (template_hole 3, template_var 1)),
                template_app (template_hole 2, template_var 3))),
            template_app (template_hole 2, template_var 0)),
          template_hole 1),
        template_equation
         (template_app
           (template_app
             (template_hole 5,
              template_app
               (template_app
                 (template_hole 4,
                  template_app (template_hole 0, template_var 1)),
                template_app (template_hole 2, template_var 0))),
            template_app (template_hole 2, template_var 3)),
          template_hole 1)],
       template_predicate
        (
           template_app
            (template_app
              (template_app (template_hole 7, template_var 0),
               template_var 2),
             template_var 1)
           ))),
    ("ReduceStoreBuffer.reads_consistent_flush_other",
     "[| outstanding_refs is_volatile_Write\<^sub>s\<^sub>b ?sb = {};
         outstanding_refs (Not o is_volatile_Read\<^sub>s\<^sub>b) ?xs Int
         outstanding_refs is_non_volatile_Write\<^sub>s\<^sub>b ?sb =
         {};
         reads_consistent ?pending_write ?\<O> ?m ?xs |]
      ==> reads_consistent ?pending_write ?\<O> (flush ?sb ?m) ?xs",
     template_implication
      ([template_equation
         (template_app
           (template_app (template_hole 10, template_hole 9),
            template_var 4),
          template_hole 8),
        template_equation
         (template_app
           (template_app
             (template_hole 7,
              template_app
               (template_app
                 (template_hole 6,
                  template_app
                   (template_app (template_hole 5, template_hole 4),
                    template_hole 3)),
                template_var 3)),
            template_app
             (template_app (template_hole 10, template_hole 2),
              template_var 4)),
          template_hole 8),
        template_predicate
         (
            template_app
             (template_app
               (template_app
                 (template_app (template_hole 1, template_var 2),
                  template_var 1),
                template_var 0),
              template_var 3)
            )],
       template_predicate
        (
           template_app
            (template_app
              (template_app
                (template_app (template_hole 1, template_var 2),
                 template_var 1),
               template_app
                (template_app (template_hole 0, template_var 4),
                 template_var 0)),
             template_var 3)
           ))),
    ("ReduceStoreBuffer.outstanding_refs_non_volatile_Read\<^sub>s\<^sub>b_all_acquired",
     "[| reads_consistent ?pending_write ?\<O> ?m ?sb;
         non_volatile_owned_or_read_only ?pending_write ?\<S> ?\<O> ?sb;
         ?a : outstanding_refs is_non_volatile_Read\<^sub>s\<^sub>b ?sb |]
      ==> ?a : ?\<O> |
          ?a : all_acquired ?sb | ?a : read_only_reads ?\<O> ?sb",
     template_implication
      ([template_predicate
         (
            template_app
             (template_app
               (template_app
                 (template_app (template_hole 7, template_var 5),
                  template_var 4),
                template_var 3),
              template_var 2)
            ),
        template_predicate
         (
            template_app
             (template_app
               (template_app
                 (template_app (template_hole 6, template_var 5),
                  template_var 1),
                template_var 4),
              template_var 2)
            ),
        template_predicate
         (
            template_app
             (template_app (template_hole 5, template_var 0),
              template_app
               (template_app (template_hole 4, template_hole 3),
                template_var 2))
            )],
       template_predicate
        (
           template_app
            (template_app
              (template_hole 2,
               template_app
                (template_app (template_hole 5, template_var 0),
                 template_var 4)),
             template_app
              (template_app
                (template_hole 2,
                 template_app
                  (template_app (template_hole 5, template_var 0),
                   template_app (template_hole 1, template_var 2))),
               template_app
                (template_app (template_hole 5, template_var 0),
                 template_app
                  (template_app (template_hole 0, template_var 4),
                   template_var 2))))
           ))),
    ("ReduceStoreBuffer.no_volatile_Write\<^sub>s\<^sub>bs_conv",
     "(outstanding_refs is_volatile_Write\<^sub>s\<^sub>b ?sb = {}) =
      (ALL r:set ?sb.
          ALL v' sop' a' A L R W.
             r ~= Write\<^sub>s\<^sub>b True a' sop' v' A L R W)",
     template_equation
      (template_app
        (template_app
          (template_hole 12,
           template_app
            (template_app (template_hole 11, template_hole 10),
             template_var 0)),
         template_hole 9),
       template_app
        (template_app
          (template_hole 8, template_app (template_hole 7, template_var 0)),
         t_empty))),
    ("ReduceStoreBuffer.flush_all_until_volatile_write_unchanged_addresses",
     "?a ~: (UN (uu_, uu_, uu_, sb, uu_, uu_, uu_):set ?ls.
                outstanding_refs is_Write\<^sub>s\<^sub>b
                 (takeWhile (Not o is_volatile_Write\<^sub>s\<^sub>b)
                   sb)) ==>
      flush_all_until_volatile_write ?ls ?m ?a = ?m ?a",
     template_implication
      ([template_negation
         (
            template_predicate
             (
                template_app
                 (template_app (template_hole 16, template_var 2),
                  template_app
                   (template_hole 15,
                    template_app
                     (template_app
                       (template_hole 14,
                        template_app (template_hole 13, t_empty)),
                      template_app (template_hole 2, template_var 1))))
                )
            )],
       template_equation
        (template_app
          (template_app
            (template_app (template_hole 0, template_var 1),
             template_var 0),
           template_var 2),
         template_app (template_var 0, template_var 2)))),
    ("ReduceStoreBuffer.takeWhile_dropWhile_real_prefix",
     "[| ?x : set ?xs; ~ ?P ?x |]
      ==> EX y ys.
             ?xs = takeWhile ?P ?xs @ y # ys &
             ~ ?P y & dropWhile ?P ?xs = y # ys",
     template_implication
      ([template_predicate
         (
            template_app
             (template_app (template_hole 10, template_var 2),
              template_app (template_hole 9, template_var 1))
            ),
        template_negation
         (
            template_predicate
             (template_app (template_var 0, template_var 2))
            )],
       template_predicate (template_app (template_hole 7, t_empty)))),
    ("ReduceStoreBuffer.share_augment_release_commute",
     "(?R Un ?L Un ?A) Int
      (all_shared ?sb Un all_unshared ?sb Un all_acquired ?sb) =
      {} ==>
      share ?sb
       ?\<S> \<oplus>\<^bsub>?W\<^esub> ?R \<ominus>\<^bsub>?A\<^esub> ?L =
      share ?sb
       (?\<S> \<oplus>\<^bsub>?W\<^esub> ?R \<ominus>\<^bsub>?A\<^esub> ?L)",
     template_implication
      ([template_equation
         (template_app
           (template_app
             (template_hole 9,
              template_app
               (template_app
                 (template_hole 8,
                  template_app
                   (template_app (template_hole 8, template_var 5),
                    template_var 4)),
                template_var 3)),
            template_app
             (template_app
               (template_hole 8,
                template_app
                 (template_app
                   (template_hole 8,
                    template_app (template_hole 7, template_var 2)),
                  template_app (template_hole 6, template_var 2))),
              template_app (template_hole 5, template_var 2))),
          template_hole 4)],
       template_equation
        (template_app
          (template_app
            (template_app
              (template_hole 2,
               template_app
                (template_app
                  (template_app
                    (template_hole 1,
                     template_app
                      (template_app (template_hole 0, template_var 2),
                       template_var 1)),
                   template_var 0),
                 template_var 5)),
             template_var 3),
           template_var 4),
         template_app
          (template_app (template_hole 0, template_var 2),
           template_app
            (template_app
              (template_app
                (template_hole 2,
                 template_app
                  (template_app
                    (template_app (template_hole 1, template_var 1),
                     template_var 0),
                   template_var 5)),
               template_var 3),
             template_var 4))))),
    ("ReduceStoreBuffer.flush_all_until_volatile_wirte_mem_independent",
     "?a : (UN (uu_, uu_, uu_, sb, uu_, uu_, uu_):set ?ls.
               outstanding_refs is_Write\<^sub>s\<^sub>b
                (takeWhile (Not o is_volatile_Write\<^sub>s\<^sub>b)
                  sb)) ==>
      flush_all_until_volatile_write ?ls ?m' ?a =
      flush_all_until_volatile_write ?ls ?m ?a",
     template_implication
      ([template_predicate
         (
            template_app
             (template_app (template_hole 17, template_var 3),
              template_app
               (template_hole 16,
                template_app
                 (template_app
                   (template_hole 15,
                    template_app (template_hole 14, t_empty)),
                  template_app (template_hole 2, template_var 2))))
            )],
       template_equation
        (template_app
          (template_app
            (template_app (template_hole 0, template_var 2),
             template_var 1),
           template_var 3),
         template_app
          (template_app
            (template_app (template_hole 0, template_var 2),
             template_var 0),
           template_var 3)))),
    ("ReduceStoreBuffer.reads_consistent_buffered_snoc",
     "[| buffered_val ?sb ?a = Some ?v;
         reads_consistent ?pending_write ?\<O> ?m ?sb;
         ?volatile -->
         outstanding_refs is_volatile_Write\<^sub>s\<^sub>b ?sb = {} |]
      ==> reads_consistent ?pending_write ?\<O> ?m
           (?sb @ [Read\<^sub>s\<^sub>b ?volatile ?a ?t ?v])",
     template_implication
      ([template_equation
         (template_app
           (template_app (template_hole 11, template_var 7),
            template_var 6),
          template_app (template_hole 10, template_var 5)),
        template_predicate
         (
            template_app
             (template_app
               (template_app
                 (template_app (template_hole 9, template_var 4),
                  template_var 3),
                template_var 2),
              template_var 7)
            ),
        template_predicate
         (
            template_app
             (template_app (template_hole 8, template_var 1),
              template_app
               (template_app
                 (template_hole 7,
                  template_app
                   (template_app (template_hole 6, template_hole 5),
                    template_var 7)),
                template_hole 4))
            )],
       template_predicate
        (
           template_app
            (template_app
              (template_app
                (template_app (template_hole 9, template_var 4),
                 template_var 3),
               template_var 2),
             template_app
              (template_app (template_hole 3, template_var 7),
               template_app
                (template_app
                  (template_hole 2,
                   template_app
                    (template_app
                      (template_app
                        (template_app (template_hole 1, template_var 1),
                         template_var 6),
                       template_var 0),
                     template_var 5)),
                 template_hole 0)))
           ))),
    ("ReduceStoreBuffer.split_volatile_Write\<^sub>s\<^sub>b_in_outstanding_refs",
     "?a : outstanding_refs is_volatile_Write\<^sub>s\<^sub>b ?xs ==>
      EX sop v ys zs A L R W.
         ?xs = ys @ Write\<^sub>s\<^sub>b True ?a sop v A L R W # zs",
     template_implication
      ([template_predicate
         (
            template_app
             (template_app (template_hole 11, template_var 1),
              template_app
               (template_app (template_hole 10, template_hole 9),
                template_var 0))
            )],
       template_predicate (template_app (template_hole 8, t_empty)))),
    ("ReduceStoreBuffer.non_volatile_owned_or_read_only_read_only_reads_eq'",
     "[| non_volatile_owned_or_read_only False ?\<S> ?\<O> ?sb;
         ALL a:read_only_reads
                (acquired True
                  (takeWhile (Not o is_volatile_Write\<^sub>s\<^sub>b) ?sb)
                  ?\<O>)
                (dropWhile (Not o is_volatile_Write\<^sub>s\<^sub>b) ?sb).
            a : read_only ?\<S> --> a : read_only ?\<S>' |]
      ==> non_volatile_owned_or_read_only False ?\<S>' ?\<O> ?sb",
     template_implication
      ([template_predicate
         (
            template_app
             (template_app
               (template_app
                 (template_app (template_hole 13, template_hole 12),
                  template_var 3),
                template_var 2),
              template_var 1)
            ),
        template_predicate
         (
            template_app
             (template_app
               (template_hole 11,
                template_app
                 (template_app
                   (template_hole 10,
                    template_app
                     (template_app
                       (template_app (template_hole 9, template_hole 8),
                        template_app
                         (template_app
                           (template_hole 7,
                            template_app
                             (template_app
                               (template_hole 6, template_hole 5),
                              template_hole 4)),
                          template_var 1)),
                      template_var 2)),
                  template_app
                   (template_app
                     (template_hole 3,
                      template_app
                       (template_app (template_hole 6, template_hole 5),
                        template_hole 4)),
                    template_var 1))),
              t_empty)
            )],
       template_predicate
        (
           template_app
            (template_app
              (template_app
                (template_app (template_hole 13, template_hole 12),
                 template_var 0),
               template_var 2),
             template_var 1)
           ))),
    ("ReduceStoreBuffer.outstanding_refs_non_volatile_Read\<^sub>s\<^sub>b_all_acquired_dropWhile",
     "[| reads_consistent ?pending_write ?\<O> ?m ?sb;
         non_volatile_owned_or_read_only ?pending_write ?\<S> ?\<O> ?sb;
         ?a : outstanding_refs is_non_volatile_Read\<^sub>s\<^sub>b
               (dropWhile (Not o is_volatile_Write\<^sub>s\<^sub>b) ?sb) |]
      ==> ?a : ?\<O> |
          ?a : all_acquired ?sb | ?a : read_only_reads ?\<O> ?sb",
     template_implication
      ([template_predicate
         (
            template_app
             (template_app
               (template_app
                 (template_app (template_hole 11, template_var 5),
                  template_var 4),
                template_var 3),
              template_var 2)
            ),
        template_predicate
         (
            template_app
             (template_app
               (template_app
                 (template_app (template_hole 10, template_var 5),
                  template_var 1),
                template_var 4),
              template_var 2)
            ),
        template_predicate
         (
            template_app
             (template_app (template_hole 9, template_var 0),
              template_app
               (template_app (template_hole 8, template_hole 7),
                template_app
                 (template_app
                   (template_hole 6,
                    template_app
                     (template_app (template_hole 5, template_hole 4),
                      template_hole 3)),
                  template_var 2)))
            )],
       template_predicate
        (
           template_app
            (template_app
              (template_hole 2,
               template_app
                (template_app (template_hole 9, template_var 0),
                 template_var 4)),
             template_app
              (template_app
                (template_hole 2,
                 template_app
                  (template_app (template_hole 9, template_var 0),
                   template_app (template_hole 1, template_var 2))),
               template_app
                (template_app (template_hole 9, template_var 0),
                 template_app
                  (template_app (template_hole 0, template_var 4),
                   template_var 2))))
           ))),
    ("ReduceStoreBuffer.read_only_share_all_acquired_in",
     "[| ?\<O> Int read_only ?S = {}; weak_sharing_consistent ?\<O> ?sb;
         ?a : read_only (share ?sb ?S) |]
      ==> ?a : read_only (share ?sb Map.empty) |
          ?a : read_only ?S & ?a ~: all_acquired ?sb",
     template_implication
      ([template_equation
         (template_app
           (template_app (template_hole 10, template_var 3),
            template_app (template_hole 9, template_var 2)),
          template_hole 8),
        template_predicate
         (
            template_app
             (template_app (template_hole 7, template_var 3),
              template_var 1)
            ),
        template_predicate
         (
            template_app
             (template_app (template_hole 6, template_var 0),
              template_app
               (template_hole 9,
                template_app
                 (template_app (template_hole 5, template_var 1),
                  template_var 2)))
            )],
       template_predicate
        (
           template_app
            (template_app
              (template_hole 4,
               template_app
                (template_app (template_hole 6, template_var 0),
                 template_app
                  (template_hole 9,
                   template_app
                    (template_app (template_hole 5, template_var 1),
                     t_empty)))),
             template_app
              (template_app
                (template_hole 2,
                 template_app
                  (template_app (template_hole 6, template_var 0),
                   template_app (template_hole 9, template_var 2))),
               template_app
                (template_hole 1,
                 template_app
                  (template_app (template_hole 6, template_var 0),
                   template_app (template_hole 0, template_var 1)))))
           ))),
    ("ReduceStoreBuffer.split_Write\<^sub>s\<^sub>b_in_outstanding_refs",
     "?a : outstanding_refs is_Write\<^sub>s\<^sub>b ?xs ==>
      EX sop volatile v ys zs A L R W.
         ?xs = ys @ Write\<^sub>s\<^sub>b volatile ?a sop v A L R W # zs",
     template_implication
      ([template_predicate
         (
            template_app
             (template_app (template_hole 11, template_var 1),
              template_app
               (template_app (template_hole 10, template_hole 9),
                template_var 0))
            )],
       template_predicate (template_app (template_hole 8, t_empty)))),
    ("ReduceStoreBuffer.no_unacquired_write_to_read_only_reads",
     "[| no_write_to_read_only_memory ?\<S> ?sb;
         non_volatile_owned_or_read_only True ?\<S> ?\<O> ?sb;
         sharing_consistent ?\<S> ?\<O> ?sb; ?a : read_only_reads ?\<O> ?sb;
         ?a ~: ?\<O> Un all_acquired ?sb |]
      ==> ?a ~: outstanding_refs is_Write\<^sub>s\<^sub>b ?sb",
     template_implication
      ([template_predicate
         (
            template_app
             (template_app (template_hole 10, template_var 3),
              template_var 2)
            ),
        template_predicate
         (
            template_app
             (template_app
               (template_app
                 (template_app (template_hole 9, template_hole 8),
                  template_var 3),
                template_var 1),
              template_var 2)
            ),
        template_predicate
         (
            template_app
             (template_app
               (template_app (template_hole 7, template_var 3),
                template_var 1),
              template_var 2)
            ),
        template_predicate
         (
            template_app
             (template_app (template_hole 6, template_var 0),
              template_app
               (template_app (template_hole 5, template_var 1),
                template_var 2))
            ),
        template_negation
         (
            template_predicate
             (
                template_app
                 (template_app (template_hole 6, template_var 0),
                  template_app
                   (template_app (template_hole 3, template_var 1),
                    template_app (template_hole 2, template_var 2)))
                )
            )],
       template_negation
        (
           template_predicate
            (
               template_app
                (template_app (template_hole 6, template_var 0),
                 template_app
                  (template_app (template_hole 1, template_hole 0),
                   template_var 2))
               )
           ))),
    ("ReduceStoreBuffer.read_only_shared_all_until_volatile_write_subset",
     "[| ownership_distinct ?ts; weak_sharing_consis ?ts |]
      ==> read_only (share_all_until_volatile_write ?ts ?\<S>)
          <= read_only ?\<S> Un
             (UN (uu_, uu_, uu_, sb, uu_, \<O>, uu_):set ?ts.
                 \<O> Un
                 all_acquired
                  (takeWhile (Not o is_volatile_Write\<^sub>s\<^sub>b)
                    sb))",
     template_implication
      ([template_predicate
         (template_app (template_hole 19, template_var 1)),
        template_predicate
         (template_app (template_hole 18, template_var 1))],
       template_inequation
        (less_equals,
         template_app
          (template_hole 16,
           template_app
            (template_app (template_hole 15, template_var 1),
             template_var 0)),
         template_app
          (template_app
            (template_hole 14,
             template_app (template_hole 16, template_var 0)),
           template_app
            (template_hole 13,
             template_app
              (template_app
                (template_hole 12,
                 template_app (template_hole 11, t_empty)),
               template_app (template_hole 0, template_var 1))))))),
    ("ReduceStoreBuffer.reads_consistent_unbuffered_snoc",
     "[| buffered_val ?sb ?a = None; ?m ?a = ?v;
         reads_consistent ?pending_write ?\<O> ?m ?sb;
         ?volatile -->
         outstanding_refs is_volatile_Write\<^sub>s\<^sub>b ?sb = {} |]
      ==> reads_consistent ?pending_write ?\<O> ?m
           (?sb @ [Read\<^sub>s\<^sub>b ?volatile ?a ?t ?v])",
     template_implication
      ([template_equation
         (template_app
           (template_app (template_hole 12, template_var 7),
            template_var 6),
          template_hole 11),
        template_equation
         (template_app (template_var 5, template_var 6), template_var 4),
        template_predicate
         (
            template_app
             (template_app
               (template_app
                 (template_app (template_hole 9, template_var 3),
                  template_var 2),
                template_var 5),
              template_var 7)
            ),
        template_predicate
         (
            template_app
             (template_app (template_hole 8, template_var 1),
              template_app
               (template_app
                 (template_hole 7,
                  template_app
                   (template_app (template_hole 6, template_hole 5),
                    template_var 7)),
                template_hole 4))
            )],
       template_predicate
        (
           template_app
            (template_app
              (template_app
                (template_app (template_hole 9, template_var 3),
                 template_var 2),
               template_var 5),
             template_app
              (template_app (template_hole 3, template_var 7),
               template_app
                (template_app
                  (template_hole 2,
                   template_app
                    (template_app
                      (template_app
                        (template_app (template_hole 1, template_var 1),
                         template_var 6),
                       template_var 0),
                     template_var 4)),
                 template_hole 0)))
           ))),
    ("ReduceStoreBuffer.reads_consistent_append",
     "reads_consistent ?pending_write ?\<O> ?m (?xs @ ?ys) =
      (reads_consistent ?pending_write ?\<O> ?m ?xs &
       reads_consistent
        (?pending_write |
         outstanding_refs is_volatile_Write\<^sub>s\<^sub>b ?xs ~= {})
        (acquired True ?xs ?\<O>) (flush ?xs ?m) ?ys &
       (outstanding_refs is_volatile_Write\<^sub>s\<^sub>b ?xs ~= {} -->
        outstanding_refs is_volatile_Read\<^sub>s\<^sub>b ?ys = {}))",
     template_implication
      ([template_predicate
         (
            template_app
             (template_app
               (template_app
                 (template_app (template_hole 13, template_var 4),
                  template_var 3),
                template_var 2),
              template_app
               (template_app (template_hole 12, template_var 1),
                template_var 0))
            )],
       template_predicate
        (
           template_app
            (template_app
              (template_hole 11,
               template_app
                (template_app
                  (template_app
                    (template_app (template_hole 13, template_var 4),
                     template_var 3),
                   template_var 2),
                 template_var 1)),
             template_app
              (template_app
                (template_hole 11,
                 template_app
                  (template_app
                    (template_app
                      (template_app
                        (template_hole 13,
                         template_app
                          (template_app (template_hole 10, template_var 4),
                           template_app
                            (template_hole 9,
                             template_app
                              (template_app
                                (template_hole 8,
                                 template_app
                                  (template_app
                                    (template_hole 7, template_hole 6),
                                   template_var 1)),
                               template_hole 5)))),
                       template_app
                        (template_app
                          (template_app (template_hole 4, template_hole 3),
                           template_var 1),
                         template_var 3)),
                     template_app
                      (template_app (template_hole 2, template_var 1),
                       template_var 2)),
                   template_var 0)),
               template_app
                (template_app
                  (template_hole 1,
                   template_app
                    (template_hole 9,
                     template_app
                      (template_app
                        (template_hole 8,
                         template_app
                          (template_app (template_hole 7, template_hole 6),
                           template_var 1)),
                       template_hole 5))),
                 template_app
                  (template_app
                    (template_hole 8,
                     template_app
                      (template_app (template_hole 7, template_hole 0),
                       template_var 0)),
                   template_hole 5))))
           ))),
    ("ReduceStoreBuffer.in_load_tmps_conv",
     "(?t : load_tmps ?xs) =
      ((EX volatile a. Read volatile a ?t : set ?xs) |
       (EX a sop cond ret A L R W.
           RMW a ?t sop cond ret A L R W : set ?xs))",
     template_equation
      (template_app
        (template_app (template_hole 12, template_var 1),
         template_app (template_hole 11, template_var 0)),
       template_app
        (template_app
          (template_hole 10, template_app (template_hole 9, t_empty)),
         template_app (template_hole 8, t_empty)))),
    ("ReduceStoreBuffer.flush_all_until_volatile_nth_update_unused",
     "[| ?i < length ?ts;
         ?ts ! ?i = (?p, ?is, ?\<theta>, ?sb, ?\<D>, ?\<O>, ?\<R>) |]
      ==> flush_all_until_volatile_write
           (?ts[?i := (?p', ?is', ?\<theta>', ?sb, ?\<D>', ?\<O>', ?\<R>')])
           ?m =
          flush_all_until_volatile_write ?ts ?m",
     template_implication
      ([template_inequation
         (less_than, template_var 15,
          template_app (template_hole 11, template_var 14)),
        template_equation
         (template_app
           (template_app (template_hole 9, template_var 14),
            template_var 15),
          template_app
           (template_app (template_hole 8, template_var 13),
            template_app
             (template_app (template_hole 7, template_var 12),
              template_app
               (template_app (template_hole 6, template_var 11),
                template_app
                 (template_app (template_hole 5, template_var 10),
                  template_app
                   (template_app (template_hole 4, template_var 9),
                    template_app
                     (template_app (template_hole 3, template_var 8),
                      template_var 7)))))))],
       template_equation
        (template_app
          (template_app
            (template_hole 1,
             template_app
              (template_app
                (template_app (template_hole 0, template_var 14),
                 template_var 15),
               template_app
                (template_app (template_hole 8, template_var 6),
                 template_app
                  (template_app (template_hole 7, template_var 5),
                   template_app
                    (template_app (template_hole 6, template_var 4),
                     template_app
                      (template_app (template_hole 5, template_var 10),
                       template_app
                        (template_app (template_hole 4, template_var 3),
                         template_app
                          (template_app (template_hole 3, template_var 2),
                           template_var 1)))))))),
           template_var 0),
         template_app
          (template_app (template_hole 1, template_var 14),
           template_var 0)))),
    ("ReduceStoreBuffer.read_only_read_witness",
     "[| non_volatile_owned_or_read_only True ?\<S> ?\<O> ?sb;
         ?a : read_only_reads ?\<O> ?sb |]
      ==> EX xs ys t v.
             ?sb = xs @ Read\<^sub>s\<^sub>b False ?a t v # ys &
             ?a : read_only (share xs ?\<S>) &
             ?a ~: read_only_reads ?\<O> xs",
     template_implication
      ([template_predicate
         (
            template_app
             (template_app
               (template_app
                 (template_app (template_hole 14, template_hole 13),
                  template_var 3),
                template_var 2),
              template_var 1)
            ),
        template_predicate
         (
            template_app
             (template_app (template_hole 12, template_var 0),
              template_app
               (template_app (template_hole 11, template_var 2),
                template_var 1))
            )],
       template_predicate (template_app (template_hole 10, t_empty)))),
    ("ReduceStoreBuffer.reads_consistent_mem_eq_on_unforwarded_non_volatile_reads_drop",
     "[| ALL a:?A Un ?W. ?m' a = ?m a;
         unforwarded_non_volatile_reads
          (dropWhile (Not o is_volatile_Write\<^sub>s\<^sub>b) ?sb) ?W
         <= ?A;
         acquired_reads True
          (takeWhile (Not o is_volatile_Write\<^sub>s\<^sub>b) ?sb) ?\<O>
         <= ?A;
         reads_consistent False ?\<O> ?m ?sb |]
      ==> reads_consistent False ?\<O> ?m' ?sb",
     template_implication
      ([template_predicate
         (
            template_app
             (template_app
               (template_hole 13,
                template_app
                 (template_app (template_hole 12, template_var 5),
                  template_var 4)),
              t_empty)
            ),
        template_inequation
         (less_equals,
          template_app
           (template_app
             (template_hole 9,
              template_app
               (template_app
                 (template_hole 8,
                  template_app
                   (template_app (template_hole 7, template_hole 6),
                    template_hole 5)),
                template_var 1)),
            template_var 4),
          template_var 5),
        template_inequation
         (less_equals,
          template_app
           (template_app
             (template_app (template_hole 4, template_hole 3),
              template_app
               (template_app
                 (template_hole 2,
                  template_app
                   (template_app (template_hole 7, template_hole 6),
                    template_hole 5)),
                template_var 1)),
            template_var 0),
          template_var 5),
        template_predicate
         (
            template_app
             (template_app
               (template_app
                 (template_app (template_hole 1, template_hole 0),
                  template_var 0),
                template_var 2),
              template_var 1)
            )],
       template_predicate
        (
           template_app
            (template_app
              (template_app
                (template_app (template_hole 1, template_hole 0),
                 template_var 0),
               template_var 3),
             template_var 1)
           ))),
    ("ReduceStoreBuffer.flush_all_until_volatile_write_update_other",
     "ALL j<length ?ts.
         let (uu_, uu_, uu_, sb\<^sub>j, uu_, uu_, uu_) = ?ts ! j
         in ?a ~: outstanding_refs is_non_volatile_Write\<^sub>s\<^sub>b
                   (takeWhile (Not o is_volatile_Write\<^sub>s\<^sub>b)
                     sb\<^sub>j) ==>
      flush_all_until_volatile_write ?ts (?m(?a := ?v)) =
      (flush_all_until_volatile_write ?ts ?m)(?a := ?v)",
     template_implication
      ([template_predicate (template_app (template_hole 21, t_empty))],
       template_equation
        (template_app
          (template_app (template_hole 1, template_var 3),
           template_app
            (template_app
              (template_app (template_hole 0, template_var 1),
               template_var 2),
             template_var 0)),
         template_app
          (template_app
            (template_app
              (template_hole 0,
               template_app
                (template_app (template_hole 1, template_var 3),
                 template_var 1)),
             template_var 2),
           template_var 0)))),
    ("ReduceStoreBuffer.share_all_until_volatile_write_Fence_commute",
     "[| ?i < length ?ls;
         ?ls ! ?i = (?p, Fence # ?is, ?\<theta>, [], ?\<D>, ?\<O>, ?\<R>) |]
      ==> share_all_until_volatile_write
           (?ls[?i := (?p, ?is, ?\<theta>, [], ?\<D>', ?\<O>, ?\<R>')]) ?S =
          share_all_until_volatile_write ?ls ?S",
     template_implication
      ([template_inequation
         (less_than, template_var 10,
          template_app (template_hole 14, template_var 9)),
        template_equation
         (template_app
           (template_app (template_hole 12, template_var 9),
            template_var 10),
          template_app
           (template_app (template_hole 11, template_var 8),
            template_app
             (template_app
               (template_hole 10,
                template_app
                 (template_app (template_hole 9, template_hole 8),
                  template_var 7)),
              template_app
               (template_app (template_hole 7, template_var 6),
                template_app
                 (template_app (template_hole 6, template_hole 5),
                  template_app
                   (template_app (template_hole 4, template_var 5),
                    template_app
                     (template_app (template_hole 3, template_var 4),
                      template_var 3)))))))],
       template_equation
        (template_app
          (template_app
            (template_hole 1,
             template_app
              (template_app
                (template_app (template_hole 0, template_var 9),
                 template_var 10),
               template_app
                (template_app (template_hole 11, template_var 8),
                 template_app
                  (template_app (template_hole 10, template_var 7),
                   template_app
                    (template_app (template_hole 7, template_var 6),
                     template_app
                      (template_app (template_hole 6, template_hole 5),
                       template_app
                        (template_app (template_hole 4, template_var 2),
                         template_app
                          (template_app (template_hole 3, template_var 4),
                           template_var 1)))))))),
           template_var 0),
         template_app
          (template_app (template_hole 1, template_var 9),
           template_var 0)))),
    ("ReduceStoreBuffer.safeE",
     "[| safe_free_flowing (?ts, ?m, ?\<S>); ?i < length ?ts;
         ?ts ! ?i = (?p, ?is, ?\<theta>, ?x, ?\<D>, ?\<O>, ?\<R>) |]
      ==> map owned
           ?ts,?i\<turnstile> (?is, ?\<theta>, ?m, ?\<D>, ?\<O>,
                               ?\<S>) \<surd>",
     template_implication
      ([template_predicate
         (
            template_app
             (template_hole 20,
              template_app
               (template_app (template_hole 19, template_var 10),
                template_app
                 (template_app (template_hole 18, template_var 9),
                  template_var 8)))
            ),
        template_inequation
         (less_than, template_var 7,
          template_app (template_hole 16, template_var 10)),
        template_equation
         (template_app
           (template_app (template_hole 14, template_var 10),
            template_var 7),
          template_app
           (template_app (template_hole 13, template_var 6),
            template_app
             (template_app (template_hole 12, template_var 5),
              template_app
               (template_app (template_hole 11, template_var 4),
                template_app
                 (template_app (template_hole 10, template_var 3),
                  template_app
                   (template_app (template_hole 9, template_var 2),
                    template_app
                     (template_app (template_hole 8, template_var 1),
                      template_var 0)))))))],
       template_predicate
        (
           template_app
            (template_app
              (template_app
                (template_hole 7,
                 template_app
                  (template_app (template_hole 6, template_hole 5),
                   template_var 10)),
               template_var 7),
             template_app
              (template_app (template_hole 4, template_var 5),
               template_app
                (template_app (template_hole 3, template_var 4),
                 template_app
                  (template_app (template_hole 2, template_var 9),
                   template_app
                    (template_app (template_hole 1, template_var 2),
                     template_app
                      (template_app (template_hole 0, template_var 1),
                       template_var 8))))))
           ))),
    ("ReduceStoreBuffer.outstanding_refs_non_volatile_Read\<^sub>s\<^sub>b_all_acquired_dropWhile'",
     "[| reads_consistent ?pending_write ?\<O> ?m ?sb;
         non_volatile_owned_or_read_only ?pending_write ?\<S> ?\<O> ?sb;
         ?a : outstanding_refs is_non_volatile_Read\<^sub>s\<^sub>b
               (dropWhile (Not o is_volatile_Write\<^sub>s\<^sub>b) ?sb) |]
      ==> ?a : ?\<O> |
          ?a : all_acquired ?sb |
          ?a : read_only_reads
                (acquired True
                  (takeWhile (Not o is_volatile_Write\<^sub>s\<^sub>b) ?sb)
                  ?\<O>)
                (dropWhile (Not o is_volatile_Write\<^sub>s\<^sub>b) ?sb)",
     template_implication
      ([template_predicate
         (
            template_app
             (template_app
               (template_app
                 (template_app (template_hole 14, template_var 5),
                  template_var 4),
                template_var 3),
              template_var 2)
            ),
        template_predicate
         (
            template_app
             (template_app
               (template_app
                 (template_app (template_hole 13, template_var 5),
                  template_var 1),
                template_var 4),
              template_var 2)
            ),
        template_predicate
         (
            template_app
             (template_app (template_hole 12, template_var 0),
              template_app
               (template_app (template_hole 11, template_hole 10),
                template_app
                 (template_app
                   (template_hole 9,
                    template_app
                     (template_app (template_hole 8, template_hole 7),
                      template_hole 6)),
                  template_var 2)))
            )],
       template_predicate
        (
           template_app
            (template_app
              (template_hole 5,
               template_app
                (template_app (template_hole 12, template_var 0),
                 template_var 4)),
             template_app
              (template_app
                (template_hole 5,
                 template_app
                  (template_app (template_hole 12, template_var 0),
                   template_app (template_hole 4, template_var 2))),
               template_app
                (template_app (template_hole 12, template_var 0),
                 template_app
                  (template_app
                    (template_hole 3,
                     template_app
                      (template_app
                        (template_app (template_hole 2, template_hole 1),
                         template_app
                          (template_app
                            (template_hole 0,
                             template_app
                              (template_app
                                (template_hole 8, template_hole 7),
                               template_hole 6)),
                           template_var 2)),
                       template_var 4)),
                   template_app
                    (template_app
                      (template_hole 9,
                       template_app
                        (template_app (template_hole 8, template_hole 7),
                         template_hole 6)),
                     template_var 2)))))
           ))),
    ("ReduceStoreBuffer.sharing_consistent_share_all_until_volatile_write",
     "[| ownership_distinct ?ts; sharing_consis ?\<S> ?ts; ?i < length ?ts;
         ?ts ! ?i = (?p, ?is, ?\<theta>, ?sb, ?\<D>, ?\<O>, ?\<R>) |]
      ==> sharing_consistent (share_all_until_volatile_write ?ts ?\<S>)
           (acquired True
             (takeWhile (Not o is_volatile_Write\<^sub>s\<^sub>b) ?sb)
             ?\<O>)
           (dropWhile (Not o is_volatile_Write\<^sub>s\<^sub>b) ?sb)",
     template_implication
      ([template_predicate
         (template_app (template_hole 20, template_var 9)),
        template_predicate
         (
            template_app
             (template_app (template_hole 19, template_var 8),
              template_var 9)
            ),
        template_inequation
         (less_than, template_var 7,
          template_app (template_hole 17, template_var 9)),
        template_equation
         (template_app
           (template_app (template_hole 15, template_var 9),
            template_var 7),
          template_app
           (template_app (template_hole 14, template_var 6),
            template_app
             (template_app (template_hole 13, template_var 5),
              template_app
               (template_app (template_hole 12, template_var 4),
                template_app
                 (template_app (template_hole 11, template_var 3),
                  template_app
                   (template_app (template_hole 10, template_var 2),
                    template_app
                     (template_app (template_hole 9, template_var 1),
                      template_var 0)))))))],
       template_predicate
        (
           template_app
            (template_app
              (template_app
                (template_hole 8,
                 template_app
                  (template_app (template_hole 7, template_var 9),
                   template_var 8)),
               template_app
                (template_app
                  (template_app (template_hole 6, template_hole 5),
                   template_app
                    (template_app
                      (template_hole 4,
                       template_app
                        (template_app (template_hole 3, template_hole 2),
                         template_hole 1)),
                     template_var 3)),
                 template_var 1)),
             template_app
              (template_app
                (template_hole 0,
                 template_app
                  (template_app (template_hole 3, template_hole 2),
                   template_hole 1)),
               template_var 3))
           ))),
    ("ReduceStoreBuffer.flush_all_until_volatile_write_Prog\<^sub>s\<^sub>b_commute",
     "[| ?i < length ?ts;
         ?ts ! ?i =
         (?p, ?is, ?\<theta>,
          Prog\<^sub>s\<^sub>b ?p\<^sub>1 ?p\<^sub>2 ?mis # ?sb, ?\<D>,
          ?\<O>, ?\<R>) |]
      ==> flush_all_until_volatile_write
           (?ts[?i := (?p, ?is, ?\<theta>, ?sb, ?\<D>', ?\<O>, ?\<R>')])
           ?m =
          flush_all_until_volatile_write ?ts ?m",
     template_implication
      ([template_inequation
         (less_than, template_var 14,
          template_app (template_hole 13, template_var 13)),
        template_equation
         (template_app
           (template_app (template_hole 11, template_var 13),
            template_var 14),
          template_app
           (template_app (template_hole 10, template_var 12),
            template_app
             (template_app (template_hole 9, template_var 11),
              template_app
               (template_app (template_hole 8, template_var 10),
                template_app
                 (template_app
                   (template_hole 7,
                    template_app
                     (template_app
                       (template_hole 6,
                        template_app
                         (template_app
                           (template_app (template_hole 5, template_var 9),
                            template_var 8),
                          template_var 7)),
                      template_var 6)),
                  template_app
                   (template_app (template_hole 4, template_var 5),
                    template_app
                     (template_app (template_hole 3, template_var 4),
                      template_var 3)))))))],
       template_equation
        (template_app
          (template_app
            (template_hole 1,
             template_app
              (template_app
                (template_app (template_hole 0, template_var 13),
                 template_var 14),
               template_app
                (template_app (template_hole 10, template_var 12),
                 template_app
                  (template_app (template_hole 9, template_var 11),
                   template_app
                    (template_app (template_hole 8, template_var 10),
                     template_app
                      (template_app (template_hole 7, template_var 6),
                       template_app
                        (template_app (template_hole 4, template_var 2),
                         template_app
                          (template_app (template_hole 3, template_var 4),
                           template_var 1)))))))),
           template_var 0),
         template_app
          (template_app (template_hole 1, template_var 13),
           template_var 0)))),
    ("ReduceStoreBuffer.safe_delayedE",
     "[| safe_delayed (?ts, ?m, ?\<S>); ?i < length ?ts;
         ?ts ! ?i = (?p, ?is, ?\<theta>, ?x, ?\<D>, ?\<O>, ?\<R>) |]
      ==> map owned
           ?ts,map released
                ?ts,?i\<turnstile> (?is, ?\<theta>, ?m, ?\<D>, ?\<O>,
                                    ?\<S>) \<surd>",
     template_implication
      ([template_predicate
         (
            template_app
             (template_hole 20,
              template_app
               (template_app (template_hole 19, template_var 10),
                template_app
                 (template_app (template_hole 18, template_var 9),
                  template_var 8)))
            ),
        template_inequation
         (less_than, template_var 7,
          template_app (template_hole 16, template_var 10)),
        template_equation
         (template_app
           (template_app (template_hole 14, template_var 10),
            template_var 7),
          template_app
           (template_app (template_hole 13, template_var 6),
            template_app
             (template_app (template_hole 12, template_var 5),
              template_app
               (template_app (template_hole 11, template_var 4),
                template_app
                 (template_app (template_hole 10, template_var 3),
                  template_app
                   (template_app (template_hole 9, template_var 2),
                    template_app
                     (template_app (template_hole 8, template_var 1),
                      template_var 0)))))))],
       template_predicate
        (
           template_app
            (template_app
              (template_app
                (template_app
                  (template_hole 7,
                   template_app
                    (template_app (template_hole 6, template_hole 5),
                     template_var 10)),
                 template_app
                  (template_app (template_hole 4, template_hole 3),
                   template_var 10)),
               template_var 7),
             template_app
              (template_app (template_hole 2, template_var 5),
               template_app
                (template_app (template_hole 1, template_var 4),
                 template_app
                  (template_app (template_hole 0, template_var 9),
                   template_app
                    (template_app (template_hole 9, template_var 2),
                     template_app
                      (template_app (template_hole 8, template_var 1),
                       template_var 8))))))
           ))),
    ("ReduceStoreBuffer.flush_all_until_volatile_write_Ghost\<^sub>s\<^sub>b_commute",
     "[| ?i < length ?ts;
         ?ts ! ?i =
         (?p, ?is, ?\<theta>, Ghost\<^sub>s\<^sub>b ?A ?L ?R ?W # ?sb,
          ?\<D>, ?\<O>, ?\<R>) |]
      ==> flush_all_until_volatile_write
           (?ts[?i := (?p', ?is', ?\<theta>', ?sb, ?\<D>', ?\<O>', ?\<R>')])
           ?m =
          flush_all_until_volatile_write ?ts ?m",
     template_implication
      ([template_inequation
         (less_than, template_var 19,
          template_app (template_hole 13, template_var 18)),
        template_equation
         (template_app
           (template_app (template_hole 11, template_var 18),
            template_var 19),
          template_app
           (template_app (template_hole 10, template_var 17),
            template_app
             (template_app (template_hole 9, template_var 16),
              template_app
               (template_app (template_hole 8, template_var 15),
                template_app
                 (template_app
                   (template_hole 7,
                    template_app
                     (template_app
                       (template_hole 6,
                        template_app
                         (template_app
                           (template_app
                             (template_app
                               (template_hole 5, template_var 14),
                              template_var 13),
                            template_var 12),
                          template_var 11)),
                      template_var 10)),
                  template_app
                   (template_app (template_hole 4, template_var 9),
                    template_app
                     (template_app (template_hole 3, template_var 8),
                      template_var 7)))))))],
       template_equation
        (template_app
          (template_app
            (template_hole 1,
             template_app
              (template_app
                (template_app (template_hole 0, template_var 18),
                 template_var 19),
               template_app
                (template_app (template_hole 10, template_var 6),
                 template_app
                  (template_app (template_hole 9, template_var 5),
                   template_app
                    (template_app (template_hole 8, template_var 4),
                     template_app
                      (template_app (template_hole 7, template_var 10),
                       template_app
                        (template_app (template_hole 4, template_var 3),
                         template_app
                          (template_app (template_hole 3, template_var 2),
                           template_var 1)))))))),
           template_var 0),
         template_app
          (template_app (template_hole 1, template_var 18),
           template_var 0)))),
    ("ReduceStoreBuffer.flush_all_until_volatile_write_Read\<^sub>s\<^sub>b_commute",
     "[| ?i < length ?ts;
         ?ts ! ?i =
         (?p, ?is, ?\<theta>, Read\<^sub>s\<^sub>b ?volatile ?a ?t ?v # ?sb,
          ?\<D>, ?\<O>, ?\<R>) |]
      ==> flush_all_until_volatile_write
           (?ts[?i := (?p, ?is, ?\<theta>, ?sb, ?\<D>', ?\<O>, ?\<R>')])
           ?m =
          flush_all_until_volatile_write ?ts ?m",
     template_implication
      ([template_inequation
         (less_than, template_var 15,
          template_app (template_hole 13, template_var 14)),
        template_equation
         (template_app
           (template_app (template_hole 11, template_var 14),
            template_var 15),
          template_app
           (template_app (template_hole 10, template_var 13),
            template_app
             (template_app (template_hole 9, template_var 12),
              template_app
               (template_app (template_hole 8, template_var 11),
                template_app
                 (template_app
                   (template_hole 7,
                    template_app
                     (template_app
                       (template_hole 6,
                        template_app
                         (template_app
                           (template_app
                             (template_app
                               (template_hole 5, template_var 10),
                              template_var 9),
                            template_var 8),
                          template_var 7)),
                      template_var 6)),
                  template_app
                   (template_app (template_hole 4, template_var 5),
                    template_app
                     (template_app (template_hole 3, template_var 4),
                      template_var 3)))))))],
       template_equation
        (template_app
          (template_app
            (template_hole 1,
             template_app
              (template_app
                (template_app (template_hole 0, template_var 14),
                 template_var 15),
               template_app
                (template_app (template_hole 10, template_var 13),
                 template_app
                  (template_app (template_hole 9, template_var 12),
                   template_app
                    (template_app (template_hole 8, template_var 11),
                     template_app
                      (template_app (template_hole 7, template_var 6),
                       template_app
                        (template_app (template_hole 4, template_var 2),
                         template_app
                          (template_app (template_hole 3, template_var 4),
                           template_var 1)))))))),
           template_var 0),
         template_app
          (template_app (template_hole 1, template_var 14),
           template_var 0)))),
    ("ReduceStoreBuffer.weak_sharing_consistent_preserves_distinct_share_all_until_volatile_write",
     "[| ownership_distinct ?ts; read_only_unowned ?\<S> ?ts;
         weak_sharing_consis ?ts; ?i < length ?ts;
         ?ts ! ?i = (?p, ?is, ?\<theta>, ?sb, ?\<D>, ?\<O>, ?\<R>) |]
      ==> acquired True
           (takeWhile (Not o is_volatile_Write\<^sub>s\<^sub>b) ?sb)
           ?\<O> Int
          read_only (share_all_until_volatile_write ?ts ?\<S>) =
          {}",
     template_implication
      ([template_predicate
         (template_app (template_hole 23, template_var 9)),
        template_predicate
         (
            template_app
             (template_app (template_hole 22, template_var 8),
              template_var 9)
            ),
        template_predicate
         (template_app (template_hole 21, template_var 9)),
        template_inequation
         (less_than, template_var 7,
          template_app (template_hole 19, template_var 9)),
        template_equation
         (template_app
           (template_app (template_hole 17, template_var 9),
            template_var 7),
          template_app
           (template_app (template_hole 16, template_var 6),
            template_app
             (template_app (template_hole 15, template_var 5),
              template_app
               (template_app (template_hole 14, template_var 4),
                template_app
                 (template_app (template_hole 13, template_var 3),
                  template_app
                   (template_app (template_hole 12, template_var 2),
                    template_app
                     (template_app (template_hole 11, template_var 1),
                      template_var 0)))))))],
       template_equation
        (template_app
          (template_app
            (template_hole 9,
             template_app
              (template_app
                (template_app (template_hole 8, template_hole 7),
                 template_app
                  (template_app
                    (template_hole 6,
                     template_app
                      (template_app (template_hole 5, template_hole 4),
                       template_hole 3)),
                   template_var 3)),
               template_var 1)),
           template_app
            (template_hole 2,
             template_app
              (template_app (template_hole 1, template_var 9),
               template_var 8))),
         template_hole 0))),
    ("ReduceStoreBuffer.notin_outstanding_non_volatile_takeWhile_Un_lem'",
     "?a ~: (UN (uu_, uu_, uu_, sb, uu_, uu_, uu_):set ?ls.
                outstanding_refs (Not o is_volatile) sb) ==>
      ?a ~: (UN (uu_, uu_, uu_, sb, uu_, uu_, uu_):set ?ls.
                outstanding_refs is_Write\<^sub>s\<^sub>b
                 (takeWhile (Not o is_volatile_Write\<^sub>s\<^sub>b) sb))",
     template_implication
      ([template_negation
         (
            template_predicate
             (
                template_app
                 (template_app (template_hole 15, template_var 1),
                  template_app
                   (template_hole 14,
                    template_app
                     (template_app
                       (template_hole 13,
                        template_app (template_hole 12, t_empty)),
                      template_app (template_hole 3, template_var 0))))
                )
            )],
       template_negation
        (
           template_predicate
            (
               template_app
                (template_app (template_hole 15, template_var 1),
                 template_app
                  (template_hole 14,
                   template_app
                    (template_app
                      (template_hole 13,
                       template_app (template_hole 12, t_empty)),
                     template_app (template_hole 3, template_var 0))))
               )
           ))),
    ("ReduceStoreBuffer.flush_all_until_volatile_write_append_Ghost_commute",
     "[| ?i < length ?ts;
         ?ts ! ?i = (?p, ?is, ?\<theta>, ?sb, ?\<D>, ?\<O>, ?\<R>) |]
      ==> flush_all_until_volatile_write
           (?ts[?i :=
                  (?p', ?is', ?\<theta>',
                   ?sb @ [Ghost\<^sub>s\<^sub>b ?A ?L ?R ?W], ?\<D>',
                   ?\<O>', ?\<R>')])
           ?m =
          flush_all_until_volatile_write ?ts ?m",
     template_implication
      ([template_inequation
         (less_than, template_var 19,
          template_app (template_hole 15, template_var 18)),
        template_equation
         (template_app
           (template_app (template_hole 13, template_var 18),
            template_var 19),
          template_app
           (template_app (template_hole 12, template_var 17),
            template_app
             (template_app (template_hole 11, template_var 16),
              template_app
               (template_app (template_hole 10, template_var 15),
                template_app
                 (template_app (template_hole 9, template_var 14),
                  template_app
                   (template_app (template_hole 8, template_var 13),
                    template_app
                     (template_app (template_hole 7, template_var 12),
                      template_var 11)))))))],
       template_equation
        (template_app
          (template_app
            (template_hole 5,
             template_app
              (template_app
                (template_app (template_hole 4, template_var 18),
                 template_var 19),
               template_app
                (template_app (template_hole 12, template_var 10),
                 template_app
                  (template_app (template_hole 11, template_var 9),
                   template_app
                    (template_app (template_hole 10, template_var 8),
                     template_app
                      (template_app
                        (template_hole 9,
                         template_app
                          (template_app (template_hole 3, template_var 14),
                           template_app
                            (template_app
                              (template_hole 2,
                               template_app
                                (template_app
                                  (template_app
                                    (template_app
(template_hole 1, template_var 7),
                                     template_var 6),
                                   template_var 5),
                                 template_var 4)),
                             template_hole 0))),
                       template_app
                        (template_app (template_hole 8, template_var 3),
                         template_app
                          (template_app (template_hole 7, template_var 2),
                           template_var 1)))))))),
           template_var 0),
         template_app
          (template_app (template_hole 5, template_var 18),
           template_var 0)))),
    ("ReduceStoreBuffer.reads_consistent_flush_all_until_volatile_write",
     "[| valid_ownership_and_sharing ?\<S> ?ts; ?i < length ?ts;
         ?ts ! ?i = (?p, ?is, ?\<theta>, ?sb, ?\<D>, ?\<O>, ?\<R>);
         reads_consistent ?pending_write ?\<O> ?m ?sb |]
      ==> reads_consistent True
           (acquired True
             (takeWhile (Not o is_volatile_Write\<^sub>s\<^sub>b) ?sb)
             ?\<O>)
           (flush_all_until_volatile_write ?ts ?m)
           (dropWhile (Not o is_volatile_Write\<^sub>s\<^sub>b) ?sb)",
     template_implication
      ([template_predicate
         (
            template_app
             (template_app (template_hole 19, template_var 11),
              template_var 10)
            ),
        template_inequation
         (less_than, template_var 9,
          template_app (template_hole 17, template_var 10)),
        template_equation
         (template_app
           (template_app (template_hole 15, template_var 10),
            template_var 9),
          template_app
           (template_app (template_hole 14, template_var 8),
            template_app
             (template_app (template_hole 13, template_var 7),
              template_app
               (template_app (template_hole 12, template_var 6),
                template_app
                 (template_app (template_hole 11, template_var 5),
                  template_app
                   (template_app (template_hole 10, template_var 4),
                    template_app
                     (template_app (template_hole 9, template_var 3),
                      template_var 2))))))),
        template_predicate
         (
            template_app
             (template_app
               (template_app
                 (template_app (template_hole 8, template_var 1),
                  template_var 3),
                template_var 0),
              template_var 5)
            )],
       template_predicate
        (
           template_app
            (template_app
              (template_app
                (template_app (template_hole 8, template_hole 7),
                 template_app
                  (template_app
                    (template_app (template_hole 6, template_hole 7),
                     template_app
                      (template_app
                        (template_hole 5,
                         template_app
                          (template_app (template_hole 4, template_hole 3),
                           template_hole 2)),
                       template_var 5)),
                   template_var 3)),
               template_app
                (template_app (template_hole 1, template_var 10),
                 template_var 0)),
             template_app
              (template_app
                (template_hole 0,
                 template_app
                  (template_app (template_hole 4, template_hole 3),
                   template_hole 2)),
               template_var 5))
           ))),
    ("ReduceStoreBuffer.share_all_until_volatile_write_thread_local",
     "[| ownership_distinct ?ts; sharing_consis ?\<S> ?ts; ?i < length ?ts;
         ?ts ! ?i = (?p, ?is, ?\<theta>, ?sb, ?\<D>, ?\<O>, ?\<R>);
         ?a : ?\<O> Un all_acquired ?sb |]
      ==> share_all_until_volatile_write ?ts ?\<S> ?a =
          share (takeWhile (Not o is_volatile_Write\<^sub>s\<^sub>b) ?sb)
           ?\<S> ?a",
     template_implication
      ([template_predicate
         (template_app (template_hole 21, template_var 10)),
        template_predicate
         (
            template_app
             (template_app (template_hole 20, template_var 9),
              template_var 10)
            ),
        template_inequation
         (less_than, template_var 8,
          template_app (template_hole 18, template_var 10)),
        template_equation
         (template_app
           (template_app (template_hole 16, template_var 10),
            template_var 8),
          template_app
           (template_app (template_hole 15, template_var 7),
            template_app
             (template_app (template_hole 14, template_var 6),
              template_app
               (template_app (template_hole 13, template_var 5),
                template_app
                 (template_app (template_hole 12, template_var 4),
                  template_app
                   (template_app (template_hole 11, template_var 3),
                    template_app
                     (template_app (template_hole 10, template_var 2),
                      template_var 1))))))),
        template_predicate
         (
            template_app
             (template_app (template_hole 9, template_var 0),
              template_app
               (template_app (template_hole 8, template_var 2),
                template_app (template_hole 7, template_var 4)))
            )],
       template_equation
        (template_app
          (template_app
            (template_app (template_hole 5, template_var 10),
             template_var 9),
           template_var 0),
         template_app
          (template_app
            (template_app
              (template_hole 4,
               template_app
                (template_app
                  (template_hole 3,
                   template_app
                    (template_app (template_hole 2, template_hole 1),
                     template_hole 0)),
                 template_var 4)),
             template_var 9),
           template_var 0)))),
    ("ReduceStoreBuffer.share_all_until_volatile_write_RMW_commute",
     "[| ?i < length ?ls;
         ?ls ! ?i =
         (?p, RMW ?a ?t (?D, ?f) ?cond ?ret ?A ?L ?R ?W # ?is, ?\<theta>,
          [], ?\<D>, ?\<O>) |]
      ==> share_all_until_volatile_write
           (?ls[?i := (?p', ?is, ?\<theta>', [], ?\<D>', ?\<O>')]) ?S =
          share_all_until_volatile_write ?ls ?S",
     template_implication
      ([template_inequation
         (less_than, template_var 21,
          template_app (template_hole 14, template_var 20)),
        template_equation
         (template_app
           (template_app (template_hole 12, template_var 20),
            template_var 21),
          template_app
           (template_app (template_hole 11, template_var 19),
            template_app
             (template_app
               (template_hole 10,
                template_app
                 (template_app
                   (template_hole 9,
                    template_app
                     (template_app
                       (template_app
                         (template_app
                           (template_app
                             (template_app
                               (template_app
                                 (template_app
                                   (template_app
                                     (template_hole 8, template_var 18),
                                    template_var 17),
                                  template_app
                                   (template_app
                                     (template_hole 7, template_var 16),
                                    template_var 15)),
                                template_var 14),
                              template_var 13),
                            template_var 12),
                          template_var 11),
                        template_var 10),
                      template_var 9)),
                  template_var 8)),
              template_app
               (template_app (template_hole 6, template_var 7),
                template_app
                 (template_app (template_hole 5, template_hole 4),
                  template_app
                   (template_app (template_hole 3, template_var 6),
                    template_var 5))))))],
       template_equation
        (template_app
          (template_app
            (template_hole 1,
             template_app
              (template_app
                (template_app (template_hole 0, template_var 20),
                 template_var 21),
               template_app
                (template_app (template_hole 11, template_var 4),
                 template_app
                  (template_app (template_hole 10, template_var 8),
                   template_app
                    (template_app (template_hole 6, template_var 3),
                     template_app
                      (template_app (template_hole 5, template_hole 4),
                       template_app
                        (template_app (template_hole 3, template_var 2),
                         template_var 1))))))),
           template_var 0),
         template_app
          (template_app (template_hole 1, template_var 20),
           template_var 0)))),
    ("ReduceStoreBuffer.flush_all_until_volatile_write_append_Prog\<^sub>s\<^sub>b_commute",
     "[| ?i < length ?ts;
         ?ts ! ?i = (?p, ?is, ?\<theta>, ?sb, ?\<D>, ?\<O>, ?\<R>) |]
      ==> flush_all_until_volatile_write
           (?ts[?i :=
                  (?p\<^sub>2, ?is @ ?mis, ?\<theta>,
                   ?sb @ [Prog\<^sub>s\<^sub>b ?p\<^sub>1 ?p\<^sub>2 ?mis],
                   ?\<D>', ?\<O>, ?\<R>')])
           ?m =
          flush_all_until_volatile_write ?ts ?m",
     template_implication
      ([template_inequation
         (less_than, template_var 14,
          template_app (template_hole 16, template_var 13)),
        template_equation
         (template_app
           (template_app (template_hole 14, template_var 13),
            template_var 14),
          template_app
           (template_app (template_hole 13, template_var 12),
            template_app
             (template_app (template_hole 12, template_var 11),
              template_app
               (template_app (template_hole 11, template_var 10),
                template_app
                 (template_app (template_hole 10, template_var 9),
                  template_app
                   (template_app (template_hole 9, template_var 8),
                    template_app
                     (template_app (template_hole 8, template_var 7),
                      template_var 6)))))))],
       template_equation
        (template_app
          (template_app
            (template_hole 6,
             template_app
              (template_app
                (template_app (template_hole 5, template_var 13),
                 template_var 14),
               template_app
                (template_app (template_hole 13, template_var 5),
                 template_app
                  (template_app
                    (template_hole 12,
                     template_app
                      (template_app (template_hole 4, template_var 11),
                       template_var 4)),
                   template_app
                    (template_app (template_hole 11, template_var 10),
                     template_app
                      (template_app
                        (template_hole 10,
                         template_app
                          (template_app (template_hole 3, template_var 9),
                           template_app
                            (template_app
                              (template_hole 2,
                               template_app
                                (template_app
                                  (template_app
                                    (template_hole 1, template_var 3),
                                   template_var 5),
                                 template_var 4)),
                             template_hole 0))),
                       template_app
                        (template_app (template_hole 9, template_var 2),
                         template_app
                          (template_app (template_hole 8, template_var 7),
                           template_var 1)))))))),
           template_var 0),
         template_app
          (template_app (template_hole 6, template_var 13),
           template_var 0)))),
    ("ReduceStoreBuffer.share_all_until_volatile_write_share_acquired",
     "[| ownership_distinct ?ts; sharing_consis ?\<S> ?ts; ?a ~: dom ?\<S>;
         ?a : dom (share_all_until_volatile_write ?ts ?\<S>) |]
      ==> EX i<length ?ts.
             let (uu_, uu_, uu_, sb, uu_, uu_, uu_) = ?ts ! i
             in ?a : all_shared
                      (takeWhile (Not o is_volatile_Write\<^sub>s\<^sub>b)
                        sb)",
     template_implication
      ([template_predicate
         (template_app (template_hole 21, template_var 2)),
        template_predicate
         (
            template_app
             (template_app (template_hole 20, template_var 1),
              template_var 2)
            ),
        template_negation
         (
            template_predicate
             (
                template_app
                 (template_app (template_hole 18, template_var 0),
                  template_app (template_hole 17, template_var 1))
                )
            ),
        template_predicate
         (
            template_app
             (template_app (template_hole 18, template_var 0),
              template_app
               (template_hole 17,
                template_app
                 (template_app (template_hole 16, template_var 2),
                  template_var 1)))
            )],
       template_predicate (template_app (template_hole 15, t_empty)))),
    ("ReduceStoreBuffer.flush_all_until_volatile_write_append_unflushed",
     "[| outstanding_refs is_volatile_Write\<^sub>s\<^sub>b ?sb ~= {};
         ?i < length ?ts;
         ?ts ! ?i = (?p, ?is, ?xs, ?sb, ?\<D>, ?\<O>, ?\<R>) |]
      ==> flush_all_until_volatile_write
           (?ts[?i := (?p', ?is', ?xs, ?sb @ ?sbx, ?\<D>', ?\<O>, ?\<R>')])
           ?m =
          flush_all_until_volatile_write ?ts ?m",
     template_implication
      ([template_negation
         (
            template_equation
             (template_app
               (template_app (template_hole 16, template_hole 15),
                template_var 14),
              template_hole 14)
            ),
        template_inequation
         (less_than, template_var 13,
          template_app (template_hole 12, template_var 12)),
        template_equation
         (template_app
           (template_app (template_hole 10, template_var 12),
            template_var 13),
          template_app
           (template_app (template_hole 9, template_var 11),
            template_app
             (template_app (template_hole 8, template_var 10),
              template_app
               (template_app (template_hole 7, template_var 9),
                template_app
                 (template_app (template_hole 6, template_var 14),
                  template_app
                   (template_app (template_hole 5, template_var 8),
                    template_app
                     (template_app (template_hole 4, template_var 7),
                      template_var 6)))))))],
       template_equation
        (template_app
          (template_app
            (template_hole 2,
             template_app
              (template_app
                (template_app (template_hole 1, template_var 12),
                 template_var 13),
               template_app
                (template_app (template_hole 9, template_var 5),
                 template_app
                  (template_app (template_hole 8, template_var 4),
                   template_app
                    (template_app (template_hole 7, template_var 9),
                     template_app
                      (template_app
                        (template_hole 6,
                         template_app
                          (template_app (template_hole 0, template_var 14),
                           template_var 3)),
                       template_app
                        (template_app (template_hole 5, template_var 2),
                         template_app
                          (template_app (template_hole 4, template_var 7),
                           template_var 1)))))))),
           template_var 0),
         template_app
          (template_app (template_hole 2, template_var 12),
           template_var 0)))),
    ("ReduceStoreBuffer.share_all_until_volatile_write_thread_local'",
     "[| ownership_distinct ?ts; sharing_consis ?\<S> ?ts; ?i < length ?ts;
         ?ts ! ?i = (?p, ?is, ?\<theta>, ?sb, ?\<D>, ?\<O>, ?\<R>);
         ?a : ?\<O> Un all_acquired ?sb |]
      ==> share (dropWhile (Not o is_volatile_Write\<^sub>s\<^sub>b) ?sb)
           (share_all_until_volatile_write ?ts ?\<S>) ?a =
          share ?sb ?\<S> ?a",
     template_implication
      ([template_predicate
         (template_app (template_hole 21, template_var 10)),
        template_predicate
         (
            template_app
             (template_app (template_hole 20, template_var 9),
              template_var 10)
            ),
        template_inequation
         (less_than, template_var 8,
          template_app (template_hole 18, template_var 10)),
        template_equation
         (template_app
           (template_app (template_hole 16, template_var 10),
            template_var 8),
          template_app
           (template_app (template_hole 15, template_var 7),
            template_app
             (template_app (template_hole 14, template_var 6),
              template_app
               (template_app (template_hole 13, template_var 5),
                template_app
                 (template_app (template_hole 12, template_var 4),
                  template_app
                   (template_app (template_hole 11, template_var 3),
                    template_app
                     (template_app (template_hole 10, template_var 2),
                      template_var 1))))))),
        template_predicate
         (
            template_app
             (template_app (template_hole 9, template_var 0),
              template_app
               (template_app (template_hole 8, template_var 2),
                template_app (template_hole 7, template_var 4)))
            )],
       template_equation
        (template_app
          (template_app
            (template_app
              (template_hole 5,
               template_app
                (template_app
                  (template_hole 4,
                   template_app
                    (template_app (template_hole 3, template_hole 2),
                     template_hole 1)),
                 template_var 4)),
             template_app
              (template_app (template_hole 0, template_var 10),
               template_var 9)),
           template_var 0),
         template_app
          (template_app
            (template_app (template_hole 5, template_var 4),
             template_var 9),
           template_var 0)))),
    ("ReduceStoreBuffer.in_store_sops_conv",
     "(?sop : store_sops ?xs) =
      ((EX volatile a A L R W. Write volatile a ?sop A L R W : set ?xs) |
       (EX a t cond ret A L R W. RMW a t ?sop cond ret A L R W : set ?xs))",
     template_equation
      (template_app
        (template_app (template_hole 11, template_var 1),
         template_app (template_hole 10, template_var 0)),
       template_app
        (template_app
          (template_hole 9, template_app (template_hole 8, t_empty)),
         template_app (template_hole 7, t_empty)))),
    ("ReduceStoreBuffer.share_all_until_volatile_write_Read_commute",
     "[| ?i < length ?ls;
         ?ls ! ?i =
         (?p, Read ?volatile ?a ?t # ?is, ?\<theta>, ?sb, ?\<D>, ?\<O>) |]
      ==> share_all_until_volatile_write
           (?ls[?i :=
                  (?p, ?is, ?\<theta>(?t |-> ?v),
                   ?sb @ [Read\<^sub>s\<^sub>b ?volatile ?a ?t ?v], ?\<D>',
                   ?\<O>)])
           ?S =
          share_all_until_volatile_write ?ls ?S",
     template_implication
      ([template_inequation
         (less_than, template_var 13,
          template_app (template_hole 18, template_var 12)),
        template_equation
         (template_app
           (template_app (template_hole 16, template_var 12),
            template_var 13),
          template_app
           (template_app (template_hole 15, template_var 11),
            template_app
             (template_app
               (template_hole 14,
                template_app
                 (template_app
                   (template_hole 13,
                    template_app
                     (template_app
                       (template_app (template_hole 12, template_var 10),
                        template_var 9),
                      template_var 8)),
                  template_var 7)),
              template_app
               (template_app (template_hole 11, template_var 6),
                template_app
                 (template_app (template_hole 10, template_var 5),
                  template_app
                   (template_app (template_hole 9, template_var 4),
                    template_var 3))))))],
       template_equation
        (template_app
          (template_app
            (template_hole 7,
             template_app
              (template_app
                (template_app (template_hole 6, template_var 12),
                 template_var 13),
               template_app
                (template_app (template_hole 15, template_var 11),
                 template_app
                  (template_app (template_hole 14, template_var 7),
                   template_app
                    (template_app
                      (template_hole 11,
                       template_app
                        (template_app
                          (template_app (template_hole 5, template_var 6),
                           template_var 8),
                         template_app (template_hole 4, template_var 2))),
                     template_app
                      (template_app
                        (template_hole 10,
                         template_app
                          (template_app (template_hole 3, template_var 5),
                           template_app
                            (template_app
                              (template_hole 2,
                               template_app
                                (template_app
                                  (template_app
                                    (template_app
(template_hole 1, template_var 10),
                                     template_var 9),
                                   template_var 8),
                                 template_var 2)),
                             template_hole 0))),
                       template_app
                        (template_app (template_hole 9, template_var 1),
                         template_var 3))))))),
           template_var 0),
         template_app
          (template_app (template_hole 7, template_var 12),
           template_var 0)))),
    ("ReduceStoreBuffer.read_only_share_all_until_volatile_write_unacquired",
     "[| ownership_distinct ?ts; read_only_unowned ?\<S> ?ts;
         weak_sharing_consis ?ts;
         ALL i<length ?ts.
            let (uu_, uu_, uu_, sb, uu_, \<O>, \<R>) = ?ts ! i
            in ?a ~: all_acquired
                      (takeWhile (Not o is_volatile_Write\<^sub>s\<^sub>b)
                        sb);
         ?a : read_only ?\<S> |]
      ==> ?a : read_only (share_all_until_volatile_write ?ts ?\<S>)",
     template_implication
      ([template_predicate
         (template_app (template_hole 22, template_var 2)),
        template_predicate
         (
            template_app
             (template_app (template_hole 21, template_var 1),
              template_var 2)
            ),
        template_predicate
         (template_app (template_hole 20, template_var 2)),
        template_predicate (template_app (template_hole 19, t_empty)),
        template_predicate
         (
            template_app
             (template_app (template_hole 6, template_var 0),
              template_app (template_hole 1, template_var 1))
            )],
       template_predicate
        (
           template_app
            (template_app (template_hole 6, template_var 0),
             template_app
              (template_hole 1,
               template_app
                (template_app (template_hole 0, template_var 2),
                 template_var 1)))
           ))),
    ("ReduceStoreBuffer.reads_consistent_flush_all_until_volatile_write_aux",
     "[| outstanding_refs is_volatile_Read\<^sub>s\<^sub>b ?xs = {};
         reads_consistent ?pending_write ?\<O>' ?m ?xs;
         ALL i<length ?ts.
            let (p, is, \<theta>, sb, \<D>, \<O>, \<R>) = ?ts ! i
            in outstanding_refs (Not o is_volatile_Read\<^sub>s\<^sub>b)
                ?xs Int
               outstanding_refs is_non_volatile_Write\<^sub>s\<^sub>b
                (takeWhile (Not o is_volatile_Write\<^sub>s\<^sub>b) sb) =
               {} |]
      ==> reads_consistent ?pending_write ?\<O>'
           (flush_all_until_volatile_write ?ts ?m) ?xs",
     template_implication
      ([template_equation
         (template_app
           (template_app (template_hole 24, template_hole 23),
            template_var 4),
          template_hole 22),
        template_predicate
         (
            template_app
             (template_app
               (template_app
                 (template_app (template_hole 21, template_var 3),
                  template_var 2),
                template_var 1),
              template_var 4)
            ),
        template_predicate (template_app (template_hole 20, t_empty))],
       template_predicate
        (
           template_app
            (template_app
              (template_app
                (template_app (template_hole 21, template_var 3),
                 template_var 2),
               template_app
                (template_app (template_hole 0, template_var 0),
                 template_var 1)),
             template_var 4)
           ))),
    ("ReduceStoreBuffer.share_all_until_volatile_write_append_Ghost\<^sub>s\<^sub>b'",
     "[| outstanding_refs is_volatile_Write\<^sub>s\<^sub>b ?sb ~= {};
         ?i < length ?ts;
         ?ts ! ?i = (?p, ?is, ?\<theta>, ?sb, ?\<D>, ?\<O>, ?\<R>) |]
      ==> share_all_until_volatile_write ?ts ?\<S> =
          share_all_until_volatile_write
           (?ts[?i :=
                  (?p', ?is', ?\<theta>',
                   ?sb @ [Ghost\<^sub>s\<^sub>b ?A ?L ?R ?W], ?\<D>',
                   ?\<O>', ?\<R>')])
           ?\<S>",
     template_implication
      ([template_negation
         (
            template_equation
             (template_app
               (template_app (template_hole 19, template_hole 18),
                template_var 19),
              template_hole 17)
            ),
        template_inequation
         (less_than, template_var 18,
          template_app (template_hole 15, template_var 17)),
        template_equation
         (template_app
           (template_app (template_hole 13, template_var 17),
            template_var 18),
          template_app
           (template_app (template_hole 12, template_var 16),
            template_app
             (template_app (template_hole 11, template_var 15),
              template_app
               (template_app (template_hole 10, template_var 14),
                template_app
                 (template_app (template_hole 9, template_var 19),
                  template_app
                   (template_app (template_hole 8, template_var 13),
                    template_app
                     (template_app (template_hole 7, template_var 12),
                      template_var 11)))))))],
       template_equation
        (template_app
          (template_app (template_hole 5, template_var 17),
           template_var 10),
         template_app
          (template_app
            (template_hole 5,
             template_app
              (template_app
                (template_app (template_hole 4, template_var 17),
                 template_var 18),
               template_app
                (template_app (template_hole 12, template_var 9),
                 template_app
                  (template_app (template_hole 11, template_var 8),
                   template_app
                    (template_app (template_hole 10, template_var 7),
                     template_app
                      (template_app
                        (template_hole 9,
                         template_app
                          (template_app (template_hole 3, template_var 19),
                           template_app
                            (template_app
                              (template_hole 2,
                               template_app
                                (template_app
                                  (template_app
                                    (template_app
(template_hole 1, template_var 6),
                                     template_var 5),
                                   template_var 4),
                                 template_var 3)),
                             template_hole 0))),
                       template_app
                        (template_app (template_hole 8, template_var 2),
                         template_app
                          (template_app (template_hole 7, template_var 1),
                           template_var 0)))))))),
           template_var 10)))),
    ("ReduceStoreBuffer.flush_all_until_volatile_write_Read_commute",
     "[| ?i < length ?ls;
         ?ls ! ?i =
         (?p, Read ?volatile ?a ?t # ?is, ?\<theta>, ?sb, ?\<D>, ?\<O>,
          ?\<R>) |]
      ==> flush_all_until_volatile_write
           (?ls[?i :=
                  (?p, ?is, ?\<theta>(?t |-> ?v),
                   ?sb @ [Read\<^sub>s\<^sub>b ?volatile ?a ?t ?v], ?\<D>',
                   ?\<O>', ?\<R>')])
           ?m =
          flush_all_until_volatile_write ?ls ?m",
     template_implication
      ([template_inequation
         (less_than, template_var 16,
          template_app (template_hole 19, template_var 15)),
        template_equation
         (template_app
           (template_app (template_hole 17, template_var 15),
            template_var 16),
          template_app
           (template_app (template_hole 16, template_var 14),
            template_app
             (template_app
               (template_hole 15,
                template_app
                 (template_app
                   (template_hole 14,
                    template_app
                     (template_app
                       (template_app (template_hole 13, template_var 13),
                        template_var 12),
                      template_var 11)),
                  template_var 10)),
              template_app
               (template_app (template_hole 12, template_var 9),
                template_app
                 (template_app (template_hole 11, template_var 8),
                  template_app
                   (template_app (template_hole 10, template_var 7),
                    template_app
                     (template_app (template_hole 9, template_var 6),
                      template_var 5)))))))],
       template_equation
        (template_app
          (template_app
            (template_hole 7,
             template_app
              (template_app
                (template_app (template_hole 6, template_var 15),
                 template_var 16),
               template_app
                (template_app (template_hole 16, template_var 14),
                 template_app
                  (template_app (template_hole 15, template_var 10),
                   template_app
                    (template_app
                      (template_hole 12,
                       template_app
                        (template_app
                          (template_app (template_hole 5, template_var 9),
                           template_var 11),
                         template_app (template_hole 4, template_var 4))),
                     template_app
                      (template_app
                        (template_hole 11,
                         template_app
                          (template_app (template_hole 3, template_var 8),
                           template_app
                            (template_app
                              (template_hole 2,
                               template_app
                                (template_app
                                  (template_app
                                    (template_app
(template_hole 1, template_var 13),
                                     template_var 12),
                                   template_var 11),
                                 template_var 4)),
                             template_hole 0))),
                       template_app
                        (template_app (template_hole 10, template_var 3),
                         template_app
                          (template_app (template_hole 9, template_var 2),
                           template_var 1)))))))),
           template_var 0),
         template_app
          (template_app (template_hole 7, template_var 15),
           template_var 0)))),
    ("ReduceStoreBuffer.share_all_until_volatile_write_unowned",
     "[| ownership_distinct ?ts; sharing_consis ?\<S> ?ts;
         ALL i p is \<theta> sb \<D> \<O> \<R>.
            i < length ?ts -->
            ?ts ! i = (p, is, \<theta>, sb, \<D>, \<O>, \<R>) -->
            ?a ~: \<O> Un all_acquired sb |]
      ==> share_all_until_volatile_write ?ts ?\<S> ?a = ?\<S> ?a",
     template_implication
      ([template_predicate
         (template_app (template_hole 26, template_var 2)),
        template_predicate
         (
            template_app
             (template_app (template_hole 25, template_var 1),
              template_var 2)
            ),
        template_predicate (template_app (template_hole 24, t_empty))],
       template_equation
        (template_app
          (template_app
            (template_app (template_hole 0, template_var 2),
             template_var 1),
           template_var 0),
         template_app (template_var 1, template_var 0)))),
    ("ReduceStoreBuffer.share_commute",
     "[| sharing_consistent ?\<S> ?\<O> ?sb; all_shared ?sb Int ?L = {};
         all_shared ?sb Int ?A = {}; all_acquired ?sb Int ?R = {};
         all_unshared ?sb Int ?R = {}; all_shared ?sb Int ?R = {} |]
      ==> share ?sb
           (?\<S> \<oplus>\<^bsub>?W\<^esub> ?R \<ominus>\<^bsub>?A\<^esub> ?L) =
          share ?sb
           ?\<S> \<oplus>\<^bsub>?W\<^esub> ?R \<ominus>\<^bsub>?A\<^esub> ?L",
     template_implication
      ([template_predicate
         (
            template_app
             (template_app
               (template_app (template_hole 10, template_var 6),
                template_var 5),
              template_var 4)
            ),
        template_equation
         (template_app
           (template_app
             (template_hole 8,
              template_app (template_hole 7, template_var 4)),
            template_var 3),
          template_hole 6),
        template_equation
         (template_app
           (template_app
             (template_hole 8,
              template_app (template_hole 7, template_var 4)),
            template_var 2),
          template_hole 6),
        template_equation
         (template_app
           (template_app
             (template_hole 8,
              template_app (template_hole 5, template_var 4)),
            template_var 1),
          template_hole 6),
        template_equation
         (template_app
           (template_app
             (template_hole 8,
              template_app (template_hole 4, template_var 4)),
            template_var 1),
          template_hole 6),
        template_equation
         (template_app
           (template_app
             (template_hole 8,
              template_app (template_hole 7, template_var 4)),
            template_var 1),
          template_hole 6)],
       template_equation
        (template_app
          (template_app (template_hole 2, template_var 4),
           template_app
            (template_app
              (template_app
                (template_hole 1,
                 template_app
                  (template_app
                    (template_app (template_hole 0, template_var 6),
                     template_var 0),
                   template_var 1)),
               template_var 2),
             template_var 3)),
         template_app
          (template_app
            (template_app
              (template_hole 1,
               template_app
                (template_app
                  (template_app
                    (template_hole 0,
                     template_app
                      (template_app (template_hole 2, template_var 4),
                       template_var 6)),
                   template_var 0),
                 template_var 1)),
             template_var 2),
           template_var 3)))),
    ("ReduceStoreBuffer.flush_all_until_volatile_write_append_volatile_write_commute",
     "[| outstanding_refs is_volatile_Write\<^sub>s\<^sub>b ?sb = {};
         ?i < length ?ts;
         ?ts ! ?i = (?p, ?is, ?\<theta>, ?sb, ?\<D>, ?\<O>, ?\<R>) |]
      ==> flush_all_until_volatile_write
           (?ts[?i :=
                  (?p', ?is', ?\<theta>,
                   ?sb @
                   [Write\<^sub>s\<^sub>b True ?a ?sop ?v ?A ?L ?R ?W],
                   ?\<D>', ?\<O>, ?\<R>')])
           ?m =
          flush_all_until_volatile_write ?ts ?m",
     template_implication
      ([template_equation
         (template_app
           (template_app (template_hole 20, template_hole 19),
            template_var 20),
          template_hole 18),
        template_inequation
         (less_than, template_var 19,
          template_app (template_hole 16, template_var 18)),
        template_equation
         (template_app
           (template_app (template_hole 14, template_var 18),
            template_var 19),
          template_app
           (template_app (template_hole 13, template_var 17),
            template_app
             (template_app (template_hole 12, template_var 16),
              template_app
               (template_app (template_hole 11, template_var 15),
                template_app
                 (template_app (template_hole 10, template_var 20),
                  template_app
                   (template_app (template_hole 9, template_var 14),
                    template_app
                     (template_app (template_hole 8, template_var 13),
                      template_var 12)))))))],
       template_equation
        (template_app
          (template_app
            (template_hole 6,
             template_app
              (template_app
                (template_app (template_hole 5, template_var 18),
                 template_var 19),
               template_app
                (template_app (template_hole 13, template_var 11),
                 template_app
                  (template_app (template_hole 12, template_var 10),
                   template_app
                    (template_app (template_hole 11, template_var 15),
                     template_app
                      (template_app
                        (template_hole 10,
                         template_app
                          (template_app (template_hole 4, template_var 20),
                           template_app
                            (template_app
                              (template_hole 3,
                               template_app
                                (template_app
                                  (template_app
                                    (template_app
(template_app
  (template_app
    (template_app
      (template_app (template_hole 2, template_hole 1), template_var 9),
     template_var 8),
   template_var 7),
 template_var 6),
                                     template_var 5),
                                   template_var 4),
                                 template_var 3)),
                             template_hole 0))),
                       template_app
                        (template_app (template_hole 9, template_var 2),
                         template_app
                          (template_app (template_hole 8, template_var 13),
                           template_var 1)))))))),
           template_var 0),
         template_app
          (template_app (template_hole 6, template_var 18),
           template_var 0)))),
    ("ReduceStoreBuffer.share_all_until_volatile_write_update_sb",
     "[| !!S. share
               (takeWhile (Not o is_volatile_Write\<^sub>s\<^sub>b) ?sb')
               S =
              share
               (takeWhile (Not o is_volatile_Write\<^sub>s\<^sub>b) ?sb) S;
         ?i < length ?ts;
         ?ts ! ?i = (?p, ?is, ?\<theta>, ?sb, ?\<D>, ?\<O>, ?\<R>) |]
      ==> share_all_until_volatile_write ?ts ?\<S> =
          share_all_until_volatile_write
           (?ts[?i :=
                  (?p', ?is', ?\<theta>', ?sb', ?\<D>', ?\<O>', ?\<R>')])
           ?\<S>",
     template_implication
      ([template_predicate (template_app (template_hole 19, t_empty)),
        template_inequation
         (less_than, template_var 14,
          template_app (template_hole 10, template_var 13)),
        template_equation
         (template_app
           (template_app (template_hole 8, template_var 13),
            template_var 14),
          template_app
           (template_app (template_hole 7, template_var 12),
            template_app
             (template_app (template_hole 6, template_var 11),
              template_app
               (template_app (template_hole 5, template_var 10),
                template_app
                 (template_app (template_hole 4, template_var 15),
                  template_app
                   (template_app (template_hole 3, template_var 9),
                    template_app
                     (template_app (template_hole 2, template_var 8),
                      template_var 7)))))))],
       template_equation
        (template_app
          (template_app (template_hole 1, template_var 13), template_var 6),
         template_app
          (template_app
            (template_hole 1,
             template_app
              (template_app
                (template_app (template_hole 0, template_var 13),
                 template_var 14),
               template_app
                (template_app (template_hole 7, template_var 5),
                 template_app
                  (template_app (template_hole 6, template_var 4),
                   template_app
                    (template_app (template_hole 5, template_var 3),
                     template_app
                      (template_app (template_hole 4, template_var 16),
                       template_app
                        (template_app (template_hole 3, template_var 2),
                         template_app
                          (template_app (template_hole 2, template_var 1),
                           template_var 0)))))))),
           template_var 6)))),
    ("ReduceStoreBuffer.share_all_until_volatile_write_Write_commute",
     "[| ?i < length ?ls;
         ?ls ! ?i =
         (?p, Write ?volatile ?a (?D, ?f) ?A ?L ?R ?W # ?is, ?\<theta>, ?sb,
          ?\<D>, ?\<O>) |]
      ==> share_all_until_volatile_write
           (?ls[?i :=
                  (?p, ?is, ?\<theta>,
                   ?sb @
                   [Write\<^sub>s\<^sub>b ?volatile ?a ?t (?f ?\<theta>) ?A
                     ?L ?R ?W],
                   ?\<D>', ?\<O>)])
           ?S =
          share_all_until_volatile_write ?ls ?S",
     template_implication
      ([template_inequation
         (less_than, template_var 18,
          template_app (template_hole 17, template_var 17)),
        template_equation
         (template_app
           (template_app (template_hole 15, template_var 17),
            template_var 18),
          template_app
           (template_app (template_hole 14, template_var 16),
            template_app
             (template_app
               (template_hole 13,
                template_app
                 (template_app
                   (template_hole 12,
                    template_app
                     (template_app
                       (template_app
                         (template_app
                           (template_app
                             (template_app
                               (template_app
                                 (template_hole 11, template_var 15),
                                template_var 14),
                              template_app
                               (template_app
                                 (template_hole 10, template_var 13),
                                template_var 12)),
                            template_var 11),
                          template_var 10),
                        template_var 9),
                      template_var 8)),
                  template_var 7)),
              template_app
               (template_app (template_hole 9, template_var 6),
                template_app
                 (template_app (template_hole 8, template_var 5),
                  template_app
                   (template_app (template_hole 7, template_var 4),
                    template_var 3))))))],
       template_equation
        (template_app
          (template_app
            (template_hole 5,
             template_app
              (template_app
                (template_app (template_hole 4, template_var 17),
                 template_var 18),
               template_app
                (template_app (template_hole 14, template_var 16),
                 template_app
                  (template_app (template_hole 13, template_var 7),
                   template_app
                    (template_app (template_hole 9, template_var 6),
                     template_app
                      (template_app
                        (template_hole 8,
                         template_app
                          (template_app (template_hole 3, template_var 5),
                           template_app
                            (template_app
                              (template_hole 2,
                               template_app
                                (template_app
                                  (template_app
                                    (template_app
(template_app
  (template_app
    (template_app
      (template_app (template_hole 1, template_var 15), template_var 14),
     template_var 2),
   template_app (template_var 12, template_var 6)),
 template_var 11),
                                     template_var 10),
                                   template_var 9),
                                 template_var 8)),
                             template_hole 0))),
                       template_app
                        (template_app (template_hole 7, template_var 1),
                         template_var 3))))))),
           template_var 0),
         template_app
          (template_app (template_hole 5, template_var 17),
           template_var 0)))),
    ("ReduceStoreBuffer.split_all_acquired_in",
     "?a : all_acquired ?xs ==>
      (EX sop a' v ys zs A L R W.
          ?xs = ys @ Write\<^sub>s\<^sub>b True a' sop v A L R W # zs &
          ?a : A) |
      (EX A L R W ys zs.
          ?xs = ys @ Ghost\<^sub>s\<^sub>b A L R W # zs & ?a : A)",
     template_implication
      ([template_predicate
         (
            template_app
             (template_app (template_hole 13, template_var 1),
              template_app (template_hole 12, template_var 0))
            )],
       template_predicate
        (
           template_app
            (template_app
              (template_hole 11, template_app (template_hole 10, t_empty)),
             template_app (template_hole 7, t_empty))
           ))),
    ("ReduceStoreBuffer.read_only_read_acquired_witness",
     "[| non_volatile_owned_or_read_only True ?\<S> ?\<O> ?sb;
         sharing_consistent ?\<S> ?\<O> ?sb; ?a ~: read_only ?\<S>;
         ?a ~: ?\<O>; ?a : read_only_reads ?\<O> ?sb |]
      ==> EX xs ys t v.
             ?sb = xs @ Read\<^sub>s\<^sub>b False ?a t v # ys &
             ?a : all_acquired xs &
             ?a : read_only (share xs ?\<S>) &
             ?a ~: read_only_reads ?\<O> xs",
     template_implication
      ([template_predicate
         (
            template_app
             (template_app
               (template_app
                 (template_app (template_hole 16, template_hole 15),
                  template_var 3),
                template_var 2),
              template_var 1)
            ),
        template_predicate
         (
            template_app
             (template_app
               (template_app (template_hole 14, template_var 3),
                template_var 2),
              template_var 1)
            ),
        template_negation
         (
            template_predicate
             (
                template_app
                 (template_app (template_hole 12, template_var 0),
                  template_app (template_hole 11, template_var 3))
                )
            ),
        template_negation
         (
            template_predicate
             (
                template_app
                 (template_app (template_hole 12, template_var 0),
                  template_var 2)
                )
            ),
        template_predicate
         (
            template_app
             (template_app (template_hole 12, template_var 0),
              template_app
               (template_app (template_hole 10, template_var 2),
                template_var 1))
            )],
       template_predicate (template_app (template_hole 9, t_empty)))),
    ("ReduceStoreBuffer.read_only_read_acquired_unforwarded_witness",
     "[| non_volatile_owned_or_read_only True ?\<S> ?\<O> ?sb;
         sharing_consistent ?\<S> ?\<O> ?sb; ?a ~: read_only ?\<S>;
         ?a ~: ?\<O>; ?a : read_only_reads ?\<O> ?sb;
         ?a : unforwarded_non_volatile_reads ?sb ?X |]
      ==> EX xs ys t v.
             ?sb = xs @ Read\<^sub>s\<^sub>b False ?a t v # ys &
             ?a : all_acquired xs &
             ?a ~: outstanding_refs is_Write\<^sub>s\<^sub>b xs",
     template_implication
      ([template_predicate
         (
            template_app
             (template_app
               (template_app
                 (template_app (template_hole 18, template_hole 17),
                  template_var 4),
                template_var 3),
              template_var 2)
            ),
        template_predicate
         (
            template_app
             (template_app
               (template_app (template_hole 16, template_var 4),
                template_var 3),
              template_var 2)
            ),
        template_negation
         (
            template_predicate
             (
                template_app
                 (template_app (template_hole 14, template_var 1),
                  template_app (template_hole 13, template_var 4))
                )
            ),
        template_negation
         (
            template_predicate
             (
                template_app
                 (template_app (template_hole 14, template_var 1),
                  template_var 3)
                )
            ),
        template_predicate
         (
            template_app
             (template_app (template_hole 14, template_var 1),
              template_app
               (template_app (template_hole 12, template_var 3),
                template_var 2))
            ),
        template_predicate
         (
            template_app
             (template_app (template_hole 14, template_var 1),
              template_app
               (template_app (template_hole 11, template_var 2),
                template_var 0))
            )],
       template_predicate (template_app (template_hole 10, t_empty)))),
    ("ReduceStoreBuffer.virtual_memop_step_simulates_direct_memop_step",
     "(?is, ?\<theta>, ?x, ?m, ?\<D>, ?\<O>, ?\<R>,
       ?\<S>) \<rightarrow> (?is', ?\<theta>', ?x', ?m', ?\<D>', ?\<O>',
                             ?\<R>', ?\<S>') ==>
      (?is, ?\<theta>, ?x, ?m, ?\<D>, ?\<O>, (),
       ?\<S>) \<rightarrow>\<^sub>v (?is', ?\<theta>', ?x', ?m', ?\<D>',
                                     ?\<O>', (), ?\<S>')",
     template_implication
      ([template_predicate
         (
            template_app
             (template_app
               (template_app
                 (template_app (template_hole 18, t_empty),
                  template_hole 16),
                template_app
                 (template_app (template_hole 15, template_var 15),
                  template_app
                   (template_app (template_hole 14, template_var 14),
                    template_app
                     (template_app (template_hole 13, template_var 13),
                      template_app
                       (template_app (template_hole 12, template_var 12),
                        template_app
                         (template_app (template_hole 11, template_var 11),
                          template_app
                           (template_app
                             (template_hole 10, template_var 10),
                            template_app
                             (template_app
                               (template_hole 9, template_var 9),
                              template_var 8)))))))),
              template_app
               (template_app (template_hole 15, template_var 7),
                template_app
                 (template_app (template_hole 14, template_var 6),
                  template_app
                   (template_app (template_hole 13, template_var 5),
                    template_app
                     (template_app (template_hole 12, template_var 4),
                      template_app
                       (template_app (template_hole 11, template_var 3),
                        template_app
                         (template_app (template_hole 10, template_var 2),
                          template_app
                           (template_app (template_hole 9, template_var 1),
                            template_var 0))))))))
            )],
       template_predicate
        (
           template_app
            (template_app
              (template_app
                (template_app (template_hole 8, template_hole 7), t_empty),
               template_app
                (template_app (template_hole 6, template_var 15),
                 template_app
                  (template_app (template_hole 5, template_var 14),
                   template_app
                    (template_app (template_hole 4, template_var 13),
                     template_app
                      (template_app (template_hole 3, template_var 12),
                       template_app
                        (template_app (template_hole 2, template_var 11),
                         template_app
                          (template_app (template_hole 1, template_var 10),
                           template_app
                            (template_app
                              (template_hole 0, template_hole 7),
                             template_var 8)))))))),
             template_app
              (template_app (template_hole 6, template_var 7),
               template_app
                (template_app (template_hole 5, template_var 6),
                 template_app
                  (template_app (template_hole 4, template_var 5),
                   template_app
                    (template_app (template_hole 3, template_var 4),
                     template_app
                      (template_app (template_hole 2, template_var 3),
                       template_app
                        (template_app (template_hole 1, template_var 2),
                         template_app
                          (template_app (template_hole 0, template_hole 7),
                           template_var 0))))))))
           ))),
    ("ReduceStoreBuffer.reads_consistent_flush_other'",
     "[| outstanding_refs is_volatile_Write\<^sub>s\<^sub>b ?sb = {};
         outstanding_refs is_non_volatile_Write\<^sub>s\<^sub>b ?sb Int
         (outstanding_refs is_volatile_Write\<^sub>s\<^sub>b ?xs Un
          outstanding_refs is_non_volatile_Write\<^sub>s\<^sub>b ?xs Un
          outstanding_refs is_non_volatile_Read\<^sub>s\<^sub>b
           (dropWhile (Not o is_volatile_Write\<^sub>s\<^sub>b) ?xs) Un
          (outstanding_refs is_non_volatile_Read\<^sub>s\<^sub>b
            (takeWhile (Not o is_volatile_Write\<^sub>s\<^sub>b) ?xs) -
           ?RO) Un
          (?\<O> Un
           all_acquired
            (takeWhile (Not o is_volatile_Write\<^sub>s\<^sub>b) ?xs))) =
         {};
         reads_consistent False ?\<O> ?m ?xs;
         read_only_reads ?\<O>
          (takeWhile (Not o is_volatile_Write\<^sub>s\<^sub>b) ?xs)
         <= ?RO |]
      ==> reads_consistent False ?\<O> (flush ?sb ?m) ?xs",
     template_implication
      ([template_equation
         (template_app
           (template_app (template_hole 20, template_hole 19),
            template_var 4),
          template_hole 18),
        template_equation
         (template_app
           (template_app
             (template_hole 17,
              template_app
               (template_app (template_hole 20, template_hole 16),
                template_var 4)),
            template_app
             (template_app
               (template_hole 15,
                template_app
                 (template_app
                   (template_hole 15,
                    template_app
                     (template_app
                       (template_hole 15,
                        template_app
                         (template_app
                           (template_hole 15,
                            template_app
                             (template_app
                               (template_hole 14, template_hole 13),
                              template_var 3)),
                          template_app
                           (template_app
                             (template_hole 14, template_hole 12),
                            template_var 3))),
                      template_app
                       (template_app (template_hole 14, template_hole 11),
                        template_app
                         (template_app
                           (template_hole 10,
                            template_app
                             (template_app
                               (template_hole 9, template_hole 8),
                              template_hole 13)),
                          template_var 3)))),
                  template_app
                   (template_app
                     (template_hole 7,
                      template_app
                       (template_app (template_hole 14, template_hole 11),
                        template_app
                         (template_app
                           (template_hole 6,
                            template_app
                             (template_app
                               (template_hole 9, template_hole 8),
                              template_hole 13)),
                          template_var 3))),
                    template_var 2))),
              template_app
               (template_app (template_hole 15, template_var 1),
                template_app
                 (template_hole 5,
                  template_app
                   (template_app
                     (template_hole 6,
                      template_app
                       (template_app (template_hole 9, template_hole 8),
                        template_hole 13)),
                    template_var 3))))),
          template_hole 18),
        template_predicate
         (
            template_app
             (template_app
               (template_app
                 (template_app (template_hole 4, template_hole 3),
                  template_var 1),
                template_var 0),
              template_var 3)
            ),
        template_inequation
         (less_equals,
          template_app
           (template_app (template_hole 1, template_var 1),
            template_app
             (template_app
               (template_hole 6,
                template_app
                 (template_app (template_hole 9, template_hole 8),
                  template_hole 13)),
              template_var 3)),
          template_var 2)],
       template_predicate
        (
           template_app
            (template_app
              (template_app
                (template_app (template_hole 4, template_hole 3),
                 template_var 1),
               template_app
                (template_app (template_hole 0, template_var 4),
                 template_var 0)),
             template_var 3)
           ))),
    ("ReduceStoreBuffer.converse_rtranclp_induct_sbh_steps",
     "[| ?r^** (?ts, ?m, ?\<S>) (?ts', ?m', ?\<S>'); ?P ?ts' ?m' ?\<S>';
         !!a aa b ab ac ba.
            [| ?r (a, aa, b) (ab, ac, ba);
               ?r^** (ab, ac, ba) (?ts', ?m', ?\<S>'); ?P ab ac ba |]
            ==> ?P a aa b |]
      ==> ?P ?ts ?m ?\<S>",
     template_implication
      ([template_predicate
         (
            template_app
             (template_app
               (template_app (template_hole 5, template_var 7),
                template_app
                 (template_app (template_hole 4, template_var 6),
                  template_app
                   (template_app (template_hole 3, template_var 5),
                    template_var 4))),
              template_app
               (template_app (template_hole 4, template_var 3),
                template_app
                 (template_app (template_hole 3, template_var 2),
                  template_var 1)))
            ),
        template_predicate
         (
            template_app
             (template_app
               (template_app (template_var 0, template_var 3),
                template_var 2),
              template_var 1)
            ),
        template_predicate (template_app (template_hole 2, t_empty))],
       template_predicate
        (
           template_app
            (template_app
              (template_app (template_var 0, template_var 6),
               template_var 5),
             template_var 4)
           ))),
    ("ReduceStoreBuffer.memop_empty_rels_safe_free_flowing_implies_safe_delayed",
     "[| ?\<O>s,?i\<turnstile> (?is, ?\<theta>, ?m, ?\<D>, ?\<O>,
                                ?\<S>) \<surd>;
         ALL \<R>:set ?\<R>s. \<R> = Map.empty;
         length ?\<O>s = length ?\<R>s;
         ALL a. (ALL i<length ?\<O>s. a ~: ?\<O>s ! i) --> a : dom ?\<S>;
         ?\<O>s ! ?i = ?\<O> |]
      ==> ?\<O>s,?\<R>s,?i\<turnstile> (?is, ?\<theta>, ?m, ?\<D>, ?\<O>,
  ?\<S>) \<surd>",
     template_implication
      ([template_predicate
         (
            template_app
             (template_app
               (template_app (template_hole 21, template_var 8),
                template_var 7),
              template_app
               (template_app (template_hole 20, template_var 6),
                template_app
                 (template_app (template_hole 19, template_var 5),
                  template_app
                   (template_app (template_hole 18, template_var 4),
                    template_app
                     (template_app (template_hole 17, template_var 3),
                      template_app
                       (template_app (template_hole 16, template_var 2),
                        template_var 1))))))
            ),
        template_predicate
         (
            template_app
             (template_app
               (template_hole 15,
                template_app (template_hole 14, template_var 0)),
              t_empty)
            ),
        template_equation
         (template_app (template_hole 10, template_var 8),
          template_app (template_hole 9, template_var 0)),
        template_predicate (template_app (template_hole 8, t_empty)),
        template_equation
         (template_app
           (template_app (template_hole 3, template_var 8), template_var 7),
          template_var 2)],
       template_predicate
        (
           template_app
            (template_app
              (template_app
                (template_app (template_hole 0, template_var 8),
                 template_var 0),
               template_var 7),
             template_app
              (template_app (template_hole 20, template_var 6),
               template_app
                (template_app (template_hole 19, template_var 5),
                 template_app
                  (template_app (template_hole 18, template_var 4),
                   template_app
                    (template_app (template_hole 17, template_var 3),
                     template_app
                      (template_app (template_hole 16, template_var 2),
                       template_var 1))))))
           ))),
    ("ReduceStoreBuffer.distinct_read_tmps_conv",
     "distinct_read_tmps ?xs =
      (ALL i<length ?xs.
          ALL j<length ?xs.
             i ~= j -->
             (case ?xs ! i of
              Read\<^sub>s\<^sub>b x xa t\<^sub>i xb =>
                case ?xs ! j of
                Read\<^sub>s\<^sub>b x xa t\<^sub>j xb =>
                  t\<^sub>i ~= t\<^sub>j
                | _ => True
              | _ => True))",
     template_equation
      (template_app (template_hole 9, template_var 0),
       template_app (template_hole 8, t_empty))),
    ("ReduceStoreBuffer.in_outstanding_refs_cases",
     "[| ?a : outstanding_refs ?P ?xs;
         !!volatile sop v A L R W.
            [| Write\<^sub>s\<^sub>b volatile ?a sop v A L R W : set ?xs;
               ?P (Write\<^sub>s\<^sub>b volatile ?a sop v A L R W) |]
            ==> ?C;
         !!volatile t v.
            [| Read\<^sub>s\<^sub>b volatile ?a t v : set ?xs;
               ?P (Read\<^sub>s\<^sub>b volatile ?a t v) |]
            ==> ?C |]
      ==> ?C",
     template_implication
      ([template_predicate
         (
            template_app
             (template_app (template_hole 9, template_var 3),
              template_app
               (template_app (template_hole 8, template_var 2),
                template_var 1))
            ),
        template_predicate (template_app (template_hole 7, t_empty)),
        template_predicate (template_app (template_hole 7, t_empty))],
       template_predicate (template_var 0))),
    ("ReduceStoreBuffer.acquire_ownership_nth_update",
     "[| ?i < length ?ts;
         ?ts ! ?i = (?p, ?is, ?xs, ?sb, ?\<D>, ?\<O>, ?\<R>) |]
      ==> (UN (uu_, uu_, uu_, uu_, uu_, \<O>,
              uu_):set (?ts[?i :=
                              (?p', ?is', ?xs', ?sb', ?\<D>', ?\<O> Un ?A,
                               ?\<R>')]).
              \<O>) =
          (UN (uu_, uu_, uu_, uu_, uu_, \<O>, uu_):set ?ts. \<O>) Un ?A",
     template_implication
      ([template_inequation
         (less_than, template_var 15,
          template_app (template_hole 20, template_var 14)),
        template_equation
         (template_app
           (template_app (template_hole 18, template_var 14),
            template_var 15),
          template_app
           (template_app (template_hole 17, template_var 13),
            template_app
             (template_app (template_hole 16, template_var 12),
              template_app
               (template_app (template_hole 15, template_var 11),
                template_app
                 (template_app (template_hole 14, template_var 10),
                  template_app
                   (template_app (template_hole 13, template_var 9),
                    template_app
                     (template_app (template_hole 12, template_var 8),
                      template_var 7)))))))],
       template_equation
        (template_app
          (template_hole 10,
           template_app
            (template_app
              (template_hole 9, template_app (template_hole 8, t_empty)),
             template_app
              (template_hole 2,
               template_app
                (template_app
                  (template_app (template_hole 1, template_var 14),
                   template_var 15),
                 template_app
                  (template_app (template_hole 17, template_var 6),
                   template_app
                    (template_app (template_hole 16, template_var 5),
                     template_app
                      (template_app (template_hole 15, template_var 4),
                       template_app
                        (template_app (template_hole 14, template_var 3),
                         template_app
                          (template_app (template_hole 13, template_var 2),
                           template_app
                            (template_app
                              (template_hole 12,
                               template_app
                                (template_app
                                  (template_hole 0, template_var 8),
                                 template_var 1)),
                             template_var 0)))))))))),
         template_app
          (template_app
            (template_hole 0,
             template_app
              (template_hole 10,
               template_app
                (template_app
                  (template_hole 9,
                   template_app (template_hole 8, t_empty)),
                 template_app (template_hole 2, template_var 14)))),
           template_var 1)))),
    ("ReduceStoreBuffer.update_commute",
     "[| ALL a m. a ~: ?G --> ?g m a = m a;
         ALL a m. a : ?G --> ?g (?f m) a = ?g m a;
         ALL a m. a ~: ?F --> ?f m a = m a;
         ALL a m. a : ?F --> ?f (?g m) a = ?f m a; ?G Int ?F = {} |]
      ==> ?f (?g ?m) = ?g (?f ?m)",
     template_implication
      ([template_predicate (template_app (template_hole 9, t_empty)),
        template_predicate (template_app (template_hole 9, t_empty)),
        template_predicate (template_app (template_hole 9, t_empty)),
        template_predicate (template_app (template_hole 9, t_empty)),
        template_equation
         (template_app
           (template_app (template_hole 2, template_var 4), template_var 1),
          template_hole 1)],
       template_equation
        (template_app
          (template_var 2, template_app (template_var 3, template_var 0)),
         template_app
          (template_var 3,
           template_app (template_var 2, template_var 0))))),
    ("ReduceStoreBuffer.flush_all_until_volatile_write_buffered_val_conv",
     "[| outstanding_refs is_volatile_Write\<^sub>s\<^sub>b ?sb = {};
         ?i < length ?ls;
         ?ls ! ?i = (?p, ?is, ?xs, ?sb, ?\<D>, ?\<O>, ?\<R>);
         ALL j<length ?ls.
            ?i ~= j -->
            (let (uu_, uu_, uu_, sb\<^sub>j, uu_, uu_, uu_) = ?ls ! j
             in ?a ~: outstanding_refs is_non_volatile_Write\<^sub>s\<^sub>b
                       (takeWhile (Not o is_volatile_Write\<^sub>s\<^sub>b)
                         sb\<^sub>j)) |]
      ==> flush_all_until_volatile_write ?ls ?m ?a =
          (case buffered_val ?sb ?a of None => ?m ?a | Some v => v)",
     template_implication
      ([template_equation
         (template_app
           (template_app (template_hole 30, template_hole 29),
            template_var 10),
          template_hole 28),
        template_inequation
         (less_than, template_var 9,
          template_app (template_hole 26, template_var 8)),
        template_equation
         (template_app
           (template_app (template_hole 24, template_var 8),
            template_var 9),
          template_app
           (template_app (template_hole 23, template_var 7),
            template_app
             (template_app (template_hole 22, template_var 6),
              template_app
               (template_app (template_hole 21, template_var 5),
                template_app
                 (template_app (template_hole 20, template_var 10),
                  template_app
                   (template_app (template_hole 19, template_var 4),
                    template_app
                     (template_app (template_hole 18, template_var 3),
                      template_var 2))))))),
        template_predicate (template_app (template_hole 17, t_empty))],
       template_equation
        (template_app
          (template_app
            (template_app (template_hole 2, template_var 8),
             template_var 0),
           template_var 1),
         template_app
          (template_app
            (template_app
              (template_hole 1,
               template_app (template_var 0, template_var 1)),
             t_empty),
           template_app
            (template_app (template_hole 0, template_var 10),
             template_var 1))))),
    ("ReduceStoreBuffer.update_commute'",
     "[| ALL a m. a ~: ?G --> ?g m a = m a;
         ALL a m\<^sub>1 m\<^sub>2.
            a : ?G --> ?g m\<^sub>1 a = ?g m\<^sub>2 a;
         ALL a m. a ~: ?F --> ?f m a = m a;
         ALL a m\<^sub>1 m\<^sub>2.
            a : ?F --> ?f m\<^sub>1 a = ?f m\<^sub>2 a;
         ?G Int ?F = {} |]
      ==> ?f (?g ?m) = ?g (?f ?m)",
     template_implication
      ([template_predicate (template_app (template_hole 9, t_empty)),
        template_predicate (template_app (template_hole 9, t_empty)),
        template_predicate (template_app (template_hole 9, t_empty)),
        template_predicate (template_app (template_hole 9, t_empty)),
        template_equation
         (template_app
           (template_app (template_hole 2, template_var 4), template_var 2),
          template_hole 1)],
       template_equation
        (template_app
          (template_var 1, template_app (template_var 3, template_var 0)),
         template_app
          (template_var 3,
           template_app (template_var 1, template_var 0))))),
    ("ReduceStoreBuffer.release_ownership_nth_update",
     "[| ?R <= ?\<O>; ?i < length ?ts;
         ?ts ! ?i = (?p, ?is, ?xs, ?sb, ?\<D>, ?\<O>, ?\<R>);
         ownership_distinct ?ts |]
      ==> (UN (uu_, uu_, uu_, uu_, uu_, \<O>,
              uu_):set (?ts[?i :=
                              (?p', ?is', ?xs', ?sb', ?\<D>', ?\<O> - ?R,
                               ?\<R>')]).
              \<O>) =
          (UN (uu_, uu_, uu_, uu_, uu_, \<O>, uu_):set ?ts. \<O>) - ?R",
     template_implication
      ([template_inequation (less_equals, template_var 15, template_var 14),
        template_inequation
         (less_than, template_var 13,
          template_app (template_hole 21, template_var 12)),
        template_equation
         (template_app
           (template_app (template_hole 19, template_var 12),
            template_var 13),
          template_app
           (template_app (template_hole 18, template_var 11),
            template_app
             (template_app (template_hole 17, template_var 10),
              template_app
               (template_app (template_hole 16, template_var 9),
                template_app
                 (template_app (template_hole 15, template_var 8),
                  template_app
                   (template_app (template_hole 14, template_var 7),
                    template_app
                     (template_app (template_hole 13, template_var 14),
                      template_var 6))))))),
        template_predicate
         (template_app (template_hole 12, template_var 12))],
       template_equation
        (template_app
          (template_hole 10,
           template_app
            (template_app
              (template_hole 9, template_app (template_hole 8, t_empty)),
             template_app
              (template_hole 2,
               template_app
                (template_app
                  (template_app (template_hole 1, template_var 12),
                   template_var 13),
                 template_app
                  (template_app (template_hole 18, template_var 5),
                   template_app
                    (template_app (template_hole 17, template_var 4),
                     template_app
                      (template_app (template_hole 16, template_var 3),
                       template_app
                        (template_app (template_hole 15, template_var 2),
                         template_app
                          (template_app (template_hole 14, template_var 1),
                           template_app
                            (template_app
                              (template_hole 13,
                               template_app
                                (template_app
                                  (template_hole 0, template_var 14),
                                 template_var 15)),
                             template_var 0)))))))))),
         template_app
          (template_app
            (template_hole 0,
             template_app
              (template_hole 10,
               template_app
                (template_app
                  (template_hole 9,
                   template_app (template_hole 8, t_empty)),
                 template_app (template_hole 2, template_var 12)))),
           template_var 15)))),
    ("ReduceStoreBuffer.share_all_until_volatile_write_share_commute",
     "[| ownership_distinct ?ts; sharing_consis ?\<S> ?ts;
         ALL i p is \<O> \<R> \<D> \<theta> sb.
            i < length ?ts -->
            ?ts ! i = (p, is, \<theta>, sb, \<D>, \<O>, \<R>) -->
            (all_shared
              (takeWhile (Not o is_volatile_Write\<^sub>s\<^sub>b) sb) Un
             all_unshared
              (takeWhile (Not o is_volatile_Write\<^sub>s\<^sub>b) sb) Un
             all_acquired
              (takeWhile (Not o is_volatile_Write\<^sub>s\<^sub>b) sb)) Int
            (all_shared ?sb' Un all_unshared ?sb' Un all_acquired ?sb') =
            {} |]
      ==> share_all_until_volatile_write ?ts (share ?sb' ?\<S>) =
          share ?sb' (share_all_until_volatile_write ?ts ?\<S>)",
     template_implication
      ([template_predicate
         (template_app (template_hole 34, template_var 2)),
        template_predicate
         (
            template_app
             (template_app (template_hole 33, template_var 1),
              template_var 2)
            ),
        template_predicate (template_app (template_hole 32, t_empty))],
       template_equation
        (template_app
          (template_app (template_hole 1, template_var 2),
           template_app
            (template_app (template_hole 0, template_var 0),
             template_var 1)),
         template_app
          (template_app (template_hole 0, template_var 0),
           template_app
            (template_app (template_hole 1, template_var 2),
             template_var 1))))),
    ("ReduceStoreBuffer.acquire_release_ownership_nth_update",
     "[| ?R <= ?\<O>; ?i < length ?ts;
         ?ts ! ?i = (?p, ?is, ?xs, ?sb, ?\<D>, ?\<O>, ?\<R>);
         ownership_distinct ?ts |]
      ==> (UN (uu_, uu_, uu_, uu_, uu_, \<O>,
              uu_):set (?ts[?i :=
                              (?p', ?is', ?xs', ?sb', ?\<D>',
                               ?\<O> Un ?A - ?R, ?\<R>')]).
              \<O>) =
          (UN (uu_, uu_, uu_, uu_, uu_, \<O>, uu_):set ?ts. \<O>) Un ?A -
          ?R",
     template_implication
      ([template_inequation (less_equals, template_var 16, template_var 15),
        template_inequation
         (less_than, template_var 14,
          template_app (template_hole 22, template_var 13)),
        template_equation
         (template_app
           (template_app (template_hole 20, template_var 13),
            template_var 14),
          template_app
           (template_app (template_hole 19, template_var 12),
            template_app
             (template_app (template_hole 18, template_var 11),
              template_app
               (template_app (template_hole 17, template_var 10),
                template_app
                 (template_app (template_hole 16, template_var 9),
                  template_app
                   (template_app (template_hole 15, template_var 8),
                    template_app
                     (template_app (template_hole 14, template_var 15),
                      template_var 7))))))),
        template_predicate
         (template_app (template_hole 13, template_var 13))],
       template_equation
        (template_app
          (template_hole 11,
           template_app
            (template_app
              (template_hole 10, template_app (template_hole 9, t_empty)),
             template_app
              (template_hole 3,
               template_app
                (template_app
                  (template_app (template_hole 2, template_var 13),
                   template_var 14),
                 template_app
                  (template_app (template_hole 19, template_var 6),
                   template_app
                    (template_app (template_hole 18, template_var 5),
                     template_app
                      (template_app (template_hole 17, template_var 4),
                       template_app
                        (template_app (template_hole 16, template_var 3),
                         template_app
                          (template_app (template_hole 15, template_var 2),
                           template_app
                            (template_app
                              (template_hole 14,
                               template_app
                                (template_app
                                  (template_hole 1,
                                   template_app
                                    (template_app
(template_hole 0, template_var 15),
                                     template_var 1)),
                                 template_var 16)),
                             template_var 0)))))))))),
         template_app
          (template_app
            (template_hole 1,
             template_app
              (template_app
                (template_hole 0,
                 template_app
                  (template_hole 11,
                   template_app
                    (template_app
                      (template_hole 10,
                       template_app (template_hole 9, t_empty)),
                     template_app (template_hole 3, template_var 13)))),
               template_var 1)),
           template_var 16)))),
    ("ReduceStoreBuffer.in_read_only_share_all_until_volatile_write",
     "[| ownership_distinct ?ts; sharing_consis ?\<S> ?ts;
         read_only_unowned ?\<S> ?ts; ?i < length ?ts;
         ?ts ! ?i = (?p, ?is, ?\<theta>, ?sb, ?\<D>, ?\<O>, ?\<R>);
         ALL j<length ?ts.
            ?i ~= j -->
            (let (uu_, uu_, uu_, sb\<^sub>j, uu_, uu_, uu_) = ?ts ! j
             in ?a ~: all_acquired
                       (takeWhile (Not o is_volatile_Write\<^sub>s\<^sub>b)
                         sb\<^sub>j));
         ?a : read_only (share ?sb ?\<S>) |]
      ==> ?a : read_only
                (share
                  (dropWhile (Not o is_volatile_Write\<^sub>s\<^sub>b) ?sb)
                  (share_all_until_volatile_write ?ts ?\<S>))",
     template_implication
      ([template_predicate
         (template_app (template_hole 32, template_var 10)),
        template_predicate
         (
            template_app
             (template_app (template_hole 31, template_var 9),
              template_var 10)
            ),
        template_predicate
         (
            template_app
             (template_app (template_hole 30, template_var 9),
              template_var 10)
            ),
        template_inequation
         (less_than, template_var 8,
          template_app (template_hole 28, template_var 10)),
        template_equation
         (template_app
           (template_app (template_hole 26, template_var 10),
            template_var 8),
          template_app
           (template_app (template_hole 25, template_var 7),
            template_app
             (template_app (template_hole 24, template_var 6),
              template_app
               (template_app (template_hole 23, template_var 5),
                template_app
                 (template_app (template_hole 22, template_var 4),
                  template_app
                   (template_app (template_hole 21, template_var 3),
                    template_app
                     (template_app (template_hole 20, template_var 2),
                      template_var 1))))))),
        template_predicate (template_app (template_hole 19, t_empty)),
        template_predicate
         (
            template_app
             (template_app (template_hole 8, template_var 0),
              template_app
               (template_hole 3,
                template_app
                 (template_app (template_hole 2, template_var 4),
                  template_var 9)))
            )],
       template_predicate
        (
           template_app
            (template_app (template_hole 8, template_var 0),
             template_app
              (template_hole 3,
               template_app
                (template_app
                  (template_hole 2,
                   template_app
                    (template_app
                      (template_hole 1,
                       template_app
                        (template_app (template_hole 5, template_hole 17),
                         template_hole 4)),
                     template_var 4)),
                 template_app
                  (template_app (template_hole 0, template_var 10),
                   template_var 9))))
           ))),
    ("ReduceStoreBuffer.reads_consistent_flush_all_until_volatile_write_aux'",
     "[| outstanding_refs is_volatile_Read\<^sub>s\<^sub>b ?xs = {};
         read_only_reads ?\<O>'
          (takeWhile (Not o is_volatile_Write\<^sub>s\<^sub>b) ?xs)
         <= ?RO;
         reads_consistent False ?\<O>' ?m ?xs;
         ALL i<length ?ts.
            let (p, is, \<theta>, sb, \<D>, \<O>) = ?ts ! i
            in outstanding_refs is_non_volatile_Write\<^sub>s\<^sub>b
                (takeWhile (Not o is_volatile_Write\<^sub>s\<^sub>b) sb) Int
               (outstanding_refs is_volatile_Write\<^sub>s\<^sub>b ?xs Un
                outstanding_refs is_non_volatile_Write\<^sub>s\<^sub>b
                 ?xs Un
                outstanding_refs is_non_volatile_Read\<^sub>s\<^sub>b
                 (dropWhile (Not o is_volatile_Write\<^sub>s\<^sub>b)
                   ?xs) Un
                (outstanding_refs is_non_volatile_Read\<^sub>s\<^sub>b
                  (takeWhile (Not o is_volatile_Write\<^sub>s\<^sub>b)
                    ?xs) -
                 ?RO) Un
                (?\<O>' Un
                 all_acquired
                  (takeWhile (Not o is_volatile_Write\<^sub>s\<^sub>b)
                    ?xs))) =
               {} |]
      ==> reads_consistent False ?\<O>'
           (flush_all_until_volatile_write ?ts ?m) ?xs",
     template_implication
      ([template_equation
         (template_app
           (template_app (template_hole 34, template_hole 33),
            template_var 4),
          template_hole 32),
        template_inequation
         (less_equals,
          template_app
           (template_app (template_hole 30, template_var 3),
            template_app
             (template_app
               (template_hole 29,
                template_app
                 (template_app (template_hole 28, template_hole 27),
                  template_hole 26)),
              template_var 4)),
          template_var 2),
        template_predicate
         (
            template_app
             (template_app
               (template_app
                 (template_app (template_hole 25, template_hole 24),
                  template_var 3),
                template_var 1),
              template_var 4)
            ),
        template_predicate (template_app (template_hole 23, t_empty))],
       template_predicate
        (
           template_app
            (template_app
              (template_app
                (template_app (template_hole 25, template_hole 24),
                 template_var 3),
               template_app
                (template_app (template_hole 0, template_var 0),
                 template_var 1)),
             template_var 4)
           ))),
    ("ReduceStoreBuffer.flush_all_until_volatile_write_append_non_volatile_write_commute",
     "[| outstanding_refs is_volatile_Write\<^sub>s\<^sub>b ?sb = {};
         ?i < length ?ts;
         ?ts ! ?i = (?p, ?is, ?xs, ?sb, ?\<D>, ?\<O>, ?\<R>);
         ALL j<length ?ts.
            ?i ~= j -->
            (let (uu_, uu_, uu_, sb\<^sub>j, uu_, uu_, uu_) = ?ts ! j
             in ?a ~: outstanding_refs is_non_volatile_Write\<^sub>s\<^sub>b
                       (takeWhile (Not o is_volatile_Write\<^sub>s\<^sub>b)
                         sb\<^sub>j)) |]
      ==> flush_all_until_volatile_write
           (?ts[?i :=
                  (?p', ?is', ?xs,
                   ?sb @
                   [Write\<^sub>s\<^sub>b False ?a ?sop ?v ?A ?L ?R ?W],
                   ?\<D>', ?\<O>, ?\<R>')])
           ?m =
          (flush_all_until_volatile_write ?ts ?m)(?a := ?v)",
     template_implication
      ([template_equation
         (template_app
           (template_app (template_hole 36, template_hole 35),
            template_var 20),
          template_hole 34),
        template_inequation
         (less_than, template_var 19,
          template_app (template_hole 32, template_var 18)),
        template_equation
         (template_app
           (template_app (template_hole 30, template_var 18),
            template_var 19),
          template_app
           (template_app (template_hole 29, template_var 17),
            template_app
             (template_app (template_hole 28, template_var 16),
              template_app
               (template_app (template_hole 27, template_var 15),
                template_app
                 (template_app (template_hole 26, template_var 20),
                  template_app
                   (template_app (template_hole 25, template_var 14),
                    template_app
                     (template_app (template_hole 24, template_var 13),
                      template_var 12))))))),
        template_predicate (template_app (template_hole 23, t_empty))],
       template_equation
        (template_app
          (template_app
            (template_hole 7,
             template_app
              (template_app
                (template_app (template_hole 6, template_var 18),
                 template_var 19),
               template_app
                (template_app (template_hole 29, template_var 10),
                 template_app
                  (template_app (template_hole 28, template_var 9),
                   template_app
                    (template_app (template_hole 27, template_var 15),
                     template_app
                      (template_app
                        (template_hole 26,
                         template_app
                          (template_app (template_hole 5, template_var 20),
                           template_app
                            (template_app
                              (template_hole 4,
                               template_app
                                (template_app
                                  (template_app
                                    (template_app
(template_app
  (template_app
    (template_app
      (template_app (template_hole 3, template_hole 2), template_var 11),
     template_var 8),
   template_var 7),
 template_var 6),
                                     template_var 5),
                                   template_var 4),
                                 template_var 3)),
                             template_hole 1))),
                       template_app
                        (template_app (template_hole 25, template_var 2),
                         template_app
                          (template_app (template_hole 24, template_var 13),
                           template_var 1)))))))),
           template_var 0),
         template_app
          (template_app
            (template_app
              (template_hole 0,
               template_app
                (template_app (template_hole 7, template_var 18),
                 template_var 0)),
             template_var 11),
           template_var 7)))),
    ("ReduceStoreBuffer.converse_rtranclp_induct5",
     "[| ?r^** (?m, ?sb, ?\<O>, ?\<R>, ?\<S>)
          (?m', ?sb', ?\<O>', ?\<R>', ?\<S>');
         ?P ?m' ?sb' ?\<O>' ?\<R>' ?\<S>';
         !!a aa ab ac b ad ae af ag ba.
            [| ?r (a, aa, ab, ac, b) (ad, ae, af, ag, ba);
               ?r^** (ad, ae, af, ag, ba)
                (?m', ?sb', ?\<O>', ?\<R>', ?\<S>');
               ?P ad ae af ag ba |]
            ==> ?P a aa ab ac b |]
      ==> ?P ?m ?sb ?\<O> ?\<R> ?\<S>",
     template_implication
      ([template_predicate
         (
            template_app
             (template_app
               (template_app (template_hole 9, template_var 11),
                template_app
                 (template_app (template_hole 8, template_var 10),
                  template_app
                   (template_app (template_hole 7, template_var 9),
                    template_app
                     (template_app (template_hole 6, template_var 8),
                      template_app
                       (template_app (template_hole 5, template_var 7),
                        template_var 6))))),
              template_app
               (template_app (template_hole 8, template_var 5),
                template_app
                 (template_app (template_hole 7, template_var 4),
                  template_app
                   (template_app (template_hole 6, template_var 3),
                    template_app
                     (template_app (template_hole 5, template_var 2),
                      template_var 1)))))
            ),
        template_predicate
         (
            template_app
             (template_app
               (template_app
                 (template_app
                   (template_app (template_var 0, template_var 5),
                    template_var 4),
                  template_var 3),
                template_var 2),
              template_var 1)
            ),
        template_predicate (template_app (template_hole 4, t_empty))],
       template_predicate
        (
           template_app
            (template_app
              (template_app
                (template_app
                  (template_app (template_var 0, template_var 10),
                   template_var 9),
                 template_var 8),
               template_var 7),
             template_var 6)
           ))),
    ("ReduceStoreBuffer.sharing_consis_share_all_until_volatile_write",
     "[| ownership_distinct ?ts; sharing_consis ?\<S> ?ts;
         length ?ts' = length ?ts;
         ALL i<length ?ts.
            let (uu_, uu_, uu_, sb, uu_, \<O>, uu_) = ?ts ! i;
                (uu_, uu_, uu_, sb', uu_, \<O>', uu_) = ?ts' ! i
            in \<O>' =
               acquired True
                (takeWhile (Not o is_volatile_Write\<^sub>s\<^sub>b) sb)
                \<O> &
               sb' =
               dropWhile (Not o is_volatile_Write\<^sub>s\<^sub>b) sb |]
      ==> sharing_consis (share_all_until_volatile_write ?ts ?\<S>) ?ts' &
          dom (share_all_until_volatile_write ?ts ?\<S>) - dom ?\<S>
          <= (UN (uu_, uu_, uu_, uu_, uu_, \<O>, uu_):set ?ts. \<O>) &
          dom ?\<S> - dom (share_all_until_volatile_write ?ts ?\<S>)
          <= (UN (uu_, uu_, uu_, sb, uu_, \<O>, uu_):set ?ts.
                 all_acquired sb Un \<O>)",
     template_implication
      ([template_predicate
         (template_app (template_hole 39, template_var 2)),
        template_predicate
         (
            template_app
             (template_app (template_hole 38, template_var 1),
              template_var 2)
            ),
        template_equation
         (template_app (template_hole 36, template_var 0),
          template_app (template_hole 36, template_var 2)),
        template_predicate (template_app (template_hole 35, t_empty))],
       template_predicate
        (
           template_app
            (template_app
              (template_hole 24,
               template_app
                (template_app
                  (template_hole 38,
                   template_app
                    (template_app (template_hole 14, template_var 2),
                     template_var 1)),
                 template_var 0)),
             template_app
              (template_app
                (template_hole 24,
                 template_app
                  (template_app
                    (template_hole 13,
                     template_app
                      (template_app
                        (template_hole 12,
                         template_app
                          (template_hole 11,
                           template_app
                            (template_app
                              (template_hole 14, template_var 2),
                             template_var 1))),
                       template_app (template_hole 11, template_var 1))),
                   template_app
                    (template_hole 10,
                     template_app
                      (template_app
                        (template_hole 9,
                         template_app (template_hole 8, t_empty)),
                       template_app (template_hole 2, template_var 2))))),
               template_app
                (template_app
                  (template_hole 13,
                   template_app
                    (template_app
                      (template_hole 12,
                       template_app (template_hole 11, template_var 1)),
                     template_app
                      (template_hole 11,
                       template_app
                        (template_app (template_hole 14, template_var 2),
                         template_var 1)))),
                 template_app
                  (template_hole 10,
                   template_app
                    (template_app
                      (template_hole 9,
                       template_app (template_hole 8, t_empty)),
                     template_app (template_hole 2, template_var 2))))))
           ))),
    ("ReduceStoreBuffer.share_all_until_volatile_write_Ghost\<^sub>s\<^sub>b_commute",
     "[| ownership_distinct ?ts; sharing_consis ?\<S> ?ts; ?i < length ?ts;
         ?ts ! ?i =
         (?p, ?is, ?\<theta>, Ghost\<^sub>s\<^sub>b ?A ?L ?R ?W # ?sb,
          ?\<D>, ?\<O>, ?\<R>);
         ALL j p is \<O> \<R> \<D> \<theta> sb.
            j < length ?ts -->
            ?i ~= j -->
            ?ts ! j = (p, is, \<theta>, sb, \<D>, \<O>, \<R>) -->
            (all_shared
              (takeWhile (Not o is_volatile_Write\<^sub>s\<^sub>b) sb) Un
             all_unshared
              (takeWhile (Not o is_volatile_Write\<^sub>s\<^sub>b) sb) Un
             all_acquired
              (takeWhile (Not o is_volatile_Write\<^sub>s\<^sub>b) sb)) Int
            (?R Un ?L Un ?A) =
            {} |]
      ==> share_all_until_volatile_write
           (?ts[?i := (?p', ?is', ?\<theta>', ?sb, ?\<D>', ?\<O>', ?\<R>')])
           (?\<S> \<oplus>\<^bsub>?W\<^esub> ?R \<ominus>\<^bsub>?A\<^esub> ?L) =
          share_all_until_volatile_write ?ts ?\<S>",
     template_implication
      ([template_predicate
         (template_app (template_hole 39, template_var 19)),
        template_predicate
         (
            template_app
             (template_app (template_hole 38, template_var 18),
              template_var 19)
            ),
        template_inequation
         (less_than, template_var 17,
          template_app (template_hole 36, template_var 19)),
        template_equation
         (template_app
           (template_app (template_hole 34, template_var 19),
            template_var 17),
          template_app
           (template_app (template_hole 33, template_var 16),
            template_app
             (template_app (template_hole 32, template_var 15),
              template_app
               (template_app (template_hole 31, template_var 14),
                template_app
                 (template_app
                   (template_hole 30,
                    template_app
                     (template_app
                       (template_hole 29,
                        template_app
                         (template_app
                           (template_app
                             (template_app
                               (template_hole 28, template_var 13),
                              template_var 12),
                            template_var 11),
                          template_var 10)),
                      template_var 9)),
                  template_app
                   (template_app (template_hole 27, template_var 8),
                    template_app
                     (template_app (template_hole 26, template_var 7),
                      template_var 6))))))),
        template_predicate (template_app (template_hole 25, t_empty))],
       template_equation
        (template_app
          (template_app
            (template_hole 3,
             template_app
              (template_app
                (template_app (template_hole 2, template_var 19),
                 template_var 17),
               template_app
                (template_app (template_hole 33, template_var 5),
                 template_app
                  (template_app (template_hole 32, template_var 4),
                   template_app
                    (template_app (template_hole 31, template_var 3),
                     template_app
                      (template_app (template_hole 30, template_var 9),
                       template_app
                        (template_app (template_hole 27, template_var 2),
                         template_app
                          (template_app (template_hole 26, template_var 1),
                           template_var 0)))))))),
           template_app
            (template_app
              (template_app
                (template_hole 1,
                 template_app
                  (template_app
                    (template_app (template_hole 0, template_var 18),
                     template_var 10),
                   template_var 11)),
               template_var 13),
             template_var 12)),
         template_app
          (template_app (template_hole 3, template_var 19),
           template_var 18)))),
    ("ReduceStoreBuffer.flush_all_until_volatile_write_Write\<^sub>s\<^sub>b_non_volatile_commute",
     "[| ?i < length ?ts;
         ?ts ! ?i =
         (?p, ?is, ?xs,
          Write\<^sub>s\<^sub>b False ?a ?sop ?v ?A ?L ?R ?W # ?sb, ?\<D>,
          ?\<O>, ?\<R>);
         ALL i<length ?ts.
            ALL j<length ?ts.
               i ~= j -->
               (let (uu_, uu_, uu_, sb\<^sub>i, uu_, uu_, uu_) = ?ts ! i;
                    (uu_, uu_, uu_, sb\<^sub>j, uu_, uu_, uu_) = ?ts ! j
                in outstanding_refs is_Write\<^sub>s\<^sub>b sb\<^sub>i Int
                   outstanding_refs is_Write\<^sub>s\<^sub>b
                    (takeWhile (Not o is_volatile_Write\<^sub>s\<^sub>b)
                      sb\<^sub>j) =
                   {});
         ALL j<length ?ts.
            ?i ~= j -->
            (let (uu_, uu_, uu_, sb\<^sub>j, uu_, uu_, uu_) = ?ts ! j
             in ?a ~: outstanding_refs is_Write\<^sub>s\<^sub>b
                       (takeWhile (Not o is_volatile_Write\<^sub>s\<^sub>b)
                         sb\<^sub>j)) |]
      ==> flush_all_until_volatile_write
           (?ts[?i := (?p, ?is, ?xs, ?sb, ?\<D>', ?\<O>, ?\<R>')])
           (?m(?a := ?v)) =
          flush_all_until_volatile_write ?ts ?m",
     template_implication
      ([template_inequation
         (less_than, template_var 18,
          template_app (template_hole 35, template_var 17)),
        template_equation
         (template_app
           (template_app (template_hole 33, template_var 17),
            template_var 18),
          template_app
           (template_app (template_hole 32, template_var 16),
            template_app
             (template_app (template_hole 31, template_var 15),
              template_app
               (template_app (template_hole 30, template_var 14),
                template_app
                 (template_app
                   (template_hole 29,
                    template_app
                     (template_app
                       (template_hole 28,
                        template_app
                         (template_app
                           (template_app
                             (template_app
                               (template_app
                                 (template_app
                                   (template_app
                                     (template_app
 (template_hole 27, template_hole 26),
template_var 13),
                                    template_var 12),
                                  template_var 11),
                                template_var 10),
                              template_var 9),
                            template_var 8),
                          template_var 7)),
                      template_var 6)),
                  template_app
                   (template_app (template_hole 25, template_var 5),
                    template_app
                     (template_app (template_hole 24, template_var 4),
                      template_var 3))))))),
        template_predicate (template_app (template_hole 23, t_empty)),
        template_predicate (template_app (template_hole 23, t_empty))],
       template_equation
        (template_app
          (template_app
            (template_hole 2,
             template_app
              (template_app
                (template_app (template_hole 1, template_var 17),
                 template_var 18),
               template_app
                (template_app (template_hole 32, template_var 16),
                 template_app
                  (template_app (template_hole 31, template_var 15),
                   template_app
                    (template_app (template_hole 30, template_var 14),
                     template_app
                      (template_app (template_hole 29, template_var 6),
                       template_app
                        (template_app (template_hole 25, template_var 2),
                         template_app
                          (template_app (template_hole 24, template_var 4),
                           template_var 1)))))))),
           template_app
            (template_app
              (template_app (template_hole 0, template_var 0),
               template_var 13),
             template_var 11)),
         template_app
          (template_app (template_hole 2, template_var 17),
           template_var 0)))),
    ("ReduceStoreBuffer.flush_flush_all_until_volatile_write_Write\<^sub>s\<^sub>b_volatile_commute",
     "[| ?i < length ?ts;
         ?ts ! ?i =
         (?p, ?is, ?xs,
          Write\<^sub>s\<^sub>b True ?a ?sop ?v ?A ?L ?R ?W # ?sb, ?\<D>,
          ?\<O>, ?\<R>);
         ALL i<length ?ts.
            ALL j<length ?ts.
               i ~= j -->
               (let (uu_, uu_, uu_, sb\<^sub>i, uu_, uu_, uu_) = ?ts ! i;
                    (uu_, uu_, uu_, sb\<^sub>j, uu_, uu_, uu_) = ?ts ! j
                in outstanding_refs is_Write\<^sub>s\<^sub>b sb\<^sub>i Int
                   outstanding_refs is_Write\<^sub>s\<^sub>b
                    (takeWhile (Not o is_volatile_Write\<^sub>s\<^sub>b)
                      sb\<^sub>j) =
                   {});
         ALL j<length ?ts.
            ?i ~= j -->
            (let (uu_, uu_, uu_, sb\<^sub>j, uu_, uu_, uu_) = ?ts ! j
             in ?a ~: outstanding_refs is_Write\<^sub>s\<^sub>b
                       (takeWhile (Not o is_volatile_Write\<^sub>s\<^sub>b)
                         sb\<^sub>j)) |]
      ==> flush (takeWhile (Not o is_volatile_Write\<^sub>s\<^sub>b) ?sb)
           ((flush_all_until_volatile_write ?ts ?m)(?a := ?v)) =
          flush_all_until_volatile_write
           (?ts[?i := (?p, ?is, ?xs, ?sb, ?\<D>', ?\<O>', ?\<R>')])
           (?m(?a := ?v))",
     template_implication
      ([template_inequation
         (less_than, template_var 19,
          template_app (template_hole 36, template_var 18)),
        template_equation
         (template_app
           (template_app (template_hole 34, template_var 18),
            template_var 19),
          template_app
           (template_app (template_hole 33, template_var 17),
            template_app
             (template_app (template_hole 32, template_var 16),
              template_app
               (template_app (template_hole 31, template_var 15),
                template_app
                 (template_app
                   (template_hole 30,
                    template_app
                     (template_app
                       (template_hole 29,
                        template_app
                         (template_app
                           (template_app
                             (template_app
                               (template_app
                                 (template_app
                                   (template_app
                                     (template_app
 (template_hole 28, template_hole 27),
template_var 14),
                                    template_var 13),
                                  template_var 12),
                                template_var 11),
                              template_var 10),
                            template_var 9),
                          template_var 8)),
                      template_var 7)),
                  template_app
                   (template_app (template_hole 26, template_var 6),
                    template_app
                     (template_app (template_hole 25, template_var 5),
                      template_var 4))))))),
        template_predicate (template_app (template_hole 24, t_empty)),
        template_predicate (template_app (template_hole 24, t_empty))],
       template_equation
        (template_app
          (template_app
            (template_hole 3,
             template_app
              (template_app
                (template_hole 9,
                 template_app
                  (template_app (template_hole 8, template_hole 22),
                   template_hole 7)),
               template_var 7)),
           template_app
            (template_app
              (template_app
                (template_hole 2,
                 template_app
                  (template_app (template_hole 1, template_var 18),
                   template_var 3)),
               template_var 14),
             template_var 12)),
         template_app
          (template_app
            (template_hole 1,
             template_app
              (template_app
                (template_app (template_hole 0, template_var 18),
                 template_var 19),
               template_app
                (template_app (template_hole 33, template_var 17),
                 template_app
                  (template_app (template_hole 32, template_var 16),
                   template_app
                    (template_app (template_hole 31, template_var 15),
                     template_app
                      (template_app (template_hole 30, template_var 7),
                       template_app
                        (template_app (template_hole 26, template_var 2),
                         template_app
                          (template_app (template_hole 25, template_var 1),
                           template_var 0)))))))),
           template_app
            (template_app
              (template_app (template_hole 2, template_var 3),
               template_var 14),
             template_var 12))))),
    ("ReduceStoreBuffer.share_all_until_volatile_write_flush_commute",
     "[| takeWhile (Not o is_volatile_Write\<^sub>s\<^sub>b) ?sb = [];
         ownership_distinct ?ts; sharing_consis ?\<S> ?ts; ?i < length ?ts;
         ?ts ! ?i = (?p, ?is, ?\<theta>, ?sb, ?\<D>, ?\<O>, ?\<R>);
         ALL i p is \<O> \<R> \<D> \<theta> sb.
            i < length ?ts -->
            ?ts ! i = (p, is, \<theta>, sb, \<D>, \<O>, \<R>) -->
            (all_shared
              (takeWhile (Not o is_volatile_Write\<^sub>s\<^sub>b) sb) Un
             all_unshared
              (takeWhile (Not o is_volatile_Write\<^sub>s\<^sub>b) sb) Un
             all_acquired
              (takeWhile (Not o is_volatile_Write\<^sub>s\<^sub>b) sb)) Int
            (all_shared
              (takeWhile (Not o is_volatile_Write\<^sub>s\<^sub>b) ?sb') Un
             all_unshared
              (takeWhile (Not o is_volatile_Write\<^sub>s\<^sub>b) ?sb') Un
             all_acquired
              (takeWhile (Not o is_volatile_Write\<^sub>s\<^sub>b) ?sb')) =
            {};
         ALL j p is \<O> \<R> \<D> \<theta> sb.
            j < length ?ts -->
            ?i ~= j -->
            ?ts ! j = (p, is, \<theta>, sb, \<D>, \<O>, \<R>) -->
            (all_shared sb Un all_unshared sb Un all_acquired sb) Int
            (?R Un ?L Un ?A) =
            {} |]
      ==> share_all_until_volatile_write
           (?ts[?i :=
                  (?p', ?is', ?\<theta>', ?sb', ?\<D>', ?\<O>', ?\<R>')])
           (?\<S> \<oplus>\<^bsub>?W\<^esub> ?R \<ominus>\<^bsub>?A\<^esub> ?L) =
          share (takeWhile (Not o is_volatile_Write\<^sub>s\<^sub>b) ?sb')
           (share_all_until_volatile_write ?ts
             ?\<S> \<oplus>\<^bsub>?W\<^esub> ?R \<ominus>\<^bsub>?A\<^esub> ?L)",
     template_implication
      ([template_equation
         (template_app
           (template_app
             (template_hole 39,
              template_app
               (template_app (template_hole 38, template_hole 37),
                template_hole 36)),
            template_var 20),
          template_hole 35),
        template_predicate
         (template_app (template_hole 34, template_var 19)),
        template_predicate
         (
            template_app
             (template_app (template_hole 33, template_var 18),
              template_var 19)
            ),
        template_inequation
         (less_than, template_var 17,
          template_app (template_hole 31, template_var 19)),
        template_equation
         (template_app
           (template_app (template_hole 29, template_var 19),
            template_var 17),
          template_app
           (template_app (template_hole 28, template_var 16),
            template_app
             (template_app (template_hole 27, template_var 15),
              template_app
               (template_app (template_hole 26, template_var 14),
                template_app
                 (template_app (template_hole 25, template_var 20),
                  template_app
                   (template_app (template_hole 24, template_var 13),
                    template_app
                     (template_app (template_hole 23, template_var 12),
                      template_var 11))))))),
        template_predicate (template_app (template_hole 22, t_empty)),
        template_predicate (template_app (template_hole 22, t_empty))],
       template_equation
        (template_app
          (template_app
            (template_hole 4,
             template_app
              (template_app
                (template_app (template_hole 3, template_var 19),
                 template_var 17),
               template_app
                (template_app (template_hole 28, template_var 6),
                 template_app
                  (template_app (template_hole 27, template_var 5),
                   template_app
                    (template_app (template_hole 26, template_var 4),
                     template_app
                      (template_app (template_hole 25, template_var 10),
                       template_app
                        (template_app (template_hole 24, template_var 3),
                         template_app
                          (template_app (template_hole 23, template_var 2),
                           template_var 1)))))))),
           template_app
            (template_app
              (template_app
                (template_hole 2,
                 template_app
                  (template_app
                    (template_app (template_hole 1, template_var 18),
                     template_var 0),
                   template_var 9)),
               template_var 7),
             template_var 8)),
         template_app
          (template_app
            (template_hole 0,
             template_app
              (template_app
                (template_hole 39,
                 template_app
                  (template_app (template_hole 38, template_hole 37),
                   template_hole 36)),
               template_var 10)),
           template_app
            (template_app
              (template_app
                (template_hole 2,
                 template_app
                  (template_app
                    (template_app
                      (template_hole 1,
                       template_app
                        (template_app (template_hole 4, template_var 19),
                         template_var 18)),
                     template_var 0),
                   template_var 9)),
               template_var 7),
             template_var 8))))),
    ("ReduceStoreBuffer.flush_step_induct",
     "[| (?x1a, ?x1b, ?x1c, ?x1d,
          ?x1e) \<rightarrow>\<^sub>f (?x2a, ?x2b, ?x2c, ?x2d, ?x2e);
         !!\<O>' volatile \<O> A R \<S>' \<S> W L \<R>' \<R> m a aa b v rs.
            [| \<O>' = (if volatile then \<O> Un A - R else \<O>);
               \<S>' =
               (if volatile
                then \<S> \<oplus>\<^bsub>W\<^esub> R \<ominus>\<^bsub>A\<^esub> L
                else \<S>);
               \<R>' = (if volatile then Map.empty else \<R>) |]
            ==> ?P m
                 (Write\<^sub>s\<^sub>b volatile a (aa, b) v A L R W # rs)
                 \<O> \<R> \<S> (m(a := v)) rs \<O>' \<R>' \<S>';
         !!m volatile a t v rs \<O> \<R> \<S>.
            ?P m (Read\<^sub>s\<^sub>b volatile a t v # rs) \<O> \<R> \<S> m
             rs \<O> \<R> \<S>;
         !!m p p' is rs \<O> \<R> \<S>.
            ?P m (Prog\<^sub>s\<^sub>b p p' is # rs) \<O> \<R> \<S> m rs
             \<O> \<R> \<S>;
         !!m A L R W rs \<O> \<R> \<S>.
            ?P m (Ghost\<^sub>s\<^sub>b A L R W # rs) \<O> \<R> \<S> m rs
             (\<O> Un A - R) (augment_rels (dom \<S>) R \<R>)
             (\<S> \<oplus>\<^bsub>W\<^esub> R \<ominus>\<^bsub>A\<^esub> L) |]
      ==> ?P ?x1a ?x1b ?x1c ?x1d ?x1e ?x2a ?x2b ?x2c ?x2d ?x2e",
     template_implication
      ([template_predicate
         (
            template_app
             (template_app
               (template_hole 31,
                template_app
                 (template_app (template_hole 30, template_var 10),
                  template_app
                   (template_app (template_hole 29, template_var 9),
                    template_app
                     (template_app (template_hole 28, template_var 8),
                      template_app
                       (template_app (template_hole 27, template_var 7),
                        template_var 6))))),
              template_app
               (template_app (template_hole 30, template_var 5),
                template_app
                 (template_app (template_hole 29, template_var 4),
                  template_app
                   (template_app (template_hole 28, template_var 3),
                    template_app
                     (template_app (template_hole 27, template_var 2),
                      template_var 1)))))
            ),
        template_predicate (template_app (template_hole 26, t_empty)),
        template_predicate (template_app (template_hole 23, t_empty)),
        template_predicate (template_app (template_hole 23, t_empty)),
        template_predicate (template_app (template_hole 23, t_empty))],
       template_predicate
        (
           template_app
            (template_app
              (template_app
                (template_app
                  (template_app
                    (template_app
                      (template_app
                        (template_app
                          (template_app
                            (template_app (template_var 0, template_var 10),
                             template_var 9),
                           template_var 8),
                         template_var 7),
                       template_var 6),
                     template_var 5),
                   template_var 4),
                 template_var 3),
               template_var 2),
             template_var 1)
           ))),
    ("ReduceStoreBuffer.share_all_until_volatile_write_commute",
     "[| ownership_distinct ?ts; sharing_consis ?\<S> ?ts;
         ALL i p is \<O> \<R> \<D> \<theta> sb.
            i < length ?ts -->
            ?ts ! i = (p, is, \<theta>, sb, \<D>, \<O>, \<R>) -->
            all_shared
             (takeWhile (Not o is_volatile_Write\<^sub>s\<^sub>b) sb) Int
            ?L =
            {};
         ALL i p is \<O> \<R> \<D> \<theta> sb.
            i < length ?ts -->
            ?ts ! i = (p, is, \<theta>, sb, \<D>, \<O>, \<R>) -->
            all_shared
             (takeWhile (Not o is_volatile_Write\<^sub>s\<^sub>b) sb) Int
            ?A =
            {};
         ALL i p is \<O> \<R> \<D> \<theta> sb.
            i < length ?ts -->
            ?ts ! i = (p, is, \<theta>, sb, \<D>, \<O>, \<R>) -->
            all_acquired
             (takeWhile (Not o is_volatile_Write\<^sub>s\<^sub>b) sb) Int
            ?R =
            {};
         ALL i p is \<O> \<R> \<D> \<theta> sb.
            i < length ?ts -->
            ?ts ! i = (p, is, \<theta>, sb, \<D>, \<O>, \<R>) -->
            all_unshared
             (takeWhile (Not o is_volatile_Write\<^sub>s\<^sub>b) sb) Int
            ?R =
            {};
         ALL i p is \<O> \<R> \<D> \<theta> sb.
            i < length ?ts -->
            ?ts ! i = (p, is, \<theta>, sb, \<D>, \<O>, \<R>) -->
            all_shared
             (takeWhile (Not o is_volatile_Write\<^sub>s\<^sub>b) sb) Int
            ?R =
            {} |]
      ==> share_all_until_volatile_write ?ts
           ?\<S> \<oplus>\<^bsub>?W\<^esub> ?R \<ominus>\<^bsub>?A\<^esub> ?L =
          share_all_until_volatile_write ?ts
           (?\<S> \<oplus>\<^bsub>?W\<^esub> ?R \<ominus>\<^bsub>?A\<^esub> ?L)",
     template_implication
      ([template_predicate
         (template_app (template_hole 34, template_var 5)),
        template_predicate
         (
            template_app
             (template_app (template_hole 33, template_var 4),
              template_var 5)
            ),
        template_predicate (template_app (template_hole 32, t_empty)),
        template_predicate (template_app (template_hole 32, t_empty)),
        template_predicate (template_app (template_hole 32, t_empty)),
        template_predicate (template_app (template_hole 32, t_empty)),
        template_predicate (template_app (template_hole 32, t_empty))],
       template_equation
        (template_app
          (template_app
            (template_app
              (template_hole 2,
               template_app
                (template_app
                  (template_app
                    (template_hole 1,
                     template_app
                      (template_app (template_hole 0, template_var 5),
                       template_var 4)),
                   template_var 0),
                 template_var 1)),
             template_var 2),
           template_var 3),
         template_app
          (template_app (template_hole 0, template_var 5),
           template_app
            (template_app
              (template_app
                (template_hole 2,
                 template_app
                  (template_app
                    (template_app (template_hole 1, template_var 4),
                     template_var 0),
                   template_var 1)),
               template_var 2),
             template_var 3))))),
    ("ReduceStoreBuffer.share_all_until_volatile_write_append_Ghost\<^sub>s\<^sub>b",
     "[| outstanding_refs is_volatile_Write\<^sub>s\<^sub>b ?sb = {};
         ownership_distinct ?ts; sharing_consis ?\<S> ?ts; ?i < length ?ts;
         ?ts ! ?i = (?p, ?is, ?\<theta>, ?sb, ?\<D>, ?\<O>, ?\<R>);
         ALL j p is \<O> \<R> \<D> \<theta> sb.
            j < length ?ts -->
            ?i ~= j -->
            ?ts ! j = (p, is, \<theta>, sb, \<D>, \<O>, \<R>) -->
            all_shared
             (takeWhile (Not o is_volatile_Write\<^sub>s\<^sub>b) sb) Int
            ?L =
            {};
         ALL j p is \<O> \<R> \<D> \<theta> sb.
            j < length ?ts -->
            ?i ~= j -->
            ?ts ! j = (p, is, \<theta>, sb, \<D>, \<O>, \<R>) -->
            all_shared
             (takeWhile (Not o is_volatile_Write\<^sub>s\<^sub>b) sb) Int
            ?A =
            {};
         ALL j p is \<O> \<R> \<D> \<theta> sb.
            j < length ?ts -->
            ?i ~= j -->
            ?ts ! j = (p, is, \<theta>, sb, \<D>, \<O>, \<R>) -->
            all_acquired
             (takeWhile (Not o is_volatile_Write\<^sub>s\<^sub>b) sb) Int
            ?R =
            {};
         ALL j p is \<O> \<R> \<D> \<theta> sb.
            j < length ?ts -->
            ?i ~= j -->
            ?ts ! j = (p, is, \<theta>, sb, \<D>, \<O>, \<R>) -->
            all_unshared
             (takeWhile (Not o is_volatile_Write\<^sub>s\<^sub>b) sb) Int
            ?R =
            {};
         ALL j p is \<O> \<R> \<D> \<theta> sb.
            j < length ?ts -->
            ?i ~= j -->
            ?ts ! j = (p, is, \<theta>, sb, \<D>, \<O>, \<R>) -->
            all_shared
             (takeWhile (Not o is_volatile_Write\<^sub>s\<^sub>b) sb) Int
            ?R =
            {} |]
      ==> share_all_until_volatile_write
           (?ts[?i :=
                  (?p', ?is', ?\<theta>',
                   ?sb @ [Ghost\<^sub>s\<^sub>b ?A ?L ?R ?W], ?\<D>',
                   ?\<O>')])
           ?\<S> =
          share_all_until_volatile_write ?ts
           ?\<S> \<oplus>\<^bsub>?W\<^esub> ?R \<ominus>\<^bsub>?A\<^esub> ?L",
     template_implication
      ([template_equation
         (template_app
           (template_app (template_hole 40, template_hole 39),
            template_var 18),
          template_hole 38),
        template_predicate
         (template_app (template_hole 37, template_var 17)),
        template_predicate
         (
            template_app
             (template_app (template_hole 36, template_var 16),
              template_var 17)
            ),
        template_inequation
         (less_than, template_var 15,
          template_app (template_hole 34, template_var 17)),
        template_equation
         (template_app
           (template_app (template_hole 32, template_var 17),
            template_var 15),
          template_app
           (template_app (template_hole 31, template_var 14),
            template_app
             (template_app (template_hole 30, template_var 13),
              template_app
               (template_app (template_hole 29, template_var 12),
                template_app
                 (template_app (template_hole 28, template_var 18),
                  template_app
                   (template_app (template_hole 27, template_var 11),
                    template_app
                     (template_app (template_hole 26, template_var 10),
                      template_var 9))))))),
        template_predicate (template_app (template_hole 25, t_empty)),
        template_predicate (template_app (template_hole 25, t_empty)),
        template_predicate (template_app (template_hole 25, t_empty)),
        template_predicate (template_app (template_hole 25, t_empty)),
        template_predicate (template_app (template_hole 25, t_empty))],
       template_equation
        (template_app
          (template_app
            (template_hole 7,
             template_app
              (template_app
                (template_app (template_hole 6, template_var 17),
                 template_var 15),
               template_app
                (template_app (template_hole 31, template_var 5),
                 template_app
                  (template_app (template_hole 30, template_var 4),
                   template_app
                    (template_app (template_hole 29, template_var 3),
                     template_app
                      (template_app
                        (template_hole 28,
                         template_app
                          (template_app (template_hole 5, template_var 18),
                           template_app
                            (template_app
                              (template_hole 4,
                               template_app
                                (template_app
                                  (template_app
                                    (template_app
(template_hole 3, template_var 7),
                                     template_var 8),
                                   template_var 6),
                                 template_var 2)),
                             template_hole 2))),
                       template_app
                        (template_app (template_hole 27, template_var 1),
                         template_var 0))))))),
           template_var 16),
         template_app
          (template_app
            (template_app
              (template_hole 1,
               template_app
                (template_app
                  (template_app
                    (template_hole 0,
                     template_app
                      (template_app (template_hole 7, template_var 17),
                       template_var 16)),
                   template_var 2),
                 template_var 6)),
             template_var 7),
           template_var 8)))),
    ("ReduceStoreBuffer.concurrent_step_cases",
     "[| computation.concurrent_step ?memop_step ?storebuffer_step
          ?program_step ?record ?a1.0 ?a2.0;
         !!i ts p is \<theta> sb \<D> \<O> \<R> p' is' m \<S>.
            [| ?a1.0 = (ts, m, \<S>);
               ?a2.0 =
               (ts[i := (p', is @ is', \<theta>, ?record p p' is' sb, \<D>,
                         \<O>, \<R>)],
                m, \<S>);
               i < length ts;
               ts ! i = (p, is, \<theta>, sb, \<D>, \<O>, \<R>);
               ?program_step \<theta> p (p', is') |]
            ==> ?P;
         !!i ts p is \<theta> sb \<D> \<O> \<R> m \<S> is' \<theta>' sb' m'
            \<D>' \<O>' \<R>' \<S>'.
            [| ?a1.0 = (ts, m, \<S>);
               ?a2.0 =
               (ts[i := (p, is', \<theta>', sb', \<D>', \<O>', \<R>')], m',
                \<S>');
               i < length ts;
               ts ! i = (p, is, \<theta>, sb, \<D>, \<O>, \<R>);
               ?memop_step (is, \<theta>, sb, m, \<D>, \<O>, \<R>, \<S>)
                (is', \<theta>', sb', m', \<D>', \<O>', \<R>', \<S>') |]
            ==> ?P;
         !!i ts p is \<theta> sb \<D> \<O> \<R> m \<S> m' sb' \<O>' \<R>'
            \<S>'.
            [| ?a1.0 = (ts, m, \<S>);
               ?a2.0 =
               (ts[i := (p, is, \<theta>, sb', \<D>, \<O>', \<R>')], m',
                \<S>');
               i < length ts;
               ts ! i = (p, is, \<theta>, sb, \<D>, \<O>, \<R>);
               ?storebuffer_step (m, sb, \<O>, \<R>, \<S>)
                (m', sb', \<O>', \<R>', \<S>') |]
            ==> ?P |]
      ==> ?P",
     template_implication
      ([template_predicate
         (
            template_app
             (template_app
               (template_app
                 (template_app
                   (template_app
                     (template_app (template_hole 36, template_var 6),
                      template_var 5),
                    template_var 4),
                  template_var 3),
                template_var 2),
              template_var 1)
            ),
        template_predicate (template_app (template_hole 35, t_empty)),
        template_predicate (template_app (template_hole 35, t_empty)),
        template_predicate (template_app (template_hole 35, t_empty))],
       template_predicate (template_var 0)))]
