   [("Protocols_Normalize.import_protocols_from_ports_nnf",
     "normalized_nnf_match ?m ==>
      normalized_nnf_match (import_protocols_from_ports ?m)",
     template_implication
      ([template_predicate
         (template_app (template_hole 1, template_var 0))],
       template_predicate
        (
           template_app
            (template_hole 1,
             template_app (template_hole 0, template_var 0))
           ))),
    ("Protocols_Normalize.compress_normalize_protocols_nnf",
     "[| normalized_nnf_match ?m;
         compress_normalize_protocols ?m = Some ?m' |]
      ==> normalized_nnf_match ?m'",
     template_implication
      ([template_predicate (template_app (template_hole 3, template_var 1)),
        template_equation
         (template_app (template_hole 1, template_var 1),
          template_app (template_hole 0, template_var 0))],
       template_predicate
        (template_app (template_hole 3, template_var 0)))),
    ("Protocols_Normalize.compress_normalize_protocols_step_nnf",
     "[| normalized_nnf_match ?m;
         compress_normalize_protocols_step ?m = Some ?m' |]
      ==> normalized_nnf_match ?m'",
     template_implication
      ([template_predicate (template_app (template_hole 3, template_var 1)),
        template_equation
         (template_app (template_hole 1, template_var 1),
          template_app (template_hole 0, template_var 0))],
       template_predicate
        (template_app (template_hole 3, template_var 0)))),
    ("Protocols_Normalize.compress_pos_protocols_None",
     "compress_pos_protocols ?ps = None ==>
      ~ (ALL proto:set ?ps. match_proto proto ?p_prot)",
     template_implication
      ([template_equation
         (template_app (template_hole 5, template_var 1), template_hole 4)],
       template_negation
        (
           template_predicate
            (
               template_app
                (template_app
                  (template_hole 2,
                   template_app (template_hole 1, template_var 1)),
                 t_empty)
               )
           ))),
    ("Protocols_Normalize.import_protocols_from_ports_not_introduces_Prot_negated",
     "[| normalized_nnf_match ?m; ~ has_disc_negated is_Prot False ?m |]
      ==> ~ has_disc_negated is_Prot False
             (import_protocols_from_ports ?m)",
     template_implication
      ([template_predicate (template_app (template_hole 5, template_var 0)),
        template_negation
         (
            template_predicate
             (
                template_app
                 (template_app
                   (template_app (template_hole 3, template_hole 2),
                    template_hole 1),
                  template_var 0)
                )
            )],
       template_negation
        (
           template_predicate
            (
               template_app
                (template_app
                  (template_app (template_hole 3, template_hole 2),
                   template_hole 1),
                 template_app (template_hole 0, template_var 0))
               )
           ))),
    ("Protocols_Normalize.compress_pos_protocols_Some",
     "compress_pos_protocols ?ps = Some ?proto ==>
      match_proto ?proto ?p_prot = (ALL p:set ?ps. match_proto p ?p_prot)",
     template_implication
      ([template_equation
         (template_app (template_hole 5, template_var 2),
          template_app (template_hole 4, template_var 1))],
       template_equation
        (template_app
          (template_app (template_hole 2, template_var 1), template_var 0),
         template_app
          (template_app
            (template_hole 1,
             template_app (template_hole 0, template_var 2)),
           t_empty)))),
    ("Protocols_Normalize.compress_normalize_protocols_step_not_introduces_Prot",
     "[| ~ has_disc is_Prot ?m; normalized_nnf_match ?m;
         compress_normalize_protocols_step ?m = Some ?m' |]
      ==> ~ has_disc is_Prot ?m'",
     template_implication
      ([template_negation
         (
            template_predicate
             (
                template_app
                 (template_app (template_hole 5, template_hole 4),
                  template_var 1)
                )
            ),
        template_predicate (template_app (template_hole 3, template_var 1)),
        template_equation
         (template_app (template_hole 1, template_var 1),
          template_app (template_hole 0, template_var 0))],
       template_negation
        (
           template_predicate
            (
               template_app
                (template_app (template_hole 5, template_hole 4),
                 template_var 0)
               )
           ))),
    ("Protocols_Normalize.compress_normalize_protocols_not_introduces_Prot_negated",
     "[| ~ has_disc_negated is_Prot False ?m; normalized_nnf_match ?m;
         compress_normalize_protocols ?m = Some ?m' |]
      ==> ~ has_disc_negated is_Prot False ?m'",
     template_implication
      ([template_negation
         (
            template_predicate
             (
                template_app
                 (template_app
                   (template_app (template_hole 6, template_hole 5),
                    template_hole 4),
                  template_var 1)
                )
            ),
        template_predicate (template_app (template_hole 3, template_var 1)),
        template_equation
         (template_app (template_hole 1, template_var 1),
          template_app (template_hole 0, template_var 0))],
       template_negation
        (
           template_predicate
            (
               template_app
                (template_app
                  (template_app (template_hole 6, template_hole 5),
                   template_hole 4),
                 template_var 0)
               )
           ))),
    ("Protocols_Normalize.compress_normalize_protocols_step_not_introduces_Prot_negated",
     "[| ~ has_disc_negated is_Prot False ?m; normalized_nnf_match ?m;
         compress_normalize_protocols_step ?m = Some ?m' |]
      ==> ~ has_disc_negated is_Prot False ?m'",
     template_implication
      ([template_negation
         (
            template_predicate
             (
                template_app
                 (template_app
                   (template_app (template_hole 6, template_hole 5),
                    template_hole 4),
                  template_var 1)
                )
            ),
        template_predicate (template_app (template_hole 3, template_var 1)),
        template_equation
         (template_app (template_hole 1, template_var 1),
          template_app (template_hole 0, template_var 0))],
       template_negation
        (
           template_predicate
            (
               template_app
                (template_app
                  (template_app (template_hole 6, template_hole 5),
                   template_hole 4),
                 template_var 0)
               )
           ))),
    ("Protocols_Normalize.all_proto_hlp2",
     "(ProtoAny : ?a | (ALL p:{0..- 1}. Proto p : ?a)) =
      (ProtoAny : ?a | ?a = {p. p ~= ProtoAny})",
     template_implication
      ([template_predicate
         (
            template_app
             (template_app
               (template_hole 12,
                template_app
                 (template_app (template_hole 11, template_hole 10),
                  template_var 0)),
              template_app
               (template_app
                 (template_hole 9,
                  template_app
                   (template_app (template_hole 8, template_hole 7),
                    template_app (template_hole 6, template_hole 5))),
                t_empty))
            )],
       template_predicate
        (
           template_app
            (template_app
              (template_hole 12,
               template_app
                (template_app (template_hole 11, template_hole 10),
                 template_var 0)),
             template_app
              (template_app (template_hole 3, template_var 0),
               template_app (template_hole 2, t_empty)))
           ))),
    ("Protocols_Normalize.import_protocols_from_ports_hasdisc",
     "[| normalized_nnf_match ?m; ~ has_disc ?disc ?m;
         ALL a. ~ ?disc (Prot a) |]
      ==> normalized_nnf_match (import_protocols_from_ports ?m) &
          ~ has_disc ?disc (import_protocols_from_ports ?m)",
     template_implication
      ([template_predicate (template_app (template_hole 6, template_var 1)),
        template_negation
         (
            template_predicate
             (
                template_app
                 (template_app (template_hole 4, template_var 0),
                  template_var 1)
                )
            ),
        template_predicate (template_app (template_hole 3, t_empty))],
       template_predicate
        (
           template_app
            (template_app
              (template_hole 1,
               template_app
                (template_hole 6,
                 template_app (template_hole 0, template_var 1))),
             template_app
              (template_hole 5,
               template_app
                (template_app (template_hole 4, template_var 0),
                 template_app (template_hole 0, template_var 1))))
           ))),
    ("Protocols_Normalize.import_protocols_from_ports_hasdisc_negated",
     "[| ~ has_disc_negated ?disc False ?m; ALL a. ~ ?disc (Prot a);
         normalized_nnf_match ?m |]
      ==> normalized_nnf_match (import_protocols_from_ports ?m) &
          ~ has_disc_negated ?disc False (import_protocols_from_ports ?m)",
     template_implication
      ([template_negation
         (
            template_predicate
             (
                template_app
                 (template_app
                   (template_app (template_hole 6, template_var 1),
                    template_hole 5),
                  template_var 0)
                )
            ),
        template_predicate (template_app (template_hole 4, t_empty)),
        template_predicate
         (template_app (template_hole 2, template_var 0))],
       template_predicate
        (
           template_app
            (template_app
              (template_hole 1,
               template_app
                (template_hole 2,
                 template_app (template_hole 0, template_var 0))),
             template_app
              (template_hole 7,
               template_app
                (template_app
                  (template_app (template_hole 6, template_var 1),
                   template_hole 5),
                 template_app (template_hole 0, template_var 0))))
           ))),
    ("Protocols_Normalize.import_protocols_from_ports_preserves_normalized_n_primitive",
     "[| normalized_n_primitive (?disc, ?sel) ?f ?m;
         ALL a. ~ ?disc (Prot a); normalized_nnf_match ?m |]
      ==> normalized_nnf_match (import_protocols_from_ports ?m) &
          normalized_n_primitive (?disc, ?sel) ?f
           (import_protocols_from_ports ?m)",
     template_implication
      ([template_predicate
         (
            template_app
             (template_app
               (template_app
                 (template_hole 7,
                  template_app
                   (template_app (template_hole 6, template_var 3),
                    template_var 2)),
                template_var 1),
              template_var 0)
            ),
        template_predicate (template_app (template_hole 5, t_empty)),
        template_predicate
         (template_app (template_hole 2, template_var 0))],
       template_predicate
        (
           template_app
            (template_app
              (template_hole 1,
               template_app
                (template_hole 2,
                 template_app (template_hole 0, template_var 0))),
             template_app
              (template_app
                (template_app
                  (template_hole 7,
                   template_app
                    (template_app (template_hole 6, template_var 3),
                     template_var 2)),
                 template_var 1),
               template_app (template_hole 0, template_var 0)))
           ))),
    ("Protocols_Normalize.compress_normalize_protocols_hasdisc",
     "[| ~ has_disc ?disc ?m; ALL a. ~ ?disc (Prot a);
         normalized_nnf_match ?m;
         compress_normalize_protocols ?m = Some ?m' |]
      ==> normalized_nnf_match ?m' & ~ has_disc ?disc ?m'",
     template_implication
      ([template_negation
         (
            template_predicate
             (
                template_app
                 (template_app (template_hole 7, template_var 2),
                  template_var 1)
                )
            ),
        template_predicate (template_app (template_hole 6, t_empty)),
        template_predicate (template_app (template_hole 4, template_var 1)),
        template_equation
         (template_app (template_hole 2, template_var 1),
          template_app (template_hole 1, template_var 0))],
       template_predicate
        (
           template_app
            (template_app
              (template_hole 0,
               template_app (template_hole 4, template_var 0)),
             template_app
              (template_hole 8,
               template_app
                (template_app (template_hole 7, template_var 2),
                 template_var 0)))
           ))),
    ("Protocols_Normalize.compress_normalize_protocols_step_hasdisc",
     "[| ~ has_disc ?disc ?m; ALL a. ~ ?disc (Prot a);
         normalized_nnf_match ?m;
         compress_normalize_protocols_step ?m = Some ?m' |]
      ==> normalized_nnf_match ?m' & ~ has_disc ?disc ?m'",
     template_implication
      ([template_negation
         (
            template_predicate
             (
                template_app
                 (template_app (template_hole 7, template_var 2),
                  template_var 1)
                )
            ),
        template_predicate (template_app (template_hole 6, t_empty)),
        template_predicate (template_app (template_hole 4, template_var 1)),
        template_equation
         (template_app (template_hole 2, template_var 1),
          template_app (template_hole 1, template_var 0))],
       template_predicate
        (
           template_app
            (template_app
              (template_hole 0,
               template_app (template_hole 4, template_var 0)),
             template_app
              (template_hole 8,
               template_app
                (template_app (template_hole 7, template_var 2),
                 template_var 0)))
           ))),
    ("Protocols_Normalize.compress_normalize_protocols_hasdisc_negated",
     "[| ~ has_disc_negated ?disc False ?m; ALL a. ~ ?disc (Prot a);
         normalized_nnf_match ?m;
         compress_normalize_protocols ?m = Some ?m' |]
      ==> normalized_nnf_match ?m' & ~ has_disc_negated ?disc False ?m'",
     template_implication
      ([template_negation
         (
            template_predicate
             (
                template_app
                 (template_app
                   (template_app (template_hole 8, template_var 2),
                    template_hole 7),
                  template_var 1)
                )
            ),
        template_predicate (template_app (template_hole 6, t_empty)),
        template_predicate (template_app (template_hole 4, template_var 1)),
        template_equation
         (template_app (template_hole 2, template_var 1),
          template_app (template_hole 1, template_var 0))],
       template_predicate
        (
           template_app
            (template_app
              (template_hole 0,
               template_app (template_hole 4, template_var 0)),
             template_app
              (template_hole 9,
               template_app
                (template_app
                  (template_app (template_hole 8, template_var 2),
                   template_hole 7),
                 template_var 0)))
           ))),
    ("Protocols_Normalize.compress_normalize_protocols_step_hasdisc_negated",
     "[| ~ has_disc_negated ?disc ?neg ?m; ALL a. ~ ?disc (Prot a);
         normalized_nnf_match ?m;
         compress_normalize_protocols_step ?m = Some ?m' |]
      ==> normalized_nnf_match ?m' & ~ has_disc_negated ?disc ?neg ?m'",
     template_implication
      ([template_negation
         (
            template_predicate
             (
                template_app
                 (template_app
                   (template_app (template_hole 7, template_var 3),
                    template_var 2),
                  template_var 1)
                )
            ),
        template_predicate (template_app (template_hole 6, t_empty)),
        template_predicate (template_app (template_hole 4, template_var 1)),
        template_equation
         (template_app (template_hole 2, template_var 1),
          template_app (template_hole 1, template_var 0))],
       template_predicate
        (
           template_app
            (template_app
              (template_hole 0,
               template_app (template_hole 4, template_var 0)),
             template_app
              (template_hole 8,
               template_app
                (template_app
                  (template_app (template_hole 7, template_var 3),
                   template_var 2),
                 template_var 0)))
           ))),
    ("Protocols_Normalize.compress_normalize_protocols_preserves_normalized_n_primitive",
     "[| normalized_n_primitive (?disc, ?sel) ?P ?m;
         ALL a. ~ ?disc (Prot a); normalized_nnf_match ?m;
         compress_normalize_protocols ?m = Some ?m' |]
      ==> normalized_nnf_match ?m' &
          normalized_n_primitive (?disc, ?sel) ?P ?m'",
     template_implication
      ([template_predicate
         (
            template_app
             (template_app
               (template_app
                 (template_hole 9,
                  template_app
                   (template_app (template_hole 8, template_var 4),
                    template_var 3)),
                template_var 2),
              template_var 1)
            ),
        template_predicate (template_app (template_hole 7, t_empty)),
        template_predicate (template_app (template_hole 4, template_var 1)),
        template_equation
         (template_app (template_hole 2, template_var 1),
          template_app (template_hole 1, template_var 0))],
       template_predicate
        (
           template_app
            (template_app
              (template_hole 0,
               template_app (template_hole 4, template_var 0)),
             template_app
              (template_app
                (template_app
                  (template_hole 9,
                   template_app
                    (template_app (template_hole 8, template_var 4),
                     template_var 3)),
                 template_var 2),
               template_var 0))
           ))),
    ("Protocols_Normalize.compress_normalize_protocols_step_preserves_normalized_n_primitive",
     "[| normalized_n_primitive (?disc, ?sel) ?P ?m;
         ALL a. ~ ?disc (Prot a); normalized_nnf_match ?m;
         compress_normalize_protocols_step ?m = Some ?m' |]
      ==> normalized_nnf_match ?m' &
          normalized_n_primitive (?disc, ?sel) ?P ?m'",
     template_implication
      ([template_predicate
         (
            template_app
             (template_app
               (template_app
                 (template_hole 9,
                  template_app
                   (template_app (template_hole 8, template_var 4),
                    template_var 3)),
                template_var 2),
              template_var 1)
            ),
        template_predicate (template_app (template_hole 7, t_empty)),
        template_predicate (template_app (template_hole 4, template_var 1)),
        template_equation
         (template_app (template_hole 2, template_var 1),
          template_app (template_hole 1, template_var 0))],
       template_predicate
        (
           template_app
            (template_app
              (template_hole 0,
               template_app (template_hole 4, template_var 0)),
             template_app
              (template_app
                (template_app
                  (template_hole 9,
                   template_app
                    (template_app (template_hole 8, template_var 4),
                     template_var 3)),
                 template_var 2),
               template_var 0))
           ))),
    ("Protocols_Normalize.compress_protocols_code",
     "compress_protocols ?ps =
      (case compress_pos_protocols (getPos ?ps) of None => None
       | Some proto =>
           if ProtoAny : set (getNeg ?ps) |
              (ALL p:set (word_upto 0 255). Proto p : set (getNeg ?ps))
           then None
           else if proto = ProtoAny then Some ([], getNeg ?ps)
                else if EX p:set (getNeg ?ps).
                           simple_proto_conjunct proto p ~= None
                     then None else Some ([proto], []))",
     template_equation
      (template_app (template_hole 28, template_var 0),
       template_app
        (template_app
          (template_app (template_hole 27, template_hole 26), t_empty),
         template_app
          (template_hole 1,
           template_app (template_hole 0, template_var 0))))),
    ("Protocols_Normalize.import_protocols_from_ports_erule",
     "[| normalized_nnf_match ?m; ?P ?m;
         !!srcpts rst1 dstpts rst2.
            [| normalized_nnf_match ?m;
               primitive_extractor (is_Src_Ports, src_ports_sel) ?m =
               (srcpts, rst1);
               primitive_extractor (is_Dst_Ports, dst_ports_sel) rst1 =
               (dstpts, rst2);
               normalized_nnf_match rst1; normalized_nnf_match rst2 |]
            ==> ?P (MatchAnd
                     (MatchAnd
                       (MatchAnd
                         (andfold_MatchExp
                           (map (Match o
                                 (Prot o
                                  case_ipt_l4_ports
                                   (%proto x. Proto proto)))
                             (getPos srcpts)))
                         (andfold_MatchExp
                           (map (Match o
                                 (Prot o
                                  case_ipt_l4_ports
                                   (%proto x. Proto proto)))
                             (getPos dstpts))))
                       (alist_and'
                         (NegPos_map Src_Ports srcpts @
                          NegPos_map Dst_Ports dstpts)))
                     rst2) |]
      ==> ?P (import_protocols_from_ports ?m)",
     template_implication
      ([template_predicate
         (template_app (template_hole 26, template_var 1)),
        template_predicate (template_app (template_var 0, template_var 1)),
        template_predicate (template_app (template_hole 25, t_empty))],
       template_predicate
        (
           template_app
            (template_var 0, template_app (template_hole 0, template_var 1))
           )))]
