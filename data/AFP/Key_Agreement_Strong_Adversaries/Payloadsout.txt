Loading theory "Draft.Messages" (required by "Draft.PayloadsTemplates" via "Draft.Payloads" via "Draft.Message_derivation")
Loading theory "HOL-Library.Function_Algebras" (required by "Draft.PayloadsTemplates" via "Draft.ExtrEqs" via "HOL-Library.BigO")
Loading theory "HOL-Library.Nat_Bijection" (required by "Draft.PayloadsTemplates" via "Draft.ExtrEqs" via "HOL-Library.Stream")
Loading theory "HOL-Library.Set_Algebras" (required by "Draft.PayloadsTemplates" via "Draft.ExtrEqs" via "HOL-Library.BigO")
instantiation
  fun :: (type, plus) plus
  plus_fun == plus :: ('a => 'b) => ('a => 'b) => 'a => 'b
instantiation
  set :: (plus) plus
  plus_set == plus :: 'a set => 'a set => 'a set
instantiation
  fun :: (type, zero) zero
  zero_fun == zero_class.zero :: 'a => 'b
instantiation
  set :: (times) times
  times_set == times :: 'a set => 'a set => 'a set
instantiation
  fun :: (type, times) times
  times_fun == times :: ('a => 'b) => ('a => 'b) => 'a => 'b
instantiation
  set :: (zero) zero
  zero_set == zero_class.zero :: 'a set
instantiation
  fun :: (type, one) one
  one_fun == one_class.one :: 'a => 'b
instantiation
  set :: (one) one
  one_set == one_class.one :: 'a set
Found termination order: "(%p. size (snd p)) <*mlex*> {}"
### theory "HOL-Library.Function_Algebras"
### 0.106s elapsed time, 0.449s cpu time, 0.000s GC time
Loading theory "HOL-Library.Tree" (required by "Draft.PayloadsTemplates" via "Draft.ExtrEqs" via "Draft.Templates")
Found termination order: "size_list size <*mlex*> {}"
### theory "HOL-Library.Set_Algebras"
### 0.288s elapsed time, 1.151s cpu time, 0.081s GC time
Loading theory "HOL-Library.BigO" (required by "Draft.PayloadsTemplates" via "Draft.ExtrEqs")
### theory "HOL-Library.Nat_Bijection"
### 0.301s elapsed time, 1.211s cpu time, 0.081s GC time
Loading theory "HOL-Library.Stream" (required by "Draft.PayloadsTemplates" via "Draft.ExtrEqs")
Found termination order: "{}"
Found termination order: "{}"
consts
  left :: "'a tree => 'a tree"
consts
  right :: "'a tree => 'a tree"
Found termination order: "size <*mlex*> {}"
consts
  shift :: "'a list => 'a stream => 'a stream"
Proofs for coinductive predicate(s) "streamsp"
  Proving monotonicity ...
Found termination order: "size <*mlex*> {}"
consts
  snth :: "'a stream => nat => 'a"
consts
  stake :: "nat => 'a stream => 'a list"
Found termination order: "size <*mlex*> {}"
consts
  sdrop :: "nat => 'a stream => 'a stream"
class height = type +
  fixes height :: "'a => nat"
instantiation
  tree :: (type) height
  height_tree == height :: 'a tree => nat
consts
  sfilter :: "('a => bool) => 'a stream => 'a stream"
consts
  cycle :: "'a list => 'a stream"
Found termination order: "size <*mlex*> {}"
consts
  siterate :: "('a => 'a) => 'a => 'a stream"
Found termination order: "size <*mlex*> {}"
consts
  flat :: "'a list stream => 'a stream"
### theory "HOL-Library.BigO"
### 0.920s elapsed time, 3.483s cpu time, 0.732s GC time
Found termination order: "size <*mlex*> {}"
consts
  sinterleave :: "'a stream => 'a stream => 'a stream"
consts
  szip :: "'a stream => 'b stream => ('a * 'b) stream"
consts
  smap2 :: "('a => 'b => 'c) => 'a stream => 'b stream => 'c stream"
Found termination order: "size <*mlex*> {}"
### theory "HOL-Library.Stream"
### 1.040s elapsed time, 3.852s cpu time, 0.801s GC time
Found termination order: "size <*mlex*> {}"
Found termination order: "size <*mlex*> {}"
Found termination order: "size <*mlex*> {}"
Found termination order: "(%p. size (fst p)) <*mlex*> {}"
Found termination order: "size <*mlex*> {}"
Found termination order: "(%p. size (snd p)) <*mlex*> {}"
Found termination order: "size <*mlex*> {}"
### theory "HOL-Library.Tree"
### 1.912s elapsed time, 6.024s cpu time, 0.996s GC time
Loading theory "Draft.Templates" (required by "Draft.PayloadsTemplates" via "Draft.ExtrEqs")
datatype template_term
=
     t_empty
   | template_app of template_term * template_term
   | template_hole of int
   | template_var of int
datatype sign
= equals | greater_equals | greater_than | less_equals | less_than
datatype template
=
     template_bimplication of template * template
   | template_dunno
   | template_equation of template_term * template_term
   | template_implication of template list * template
   | template_inequation of sign * template_term * template_term
   | template_negation of template
   | template_predicate of template_term
constructor t_empty: template_term
constructor template_app: template_term * template_term -> template_term
constructor template_hole: int -> template_term
constructor template_var: int -> template_term
constructor equals: sign
constructor greater_equals: sign
constructor greater_than: sign
constructor less_equals: sign
constructor less_than: sign
constructor template_bimplication: template * template -> template
constructor template_dunno: template
constructor template_equation: template_term * template_term -> template
constructor template_implication: template list * template -> template
constructor template_inequation:
   sign * template_term * template_term -> template
constructor template_negation: template -> template
constructor template_predicate: template_term -> template
val vfs = fn: term -> (indexname * typ) list * (string * typ) list
val indexOf = fn: ''a list -> ''a -> int -> int
val has_eq = fn: term -> bool
val term2template = fn:
   (indexname * typ) list -> (string * typ) list -> term -> template_term
val lemma2predicate = fn: term -> term -> template
val makeTemplatewithContext = fn: term -> term -> template
val lemma2template = fn: term -> template
val thm2template = fn: thm -> template
val tterm2string = fn: template_term -> string
val template2string = fn: template -> string
val t = "height ?t <= size ?t": thm
val th =
   Const ("HOL.Trueprop", "bool => prop") $
     (Const ("Orderings.ord_class.less_eq", "nat => nat => bool") $
       (Const ("Tree.height_class.height", "?'a tree => nat") $
         Var (("t", 0), "?'a tree")) $
       (Const ("Nat.size_class.size", "?'a tree => nat") $
         Var (("t", 0), "?'a tree"))):
   term
### theory "Draft.Templates"
### 0.071s elapsed time, 0.169s cpu time, 0.062s GC time
Loading theory "Draft.ExtrEqs" (required by "Draft.PayloadsTemplates")
Found termination order: "{}"
Proofs for inductive predicate(s) "eq"
  Proving monotonicity ...
val eqpattern =
   Pattern
    (
       Const ("HOL.Trueprop", "bool => prop") $
         (Const ("HOL.eq", "?'a => ?'a => bool") $
           Var (("_dummy_", 1), "?'a") $ Var (("_dummy_", 2), "?'a"))
       ):
   term Find_Theorems.criterion
val badeqpattern = Pattern (Const ("Pure.eq", "?'a => ?'a => prop")):
   term Find_Theorems.criterion
val undefpattern =
   Pattern
    (
       Const ("HOL.Trueprop", "bool => prop") $
         (Const ("HOL.eq", "?'a => ?'a => bool") $
           Var (("_dummy_", 1), "?'a") $ Const ("HOL.undefined", "?'a"))
       ):
   term Find_Theorems.criterion
val thmpattern =
   Pattern
    (Const ("HOL.Trueprop", "bool => prop") $ Var (("_dummy_", 1), "bool")):
   term Find_Theorems.criterion
val badnames =
   ["*nitpick*", "*Nitpick*", "*full_exhaustive*", "*_def*", "Enum.finite*",
    "*Quickcheck*", "ATP*", "*Nunchaku*", "*Code*", "*BNF*", "*SMT*",
    "*.*.*"]:
   string list
val unwanted_names =
   [(false, Name "*nitpick*"), (false, Name "*Nitpick*"),
    (false, Name "*full_exhaustive*"), (false, Name "*_def*"),
    (false, Name "Enum.finite*"), (false, Name "*Quickcheck*"),
    (false, Name "ATP*"), (false, Name "*Nunchaku*"),
    (false, Name "*Code*"), (false, Name "*BNF*"), (false, Name "*SMT*"),
    (false, Name "*.*.*")]:
   (bool * term Find_Theorems.criterion) list
val has_vars = fn: term -> bool
val get_all_eqs = fn: string -> Proof.context -> (string * thm) list
val get_all_thms = fn: string -> Proof.context -> (string * thm) list
val get_noneq_thms = fn: string -> Proof.context -> (string * thm) list
val template_eqs = fn:
   string -> Proof.context -> (string * thm * template) list
val template_thms = fn:
   string -> Proof.context -> (string * thm * template) list
### theory "Draft.ExtrEqs"
### 0.749s elapsed time, 1.779s cpu time, 0.670s GC time
### theory "Draft.Messages"
### 3.178s elapsed time, 8.785s cpu time, 1.777s GC time
Loading theory "Draft.Message_derivation" (required by "Draft.PayloadsTemplates" via "Draft.Payloads")
Proofs for inductive predicate(s) "synthp"
  Proving monotonicity ...
Proofs for inductive predicate(s) "analzp"
  Proving monotonicity ...
[| ?x : analz ?H; !!X. X : ?H ==> ?P X;
   !!X Y.
      [| \<langle>X, Y\<rangle> : analz ?H; ?P \<langle>X, Y\<rangle> |]
      ==> ?P X;
   !!X Y.
      [| \<langle>X, Y\<rangle> : analz ?H; ?P \<langle>X, Y\<rangle> |]
      ==> ?P Y;
   !!X Y.
      [| Enc X Y : analz ?H; ?P (Enc X Y);
         Y : synth (analz ?H Int Collect ?P) |]
      ==> ?P X;
   !!X Y.
      [| Aenc X (pubK Y) : analz ?H; ?P (Aenc X (pubK Y));
         priK Y : analz ?H; ?P (priK Y) |]
      ==> ?P X;
   !!X Y.
      [| Aenc X (epubK Y) : analz ?H; ?P (Aenc X (epubK Y));
         epriK Y : synth (analz ?H Int Collect ?P) |]
      ==> ?P X;
   !!X Y.
      [| Sign X (priK Y) : analz ?H; ?P (Sign X (priK Y));
         pubK Y : analz ?H; ?P (pubK Y) |]
      ==> ?P X |]
==> ?P ?x
Proofs for inductive predicate(s) "partsp"
  Proving monotonicity ...
### theory "Draft.Message_derivation"
### 0.536s elapsed time, 0.611s cpu time, 0.086s GC time
Loading theory "Draft.Payloads" (required by "Draft.PayloadsTemplates")
Proofs for inductive predicate(s) "cpayloadp"
  Proving monotonicity ...
### theory "Draft.Payloads"
### 0.309s elapsed time, 0.309s cpu time, 0.000s GC time
Loading theory "Draft.PayloadsTemplates"
val templateLemmas =
   [("Payloads.payload_AgentI", "Messages.Agent ?A : payload",
     template_predicate
      (
         template_app
          (template_app
            (template_hole 2,
             template_app (template_hole 1, template_var 0)),
           template_hole 0)
         )),
    ("Payloads.payload_EphKI", "EphK ?X : payload",
     template_predicate
      (
         template_app
          (template_app
            (template_hole 2,
             template_app (template_hole 1, template_var 0)),
           template_hole 0)
         )),
    ("Payloads.payload_NonceI", "Nonce ?N : payload",
     template_predicate
      (
         template_app
          (template_app
            (template_hole 2,
             template_app (template_hole 1, template_var 0)),
           template_hole 0)
         )),
    ("Payloads.payload_NumberI", "Number ?N : payload",
     template_predicate
      (
         template_app
          (template_app
            (template_hole 2,
             template_app (template_hole 1, template_var 0)),
           template_hole 0)
         )),
    ("Payloads.eq_rep_abs", "eq ?x (Messages.Re (Ab ?x))",
     template_predicate
      (
         template_app
          (template_app (template_hole 2, template_var 0),
           template_app
            (template_hole 1,
             template_app (template_hole 0, template_var 0)))
         )),
    ("Payloads.analz_keys_of", "analz (keys_of ?A) = keys_of ?A",
     template_equation
      (template_app
        (template_hole 1, template_app (template_hole 0, template_var 0)),
       template_app (template_hole 0, template_var 0))),
    ("Payloads.parts_keys_of", "parts (keys_of ?A) = keys_of ?A",
     template_equation
      (template_app
        (template_hole 1, template_app (template_hole 0, template_var 0)),
       template_app (template_hole 0, template_var 0))),
    ("Payloads.keys_of_Ltk", "keys_of ?A <= range LtK",
     template_inequation
      (less_equals, template_app (template_hole 3, template_var 0),
       template_app
        (template_app (template_hole 2, template_hole 1),
         template_hole 0))),
    ("Payloads.priK_keys_of", "priK ?A : keys_of ?A",
     template_predicate
      (
         template_app
          (template_app
            (template_hole 3,
             template_app
              (template_hole 2,
               template_app (template_hole 1, template_var 0))),
           template_app (template_hole 0, template_var 0))
         )),
    ("Payloads.shrK_keys_of_1", "shrK ?A ?B : keys_of ?A",
     template_predicate
      (
         template_app
          (template_app
            (template_hole 3,
             template_app
              (template_hole 2,
               template_app
                (template_app (template_hole 1, template_var 1),
                 template_var 0))),
           template_app (template_hole 0, template_var 1))
         )),
    ("Payloads.shrK_keys_of_2", "shrK ?B ?A : keys_of ?A",
     template_predicate
      (
         template_app
          (template_app
            (template_hole 3,
             template_app
              (template_hole 2,
               template_app
                (template_app (template_hole 1, template_var 1),
                 template_var 0))),
           template_app (template_hole 0, template_var 0))
         )),
    ("Payloads.Enc_keys_clean_payload",
     "?NI <= payload ==> Enc_keys_clean ?NI",
     template_implication
      ([template_inequation (less_equals, template_var 0, template_hole 1)],
       template_predicate
        (template_app (template_hole 0, template_var 0)))),
    ("Payloads.payload_LtK", "LtK ?X : payload ==> ?P",
     template_implication
      ([template_predicate
         (
            template_app
             (template_app
               (template_hole 2,
                template_app (template_hole 1, template_var 1)),
              template_hole 0)
            )],
       template_predicate (template_var 0))),
    ("Payloads.payload_Tag", "Tag ?X : payload ==> ?P",
     template_implication
      ([template_predicate
         (
            template_app
             (template_app
               (template_hole 2,
                template_app (template_hole 1, template_var 1)),
              template_hole 0)
            )],
       template_predicate (template_var 0))),
    ("Payloads.abs_payload", "(Ab ?x : payload) = (?x : cpayload)",
     template_equation
      (template_app
        (template_app
          (template_hole 4, template_app (template_hole 3, template_var 0)),
         template_hole 2),
       template_app
        (template_app (template_hole 1, template_var 0), template_hole 0))),
    ("Payloads.payload_rep_cpayload",
     "(Messages.Re ?x : cpayload) = (?x : payload)",
     template_equation
      (template_app
        (template_app
          (template_hole 4, template_app (template_hole 3, template_var 0)),
         template_hole 2),
       template_app
        (template_app (template_hole 1, template_var 0), template_hole 0))),
    ("Payloads.payload_HashI", "?x : payload ==> Hash ?x : payload",
     template_implication
      ([template_predicate
         (
            template_app
             (template_app (template_hole 2, template_var 0),
              template_hole 1)
            )],
       template_predicate
        (
           template_app
            (template_app
              (template_hole 2,
               template_app (template_hole 0, template_var 0)),
             template_hole 1)
           ))),
    ("Payloads.Enc_keys_clean_LtKeys",
     "?K <= range LtK ==> Enc_keys_clean ?K",
     template_implication
      ([template_inequation
         (less_equals, template_var 0,
          template_app
           (template_app (template_hole 3, template_hole 2),
            template_hole 1))],
       template_predicate
        (template_app (template_hole 0, template_var 0)))),
    ("Payloads.Enc_keys_clean_Un",
     "Enc_keys_clean (?G Un ?H) = (Enc_keys_clean ?G & Enc_keys_clean ?H)",
     template_equation
      (template_app
        (template_hole 2,
         template_app
          (template_app (template_hole 1, template_var 1), template_var 0)),
       template_app
        (template_app
          (template_hole 0, template_app (template_hole 2, template_var 1)),
         template_app (template_hole 2, template_var 0)))),
    ("Payloads.abs_cpayload_rep",
     "(?x : Ab ` cpayload) = (Messages.Re ?x : cpayload)",
     template_equation
      (template_app
        (template_app (template_hole 5, template_var 0),
         template_app
          (template_app (template_hole 4, template_hole 3),
           template_hole 2)),
       template_app
        (template_app
          (template_hole 1, template_app (template_hole 0, template_var 0)),
         template_hole 2))),
    ("Payloads.Keys_bad_Ltk",
     "Keys_bad (?IK Int range LtK) ?Bad = Keys_bad ?IK ?Bad",
     template_equation
      (template_app
        (template_app
          (template_hole 4,
           template_app
            (template_app (template_hole 3, template_var 1),
             template_app
              (template_app (template_hole 2, template_hole 1),
               template_hole 0))),
         template_var 0),
       template_app
        (template_app (template_hole 4, template_var 1), template_var 0))),
    ("Payloads.parts_of_LtKeys", "?K <= range LtK ==> parts ?K = ?K",
     template_implication
      ([template_inequation
         (less_equals, template_var 0,
          template_app
           (template_app (template_hole 4, template_hole 3),
            template_hole 2))],
       template_equation
        (template_app (template_hole 0, template_var 0), template_var 0))),
    ("Payloads.priK_keys_of_eq", "priK ?B : keys_of ?A ==> ?A = ?B",
     template_implication
      ([template_predicate
         (
            template_app
             (template_app
               (template_hole 4,
                template_app
                 (template_hole 3,
                  template_app (template_hole 2, template_var 1))),
              template_app (template_hole 1, template_var 0))
            )],
       template_equation (template_var 0, template_var 1))),
    ("Payloads.Enc_keys_clean_mono",
     "[| Enc_keys_clean ?H; ?G <= ?H |] ==> Enc_keys_clean ?G",
     template_implication
      ([template_predicate (template_app (template_hole 1, template_var 1)),
        template_inequation (less_equals, template_var 0, template_var 1)],
       template_predicate
        (template_app (template_hole 1, template_var 0)))),
    ("Payloads.LtKeys_payload", "?NI <= payload ==> ?NI Int range LtK = {}",
     template_implication
      ([template_inequation (less_equals, template_var 0, template_hole 6)],
       template_equation
        (template_app
          (template_app (template_hole 4, template_var 0),
           template_app
            (template_app (template_hole 3, template_hole 2),
             template_hole 1)),
         template_hole 0))),
    ("Payloads.Keys_bad_insert_pubK",
     "Keys_bad ?IK ?Bad ==> Keys_bad (insert (pubK ?A) ?IK) ?Bad",
     template_implication
      ([template_predicate
         (
            template_app
             (template_app (template_hole 3, template_var 2),
              template_var 1)
            )],
       template_predicate
        (
           template_app
            (template_app
              (template_hole 3,
               template_app
                (template_app
                  (template_hole 2,
                   template_app
                    (template_hole 1,
                     template_app (template_hole 0, template_var 0))),
                 template_var 2)),
             template_var 1)
           ))),
    ("Payloads.analz_Un_AgentSet",
     "analz (AgentSet Un ?H) <= AgentSet Un analz ?H",
     template_inequation
      (less_equals,
       template_app
        (template_hole 4,
         template_app
          (template_app
            (template_hole 3,
             template_app
              (template_app (template_hole 2, template_hole 1),
               template_hole 0)),
           template_var 0)),
       template_app
        (template_app
          (template_hole 3,
           template_app
            (template_app (template_hole 2, template_hole 1),
             template_hole 0)),
         template_app (template_hole 4, template_var 0)))),
    ("Payloads.LtKeys_parts_payload",
     "?NI <= payload ==> parts ?NI Int range LtK = {}",
     template_implication
      ([template_inequation (less_equals, template_var 0, template_hole 7)],
       template_equation
        (template_app
          (template_app
            (template_hole 5,
             template_app (template_hole 4, template_var 0)),
           template_app
            (template_app (template_hole 3, template_hole 2),
             template_hole 1)),
         template_hole 0))),
    ("Payloads.Keys_bad_insert_keys_of",
     "Keys_bad ?Ik ?Bad ==> Keys_bad (keys_of ?A Un ?Ik) (insert ?A ?Bad)",
     template_implication
      ([template_predicate
         (
            template_app
             (template_app (template_hole 3, template_var 2),
              template_var 1)
            )],
       template_predicate
        (
           template_app
            (template_app
              (template_hole 3,
               template_app
                (template_app
                  (template_hole 2,
                   template_app (template_hole 1, template_var 0)),
                 template_var 2)),
             template_app
              (template_app (template_hole 0, template_var 0),
               template_var 1))
           ))),
    ("Payloads.eq_cpayload",
     "[| eq ?x ?y; ?x : cpayload |] ==> ?y : cpayload",
     template_implication
      ([template_predicate
         (
            template_app
             (template_app (template_hole 2, template_var 1),
              template_var 0)
            ),
        template_predicate
         (
            template_app
             (template_app (template_hole 1, template_var 1),
              template_hole 0)
            )],
       template_predicate
        (
           template_app
            (template_app (template_hole 1, template_var 0),
             template_hole 0)
           ))),
    ("Payloads.payload_analz",
     "[| ?X : analz ?S; ?S <= payload |] ==> ?X : payload",
     template_implication
      ([template_predicate
         (
            template_app
             (template_app (template_hole 3, template_var 1),
              template_app (template_hole 2, template_var 0))
            ),
        template_inequation (less_equals, template_var 0, template_hole 0)],
       template_predicate
        (
           template_app
            (template_app (template_hole 3, template_var 1),
             template_hole 0)
           ))),
    ("Payloads.payload_parts",
     "[| ?X : parts ?S; ?S <= payload |] ==> ?X : payload",
     template_implication
      ([template_predicate
         (
            template_app
             (template_app (template_hole 3, template_var 1),
              template_app (template_hole 2, template_var 0))
            ),
        template_inequation (less_equals, template_var 0, template_hole 0)],
       template_predicate
        (
           template_app
            (template_app (template_hole 3, template_var 1),
             template_hole 0)
           ))),
    ("Payloads.Keys_bad_insert_payload",
     "[| Keys_bad ?Ik ?Bad; ?x : payload |]
      ==> Keys_bad (insert ?x ?Ik) ?Bad",
     template_implication
      ([template_predicate
         (
            template_app
             (template_app (template_hole 3, template_var 2),
              template_var 1)
            ),
        template_predicate
         (
            template_app
             (template_app (template_hole 2, template_var 0),
              template_hole 1)
            )],
       template_predicate
        (
           template_app
            (template_app
              (template_hole 3,
               template_app
                (template_app (template_hole 0, template_var 0),
                 template_var 2)),
             template_var 1)
           ))),
    ("Payloads.LtKeys_parts_payload_singleton",
     "[| ?X : payload; LtK ?Y : parts {?X} |] ==> False",
     template_implication
      ([template_predicate
         (
            template_app
             (template_app (template_hole 6, template_var 1),
              template_hole 5)
            ),
        template_predicate
         (
            template_app
             (template_app
               (template_hole 6,
                template_app (template_hole 4, template_var 0)),
              template_app
               (template_hole 3,
                template_app
                 (template_app (template_hole 2, template_var 1),
                  template_hole 1)))
            )],
       template_predicate (template_hole 0))),
    ("Payloads.payload_AencI",
     "[| ?x : payload; ?y : payload |] ==> Aenc ?x ?y : payload",
     template_implication
      ([template_predicate
         (
            template_app
             (template_app (template_hole 2, template_var 1),
              template_hole 1)
            ),
        template_predicate
         (
            template_app
             (template_app (template_hole 2, template_var 0),
              template_hole 1)
            )],
       template_predicate
        (
           template_app
            (template_app
              (template_hole 2,
               template_app
                (template_app (template_hole 0, template_var 1),
                 template_var 0)),
             template_hole 1)
           ))),
    ("Payloads.payload_EncI",
     "[| ?x : payload; ?y : payload |] ==> Enc ?x ?y : payload",
     template_implication
      ([template_predicate
         (
            template_app
             (template_app (template_hole 2, template_var 1),
              template_hole 1)
            ),
        template_predicate
         (
            template_app
             (template_app (template_hole 2, template_var 0),
              template_hole 1)
            )],
       template_predicate
        (
           template_app
            (template_app
              (template_hole 2,
               template_app
                (template_app (template_hole 0, template_var 1),
                 template_var 0)),
             template_hole 1)
           ))),
    ("Payloads.payload_ExpI",
     "[| ?x : payload; ?y : payload |] ==> Exp ?x ?y : payload",
     template_implication
      ([template_predicate
         (
            template_app
             (template_app (template_hole 2, template_var 1),
              template_hole 1)
            ),
        template_predicate
         (
            template_app
             (template_app (template_hole 2, template_var 0),
              template_hole 1)
            )],
       template_predicate
        (
           template_app
            (template_app
              (template_hole 2,
               template_app
                (template_app (template_hole 0, template_var 1),
                 template_var 0)),
             template_hole 1)
           ))),
    ("Payloads.payload_PairI",
     "[| ?x : payload; ?y : payload |]
      ==> \<langle>?x, ?y\<rangle> : payload",
     template_implication
      ([template_predicate
         (
            template_app
             (template_app (template_hole 2, template_var 1),
              template_hole 1)
            ),
        template_predicate
         (
            template_app
             (template_app (template_hole 2, template_var 0),
              template_hole 1)
            )],
       template_predicate
        (
           template_app
            (template_app
              (template_hole 2,
               template_app
                (template_app (template_hole 0, template_var 1),
                 template_var 0)),
             template_hole 1)
           ))),
    ("Payloads.payload_SignI",
     "[| ?x : payload; ?y : payload |] ==> Sign ?x ?y : payload",
     template_implication
      ([template_predicate
         (
            template_app
             (template_app (template_hole 2, template_var 1),
              template_hole 1)
            ),
        template_predicate
         (
            template_app
             (template_app (template_hole 2, template_var 0),
              template_hole 1)
            )],
       template_predicate
        (
           template_app
            (template_app
              (template_hole 2,
               template_app
                (template_app (template_hole 0, template_var 1),
                 template_var 0)),
             template_hole 1)
           ))),
    ("Payloads.payload_Hash",
     "[| Hash ?X : payload; ?X : payload ==> ?P |] ==> ?P",
     template_implication
      ([template_predicate
         (
            template_app
             (template_app
               (template_hole 2,
                template_app (template_hole 1, template_var 1)),
              template_hole 0)
            ),
        template_implication
         ([template_predicate
            (
               template_app
                (template_app (template_hole 2, template_var 1),
                 template_hole 0)
               )],
          template_predicate (template_var 0))],
       template_predicate (template_var 0))),
    ("Payloads.payload_synth_analz",
     "[| ?X : synth (analz ?S); ?S <= payload |] ==> ?X : payload",
     template_implication
      ([template_predicate
         (
            template_app
             (template_app (template_hole 4, template_var 1),
              template_app
               (template_hole 3,
                template_app (template_hole 2, template_var 0)))
            ),
        template_inequation (less_equals, template_var 0, template_hole 0)],
       template_predicate
        (
           template_app
            (template_app (template_hole 4, template_var 1),
             template_hole 0)
           ))),
    ("Payloads.Keys_bad_priK_D",
     "[| priK ?A : ?IK; Keys_bad ?IK ?Bad |] ==> ?A : ?Bad",
     template_implication
      ([template_predicate
         (
            template_app
             (template_app
               (template_hole 4,
                template_app
                 (template_hole 3,
                  template_app (template_hole 2, template_var 2))),
              template_var 1)
            ),
        template_predicate
         (
            template_app
             (template_app (template_hole 1, template_var 1),
              template_var 0)
            )],
       template_predicate
        (
           template_app
            (template_app (template_hole 0, template_var 2), template_var 0)
           ))),
    ("Payloads.shrK_keys_of_eq",
     "shrK ?A ?B : keys_of ?C ==> ?A = ?C | ?B = ?C",
     template_implication
      ([template_predicate
         (
            template_app
             (template_app
               (template_hole 5,
                template_app
                 (template_hole 4,
                  template_app
                   (template_app (template_hole 3, template_var 2),
                    template_var 1))),
              template_app (template_hole 2, template_var 0))
            )],
       template_predicate
        (
           template_app
            (template_app
              (template_hole 1,
               template_app
                (template_app (template_hole 0, template_var 2),
                 template_var 0)),
             template_app
              (template_app (template_hole 0, template_var 1),
               template_var 0))
           ))),
    ("Payloads.payload_parts_singleton",
     "[| ?X : parts {?Y}; ?Y : payload |] ==> ?X : payload",
     template_implication
      ([template_predicate
         (
            template_app
             (template_app (template_hole 4, template_var 1),
              template_app
               (template_hole 3,
                template_app
                 (template_app (template_hole 2, template_var 0),
                  template_hole 1)))
            ),
        template_predicate
         (
            template_app
             (template_app (template_hole 4, template_var 0),
              template_hole 0)
            )],
       template_predicate
        (
           template_app
            (template_app (template_hole 4, template_var 1),
             template_hole 0)
           ))),
    ("Payloads.analz_Un_Tag",
     "Enc_keys_clean ?H ==> analz (Tags Un ?H) <= Tags Un analz ?H",
     template_implication
      ([template_predicate
         (template_app (template_hole 6, template_var 0))],
       template_inequation
        (less_equals,
         template_app
          (template_hole 4,
           template_app
            (template_app
              (template_hole 3,
               template_app
                (template_app (template_hole 2, template_hole 1),
                 template_hole 0)),
             template_var 0)),
         template_app
          (template_app
            (template_hole 3,
             template_app
              (template_app (template_hole 2, template_hole 1),
               template_hole 0)),
           template_app (template_hole 4, template_var 0))))),
    ("Payloads.synth_payload",
     "?Y Int payload = {} ==> synth (?X Un ?Y) <= synth ?X Un - payload",
     template_implication
      ([template_equation
         (template_app
           (template_app (template_hole 6, template_var 1),
            template_hole 5),
          template_hole 4)],
       template_inequation
        (less_equals,
         template_app
          (template_hole 2,
           template_app
            (template_app (template_hole 1, template_var 0),
             template_var 1)),
         template_app
          (template_app
            (template_hole 1,
             template_app (template_hole 2, template_var 0)),
           template_app (template_hole 0, template_hole 5))))),
    ("Payloads.synth_payload2",
     "?Y Int payload = {} ==> synth (?Y Un ?X) <= synth ?X Un - payload",
     template_implication
      ([template_equation
         (template_app
           (template_app (template_hole 6, template_var 1),
            template_hole 5),
          template_hole 4)],
       template_inequation
        (less_equals,
         template_app
          (template_hole 2,
           template_app
            (template_app (template_hole 1, template_var 1),
             template_var 0)),
         template_app
          (template_app
            (template_hole 1,
             template_app (template_hole 2, template_var 0)),
           template_app (template_hole 0, template_hole 5))))),
    ("Payloads.Keys_bad_insert_non_LtK",
     "?X ~: range LtK ==>
      Keys_bad (insert ?X ?IK) ?Bad = Keys_bad ?IK ?Bad",
     template_implication
      ([template_negation
         (
            template_predicate
             (
                template_app
                 (template_app (template_hole 6, template_var 2),
                  template_app
                   (template_app (template_hole 5, template_hole 4),
                    template_hole 3))
                )
            )],
       template_equation
        (template_app
          (template_app
            (template_hole 1,
             template_app
              (template_app (template_hole 0, template_var 2),
               template_var 1)),
           template_var 0),
         template_app
          (template_app (template_hole 1, template_var 1),
           template_var 0)))),
    ("Payloads.synth_idem_payload",
     "?X <= synth ?Y Un - payload ==> synth ?X <= synth ?Y Un - payload",
     template_implication
      ([template_inequation
         (less_equals, template_var 1,
          template_app
           (template_app
             (template_hole 3,
              template_app (template_hole 2, template_var 0)),
            template_app (template_hole 1, template_hole 0)))],
       template_inequation
        (less_equals, template_app (template_hole 2, template_var 1),
         template_app
          (template_app
            (template_hole 3,
             template_app (template_hole 2, template_var 0)),
           template_app (template_hole 1, template_hole 0))))),
    ("Payloads.Keys_bad_insert_priK_bad",
     "[| Keys_bad ?IK ?Bad; ?A : ?Bad |]
      ==> Keys_bad (insert (priK ?A) ?IK) ?Bad",
     template_implication
      ([template_predicate
         (
            template_app
             (template_app (template_hole 4, template_var 2),
              template_var 1)
            ),
        template_predicate
         (
            template_app
             (template_app (template_hole 3, template_var 0),
              template_var 1)
            )],
       template_predicate
        (
           template_app
            (template_app
              (template_hole 4,
               template_app
                (template_app
                  (template_hole 2,
                   template_app
                    (template_hole 1,
                     template_app (template_hole 0, template_var 0))),
                 template_var 2)),
             template_var 1)
           ))),
    ("Payloads.Enc_keys_clean_analz",
     "[| Enc ?X ?K : analz ?S; Enc_keys_clean ?S |]
      ==> ?K : range LtK Un payload",
     template_implication
      ([template_predicate
         (
            template_app
             (template_app
               (template_hole 8,
                template_app
                 (template_app (template_hole 7, template_var 2),
                  template_var 1)),
              template_app (template_hole 6, template_var 0))
            ),
        template_predicate
         (template_app (template_hole 5, template_var 0))],
       template_predicate
        (
           template_app
            (template_app (template_hole 8, template_var 1),
             template_app
              (template_app
                (template_hole 4,
                 template_app
                  (template_app (template_hole 3, template_hole 2),
                   template_hole 1)),
               template_hole 0))
           ))),
    ("Payloads.Keys_bad_shrK_D",
     "[| shrK ?A ?B : ?IK; Keys_bad ?IK ?Bad |] ==> ?A : ?Bad | ?B : ?Bad",
     template_implication
      ([template_predicate
         (
            template_app
             (template_app
               (template_hole 5,
                template_app
                 (template_hole 4,
                  template_app
                   (template_app (template_hole 3, template_var 3),
                    template_var 2))),
              template_var 1)
            ),
        template_predicate
         (
            template_app
             (template_app (template_hole 2, template_var 1),
              template_var 0)
            )],
       template_predicate
        (
           template_app
            (template_app
              (template_hole 1,
               template_app
                (template_app (template_hole 0, template_var 3),
                 template_var 0)),
             template_app
              (template_app (template_hole 0, template_var 2),
               template_var 0))
           ))),
    ("Payloads.Enc_keys_clean_HashSet_Un",
     "Enc_keys_clean (?G Un ?H) ==> Enc_keys_clean (HashSet ?G Un ?H)",
     template_implication
      ([template_predicate
         (
            template_app
             (template_hole 7,
              template_app
               (template_app (template_hole 6, template_var 1),
                template_var 0))
            )],
       template_predicate
        (
           template_app
            (template_hole 7,
             template_app
              (template_app
                (template_hole 6, template_app (template_hole 5, t_empty)),
               template_var 0))
           ))),
    ("Payloads.payload_Aenc",
     "[| Aenc ?X ?Y : payload; [| ?X : payload; ?Y : payload |] ==> ?P |]
      ==> ?P",
     template_implication
      ([template_predicate
         (
            template_app
             (template_app
               (template_hole 2,
                template_app
                 (template_app (template_hole 1, template_var 2),
                  template_var 1)),
              template_hole 0)
            ),
        template_implication
         ([template_predicate
            (
               template_app
                (template_app (template_hole 2, template_var 2),
                 template_hole 0)
               )],
          template_implication
           ([template_predicate
              (
                 template_app
                  (template_app (template_hole 2, template_var 1),
                   template_hole 0)
                 )],
            template_predicate (template_var 0)))],
       template_predicate (template_var 0))),
    ("Payloads.payload_Enc",
     "[| Enc ?X ?Y : payload; [| ?X : payload; ?Y : payload |] ==> ?P |]
      ==> ?P",
     template_implication
      ([template_predicate
         (
            template_app
             (template_app
               (template_hole 2,
                template_app
                 (template_app (template_hole 1, template_var 2),
                  template_var 1)),
              template_hole 0)
            ),
        template_implication
         ([template_predicate
            (
               template_app
                (template_app (template_hole 2, template_var 2),
                 template_hole 0)
               )],
          template_implication
           ([template_predicate
              (
                 template_app
                  (template_app (template_hole 2, template_var 1),
                   template_hole 0)
                 )],
            template_predicate (template_var 0)))],
       template_predicate (template_var 0))),
    ("Payloads.payload_Exp",
     "[| Exp ?X ?Y : payload; [| ?X : payload; ?Y : payload |] ==> ?P |]
      ==> ?P",
     template_implication
      ([template_predicate
         (
            template_app
             (template_app
               (template_hole 2,
                template_app
                 (template_app (template_hole 1, template_var 2),
                  template_var 1)),
              template_hole 0)
            ),
        template_implication
         ([template_predicate
            (
               template_app
                (template_app (template_hole 2, template_var 2),
                 template_hole 0)
               )],
          template_implication
           ([template_predicate
              (
                 template_app
                  (template_app (template_hole 2, template_var 1),
                   template_hole 0)
                 )],
            template_predicate (template_var 0)))],
       template_predicate (template_var 0))),
    ("Payloads.payload_Pair",
     "[| \<langle>?X, ?Y\<rangle> : payload;
         [| ?X : payload; ?Y : payload |] ==> ?P |]
      ==> ?P",
     template_implication
      ([template_predicate
         (
            template_app
             (template_app
               (template_hole 2,
                template_app
                 (template_app (template_hole 1, template_var 2),
                  template_var 1)),
              template_hole 0)
            ),
        template_implication
         ([template_predicate
            (
               template_app
                (template_app (template_hole 2, template_var 2),
                 template_hole 0)
               )],
          template_implication
           ([template_predicate
              (
                 template_app
                  (template_app (template_hole 2, template_var 1),
                   template_hole 0)
                 )],
            template_predicate (template_var 0)))],
       template_predicate (template_var 0))),
    ("Payloads.payload_Sign",
     "[| Sign ?X ?Y : payload; [| ?X : payload; ?Y : payload |] ==> ?P |]
      ==> ?P",
     template_implication
      ([template_predicate
         (
            template_app
             (template_app
               (template_hole 2,
                template_app
                 (template_app (template_hole 1, template_var 2),
                  template_var 1)),
              template_hole 0)
            ),
        template_implication
         ([template_predicate
            (
               template_app
                (template_app (template_hole 2, template_var 2),
                 template_hole 0)
               )],
          template_implication
           ([template_predicate
              (
                 template_app
                  (template_app (template_hole 2, template_var 1),
                   template_hole 0)
                 )],
            template_predicate (template_var 0)))],
       template_predicate (template_var 0))),
    ("Payloads.Enc_keys_cleanI",
     "ALL X Y. Enc X Y : parts ?S --> Y : range LtK Un payload ==>
      Enc_keys_clean ?S",
     template_implication
      ([template_predicate (template_app (template_hole 10, t_empty))],
       template_predicate
        (template_app (template_hole 0, template_var 0)))),
    ("Payloads.Keys_bad_insert_shrK_bad",
     "[| Keys_bad ?IK ?Bad; ?A : ?Bad | ?B : ?Bad |]
      ==> Keys_bad (insert (shrK ?A ?B) ?IK) ?Bad",
     template_implication
      ([template_predicate
         (
            template_app
             (template_app (template_hole 5, template_var 3),
              template_var 2)
            ),
        template_predicate
         (
            template_app
             (template_app
               (template_hole 4,
                template_app
                 (template_app (template_hole 3, template_var 1),
                  template_var 2)),
              template_app
               (template_app (template_hole 3, template_var 0),
                template_var 2))
            )],
       template_predicate
        (
           template_app
            (template_app
              (template_hole 5,
               template_app
                (template_app
                  (template_hole 2,
                   template_app
                    (template_hole 1,
                     template_app
                      (template_app (template_hole 0, template_var 1),
                       template_var 0))),
                 template_var 3)),
             template_var 2)
           ))),
    ("Payloads.parts_HashSet", "parts (HashSet ?G) <= HashSet ?G",
     template_inequation
      (less_equals,
       template_app
        (template_hole 6, template_app (template_hole 5, t_empty)),
       template_app (template_hole 5, t_empty))),
    ("Payloads.def_keys_of",
     "?K : keys_of ?A ==>
      ?K = priK ?A | (EX B. ?K = shrK ?A B | ?K = shrK B ?A)",
     template_implication
      ([template_predicate
         (
            template_app
             (template_app (template_hole 7, template_var 1),
              template_app (template_hole 6, template_var 0))
            )],
       template_predicate
        (
           template_app
            (template_app
              (template_hole 5,
               template_app
                (template_app (template_hole 4, template_var 1),
                 template_app
                  (template_hole 3,
                   template_app (template_hole 2, template_var 0)))),
             template_app (template_hole 1, t_empty))
           ))),
    ("Payloads.Keys_bad_insert_Fake",
     "[| Keys_bad ?IK ?Bad; parts ?IK Int range LtK <= ?IK;
         ?X : synth (analz ?IK) |]
      ==> Keys_bad (insert ?X ?IK) ?Bad",
     template_implication
      ([template_predicate
         (
            template_app
             (template_app (template_hole 10, template_var 2),
              template_var 1)
            ),
        template_inequation
         (less_equals,
          template_app
           (template_app
             (template_hole 8,
              template_app (template_hole 7, template_var 2)),
            template_app
             (template_app (template_hole 6, template_hole 5),
              template_hole 4)),
          template_var 2),
        template_predicate
         (
            template_app
             (template_app (template_hole 3, template_var 0),
              template_app
               (template_hole 2,
                template_app (template_hole 1, template_var 2)))
            )],
       template_predicate
        (
           template_app
            (template_app
              (template_hole 10,
               template_app
                (template_app (template_hole 0, template_var 0),
                 template_var 2)),
             template_var 1)
           ))),
    ("Payloads.Enc_keys_clean_AencSet_Un",
     "Enc_keys_clean (?G Un ?H) ==> Enc_keys_clean (AencSet ?G ?K Un ?H)",
     template_implication
      ([template_predicate
         (
            template_app
             (template_hole 7,
              template_app
               (template_app (template_hole 6, template_var 2),
                template_var 1))
            )],
       template_predicate
        (
           template_app
            (template_hole 7,
             template_app
              (template_app
                (template_hole 6, template_app (template_hole 5, t_empty)),
               template_var 1))
           ))),
    ("Payloads.Enc_keys_clean_SignSet_Un",
     "Enc_keys_clean (?G Un ?H) ==> Enc_keys_clean (SignSet ?G ?K Un ?H)",
     template_implication
      ([template_predicate
         (
            template_app
             (template_hole 7,
              template_app
               (template_app (template_hole 6, template_var 2),
                template_var 1))
            )],
       template_predicate
        (
           template_app
            (template_hole 7,
             template_app
              (template_app
                (template_hole 6, template_app (template_hole 5, t_empty)),
               template_var 1))
           ))),
    ("Payloads.Enc_keys_clean_PairSet_Tag_Un",
     "Enc_keys_clean (?G Un ?H) ==> Enc_keys_clean (PairSet Tags ?G Un ?H)",
     template_implication
      ([template_predicate
         (
            template_app
             (template_hole 10,
              template_app
               (template_app (template_hole 9, template_var 1),
                template_var 0))
            )],
       template_predicate
        (
           template_app
            (template_hole 10,
             template_app
              (template_app
                (template_hole 9, template_app (template_hole 8, t_empty)),
               template_var 0))
           ))),
    ("Payloads.Enc_keys_clean_PairSet_Agent_Un",
     "Enc_keys_clean (?G Un ?H) ==>
      Enc_keys_clean (PairSet (Messages.Agent ` ?X) ?G Un ?H)",
     template_implication
      ([template_predicate
         (
            template_app
             (template_hole 9,
              template_app
               (template_app (template_hole 8, template_var 2),
                template_var 1))
            )],
       template_predicate
        (
           template_app
            (template_hole 9,
             template_app
              (template_app
                (template_hole 8, template_app (template_hole 7, t_empty)),
               template_var 1))
           ))),
    ("Payloads.parts_msgSetD",
     "?c : parts (HashSet ?G) ==> ?c : HashSet ?G",
     template_implication
      ([template_predicate
         (
            template_app
             (template_app (template_hole 6, template_var 1),
              template_app
               (template_hole 5, template_app (template_hole 4, t_empty)))
            )],
       template_predicate
        (
           template_app
            (template_app (template_hole 6, template_var 1),
             template_app (template_hole 4, t_empty))
           ))),
    ("Payloads.brokenD",
     "(?A, ?B) : broken ?K ==>
      priK ?A : ?K | priK ?B : ?K | shrK ?A ?B : ?K | shrK ?B ?A : ?K",
     template_implication
      ([template_predicate
         (
            template_app
             (template_app
               (template_hole 7,
                template_app
                 (template_app (template_hole 6, template_var 2),
                  template_var 1)),
              template_app (template_hole 5, template_var 0))
            )],
       template_predicate
        (
           template_app
            (template_app
              (template_hole 4,
               template_app
                (template_app
                  (template_hole 3,
                   template_app
                    (template_hole 2,
                     template_app (template_hole 1, template_var 2))),
                 template_var 0)),
             template_app
              (template_app
                (template_hole 4,
                 template_app
                  (template_app
                    (template_hole 3,
                     template_app
                      (template_hole 2,
                       template_app (template_hole 1, template_var 1))),
                   template_var 0)),
               template_app
                (template_app
                  (template_hole 4,
                   template_app
                    (template_app
                      (template_hole 3,
                       template_app
                        (template_hole 2,
                         template_app
                          (template_app (template_hole 0, template_var 2),
                           template_var 1))),
                     template_var 0)),
                 template_app
                  (template_app
                    (template_hole 3,
                     template_app
                      (template_hole 2,
                       template_app
                        (template_app (template_hole 0, template_var 1),
                         template_var 2))),
                   template_var 0))))
           ))),
    ("Payloads.brokenI",
     "priK ?A : ?K | priK ?B : ?K | shrK ?A ?B : ?K | shrK ?B ?A : ?K ==>
      (?A, ?B) : broken ?K",
     template_implication
      ([template_predicate
         (
            template_app
             (template_app
               (template_hole 7,
                template_app
                 (template_app
                   (template_hole 6,
                    template_app
                     (template_hole 5,
                      template_app (template_hole 4, template_var 2))),
                  template_var 1)),
              template_app
               (template_app
                 (template_hole 7,
                  template_app
                   (template_app
                     (template_hole 6,
                      template_app
                       (template_hole 5,
                        template_app (template_hole 4, template_var 0))),
                    template_var 1)),
                template_app
                 (template_app
                   (template_hole 7,
                    template_app
                     (template_app
                       (template_hole 6,
                        template_app
                         (template_hole 5,
                          template_app
                           (template_app (template_hole 3, template_var 2),
                            template_var 0))),
                      template_var 1)),
                  template_app
                   (template_app
                     (template_hole 6,
                      template_app
                       (template_hole 5,
                        template_app
                         (template_app (template_hole 3, template_var 0),
                          template_var 2))),
                    template_var 1))))
            )],
       template_predicate
        (
           template_app
            (template_app
              (template_hole 2,
               template_app
                (template_app (template_hole 1, template_var 2),
                 template_var 0)),
             template_app (template_hole 0, template_var 1))
           ))),
    ("Payloads.Enc_keys_clean_EncSet_Un",
     "[| ?K <= range LtK; Enc_keys_clean (?G Un ?H) |]
      ==> Enc_keys_clean (EncSet ?G ?K Un ?H)",
     template_implication
      ([template_inequation
         (less_equals, template_var 2,
          template_app
           (template_app (template_hole 10, template_hole 9),
            template_hole 8)),
        template_predicate
         (
            template_app
             (template_hole 7,
              template_app
               (template_app (template_hole 6, template_var 1),
                template_var 0))
            )],
       template_predicate
        (
           template_app
            (template_hole 7,
             template_app
              (template_app
                (template_hole 6, template_app (template_hole 5, t_empty)),
               template_var 0))
           ))),
    ("Payloads.Keys_badE",
     "[| Keys_bad ?IK ?Bad;
         [| range pubK <= ?IK;
            ?IK Int range LtK <= range pubK Un \<Union> (keys_of ` ?Bad) |]
         ==> ?P |]
      ==> ?P",
     template_implication
      ([template_predicate
         (
            template_app
             (template_app (template_hole 12, template_var 2),
              template_var 1)
            ),
        template_implication
         ([template_inequation
            (less_equals,
             template_app
              (template_app (template_hole 10, t_empty), template_hole 7),
             template_var 2)],
          template_implication
           ([template_inequation
              (less_equals,
               template_app
                (template_app (template_hole 6, template_var 2),
                 template_app
                  (template_app (template_hole 5, template_hole 9),
                   template_hole 4)),
               template_app
                (template_app
                  (template_hole 3,
                   template_app
                    (template_app (template_hole 10, t_empty),
                     template_hole 7)),
                 template_app
                  (template_hole 2,
                   template_app
                    (template_app (template_hole 1, template_hole 0),
                     template_var 1))))],
            template_predicate (template_var 0)))],
       template_predicate (template_var 0))),
    ("Payloads.analz_Un_HashSet",
     "[| Enc_keys_clean ?H; ?G <= - payload |]
      ==> analz (HashSet ?G Un ?H) <= HashSet ?G Un analz ?H",
     template_implication
      ([template_predicate
         (template_app (template_hole 11, template_var 1)),
        template_inequation
         (less_equals, template_var 0,
          template_app (template_hole 9, template_hole 8))],
       template_inequation
        (less_equals,
         template_app
          (template_hole 7,
           template_app
            (template_app
              (template_hole 6, template_app (template_hole 5, t_empty)),
             template_var 1)),
         template_app
          (template_app
            (template_hole 6, template_app (template_hole 5, t_empty)),
           template_app (template_hole 7, template_var 1))))),
    ("Payloads.parts_PairSet",
     "parts (PairSet ?G ?H) <= PairSet ?G ?H Un parts ?G Un parts ?H",
     template_inequation
      (less_equals,
       template_app
        (template_hole 7, template_app (template_hole 6, t_empty)),
       template_app
        (template_app
          (template_hole 0,
           template_app
            (template_app
              (template_hole 0, template_app (template_hole 6, t_empty)),
             template_app (template_hole 7, template_var 1))),
         template_app (template_hole 7, template_var 0)))),
    ("Payloads.analz_Un_PairSet",
     "analz (PairSet ?G ?G' Un ?H)
      <= PairSet ?G ?G' Un analz (?G Un ?G' Un ?H)",
     template_inequation
      (less_equals,
       template_app
        (template_hole 7,
         template_app
          (template_app
            (template_hole 6, template_app (template_hole 5, t_empty)),
           template_var 0)),
       template_app
        (template_app
          (template_hole 6, template_app (template_hole 5, t_empty)),
         template_app
          (template_hole 7,
           template_app
            (template_app
              (template_hole 6,
               template_app
                (template_app (template_hole 6, template_var 2),
                 template_var 1)),
             template_var 0))))),
    ("Payloads.parts_msgSetD",
     "?c : parts (PairSet ?G ?H) ==>
      ?c : PairSet ?G ?H Un parts ?G Un parts ?H",
     template_implication
      ([template_predicate
         (
            template_app
             (template_app (template_hole 7, template_var 2),
              template_app
               (template_hole 6, template_app (template_hole 5, t_empty)))
            )],
       template_predicate
        (
           template_app
            (template_app (template_hole 7, template_var 2),
             template_app
              (template_app
                (template_hole 0,
                 template_app
                  (template_app
                    (template_hole 0,
                     template_app (template_hole 5, t_empty)),
                   template_app (template_hole 6, template_var 1))),
               template_app (template_hole 6, template_var 0)))
           ))),
    ("Payloads.Keys_badI",
     "[| ?IK Int range LtK
         <= range pubK Un priK ` ?Bad Un
            {shrK A B |A B. A : ?Bad | B : ?Bad};
         range pubK <= ?IK |]
      ==> Keys_bad ?IK ?Bad",
     template_implication
      ([template_inequation
         (less_equals,
          template_app
           (template_app (template_hole 16, template_var 1),
            template_app
             (template_app (template_hole 15, template_hole 14),
              template_hole 13)),
          template_app
           (template_app
             (template_hole 12,
              template_app
               (template_app
                 (template_hole 12,
                  template_app
                   (template_app (template_hole 11, t_empty),
                    template_hole 9)),
                template_app
                 (template_app (template_hole 11, t_empty),
                  template_var 0))),
            template_app (template_hole 7, t_empty))),
        template_inequation
         (less_equals,
          template_app
           (template_app (template_hole 11, t_empty), template_hole 9),
          template_var 1)],
       template_predicate
        (
           template_app
            (template_app (template_hole 0, template_var 1), template_var 0)
           ))),
    ("Payloads.analz_Un_AencSet",
     "[| ?K <= range LtK; Enc_keys_clean (?G Un ?H) |]
      ==> analz (AencSet ?G ?K Un ?H) <= AencSet ?G ?K Un analz (?G Un ?H)",
     template_implication
      ([template_inequation
         (less_equals, template_var 2,
          template_app
           (template_app (template_hole 11, template_hole 10),
            template_hole 9)),
        template_predicate
         (
            template_app
             (template_hole 8,
              template_app
               (template_app (template_hole 7, template_var 1),
                template_var 0))
            )],
       template_inequation
        (less_equals,
         template_app
          (template_hole 6,
           template_app
            (template_app
              (template_hole 7, template_app (template_hole 5, t_empty)),
             template_var 0)),
         template_app
          (template_app
            (template_hole 7, template_app (template_hole 5, t_empty)),
           template_app
            (template_hole 6,
             template_app
              (template_app (template_hole 7, template_var 1),
               template_var 0)))))),
    ("Payloads.analz_Un_EncSet",
     "[| ?K <= range LtK; Enc_keys_clean (?G Un ?H) |]
      ==> analz (EncSet ?G ?K Un ?H) <= EncSet ?G ?K Un analz (?G Un ?H)",
     template_implication
      ([template_inequation
         (less_equals, template_var 2,
          template_app
           (template_app (template_hole 11, template_hole 10),
            template_hole 9)),
        template_predicate
         (
            template_app
             (template_hole 8,
              template_app
               (template_app (template_hole 7, template_var 1),
                template_var 0))
            )],
       template_inequation
        (less_equals,
         template_app
          (template_hole 6,
           template_app
            (template_app
              (template_hole 7, template_app (template_hole 5, t_empty)),
             template_var 0)),
         template_app
          (template_app
            (template_hole 7, template_app (template_hole 5, t_empty)),
           template_app
            (template_hole 6,
             template_app
              (template_app (template_hole 7, template_var 1),
               template_var 0)))))),
    ("Payloads.analz_Un_SignSet",
     "[| ?K <= range LtK; Enc_keys_clean (?G Un ?H) |]
      ==> analz (SignSet ?G ?K Un ?H) <= SignSet ?G ?K Un analz (?G Un ?H)",
     template_implication
      ([template_inequation
         (less_equals, template_var 2,
          template_app
           (template_app (template_hole 11, template_hole 10),
            template_hole 9)),
        template_predicate
         (
            template_app
             (template_hole 8,
              template_app
               (template_app (template_hole 7, template_var 1),
                template_var 0))
            )],
       template_inequation
        (less_equals,
         template_app
          (template_hole 6,
           template_app
            (template_app
              (template_hole 7, template_app (template_hole 5, t_empty)),
             template_var 0)),
         template_app
          (template_app
            (template_hole 7, template_app (template_hole 5, t_empty)),
           template_app
            (template_hole 6,
             template_app
              (template_app (template_hole 7, template_var 1),
               template_var 0)))))),
    ("Payloads.analz_Un_EncSet2",
     "[| Enc_keys_clean ?H; ?K <= range LtK; ?K Int synth (analz ?H) = {} |]
      ==> analz (EncSet ?G ?K Un ?H) <= EncSet ?G ?K Un analz ?H",
     template_implication
      ([template_predicate
         (template_app (template_hole 16, template_var 2)),
        template_inequation
         (less_equals, template_var 1,
          template_app
           (template_app (template_hole 14, template_hole 13),
            template_hole 12)),
        template_equation
         (template_app
           (template_app (template_hole 10, template_var 1),
            template_app
             (template_hole 9,
              template_app (template_hole 8, template_var 2))),
          template_hole 7)],
       template_inequation
        (less_equals,
         template_app
          (template_hole 8,
           template_app
            (template_app
              (template_hole 6, template_app (template_hole 5, t_empty)),
             template_var 2)),
         template_app
          (template_app
            (template_hole 6, template_app (template_hole 5, t_empty)),
           template_app (template_hole 8, template_var 2))))),
    ("Payloads.parts_AencSet",
     "parts (AencSet ?G ?K)
      <= AencSet ?G ?K Un PairSet AgentSet ?G Un AgentSet Un parts ?G",
     template_inequation
      (less_equals,
       template_app
        (template_hole 11, template_app (template_hole 10, t_empty)),
       template_app
        (template_app
          (template_hole 4,
           template_app
            (template_app
              (template_hole 4,
               template_app
                (template_app
                  (template_hole 4,
                   template_app (template_hole 10, t_empty)),
                 template_app (template_hole 10, t_empty))),
             template_app
              (template_app (template_hole 2, template_hole 1),
               template_hole 0))),
         template_app (template_hole 11, template_var 1)))),
    ("Payloads.parts_EncSet",
     "parts (EncSet ?G ?K)
      <= EncSet ?G ?K Un PairSet AgentSet ?G Un AgentSet Un parts ?G",
     template_inequation
      (less_equals,
       template_app
        (template_hole 11, template_app (template_hole 10, t_empty)),
       template_app
        (template_app
          (template_hole 4,
           template_app
            (template_app
              (template_hole 4,
               template_app
                (template_app
                  (template_hole 4,
                   template_app (template_hole 10, t_empty)),
                 template_app (template_hole 10, t_empty))),
             template_app
              (template_app (template_hole 2, template_hole 1),
               template_hole 0))),
         template_app (template_hole 11, template_var 1)))),
    ("Payloads.parts_SignSet",
     "parts (SignSet ?G ?K)
      <= SignSet ?G ?K Un PairSet AgentSet ?G Un AgentSet Un parts ?G",
     template_inequation
      (less_equals,
       template_app
        (template_hole 11, template_app (template_hole 10, t_empty)),
       template_app
        (template_app
          (template_hole 4,
           template_app
            (template_app
              (template_hole 4,
               template_app
                (template_app
                  (template_hole 4,
                   template_app (template_hole 10, t_empty)),
                 template_app (template_hole 10, t_empty))),
             template_app
              (template_app (template_hole 2, template_hole 1),
               template_hole 0))),
         template_app (template_hole 11, template_var 1)))),
    ("Payloads.analz_Un_AencSet2",
     "[| Enc_keys_clean ?H; priK ` ?Ag Int synth (analz ?H) = {} |]
      ==> analz (AencSet ?G (pubK ` ?Ag) Un ?H)
          <= AencSet ?G (pubK ` ?Ag) Un analz ?H",
     template_implication
      ([template_predicate
         (template_app (template_hole 17, template_var 2)),
        template_equation
         (template_app
           (template_app
             (template_hole 15,
              template_app
               (template_app (template_hole 14, t_empty), template_var 1)),
            template_app
             (template_hole 11,
              template_app (template_hole 10, template_var 2))),
          template_hole 9)],
       template_inequation
        (less_equals,
         template_app
          (template_hole 10,
           template_app
            (template_app
              (template_hole 7, template_app (template_hole 6, t_empty)),
             template_var 2)),
         template_app
          (template_app
            (template_hole 7, template_app (template_hole 6, t_empty)),
           template_app (template_hole 10, template_var 2))))),
    ("Payloads.parts_msgSetD",
     "?c : parts (AencSet ?G ?K) ==>
      ?c : AencSet ?G ?K Un PairSet AgentSet ?G Un AgentSet Un parts ?G",
     template_implication
      ([template_predicate
         (
            template_app
             (template_app (template_hole 11, template_var 2),
              template_app
               (template_hole 10, template_app (template_hole 9, t_empty)))
            )],
       template_predicate
        (
           template_app
            (template_app (template_hole 11, template_var 2),
             template_app
              (template_app
                (template_hole 4,
                 template_app
                  (template_app
                    (template_hole 4,
                     template_app
                      (template_app
                        (template_hole 4,
                         template_app (template_hole 9, t_empty)),
                       template_app (template_hole 9, t_empty))),
                   template_app
                    (template_app (template_hole 2, template_hole 1),
                     template_hole 0))),
               template_app (template_hole 10, template_var 1)))
           ))),
    ("Payloads.parts_msgSetD",
     "?c : parts (EncSet ?G ?K) ==>
      ?c : EncSet ?G ?K Un PairSet AgentSet ?G Un AgentSet Un parts ?G",
     template_implication
      ([template_predicate
         (
            template_app
             (template_app (template_hole 11, template_var 2),
              template_app
               (template_hole 10, template_app (template_hole 9, t_empty)))
            )],
       template_predicate
        (
           template_app
            (template_app (template_hole 11, template_var 2),
             template_app
              (template_app
                (template_hole 4,
                 template_app
                  (template_app
                    (template_hole 4,
                     template_app
                      (template_app
                        (template_hole 4,
                         template_app (template_hole 9, t_empty)),
                       template_app (template_hole 9, t_empty))),
                   template_app
                    (template_app (template_hole 2, template_hole 1),
                     template_hole 0))),
               template_app (template_hole 10, template_var 1)))
           ))),
    ("Payloads.parts_msgSetD",
     "?c : parts (SignSet ?G ?K) ==>
      ?c : SignSet ?G ?K Un PairSet AgentSet ?G Un AgentSet Un parts ?G",
     template_implication
      ([template_predicate
         (
            template_app
             (template_app (template_hole 11, template_var 2),
              template_app
               (template_hole 10, template_app (template_hole 9, t_empty)))
            )],
       template_predicate
        (
           template_app
            (template_app (template_hole 11, template_var 2),
             template_app
              (template_app
                (template_hole 4,
                 template_app
                  (template_app
                    (template_hole 4,
                     template_app
                      (template_app
                        (template_hole 4,
                         template_app (template_hole 9, t_empty)),
                       template_app (template_hole 9, t_empty))),
                   template_app
                    (template_app (template_hole 2, template_hole 1),
                     template_hole 0))),
               template_app (template_hole 10, template_var 1)))
           ))),
    ("Payloads.msg_exhaust",
     "[| !!x. ?y = Messages.Agent x ==> ?P; !!x. ?y = Number x ==> ?P;
         !!x. ?y = Nonce x ==> ?P; !!x. ?y = LtK x ==> ?P;
         !!x. ?y = EphK x ==> ?P;
         !!x x'. ?y = \<langle>x, x'\<rangle> ==> ?P;
         !!x x'. ?y = Enc x x' ==> ?P; !!x x'. ?y = Aenc x x' ==> ?P;
         !!x x'. ?y = Sign x x' ==> ?P; !!x. ?y = Hash x ==> ?P;
         !!x. ?y = Tag x ==> ?P; !!x x'. ?y = Exp x x' ==> ?P |]
      ==> ?P",
     template_implication
      ([template_predicate (template_app (template_hole 20, t_empty)),
        template_predicate (template_app (template_hole 16, t_empty)),
        template_predicate (template_app (template_hole 14, t_empty)),
        template_predicate (template_app (template_hole 12, t_empty)),
        template_predicate (template_app (template_hole 10, t_empty)),
        template_predicate (template_app (template_hole 8, t_empty)),
        template_predicate (template_app (template_hole 8, t_empty)),
        template_predicate (template_app (template_hole 8, t_empty)),
        template_predicate (template_app (template_hole 8, t_empty)),
        template_predicate (template_app (template_hole 8, t_empty)),
        template_predicate (template_app (template_hole 2, t_empty)),
        template_predicate (template_app (template_hole 8, t_empty))],
       template_predicate (template_var 0))),
    ("Payloads.eq_exhaust",
     "[| !!x. eq ?y (cAgent x) ==> ?P; !!x. eq ?y (cNumber x) ==> ?P;
         !!x. eq ?y (cNonce x) ==> ?P; !!x. eq ?y (cLtK x) ==> ?P;
         !!x. eq ?y (cEphK x) ==> ?P; !!x x'. eq ?y (cPair x x') ==> ?P;
         !!x x'. eq ?y (cEnc x x') ==> ?P;
         !!x x'. eq ?y (cAenc x x') ==> ?P;
         !!x x'. eq ?y (cSign x x') ==> ?P; !!x. eq ?y (cHash x) ==> ?P;
         !!x. eq ?y (cTag x) ==> ?P; !!x x'. eq ?y (cExp x x') ==> ?P |]
      ==> ?P",
     template_implication
      ([template_predicate (template_app (template_hole 20, t_empty)),
        template_predicate (template_app (template_hole 16, t_empty)),
        template_predicate (template_app (template_hole 14, t_empty)),
        template_predicate (template_app (template_hole 12, t_empty)),
        template_predicate (template_app (template_hole 10, t_empty)),
        template_predicate (template_app (template_hole 8, t_empty)),
        template_predicate (template_app (template_hole 8, t_empty)),
        template_predicate (template_app (template_hole 8, t_empty)),
        template_predicate (template_app (template_hole 8, t_empty)),
        template_predicate (template_app (template_hole 8, t_empty)),
        template_predicate (template_app (template_hole 2, t_empty)),
        template_predicate (template_app (template_hole 8, t_empty))],
       template_predicate (template_var 0))),
    ("Payloads.payload_cases",
     "[| ?a : payload; !!A. ?a = Messages.Agent A ==> ?P;
         !!T. ?a = Number T ==> ?P; !!N. ?a = Nonce N ==> ?P;
         !!K. ?a = EphK K ==> ?P;
         !!X. [| ?a = Hash X; X : payload |] ==> ?P;
         !!X Y.
            [| ?a = \<langle>X, Y\<rangle>; X : payload; Y : payload |]
            ==> ?P;
         !!X Y. [| ?a = Enc X Y; X : payload; Y : payload |] ==> ?P;
         !!X Y. [| ?a = Aenc X Y; X : payload; Y : payload |] ==> ?P;
         !!X Y. [| ?a = Sign X Y; X : payload; Y : payload |] ==> ?P;
         !!X Y. [| ?a = Exp X Y; X : payload; Y : payload |] ==> ?P |]
      ==> ?P",
     template_implication
      ([template_predicate
         (
            template_app
             (template_app (template_hole 17, template_var 1),
              template_hole 16)
            ),
        template_predicate (template_app (template_hole 15, t_empty)),
        template_predicate (template_app (template_hole 12, t_empty)),
        template_predicate (template_app (template_hole 10, t_empty)),
        template_predicate (template_app (template_hole 8, t_empty)),
        template_predicate (template_app (template_hole 6, t_empty)),
        template_predicate (template_app (template_hole 6, t_empty)),
        template_predicate (template_app (template_hole 6, t_empty)),
        template_predicate (template_app (template_hole 6, t_empty)),
        template_predicate (template_app (template_hole 6, t_empty)),
        template_predicate (template_app (template_hole 6, t_empty))],
       template_predicate (template_var 0)))]:
   (string * thm * template) list
### theory "Draft.PayloadsTemplates"
### 0.399s elapsed time, 0.575s cpu time, 0.071s GC time
val it = (): unit
