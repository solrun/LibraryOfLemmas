   [("Refine_While.filter_nb_FAIL", "filter_nb ?cond FAIL = FAIL",
     template_equation
      (template_app
        (template_app (template_hole 1, template_var 0), template_hole 0),
       template_hole 0)),
    ("Refine_While.pw_filter_nb", "nofail (filter_nb ?b ?I) = nofail ?I",
     template_equation
      (template_app
        (template_hole 1,
         template_app
          (template_app (template_hole 0, template_var 1), template_var 0)),
       template_app (template_hole 1, template_var 0))),
    ("Refine_While.msii_is_invar", "?m <= msii ?I ?m ?c ?f",
     template_inequation
      (less_equals, template_var 3,
       template_app
        (template_app
          (template_app
            (template_app (template_hole 0, template_var 2),
             template_var 3),
           template_var 1),
         template_var 0))),
    ("Refine_While.rwof_leof_init", "?m \<le>\<^sub>n SPEC (rwof ?m ?c ?f)",
     template_predicate
      (
         template_app
          (template_app (template_hole 3, template_var 2),
           template_app
            (template_hole 2,
             template_app
              (template_hole 1,
               template_app
                (template_app
                  (template_app (template_hole 0, template_var 2),
                   template_var 1),
                 template_var 0))))
         )),
    ("Refine_While.WHILE_le_WHILEI",
     "WHILE ?b ?f ?s <= WHILE\<^bsup>?I\<^esup> ?b ?f ?s",
     template_inequation
      (less_equals,
       template_app
        (template_app
          (template_app (template_hole 1, template_var 3), template_var 2),
         template_var 1),
       template_app
        (template_app
          (template_app
            (template_app (template_hole 0, template_var 0),
             template_var 3),
           template_var 2),
         template_var 1))),
    ("Refine_While.pw_rwof_init",
     "nofail (?m0.0 >>= WHILE ?cond ?step) ==> nofail ?m0.0",
     template_implication
      ([template_predicate
         (
            template_app
             (template_hole 2,
              template_app
               (template_app (template_hole 1, template_var 2),
                template_app
                 (template_app (template_hole 0, template_var 1),
                  template_var 0)))
            )],
       template_predicate
        (template_app (template_hole 2, template_var 2)))),
    ("Refine_While.bounded_WHILE'_eq",
     "bounded_WHILE' ?n ?cond ?step ?m = bounded_WHILE ?n ?cond ?step ?m",
     template_equation
      (template_app
        (template_app
          (template_app
            (template_app (template_hole 1, template_var 3),
             template_var 2),
           template_var 1),
         template_var 0),
       template_app
        (template_app
          (template_app
            (template_app (template_hole 0, template_var 3),
             template_var 2),
           template_var 1),
         template_var 0))),
    ("Refine_While.filter_nb_mono",
     "?m <= ?m' ==> filter_nb ?cond ?m <= filter_nb ?cond ?m'",
     template_implication
      ([template_inequation (less_equals, template_var 2, template_var 1)],
       template_inequation
        (less_equals,
         template_app
          (template_app (template_hole 0, template_var 0), template_var 2),
         template_app
          (template_app (template_hole 0, template_var 0),
           template_var 1)))),
    ("Refine_While.WHILE_bounded_aux1",
     "filter_nb ?cond (bounded_WHILE ?n ?cond ?step ?m)
      <= ?m >>= WHILE ?cond ?step",
     template_inequation
      (less_equals,
       template_app
        (template_app (template_hole 3, template_var 3),
         template_app
          (template_app
            (template_app
              (template_app (template_hole 2, template_var 2),
               template_var 3),
             template_var 1),
           template_var 0)),
       template_app
        (template_app (template_hole 1, template_var 0),
         template_app
          (template_app (template_hole 0, template_var 3),
           template_var 1)))),
    ("Refine_While.filter_nb_RES",
     "filter_nb ?cond (RES ?X) = SPEC (%x. x : ?X & ~ ?cond x)",
     template_equation
      (template_app
        (template_app (template_hole 5, template_var 1),
         template_app (template_hole 4, template_var 0)),
       template_app
        (template_hole 4, template_app (template_hole 3, t_empty)))),
    ("Refine_While.WHILE_eq_I_rwof",
     "?m >>= WHILE ?c ?f = ?m >>= WHILE\<^bsup>rwof ?m ?c ?f\<^esup> ?c ?f",
     template_equation
      (template_app
        (template_app (template_hole 3, template_var 2),
         template_app
          (template_app (template_hole 2, template_var 1), template_var 0)),
       template_app
        (template_app (template_hole 3, template_var 2),
         template_app
          (template_app
            (template_app
              (template_hole 1,
               template_app
                (template_app
                  (template_app (template_hole 0, template_var 2),
                   template_var 1),
                 template_var 0)),
             template_var 1),
           template_var 0)))),
    ("Refine_While.WHILET_eq_I_rwof",
     "?m >>= WHILE\<^sub>T ?c ?f =
      ?m >>= WHILE\<^sub>T\<^bsup>rwof ?m ?c ?f\<^esup> ?c ?f",
     template_equation
      (template_app
        (template_app (template_hole 3, template_var 2),
         template_app
          (template_app (template_hole 2, template_var 1), template_var 0)),
       template_app
        (template_app (template_hole 3, template_var 2),
         template_app
          (template_app
            (template_app
              (template_hole 1,
               template_app
                (template_app
                  (template_app (template_hole 0, template_var 2),
                   template_var 1),
                 template_var 0)),
             template_var 1),
           template_var 0)))),
    ("Refine_While.nofail_WHILEIT_wf_rel",
     "nofail (?init >>= WHILE\<^sub>T\<^bsup>?I\<^esup> ?cond ?step) ==>
      wf ((rwof_rel ?init ?cond ?step)^-1)",
     template_implication
      ([template_predicate
         (
            template_app
             (template_hole 5,
              template_app
               (template_app (template_hole 4, template_var 3),
                template_app
                 (template_app
                   (template_app (template_hole 3, template_var 2),
                    template_var 1),
                  template_var 0)))
            )],
       template_predicate
        (
           template_app
            (template_hole 2,
             template_app
              (template_hole 1,
               template_app
                (template_app
                  (template_app (template_hole 0, template_var 3),
                   template_var 1),
                 template_var 0)))
           ))),
    ("Refine_While.pw_filter_nb",
     "inres (filter_nb ?b ?I) ?x = (nofail ?I --> inres ?I ?x & ~ ?b ?x)",
     template_equation
      (template_app
        (template_app
          (template_hole 5,
           template_app
            (template_app (template_hole 4, template_var 2),
             template_var 1)),
         template_var 0),
       template_app
        (template_app
          (template_hole 3, template_app (template_hole 2, template_var 1)),
         template_app
          (template_app
            (template_hole 1,
             template_app
              (template_app (template_hole 5, template_var 1),
               template_var 0)),
           template_app
            (template_hole 0,
             template_app (template_var 2, template_var 0)))))),
    ("Refine_While.tailrec_transform'",
     "?m >>= REC (tailrec_body ?a ?b) = lfp (%x. sup ?m (x >>= ?a)) >>= ?b",
     template_equation
      (template_app
        (template_app (template_hole 5, template_var 2),
         template_app
          (template_hole 4,
           template_app
            (template_app (template_hole 3, template_var 1),
             template_var 0))),
       template_app
        (template_app
          (template_hole 5, template_app (template_hole 2, t_empty)),
         template_var 0))),
    ("Refine_While.pw_rwof_in_bounded_WHILE",
     "rwof ?m0.0 ?cond ?step ?x ==>
      EX n. inres (bounded_WHILE n ?cond ?step ?m0.0) ?x",
     template_implication
      ([template_predicate
         (
            template_app
             (template_app
               (template_app
                 (template_app (template_hole 3, template_var 3),
                  template_var 2),
                template_var 1),
              template_var 0)
            )],
       template_predicate (template_app (template_hole 2, t_empty)))),
    ("Refine_While.rwof_init",
     "nofail (?m0.0 >>= WHILE ?cond ?step) ==>
      ?m0.0 <= SPEC (rwof ?m0.0 ?cond ?step)",
     template_implication
      ([template_predicate
         (
            template_app
             (template_hole 6,
              template_app
               (template_app (template_hole 5, template_var 2),
                template_app
                 (template_app (template_hole 4, template_var 1),
                  template_var 0)))
            )],
       template_inequation
        (less_equals, template_var 2,
         template_app
          (template_hole 2,
           template_app
            (template_hole 1,
             template_app
              (template_app
                (template_app (template_hole 0, template_var 2),
                 template_var 1),
               template_var 0)))))),
    ("Refine_While.rwof_cons",
     "[| is_rwof_invar ?m0.0 ?cond ?step ?I; rwof ?m0.0 ?cond ?step ?s |]
      ==> ?I ?s",
     template_implication
      ([template_predicate
         (
            template_app
             (template_app
               (template_app
                 (template_app (template_hole 1, template_var 4),
                  template_var 3),
                template_var 2),
              template_var 1)
            ),
        template_predicate
         (
            template_app
             (template_app
               (template_app
                 (template_app (template_hole 0, template_var 4),
                  template_var 3),
                template_var 2),
              template_var 0)
            )],
       template_predicate (template_app (template_var 1, template_var 0)))),
    ("Refine_While.rwof_in_bounded_WHILE",
     "rwof ?m0.0 ?cond ?step ?s ==>
      EX n. RETURN ?s <= bounded_WHILE n ?cond ?step ?m0.0",
     template_implication
      ([template_predicate
         (
            template_app
             (template_app
               (template_app
                 (template_app (template_hole 4, template_var 3),
                  template_var 2),
                template_var 1),
              template_var 0)
            )],
       template_predicate (template_app (template_hole 3, t_empty)))),
    ("Refine_While.AIF_leI",
     "[| ?\<Phi>; ?\<Phi> ==> ?S <= ?S' |]
      ==> (if ?\<Phi> then ?S else FAIL) <= ?S'",
     template_implication
      ([template_predicate (template_var 2),
        template_implication
         ([template_predicate (template_var 2)],
          template_inequation
           (less_equals, template_var 1, template_var 0))],
       template_inequation
        (less_equals,
         template_app
          (template_app
            (template_app (template_hole 1, template_var 2),
             template_var 1),
           template_hole 0),
         template_var 0))),
    ("Refine_While.WHILE_msii_conv",
     "?m >>= WHILE\<^bsup>?I\<^esup> ?c ?f =
      filter_ASSUME (Not o ?c) (filter_ASSERT ?I (msii ?I ?m ?c ?f))",
     template_equation
      (template_app
        (template_app (template_hole 6, template_var 3),
         template_app
          (template_app
            (template_app (template_hole 5, template_var 2),
             template_var 1),
           template_var 0)),
       template_app
        (template_app
          (template_hole 4,
           template_app
            (template_app (template_hole 3, template_hole 2),
             template_var 1)),
         template_app
          (template_app (template_hole 1, template_var 2),
           template_app
            (template_app
              (template_app
                (template_app (template_hole 0, template_var 2),
                 template_var 3),
               template_var 1),
             template_var 0))))),
    ("Refine_While.ref_AIFI",
     "(?\<Phi> ==> ?S <= \<Down> ?R ?S') ==>
      ?S <= \<Down> ?R (if ?\<Phi> then ?S' else FAIL)",
     template_implication
      ([template_implication
         ([template_predicate (template_var 3)],
          template_inequation
           (less_equals, template_var 2,
            template_app
             (template_app (template_hole 2, template_var 1),
              template_var 0)))],
       template_inequation
        (less_equals, template_var 2,
         template_app
          (template_app (template_hole 2, template_var 1),
           template_app
            (template_app
              (template_app (template_hole 1, template_var 3),
               template_var 0),
             template_hole 0))))),
    ("Refine_While.pw_rwof_init",
     "[| nofail (?m0.0 >>= WHILE ?cond ?step); inres ?m0.0 ?s |]
      ==> rwof ?m0.0 ?cond ?step ?s",
     template_implication
      ([template_predicate
         (
            template_app
             (template_hole 4,
              template_app
               (template_app (template_hole 3, template_var 3),
                template_app
                 (template_app (template_hole 2, template_var 2),
                  template_var 1)))
            ),
        template_predicate
         (
            template_app
             (template_app (template_hole 1, template_var 3),
              template_var 0)
            )],
       template_predicate
        (
           template_app
            (template_app
              (template_app
                (template_app (template_hole 0, template_var 3),
                 template_var 2),
               template_var 1),
             template_var 0)
           ))),
    ("Refine_While.filter_nb_cont",
     "filter_nb ?cond (Sup ?M) = Sup {filter_nb ?cond m |m. m : ?M}",
     template_equation
      (template_app
        (template_app (template_hole 5, template_var 1),
         template_app (template_hole 4, template_var 0)),
       template_app
        (template_hole 4, template_app (template_hole 3, t_empty)))),
    ("Refine_While.mWHILE_unfold",
     "?m >>= WHILE ?cond ?step =
      ?m >>=
      (%x. if ?cond x then ?step x >>= WHILE ?cond ?step else RETURN x)",
     template_equation
      (template_app
        (template_app (template_hole 3, template_var 2),
         template_app
          (template_app (template_hole 2, template_var 1), template_var 0)),
       template_app
        (template_app (template_hole 3, template_var 2), t_empty))),
    ("Refine_While.tailrec_transform_aux2",
     "lfp (%x. sup ?m (x >>= ?a))
      <= ?m >>= REC (%D s. sup (?a s >>= D) (RETURN s))",
     template_inequation
      (less_equals, template_app (template_hole 4, t_empty),
       template_app
        (template_app (template_hole 2, template_var 1),
         template_app (template_hole 1, t_empty)))),
    ("Refine_While.rwof_leof_step",
     "[| rwof ?m ?c ?f ?s; ?c ?s |]
      ==> ?f ?s \<le>\<^sub>n SPEC (rwof ?m ?c ?f)",
     template_implication
      ([template_predicate
         (
            template_app
             (template_app
               (template_app
                 (template_app (template_hole 3, template_var 3),
                  template_var 2),
                template_var 1),
              template_var 0)
            ),
        template_predicate (template_app (template_var 2, template_var 0))],
       template_predicate
        (
           template_app
            (template_app
              (template_hole 2,
               template_app (template_var 1, template_var 0)),
             template_app
              (template_hole 1,
               template_app
                (template_hole 0,
                 template_app
                  (template_app
                    (template_app (template_hole 3, template_var 3),
                     template_var 2),
                   template_var 1))))
           ))),
    ("Refine_While.bounded_WHILE_RES_rwof",
     "[| bounded_WHILE ?n ?cond ?step ?m0.0 = RES ?X; ?x : ?X |]
      ==> rwof ?m0.0 ?cond ?step ?x",
     template_implication
      ([template_equation
         (template_app
           (template_app
             (template_app
               (template_app (template_hole 3, template_var 5),
                template_var 4),
              template_var 3),
            template_var 2),
          template_app (template_hole 2, template_var 1)),
        template_predicate
         (
            template_app
             (template_app (template_hole 1, template_var 0),
              template_var 1)
            )],
       template_predicate
        (
           template_app
            (template_app
              (template_app
                (template_app (template_hole 0, template_var 2),
                 template_var 4),
               template_var 3),
             template_var 0)
           ))),
    ("Refine_While.WHILE_bounded",
     "?m >>= WHILE ?cond ?step =
      filter_nb ?cond (Sup {bounded_WHILE n ?cond ?step ?m |n. True})",
     template_equation
      (template_app
        (template_app (template_hole 8, template_var 2),
         template_app
          (template_app (template_hole 7, template_var 1), template_var 0)),
       template_app
        (template_app (template_hole 6, template_var 1),
         template_app
          (template_hole 5, template_app (template_hole 4, t_empty))))),
    ("Refine_While.tailrec_transform",
     "?m >>= REC (%D s. sup (?a s >>= D) (?b s)) =
      lfp (%x. sup ?m (x >>= ?a)) >>= ?b",
     template_equation
      (template_app
        (template_app (template_hole 5, template_var 2),
         template_app (template_hole 4, t_empty)),
       template_app
        (template_app
          (template_hole 5, template_app (template_hole 2, t_empty)),
         template_var 0))),
    ("Refine_While.WHILE_bounded_aux2",
     "?m >>= WHILE ?cond ?step
      <= filter_nb ?cond (Sup {bounded_WHILE n ?cond ?step ?m |n. True})",
     template_inequation
      (less_equals,
       template_app
        (template_app (template_hole 9, template_var 2),
         template_app
          (template_app (template_hole 8, template_var 1), template_var 0)),
       template_app
        (template_app (template_hole 7, template_var 1),
         template_app
          (template_hole 6, template_app (template_hole 5, t_empty))))),
    ("Refine_While.tailrec_transform2",
     "lfp (%x. sup ?m (x >>= ?a)) >>= ?b
      <= ?m >>= REC (%D s. sup (?a s >>= D) (?b s))",
     template_inequation
      (less_equals,
       template_app
        (template_app
          (template_hole 5, template_app (template_hole 4, t_empty)),
         template_var 0),
       template_app
        (template_app (template_hole 5, template_var 2),
         template_app (template_hole 1, t_empty)))),
    ("Refine_While.tailrec_transform1",
     "?m >>= REC (%D s. sup (?a s >>= D) (?b s))
      <= lfp (%x. sup ?m (x >>= ?a)) >>= ?b",
     template_inequation
      (less_equals,
       template_app
        (template_app (template_hole 5, template_var 2),
         template_app (template_hole 4, t_empty)),
       template_app
        (template_app
          (template_hole 5, template_app (template_hole 2, t_empty)),
         template_var 0))),
    ("Refine_While.rwof_reachable",
     "rwof ?init ?cond ?step ?s ==>
      EX s0. inres ?init s0 & (s0, ?s) : (rwof_rel ?init ?cond ?step)^*",
     template_implication
      ([template_predicate
         (
            template_app
             (template_app
               (template_app
                 (template_app (template_hole 7, template_var 3),
                  template_var 2),
                template_var 1),
              template_var 0)
            )],
       template_predicate (template_app (template_hole 6, t_empty)))),
    ("Refine_While.msii_is_invar",
     "?m <= msii ?I ?m ?c ?f ==>
      filter_ASSUME ?c (filter_ASSERT ?I ?m) >>= ?f <= msii ?I ?m ?c ?f",
     template_implication
      ([template_inequation
         (less_equals, template_var 3,
          template_app
           (template_app
             (template_app
               (template_app (template_hole 3, template_var 2),
                template_var 3),
              template_var 1),
            template_var 0))],
       template_inequation
        (less_equals,
         template_app
          (template_app
            (template_hole 2,
             template_app
              (template_app (template_hole 1, template_var 1),
               template_app
                (template_app (template_hole 0, template_var 2),
                 template_var 3))),
           template_var 0),
         template_app
          (template_app
            (template_app
              (template_app (template_hole 3, template_var 2),
               template_var 3),
             template_var 1),
           template_var 0)))),
    ("Refine_While.pw_bounded_WHILE_RES_rwof",
     "[| nofail (bounded_WHILE ?n ?cond ?step ?m0.0);
         inres (bounded_WHILE ?n ?cond ?step ?m0.0) ?x |]
      ==> rwof ?m0.0 ?cond ?step ?x",
     template_implication
      ([template_predicate
         (
            template_app
             (template_hole 3,
              template_app
               (template_app
                 (template_app
                   (template_app (template_hole 2, template_var 4),
                    template_var 3),
                  template_var 2),
                template_var 1))
            ),
        template_predicate
         (
            template_app
             (template_app
               (template_hole 1,
                template_app
                 (template_app
                   (template_app
                     (template_app (template_hole 2, template_var 4),
                      template_var 3),
                    template_var 2),
                  template_var 1)),
              template_var 0)
            )],
       template_predicate
        (
           template_app
            (template_app
              (template_app
                (template_app (template_hole 0, template_var 1),
                 template_var 3),
               template_var 2),
             template_var 0)
           ))),
    ("Refine_While.WHILE_nofail_imp_rwof_nofail",
     "[| nofail (?m0.0 >>= WHILE ?cond ?step); rwof ?m0.0 ?cond ?step ?s;
         ?cond ?s |]
      ==> nofail (?step ?s)",
     template_implication
      ([template_predicate
         (
            template_app
             (template_hole 3,
              template_app
               (template_app (template_hole 2, template_var 3),
                template_app
                 (template_app (template_hole 1, template_var 2),
                  template_var 1)))
            ),
        template_predicate
         (
            template_app
             (template_app
               (template_app
                 (template_app (template_hole 0, template_var 3),
                  template_var 2),
                template_var 1),
              template_var 0)
            ),
        template_predicate (template_app (template_var 2, template_var 0))],
       template_predicate
        (
           template_app
            (template_hole 3, template_app (template_var 1, template_var 0))
           ))),
    ("Refine_While.WHILET_nofail_imp_rwof_nofail",
     "[| nofail (?m0.0 >>= WHILE\<^sub>T ?cond ?step);
         rwof ?m0.0 ?cond ?step ?s; ?cond ?s |]
      ==> nofail (?step ?s)",
     template_implication
      ([template_predicate
         (
            template_app
             (template_hole 3,
              template_app
               (template_app (template_hole 2, template_var 3),
                template_app
                 (template_app (template_hole 1, template_var 2),
                  template_var 1)))
            ),
        template_predicate
         (
            template_app
             (template_app
               (template_app
                 (template_app (template_hole 0, template_var 3),
                  template_var 2),
                template_var 1),
              template_var 0)
            ),
        template_predicate (template_app (template_var 2, template_var 0))],
       template_predicate
        (
           template_app
            (template_hole 3, template_app (template_var 1, template_var 0))
           ))),
    ("Refine_While.WHILEI_nofail_imp_rwof_nofail",
     "[| nofail (?m0.0 >>= WHILE\<^bsup>?I\<^esup> ?cond ?step);
         rwof ?m0.0 ?cond ?step ?s; ?cond ?s |]
      ==> nofail (?step ?s)",
     template_implication
      ([template_predicate
         (
            template_app
             (template_hole 3,
              template_app
               (template_app (template_hole 2, template_var 4),
                template_app
                 (template_app
                   (template_app (template_hole 1, template_var 3),
                    template_var 2),
                  template_var 1)))
            ),
        template_predicate
         (
            template_app
             (template_app
               (template_app
                 (template_app (template_hole 0, template_var 4),
                  template_var 2),
                template_var 1),
              template_var 0)
            ),
        template_predicate (template_app (template_var 2, template_var 0))],
       template_predicate
        (
           template_app
            (template_hole 3, template_app (template_var 1, template_var 0))
           ))),
    ("Refine_While.WHILEIT_nofail_imp_rwof_nofail",
     "[| nofail (?m0.0 >>= WHILE\<^sub>T\<^bsup>?I\<^esup> ?cond ?step);
         rwof ?m0.0 ?cond ?step ?s; ?cond ?s |]
      ==> nofail (?step ?s)",
     template_implication
      ([template_predicate
         (
            template_app
             (template_hole 3,
              template_app
               (template_app (template_hole 2, template_var 4),
                template_app
                 (template_app
                   (template_app (template_hole 1, template_var 3),
                    template_var 2),
                  template_var 1)))
            ),
        template_predicate
         (
            template_app
             (template_app
               (template_app
                 (template_app (template_hole 0, template_var 4),
                  template_var 2),
                template_var 1),
              template_var 0)
            ),
        template_predicate (template_app (template_var 2, template_var 0))],
       template_predicate
        (
           template_app
            (template_hole 3, template_app (template_var 1, template_var 0))
           ))),
    ("Refine_While.ref_WHILEI_invarI",
     "(?I ?s ==> ?M <= \<Down> ?R (WHILE\<^bsup>?I\<^esup> ?b ?f ?s)) ==>
      ?M <= \<Down> ?R (WHILE\<^bsup>?I\<^esup> ?b ?f ?s)",
     template_implication
      ([template_implication
         ([template_predicate
            (template_app (template_var 5, template_var 4))],
          template_inequation
           (less_equals, template_var 3,
            template_app
             (template_app (template_hole 1, template_var 2),
              template_app
               (template_app
                 (template_app
                   (template_app (template_hole 0, template_var 5),
                    template_var 1),
                  template_var 0),
                template_var 4))))],
       template_inequation
        (less_equals, template_var 3,
         template_app
          (template_app (template_hole 1, template_var 2),
           template_app
            (template_app
              (template_app
                (template_app (template_hole 0, template_var 5),
                 template_var 1),
               template_var 0),
             template_var 4))))),
    ("Refine_While.ref_WHILEIT_invarI",
     "(?I ?s ==>
       ?M <= \<Down> ?R (WHILE\<^sub>T\<^bsup>?I\<^esup> ?b ?f ?s)) ==>
      ?M <= \<Down> ?R (WHILE\<^sub>T\<^bsup>?I\<^esup> ?b ?f ?s)",
     template_implication
      ([template_implication
         ([template_predicate
            (template_app (template_var 5, template_var 4))],
          template_inequation
           (less_equals, template_var 3,
            template_app
             (template_app (template_hole 1, template_var 2),
              template_app
               (template_app
                 (template_app
                   (template_app (template_hole 0, template_var 5),
                    template_var 1),
                  template_var 0),
                template_var 4))))],
       template_inequation
        (less_equals, template_var 3,
         template_app
          (template_app (template_hole 1, template_var 2),
           template_app
            (template_app
              (template_app
                (template_app (template_hole 0, template_var 5),
                 template_var 1),
               template_var 0),
             template_var 4))))),
    ("Refine_While.rwof_FAIL_imp_WHILE_FAIL",
     "[| rwof ?m0.0 ?cond ?step ?s; ?cond ?s; ?step ?s = FAIL |]
      ==> ?m0.0 >>= WHILE ?cond ?step = FAIL",
     template_implication
      ([template_predicate
         (
            template_app
             (template_app
               (template_app
                 (template_app (template_hole 4, template_var 3),
                  template_var 2),
                template_var 1),
              template_var 0)
            ),
        template_predicate (template_app (template_var 2, template_var 0)),
        template_equation
         (template_app (template_var 1, template_var 0), template_hole 2)],
       template_equation
        (template_app
          (template_app (template_hole 1, template_var 3),
           template_app
            (template_app (template_hole 0, template_var 2),
             template_var 1)),
         template_hole 2))),
    ("Refine_While.tailrec_transform_aux3",
     "REC (%D s. sup (?a s >>= D) (RETURN s)) ?s >>= ?b
      <= REC (%D s. sup (?a s >>= D) (?b s)) ?s",
     template_inequation
      (less_equals,
       template_app
        (template_app
          (template_hole 6,
           template_app
            (template_app (template_hole 5, t_empty), template_var 1)),
         template_var 0),
       template_app
        (template_app (template_hole 1, t_empty), template_var 1))),
    ("Refine_While.rwof_rel_spec",
     "[| rwof ?init ?cond ?step ?s; ?cond ?s |]
      ==> ?step ?s \<le>\<^sub>n
          SPEC (%s'. (?s, s') : rwof_rel ?init ?cond ?step)",
     template_implication
      ([template_predicate
         (
            template_app
             (template_app
               (template_app
                 (template_app (template_hole 6, template_var 3),
                  template_var 2),
                template_var 1),
              template_var 0)
            ),
        template_predicate (template_app (template_var 2, template_var 0))],
       template_predicate
        (
           template_app
            (template_app
              (template_hole 5,
               template_app (template_var 1, template_var 0)),
             template_app
              (template_hole 4, template_app (template_hole 3, t_empty)))
           ))),
    ("Refine_While.rwof_step'",
     "[| nofail (?step ?s); rwof ?m0.0 ?cond ?step ?s; ?cond ?s |]
      ==> ?step ?s <= SPEC (rwof ?m0.0 ?cond ?step)",
     template_implication
      ([template_predicate
         (
            template_app
             (template_hole 4,
              template_app (template_var 3, template_var 2))
            ),
        template_predicate
         (
            template_app
             (template_app
               (template_app
                 (template_app (template_hole 3, template_var 1),
                  template_var 0),
                template_var 3),
              template_var 2)
            ),
        template_predicate (template_app (template_var 0, template_var 2))],
       template_inequation
        (less_equals, template_app (template_var 3, template_var 2),
         template_app
          (template_hole 1,
           template_app
            (template_hole 0,
             template_app
              (template_app
                (template_app (template_hole 3, template_var 1),
                 template_var 0),
               template_var 3)))))),
    ("Refine_While.nofail_WHILE_eq_rwof",
     "nofail (?m0.0 >>= WHILE ?cond ?step) ==>
      ?m0.0 >>= WHILE ?cond ?step =
      SPEC (%s. rwof ?m0.0 ?cond ?step s & ~ ?cond s)",
     template_implication
      ([template_predicate
         (
            template_app
             (template_hole 8,
              template_app
               (template_app (template_hole 7, template_var 2),
                template_app
                 (template_app (template_hole 6, template_var 1),
                  template_var 0)))
            )],
       template_equation
        (template_app
          (template_app (template_hole 7, template_var 2),
           template_app
            (template_app (template_hole 6, template_var 1),
             template_var 0)),
         template_app
          (template_hole 4, template_app (template_hole 3, t_empty))))),
    ("Refine_While.tailrec_transform_aux1",
     "RETURN ?s <= ?m ==>
      REC (%D s. sup (?a s >>= D) (?b s)) ?s
      <= lfp (%x. sup ?m (x >>= ?a)) >>= ?b",
     template_implication
      ([template_inequation
         (less_equals, template_app (template_hole 7, template_var 3),
          template_var 2)],
       template_inequation
        (less_equals,
         template_app
          (template_app (template_hole 5, t_empty), template_var 3),
         template_app
          (template_app
            (template_hole 3, template_app (template_hole 2, t_empty)),
           template_var 0)))),
    ("Refine_While.pw_rwof_step'",
     "[| nofail (?step ?s); rwof ?m0.0 ?cond ?step ?s; ?cond ?s;
         inres (?step ?s) ?s' |]
      ==> rwof ?m0.0 ?cond ?step ?s'",
     template_implication
      ([template_predicate
         (
            template_app
             (template_hole 2,
              template_app (template_var 4, template_var 3))
            ),
        template_predicate
         (
            template_app
             (template_app
               (template_app
                 (template_app (template_hole 1, template_var 2),
                  template_var 1),
                template_var 4),
              template_var 3)
            ),
        template_predicate (template_app (template_var 1, template_var 3)),
        template_predicate
         (
            template_app
             (template_app
               (template_hole 0,
                template_app (template_var 4, template_var 3)),
              template_var 0)
            )],
       template_predicate
        (
           template_app
            (template_app
              (template_app
                (template_app (template_hole 1, template_var 2),
                 template_var 1),
               template_var 4),
             template_var 0)
           ))),
    ("Refine_While.WHILEI_lfp_conv",
     "?m >>= WHILE\<^bsup>?I\<^esup> ?c ?f =
      lfp (WHILEI_lfp_body ?I ?m ?c ?f) >>=
      (%s. ASSERT (?I s) >>= (%_. ASSUME (~ ?c s) >>= (%_. RETURN s)))",
     template_equation
      (template_app
        (template_app (template_hole 8, template_var 3),
         template_app
          (template_app
            (template_app (template_hole 7, template_var 2),
             template_var 1),
           template_var 0)),
       template_app
        (template_app
          (template_hole 8,
           template_app
            (template_hole 6,
             template_app
              (template_app
                (template_app
                  (template_app (template_hole 5, template_var 2),
                   template_var 3),
                 template_var 1),
               template_var 0))),
         t_empty))),
    ("Refine_While.rwof_step",
     "[| nofail (?m0.0 >>= WHILE ?cond ?step); rwof ?m0.0 ?cond ?step ?s;
         ?cond ?s |]
      ==> ?step ?s <= SPEC (rwof ?m0.0 ?cond ?step)",
     template_implication
      ([template_predicate
         (
            template_app
             (template_hole 6,
              template_app
               (template_app (template_hole 5, template_var 3),
                template_app
                 (template_app (template_hole 4, template_var 2),
                  template_var 1)))
            ),
        template_predicate
         (
            template_app
             (template_app
               (template_app
                 (template_app (template_hole 3, template_var 3),
                  template_var 2),
                template_var 1),
              template_var 0)
            ),
        template_predicate (template_app (template_var 2, template_var 0))],
       template_inequation
        (less_equals, template_app (template_var 1, template_var 0),
         template_app
          (template_hole 1,
           template_app
            (template_hole 0,
             template_app
              (template_app
                (template_app (template_hole 3, template_var 3),
                 template_var 2),
               template_var 1)))))),
    ("Refine_While.bounded_WHILE_shift",
     "?m >>=
      (%x. if ?cond x then bounded_WHILE ?n ?cond ?step (?step x)
           else RETURN x) =
      bounded_WHILE ?n ?cond ?step ?m >>=
      (%x. if ?cond x then ?step x else RETURN x)",
     template_equation
      (template_app
        (template_app (template_hole 3, template_var 3), t_empty),
       template_app
        (template_app
          (template_hole 3,
           template_app
            (template_app
              (template_app
                (template_app (template_hole 1, template_var 1),
                 template_var 2),
               template_var 0),
             template_var 3)),
         t_empty))),
    ("Refine_While.pw_rwof_step",
     "[| nofail (?m0.0 >>= WHILE ?cond ?step); rwof ?m0.0 ?cond ?step ?s;
         ?cond ?s; inres (?step ?s) ?s' |]
      ==> rwof ?m0.0 ?cond ?step ?s'",
     template_implication
      ([template_predicate
         (
            template_app
             (template_hole 4,
              template_app
               (template_app (template_hole 3, template_var 4),
                template_app
                 (template_app (template_hole 2, template_var 3),
                  template_var 2)))
            ),
        template_predicate
         (
            template_app
             (template_app
               (template_app
                 (template_app (template_hole 1, template_var 4),
                  template_var 3),
                template_var 2),
              template_var 1)
            ),
        template_predicate (template_app (template_var 3, template_var 1)),
        template_predicate
         (
            template_app
             (template_app
               (template_hole 0,
                template_app (template_var 2, template_var 1)),
              template_var 0)
            )],
       template_predicate
        (
           template_app
            (template_app
              (template_app
                (template_app (template_hole 1, template_var 4),
                 template_var 3),
               template_var 2),
             template_var 0)
           ))),
    ("Refine_While.WHILE_refine_rwof",
     "(nofail (?m >>= WHILE ?c ?f) ==>
       ?mi <= SPEC (%s. rwof ?m ?c ?f s & ~ ?c s)) ==>
      ?mi <= ?m >>= WHILE ?c ?f",
     template_implication
      ([template_implication
         ([template_predicate
            (
               template_app
                (template_hole 8,
                 template_app
                  (template_app (template_hole 7, template_var 3),
                   template_app
                    (template_app (template_hole 6, template_var 2),
                     template_var 1)))
               )],
          template_inequation
           (less_equals, template_var 0,
            template_app
             (template_hole 4, template_app (template_hole 3, t_empty))))],
       template_inequation
        (less_equals, template_var 0,
         template_app
          (template_app (template_hole 7, template_var 3),
           template_app
            (template_app (template_hole 6, template_var 2),
             template_var 1))))),
    ("Refine_While.WHILE_rule_gen_le",
     "[| ?m0.0 <= ?I; !!s. [| RETURN s <= ?I; ?b s |] ==> ?f s <= ?I |]
      ==> ?m0.0 >>= WHILE ?b ?f <= filter_nb ?b ?I",
     template_implication
      ([template_inequation (less_equals, template_var 3, template_var 2),
        template_predicate (template_app (template_hole 4, t_empty))],
       template_inequation
        (less_equals,
         template_app
          (template_app (template_hole 2, template_var 3),
           template_app
            (template_app (template_hole 1, template_var 1),
             template_var 0)),
         template_app
          (template_app (template_hole 0, template_var 1),
           template_var 2)))),
    ("Refine_While.WHILEI_tailrec_conv",
     "WHILE\<^bsup>?I\<^esup> ?c ?f =
      REC (tailrec_body
            (%s. ASSERT (?I s) >>= (%_. ASSUME (?c s) >>= (%_. ?f s)))
            (%s. ASSERT (?I s) >>=
                 (%_. ASSUME (~ ?c s) >>= (%_. RETURN s))))",
     template_equation
      (template_app
        (template_app
          (template_app (template_hole 7, template_var 2), template_var 1),
         template_var 0),
       template_app
        (template_hole 6,
         template_app (template_app (template_hole 5, t_empty), t_empty)))),
    ("Refine_While.WHILEIT_tailrec_conv",
     "WHILE\<^sub>T\<^bsup>?I\<^esup> ?c ?f =
      REC\<^sub>T
       (tailrec_body
         (%s. ASSERT (?I s) >>= (%_. ASSUME (?c s) >>= (%_. ?f s)))
         (%s. ASSERT (?I s) >>= (%_. ASSUME (~ ?c s) >>= (%_. RETURN s))))",
     template_equation
      (template_app
        (template_app
          (template_app (template_hole 7, template_var 2), template_var 1),
         template_var 0),
       template_app
        (template_hole 6,
         template_app (template_app (template_hole 5, t_empty), t_empty)))),
    ("Refine_While.is_rwof_invarI",
     "[| ?m0.0 \<le>\<^sub>n SPEC ?I;
         !!s. [| rwof ?m0.0 ?cond ?step s; ?I s; ?cond s |]
              ==> ?step s \<le>\<^sub>n SPEC ?I |]
      ==> is_rwof_invar ?m0.0 ?cond ?step ?I",
     template_implication
      ([template_predicate
         (
            template_app
             (template_app (template_hole 5, template_var 3),
              template_app
               (template_hole 4,
                template_app (template_hole 3, template_var 2)))
            ),
        template_predicate (template_app (template_hole 2, t_empty))],
       template_predicate
        (
           template_app
            (template_app
              (template_app
                (template_app (template_hole 0, template_var 3),
                 template_var 1),
               template_var 0),
             template_var 2)
           ))),
    ("Refine_While.rwof_step_refine",
     "[| nofail (?m0.0 >>= WHILE ?cond ?step); rwof ?m0.0 ?cond ?step' ?s;
         !!s. [| rwof ?m0.0 ?cond ?step s; ?cond s |]
              ==> ?step' s \<le>\<^sub>n ?step s |]
      ==> rwof ?m0.0 ?cond ?step ?s",
     template_implication
      ([template_predicate
         (
            template_app
             (template_hole 5,
              template_app
               (template_app (template_hole 4, template_var 4),
                template_app
                 (template_app (template_hole 3, template_var 3),
                  template_var 2)))
            ),
        template_predicate
         (
            template_app
             (template_app
               (template_app
                 (template_app (template_hole 2, template_var 4),
                  template_var 3),
                template_var 1),
              template_var 0)
            ),
        template_predicate (template_app (template_hole 1, t_empty))],
       template_predicate
        (
           template_app
            (template_app
              (template_app
                (template_app (template_hole 2, template_var 4),
                 template_var 3),
               template_var 2),
             template_var 0)
           ))),
    ("Refine_While.establish_rwof_invar",
     "[| ?m0.0 \<le>\<^sub>n SPEC ?I;
         !!s. [| rwof ?m0.0 ?cond ?step s; ?I s; ?cond s |]
              ==> ?step s \<le>\<^sub>n SPEC ?I;
         rwof ?m0.0 ?cond ?step ?s |]
      ==> ?I ?s",
     template_implication
      ([template_predicate
         (
            template_app
             (template_app (template_hole 4, template_var 4),
              template_app
               (template_hole 3,
                template_app (template_hole 2, template_var 3)))
            ),
        template_predicate (template_app (template_hole 1, t_empty)),
        template_predicate
         (
            template_app
             (template_app
               (template_app
                 (template_app (template_hole 0, template_var 4),
                  template_var 2),
                template_var 1),
              template_var 0)
            )],
       template_predicate (template_app (template_var 3, template_var 0)))),
    ("Refine_While.bounded_WHILE_FAIL_rwof",
     "[| bounded_WHILE ?n ?cond ?step ?m0.0 = FAIL; ?m0.0 ~= FAIL |]
      ==> EX n'<?n.
             EX x X.
                bounded_WHILE n' ?cond ?step ?m0.0 = RES X &
                x : X & ?cond x & ?step x = FAIL",
     template_implication
      ([template_equation
         (template_app
           (template_app
             (template_app
               (template_app (template_hole 9, template_var 3),
                template_var 2),
              template_var 1),
            template_var 0),
          template_hole 8),
        template_negation
         (template_equation (template_var 0, template_hole 8))],
       template_predicate (template_app (template_hole 6, t_empty)))),
    ("Refine_While.rwof_WHILE_rule",
     "[| ?m0.0 <= SPEC ?I;
         !!s. [| rwof ?m0.0 ?cond ?step s; ?I s; ?cond s |]
              ==> ?step s <= SPEC ?I |]
      ==> ?m0.0 >>= WHILE ?cond ?step
          <= SPEC (%s. rwof ?m0.0 ?cond ?step s & ~ ?cond s & ?I s)",
     template_implication
      ([template_inequation
         (less_equals, template_var 3,
          template_app
           (template_hole 7,
            template_app (template_hole 6, template_var 2))),
        template_predicate (template_app (template_hole 5, t_empty))],
       template_inequation
        (less_equals,
         template_app
          (template_app (template_hole 3, template_var 3),
           template_app
            (template_app (template_hole 2, template_var 1),
             template_var 0)),
         template_app
          (template_hole 7, template_app (template_hole 6, t_empty))))),
    ("Refine_While.msii_induct",
     "[| ?m0.0 <= ?P;
         !!m. [| m <= msii ?I ?m0.0 ?c ?f; m <= ?P;
                 filter_ASSUME ?c (filter_ASSERT ?I m) >>= ?f
                 <= msii ?I ?m0.0 ?c ?f |]
              ==> filter_ASSUME ?c (filter_ASSERT ?I m) >>= ?f <= ?P |]
      ==> msii ?I ?m0.0 ?c ?f <= ?P",
     template_implication
      ([template_inequation (less_equals, template_var 4, template_var 3),
        template_predicate (template_app (template_hole 4, t_empty))],
       template_inequation
        (less_equals,
         template_app
          (template_app
            (template_app
              (template_app (template_hole 3, template_var 2),
               template_var 4),
             template_var 1),
           template_var 0),
         template_var 3))),
    ("Refine_While.WHILE_le_rule",
     "[| (?s, ?s') : ?R;
         !!W s s'.
            [| !!s s'. (s, s') : ?R ==> W s <= ?M s'; (s, s') : ?R |]
            ==> (if ?b s then ?f s >>= W else RETURN s) <= ?M s' |]
      ==> WHILE ?b ?f ?s <= ?M ?s'",
     template_implication
      ([template_predicate
         (
            template_app
             (template_app
               (template_hole 9,
                template_app
                 (template_app (template_hole 8, template_var 5),
                  template_var 4)),
              template_var 3)
            ),
        template_predicate (template_app (template_hole 7, t_empty))],
       template_inequation
        (less_equals,
         template_app
          (template_app
            (template_app (template_hole 0, template_var 1),
             template_var 0),
           template_var 5),
         template_app (template_var 2, template_var 4)))),
    ("Refine_While.WHILE_refine",
     "[| (?x, ?x') : ?R; !!x x'. (x, x') : ?R ==> ?b x = ?b' x';
         !!x x'.
            [| (x, x') : ?R; ?b x; ?b' x' |]
            ==> ?f x <= \<Down> ?R (?f' x') |]
      ==> WHILE ?b ?f ?x <= \<Down> ?R (WHILE ?b' ?f' ?x')",
     template_implication
      ([template_predicate
         (
            template_app
             (template_app
               (template_hole 8,
                template_app
                 (template_app (template_hole 7, template_var 6),
                  template_var 5)),
              template_var 4)
            ),
        template_predicate (template_app (template_hole 6, t_empty)),
        template_predicate (template_app (template_hole 6, t_empty))],
       template_inequation
        (less_equals,
         template_app
          (template_app
            (template_app (template_hole 1, template_var 3),
             template_var 1),
           template_var 6),
         template_app
          (template_app (template_hole 2, template_var 4),
           template_app
            (template_app
              (template_app (template_hole 0, template_var 2),
               template_var 0),
             template_var 5))))),
    ("Refine_While.WHILET_refine",
     "[| (?x, ?x') : ?R; !!x x'. (x, x') : ?R ==> ?b x = ?b' x';
         !!x x'.
            [| (x, x') : ?R; ?b x; ?b' x' |]
            ==> ?f x <= \<Down> ?R (?f' x') |]
      ==> WHILE\<^sub>T ?b ?f ?x <= \<Down> ?R (WHILE\<^sub>T ?b' ?f' ?x')",
     template_implication
      ([template_predicate
         (
            template_app
             (template_app
               (template_hole 8,
                template_app
                 (template_app (template_hole 7, template_var 6),
                  template_var 5)),
              template_var 4)
            ),
        template_predicate (template_app (template_hole 6, t_empty)),
        template_predicate (template_app (template_hole 6, t_empty))],
       template_inequation
        (less_equals,
         template_app
          (template_app
            (template_app (template_hole 1, template_var 3),
             template_var 1),
           template_var 6),
         template_app
          (template_app (template_hole 2, template_var 4),
           template_app
            (template_app
              (template_app (template_hole 0, template_var 2),
               template_var 0),
             template_var 5))))),
    ("Refine_While.WHILEI_le_rule",
     "[| (?s, ?s') : ?R;
         !!W s s'.
            [| !!s s'. (s, s') : ?R ==> W s <= ?M s'; (s, s') : ?R |]
            ==> ASSERT (?I s) >>=
                (%_. if ?b s then ?f s >>= W else RETURN s)
                <= ?M s' |]
      ==> WHILE\<^bsup>?I\<^esup> ?b ?f ?s <= ?M ?s'",
     template_implication
      ([template_predicate
         (
            template_app
             (template_app
               (template_hole 11,
                template_app
                 (template_app (template_hole 10, template_var 6),
                  template_var 5)),
              template_var 4)
            ),
        template_predicate (template_app (template_hole 9, t_empty))],
       template_inequation
        (less_equals,
         template_app
          (template_app
            (template_app
              (template_app (template_hole 0, template_var 2),
               template_var 1),
             template_var 0),
           template_var 6),
         template_app (template_var 3, template_var 5)))),
    ("Refine_While.WHILE_invisible_refine",
     "[| (?s, ?s') : ?R; !!s s'. [| (s, s') : ?R; ?b' s' |] ==> ?b s;
         !!s s'.
            [| (s, s') : ?R; ?b s |]
            ==> ?f s
                <= sup (\<Down> ?R (ASSUME (?b' s') >>= (%_. ?f' s')))
                    (\<Down> ?R (RETURN s')) |]
      ==> WHILE ?b ?f ?s <= \<Down> ?R (WHILE ?b' ?f' ?s')",
     template_implication
      ([template_predicate
         (
            template_app
             (template_app
               (template_hole 11,
                template_app
                 (template_app (template_hole 10, template_var 6),
                  template_var 5)),
              template_var 4)
            ),
        template_predicate (template_app (template_hole 9, t_empty)),
        template_predicate (template_app (template_hole 9, t_empty))],
       template_inequation
        (less_equals,
         template_app
          (template_app
            (template_app (template_hole 1, template_var 2),
             template_var 1),
           template_var 6),
         template_app
          (template_app (template_hole 5, template_var 4),
           template_app
            (template_app
              (template_app (template_hole 0, template_var 3),
               template_var 0),
             template_var 5))))),
    ("Refine_While.WHILE_refine'",
     "[| ?I' ?x' ==> (?x, ?x') : ?R;
         !!x x'. [| (x, x') : ?R; ?I' x' |] ==> ?b x = ?b' x';
         !!x x'.
            [| (x, x') : ?R; ?b x; ?b' x'; ?I' x' |]
            ==> ?f x <= \<Down> ?R (?f' x') |]
      ==> WHILE ?b ?f ?x
          <= \<Down> ?R (WHILE\<^bsup>?I'\<^esup> ?b' ?f' ?x')",
     template_implication
      ([template_implication
         ([template_predicate
            (template_app (template_var 7, template_var 6))],
          template_predicate
           (
              template_app
               (template_app
                 (template_hole 8,
                  template_app
                   (template_app (template_hole 7, template_var 5),
                    template_var 6)),
                template_var 4)
              )),
        template_predicate (template_app (template_hole 6, t_empty)),
        template_predicate (template_app (template_hole 6, t_empty))],
       template_inequation
        (less_equals,
         template_app
          (template_app
            (template_app (template_hole 1, template_var 3),
             template_var 1),
           template_var 5),
         template_app
          (template_app (template_hole 2, template_var 4),
           template_app
            (template_app
              (template_app
                (template_app (template_hole 0, template_var 7),
                 template_var 2),
               template_var 0),
             template_var 6))))),
    ("Refine_While.WHILET_refine'",
     "[| ?I' ?x' ==> (?x, ?x') : ?R;
         !!x x'. [| (x, x') : ?R; ?I' x' |] ==> ?b x = ?b' x';
         !!x x'.
            [| (x, x') : ?R; ?b x; ?b' x'; ?I' x' |]
            ==> ?f x <= \<Down> ?R (?f' x') |]
      ==> WHILE\<^sub>T ?b ?f ?x
          <= \<Down> ?R (WHILE\<^sub>T\<^bsup>?I'\<^esup> ?b' ?f' ?x')",
     template_implication
      ([template_implication
         ([template_predicate
            (template_app (template_var 7, template_var 6))],
          template_predicate
           (
              template_app
               (template_app
                 (template_hole 8,
                  template_app
                   (template_app (template_hole 7, template_var 5),
                    template_var 6)),
                template_var 4)
              )),
        template_predicate (template_app (template_hole 6, t_empty)),
        template_predicate (template_app (template_hole 6, t_empty))],
       template_inequation
        (less_equals,
         template_app
          (template_app
            (template_app (template_hole 1, template_var 3),
             template_var 1),
           template_var 5),
         template_app
          (template_app (template_hole 2, template_var 4),
           template_app
            (template_app
              (template_app
                (template_app (template_hole 0, template_var 7),
                 template_var 2),
               template_var 0),
             template_var 6))))),
    ("Refine_While.WHILE_refine_genR",
     "[| (?x, ?x') : ?R'; !!x x'. (x, x') : ?R' ==> ?b x = ?b' x';
         !!x x'.
            [| (x, x') : ?R'; ?b x; ?b' x' |]
            ==> ?f x <= \<Down> ?R' (?f' x');
         !!x x'. [| (x, x') : ?R'; ~ ?b x; ~ ?b' x' |] ==> (x, x') : ?R |]
      ==> WHILE ?b ?f ?x <= \<Down> ?R (WHILE ?b' ?f' ?x')",
     template_implication
      ([template_predicate
         (
            template_app
             (template_app
               (template_hole 9,
                template_app
                 (template_app (template_hole 8, template_var 7),
                  template_var 6)),
              template_var 5)
            ),
        template_predicate (template_app (template_hole 7, t_empty)),
        template_predicate (template_app (template_hole 7, t_empty)),
        template_predicate (template_app (template_hole 7, t_empty))],
       template_inequation
        (less_equals,
         template_app
          (template_app
            (template_app (template_hole 1, template_var 4),
             template_var 2),
           template_var 7),
         template_app
          (template_app (template_hole 3, template_var 0),
           template_app
            (template_app
              (template_app (template_hole 0, template_var 3),
               template_var 1),
             template_var 6))))),
    ("Refine_While.WHILET_refine_genR",
     "[| (?x, ?x') : ?R'; !!x x'. (x, x') : ?R' ==> ?b x = ?b' x';
         !!x x'.
            [| (x, x') : ?R'; ?b x; ?b' x' |]
            ==> ?f x <= \<Down> ?R' (?f' x');
         !!x x'. [| (x, x') : ?R'; ~ ?b x; ~ ?b' x' |] ==> (x, x') : ?R |]
      ==> WHILE\<^sub>T ?b ?f ?x <= \<Down> ?R (WHILE\<^sub>T ?b' ?f' ?x')",
     template_implication
      ([template_predicate
         (
            template_app
             (template_app
               (template_hole 9,
                template_app
                 (template_app (template_hole 8, template_var 7),
                  template_var 6)),
              template_var 5)
            ),
        template_predicate (template_app (template_hole 7, t_empty)),
        template_predicate (template_app (template_hole 7, t_empty)),
        template_predicate (template_app (template_hole 7, t_empty))],
       template_inequation
        (less_equals,
         template_app
          (template_app
            (template_app (template_hole 1, template_var 4),
             template_var 2),
           template_var 7),
         template_app
          (template_app (template_hole 3, template_var 0),
           template_app
            (template_app
              (template_app (template_hole 0, template_var 3),
               template_var 1),
             template_var 6))))),
    ("Refine_While.autoref_WHILE'",
     "[| !!x x'. (x, x') : ?R ==> (?c x, ?c' $ x') : bool_rel;
         !!x x'.
            [| REMOVE_INTERNAL ?c' x'; (x, x') : ?R |]
            ==> (?f x, ?f' $ x') : \<langle>?R\<rangle>nres_rel |]
      ==> (WHILE ?c ?f,
           (Autoref_Tagging.OP WHILE :::
            (?R \<rightarrow> bool_rel) \<rightarrow>
            (?R \<rightarrow> \<langle>?R\<rangle>nres_rel) \<rightarrow>
            ?R \<rightarrow> \<langle>?R\<rangle>nres_rel) $
           ?c' $
           ?f')
          : ?R \<rightarrow> \<langle>?R\<rangle>nres_rel",
     template_implication
      ([template_predicate (template_app (template_hole 35, t_empty)),
        template_predicate (template_app (template_hole 35, t_empty))],
       template_predicate
        (
           template_app
            (template_app
              (template_hole 20,
               template_app
                (template_app
                  (template_hole 19,
                   template_app
                    (template_app (template_hole 18, template_var 3),
                     template_var 1)),
                 template_app
                  (template_app
                    (template_hole 17,
                     template_app
                      (template_app
                        (template_hole 16,
                         template_app
                          (template_app
                            (template_hole 15,
                             template_app
                              (template_hole 14, template_hole 13)),
                           template_app
                            (template_hole 12,
                             template_app
                              (template_app
                                (template_hole 11,
                                 template_app
                                  (template_app
                                    (template_hole 10, template_hole 9),
                                   template_app
                                    (template_app
(template_hole 8,
 template_app
  (template_app (template_hole 7, template_hole 6), template_var 4)),
                                     template_hole 27))),
                               template_app
                                (template_app
                                  (template_hole 5,
                                   template_app
                                    (template_app
(template_hole 4, template_hole 3),
                                     template_app
(template_app
  (template_hole 2,
   template_app
    (template_app (template_hole 1, template_hole 0), template_var 4)),
 template_app
  (template_app (template_hole 22, template_hole 21), template_var 4)))),
                                 template_app
                                  (template_app
                                    (template_hole 2,
                                     template_app
(template_app (template_hole 1, template_hole 0), template_var 4)),
                                   template_app
                                    (template_app
(template_hole 22, template_hole 21),
                                     template_var 4))))))),
                       template_var 2)),
                   template_var 0))),
             template_app
              (template_app
                (template_hole 2,
                 template_app
                  (template_app (template_hole 1, template_hole 0),
                   template_var 4)),
               template_app
                (template_app (template_hole 22, template_hole 21),
                 template_var 4)))
           ))),
    ("Refine_While.range_set_WHILE",
     "[| !!i s. ?c (i, s) = (i < ?u); ?F {} ?s0.0 = ?s0.0;
         !!s i X.
            [| ?l <= i; i < ?u |]
            ==> ?f (i, ?F X s)
                <= SPEC
                    (%(i', r).
                        i' = i + 1 & r = ?F (insert (?list ! i) X) s) |]
      ==> WHILE\<^sub>T ?c ?f (?l, ?s0.0)
          <= SPEC
              (%(uu_, r). r = ?F {?list ! i |i. ?l <= i & i < ?u} ?s0.0)",
     template_implication
      ([template_predicate (template_app (template_hole 23, t_empty)),
        template_equation
         (template_app
           (template_app (template_var 4, template_hole 16),
            template_var 3),
          template_var 3),
        template_predicate (template_app (template_hole 22, t_empty))],
       template_inequation
        (less_equals,
         template_app
          (template_app
            (template_app (template_hole 3, template_var 6),
             template_var 1),
           template_app
            (template_app (template_hole 19, template_var 2),
             template_var 3)),
         template_app
          (template_hole 12,
           template_app
            (template_hole 11,
             template_app (template_hole 10, t_empty)))))),
    ("Refine_While.WHILE_invisible_refine_genR",
     "[| (?s, ?s') : ?R'; !!s s'. [| (s, s') : ?R'; ?b' s' |] ==> ?b s;
         !!s s'.
            [| (s, s') : ?R'; ?b s |]
            ==> ?f s
                <= sup (\<Down> ?R' (ASSUME (?b' s') >>= (%_. ?f' s')))
                    (\<Down> ?R' (RETURN s'));
         !!x x'. [| (x, x') : ?R'; ~ ?b x; ~ ?b' x' |] ==> (x, x') : ?R |]
      ==> WHILE ?b ?f ?s <= \<Down> ?R (WHILE ?b' ?f' ?s')",
     template_implication
      ([template_predicate
         (
            template_app
             (template_app
               (template_hole 12,
                template_app
                 (template_app (template_hole 11, template_var 7),
                  template_var 6)),
              template_var 5)
            ),
        template_predicate (template_app (template_hole 10, t_empty)),
        template_predicate (template_app (template_hole 10, t_empty)),
        template_predicate (template_app (template_hole 10, t_empty))],
       template_inequation
        (less_equals,
         template_app
          (template_app
            (template_app (template_hole 1, template_var 3),
             template_var 2),
           template_var 7),
         template_app
          (template_app (template_hole 6, template_var 0),
           template_app
            (template_app
              (template_app (template_hole 0, template_var 4),
               template_var 1),
             template_var 6))))),
    ("Refine_While.autoref_WHILE",
     "[| !!x x'. (x, x') : ?R ==> (?c x, ?c' $ x') : bool_rel;
         !!x x'.
            [| REMOVE_INTERNAL ?c' x'; (x, x') : ?R |]
            ==> (?f x, ?f' $ x') : \<langle>?R\<rangle>nres_rel;
         (?s, ?s') : ?R |]
      ==> (WHILE ?c ?f ?s,
           (Autoref_Tagging.OP WHILE :::
            (?R \<rightarrow> bool_rel) \<rightarrow>
            (?R \<rightarrow> \<langle>?R\<rangle>nres_rel) \<rightarrow>
            ?R \<rightarrow> \<langle>?R\<rangle>nres_rel) $
           ?c' $
           ?f' $
           ?s')
          : \<langle>?R\<rangle>nres_rel",
     template_implication
      ([template_predicate (template_app (template_hole 33, t_empty)),
        template_predicate (template_app (template_hole 33, t_empty)),
        template_predicate
         (
            template_app
             (template_app
               (template_hole 30,
                template_app
                 (template_app (template_hole 29, template_var 1),
                  template_var 0)),
              template_var 6)
            )],
       template_predicate
        (
           template_app
            (template_app
              (template_hole 23,
               template_app
                (template_app
                  (template_hole 22,
                   template_app
                    (template_app
                      (template_app (template_hole 18, template_var 5),
                       template_var 3),
                     template_var 1)),
                 template_app
                  (template_app
                    (template_hole 21,
                     template_app
                      (template_app
                        (template_hole 17,
                         template_app
                          (template_app
                            (template_hole 16,
                             template_app
                              (template_app
                                (template_hole 15,
                                 template_app
                                  (template_hole 14, template_hole 13)),
                               template_app
                                (template_hole 12,
                                 template_app
                                  (template_app
                                    (template_hole 11,
                                     template_app
(template_app (template_hole 10, template_hole 9),
 template_app
  (template_app
    (template_hole 8,
     template_app
      (template_app (template_hole 7, template_hole 6), template_var 6)),
   template_hole 25))),
                                   template_app
                                    (template_app
(template_hole 5,
 template_app
  (template_app (template_hole 4, template_hole 3),
   template_app
    (template_app
      (template_hole 2,
       template_app
        (template_app (template_hole 1, template_hole 0), template_var 6)),
     template_app
      (template_app (template_hole 20, template_hole 19),
       template_var 6)))),
                                     template_app
(template_app
  (template_hole 2,
   template_app
    (template_app (template_hole 1, template_hole 0), template_var 6)),
 template_app
  (template_app (template_hole 20, template_hole 19), template_var 6))))))),
                           template_var 4)),
                       template_var 2)),
                   template_var 0))),
             template_app
              (template_app (template_hole 20, template_hole 19),
               template_var 6))
           ))),
    ("Refine_While.autoref_WHILET",
     "[| !!x x'. (x, x') : ?R ==> (?c x, ?c' $ x') : bool_rel;
         !!x x'.
            [| REMOVE_INTERNAL ?c' x'; (x, x') : ?R |]
            ==> (?f x, ?f' $ x') : \<langle>?R\<rangle>nres_rel;
         (?s, ?s') : ?R |]
      ==> (WHILE\<^sub>T ?c ?f ?s,
           (Autoref_Tagging.OP WHILE\<^sub>T :::
            (?R \<rightarrow> bool_rel) \<rightarrow>
            (?R \<rightarrow> \<langle>?R\<rangle>nres_rel) \<rightarrow>
            ?R \<rightarrow> \<langle>?R\<rangle>nres_rel) $
           ?c' $
           ?f' $
           ?s')
          : \<langle>?R\<rangle>nres_rel",
     template_implication
      ([template_predicate (template_app (template_hole 33, t_empty)),
        template_predicate (template_app (template_hole 33, t_empty)),
        template_predicate
         (
            template_app
             (template_app
               (template_hole 30,
                template_app
                 (template_app (template_hole 29, template_var 1),
                  template_var 0)),
              template_var 6)
            )],
       template_predicate
        (
           template_app
            (template_app
              (template_hole 23,
               template_app
                (template_app
                  (template_hole 22,
                   template_app
                    (template_app
                      (template_app (template_hole 18, template_var 5),
                       template_var 3),
                     template_var 1)),
                 template_app
                  (template_app
                    (template_hole 21,
                     template_app
                      (template_app
                        (template_hole 17,
                         template_app
                          (template_app
                            (template_hole 16,
                             template_app
                              (template_app
                                (template_hole 15,
                                 template_app
                                  (template_hole 14, template_hole 13)),
                               template_app
                                (template_hole 12,
                                 template_app
                                  (template_app
                                    (template_hole 11,
                                     template_app
(template_app (template_hole 10, template_hole 9),
 template_app
  (template_app
    (template_hole 8,
     template_app
      (template_app (template_hole 7, template_hole 6), template_var 6)),
   template_hole 25))),
                                   template_app
                                    (template_app
(template_hole 5,
 template_app
  (template_app (template_hole 4, template_hole 3),
   template_app
    (template_app
      (template_hole 2,
       template_app
        (template_app (template_hole 1, template_hole 0), template_var 6)),
     template_app
      (template_app (template_hole 20, template_hole 19),
       template_var 6)))),
                                     template_app
(template_app
  (template_hole 2,
   template_app
    (template_app (template_hole 1, template_hole 0), template_var 6)),
 template_app
  (template_app (template_hole 20, template_hole 19), template_var 6))))))),
                           template_var 4)),
                       template_var 2)),
                   template_var 0))),
             template_app
              (template_app (template_hole 20, template_hole 19),
               template_var 6))
           ))),
    ("Refine_While.WHILE_refine_genR'",
     "[| (?x, ?x') : ?R';
         !!x x'. [| (x, x') : ?R'; ?I' x' |] ==> ?b x = ?b' x';
         !!x x'.
            [| (x, x') : ?R'; ?b x; ?b' x'; ?I' x' |]
            ==> ?f x <= \<Down> ?R' (?f' x');
         !!x x'. [| (x, x') : ?R'; ~ ?b x; ~ ?b' x' |] ==> (x, x') : ?R |]
      ==> WHILE ?b ?f ?x
          <= \<Down> ?R (WHILE\<^bsup>?I'\<^esup> ?b' ?f' ?x')",
     template_implication
      ([template_predicate
         (
            template_app
             (template_app
               (template_hole 9,
                template_app
                 (template_app (template_hole 8, template_var 8),
                  template_var 7)),
              template_var 6)
            ),
        template_predicate (template_app (template_hole 7, t_empty)),
        template_predicate (template_app (template_hole 7, t_empty)),
        template_predicate (template_app (template_hole 7, t_empty))],
       template_inequation
        (less_equals,
         template_app
          (template_app
            (template_app (template_hole 1, template_var 4),
             template_var 2),
           template_var 8),
         template_app
          (template_app (template_hole 3, template_var 0),
           template_app
            (template_app
              (template_app
                (template_app (template_hole 0, template_var 5),
                 template_var 3),
               template_var 1),
             template_var 7))))),
    ("Refine_While.autoref_WHILEI'",
     "[| !!x x'. [| (x, x') : ?R; ?I x' |] ==> (?c x, ?c' $ x') : bool_rel;
         !!x x'.
            [| REMOVE_INTERNAL ?c' x'; (x, x') : ?R; ?I x' |]
            ==> (?f x, ?f' $ x') : \<langle>?R\<rangle>nres_rel |]
      ==> (WHILE ?c ?f,
           (Autoref_Tagging.OP WHILE\<^bsup>?I\<^esup> :::
            (?R \<rightarrow> bool_rel) \<rightarrow>
            (?R \<rightarrow> \<langle>?R\<rangle>nres_rel) \<rightarrow>
            ?R \<rightarrow> \<langle>?R\<rangle>nres_rel) $
           ?c' $
           ?f')
          : ?R \<rightarrow> \<langle>?R\<rangle>nres_rel",
     template_implication
      ([template_predicate (template_app (template_hole 35, t_empty)),
        template_predicate (template_app (template_hole 35, t_empty))],
       template_predicate
        (
           template_app
            (template_app
              (template_hole 20,
               template_app
                (template_app
                  (template_hole 19,
                   template_app
                    (template_app (template_hole 18, template_var 3),
                     template_var 1)),
                 template_app
                  (template_app
                    (template_hole 17,
                     template_app
                      (template_app
                        (template_hole 16,
                         template_app
                          (template_app
                            (template_hole 15,
                             template_app
                              (template_hole 14,
                               template_app
                                (template_hole 13, template_var 4))),
                           template_app
                            (template_hole 12,
                             template_app
                              (template_app
                                (template_hole 11,
                                 template_app
                                  (template_app
                                    (template_hole 10, template_hole 9),
                                   template_app
                                    (template_app
(template_hole 8,
 template_app
  (template_app (template_hole 7, template_hole 6), template_var 5)),
                                     template_hole 27))),
                               template_app
                                (template_app
                                  (template_hole 5,
                                   template_app
                                    (template_app
(template_hole 4, template_hole 3),
                                     template_app
(template_app
  (template_hole 2,
   template_app
    (template_app (template_hole 1, template_hole 0), template_var 5)),
 template_app
  (template_app (template_hole 22, template_hole 21), template_var 5)))),
                                 template_app
                                  (template_app
                                    (template_hole 2,
                                     template_app
(template_app (template_hole 1, template_hole 0), template_var 5)),
                                   template_app
                                    (template_app
(template_hole 22, template_hole 21),
                                     template_var 5))))))),
                       template_var 2)),
                   template_var 0))),
             template_app
              (template_app
                (template_hole 2,
                 template_app
                  (template_app (template_hole 1, template_hole 0),
                   template_var 5)),
               template_app
                (template_app (template_hole 22, template_hole 21),
                 template_var 5)))
           ))),
    ("Refine_While.autoref_WHILEIT'",
     "[| !!x x'. [| (x, x') : ?R; ?I x' |] ==> (?c x, ?c' $ x') : bool_rel;
         !!x x'.
            [| REMOVE_INTERNAL ?c' x'; (x, x') : ?R; ?I x' |]
            ==> (?f x, ?f' $ x') : \<langle>?R\<rangle>nres_rel |]
      ==> (WHILE\<^sub>T ?c ?f,
           (Autoref_Tagging.OP WHILE\<^sub>T\<^bsup>?I\<^esup> :::
            (?R \<rightarrow> bool_rel) \<rightarrow>
            (?R \<rightarrow> \<langle>?R\<rangle>nres_rel) \<rightarrow>
            ?R \<rightarrow> \<langle>?R\<rangle>nres_rel) $
           ?c' $
           ?f')
          : ?R \<rightarrow> \<langle>?R\<rangle>nres_rel",
     template_implication
      ([template_predicate (template_app (template_hole 35, t_empty)),
        template_predicate (template_app (template_hole 35, t_empty))],
       template_predicate
        (
           template_app
            (template_app
              (template_hole 20,
               template_app
                (template_app
                  (template_hole 19,
                   template_app
                    (template_app (template_hole 18, template_var 3),
                     template_var 1)),
                 template_app
                  (template_app
                    (template_hole 17,
                     template_app
                      (template_app
                        (template_hole 16,
                         template_app
                          (template_app
                            (template_hole 15,
                             template_app
                              (template_hole 14,
                               template_app
                                (template_hole 13, template_var 4))),
                           template_app
                            (template_hole 12,
                             template_app
                              (template_app
                                (template_hole 11,
                                 template_app
                                  (template_app
                                    (template_hole 10, template_hole 9),
                                   template_app
                                    (template_app
(template_hole 8,
 template_app
  (template_app (template_hole 7, template_hole 6), template_var 5)),
                                     template_hole 27))),
                               template_app
                                (template_app
                                  (template_hole 5,
                                   template_app
                                    (template_app
(template_hole 4, template_hole 3),
                                     template_app
(template_app
  (template_hole 2,
   template_app
    (template_app (template_hole 1, template_hole 0), template_var 5)),
 template_app
  (template_app (template_hole 22, template_hole 21), template_var 5)))),
                                 template_app
                                  (template_app
                                    (template_hole 2,
                                     template_app
(template_app (template_hole 1, template_hole 0), template_var 5)),
                                   template_app
                                    (template_app
(template_hole 22, template_hole 21),
                                     template_var 5))))))),
                       template_var 2)),
                   template_var 0))),
             template_app
              (template_app
                (template_hole 2,
                 template_app
                  (template_app (template_hole 1, template_hole 0),
                   template_var 5)),
               template_app
                (template_app (template_hole 22, template_hole 21),
                 template_var 5)))
           ))),
    ("Refine_While.WHILEI_refine",
     "[| ?I' ?x' ==> (?x, ?x') : ?R;
         !!x x'. [| (x, x') : ?R; ?I' x' |] ==> ?I x;
         !!x x'. [| (x, x') : ?R; ?I x; ?I' x' |] ==> ?b x = ?b' x';
         !!x x'.
            [| (x, x') : ?R; ?b x; ?b' x'; ?I x; ?I' x' |]
            ==> ?f x <= \<Down> ?R (?f' x') |]
      ==> WHILE\<^bsup>?I\<^esup> ?b ?f ?x
          <= \<Down> ?R (WHILE\<^bsup>?I'\<^esup> ?b' ?f' ?x')",
     template_implication
      ([template_implication
         ([template_predicate
            (template_app (template_var 8, template_var 7))],
          template_predicate
           (
              template_app
               (template_app
                 (template_hole 8,
                  template_app
                   (template_app (template_hole 7, template_var 6),
                    template_var 7)),
                template_var 5)
              )),
        template_predicate (template_app (template_hole 6, t_empty)),
        template_predicate (template_app (template_hole 6, t_empty)),
        template_predicate (template_app (template_hole 6, t_empty))],
       template_inequation
        (less_equals,
         template_app
          (template_app
            (template_app
              (template_app (template_hole 1, template_var 4),
               template_var 3),
             template_var 1),
           template_var 6),
         template_app
          (template_app (template_hole 2, template_var 5),
           template_app
            (template_app
              (template_app
                (template_app (template_hole 0, template_var 8),
                 template_var 2),
               template_var 0),
             template_var 7))))),
    ("Refine_While.WHILEIT_refine",
     "[| ?I' ?x' ==> (?x, ?x') : ?R;
         !!x x'. [| (x, x') : ?R; ?I' x' |] ==> ?I x;
         !!x x'. [| (x, x') : ?R; ?I x; ?I' x' |] ==> ?b x = ?b' x';
         !!x x'.
            [| (x, x') : ?R; ?b x; ?b' x'; ?I x; ?I' x' |]
            ==> ?f x <= \<Down> ?R (?f' x') |]
      ==> WHILE\<^sub>T\<^bsup>?I\<^esup> ?b ?f ?x
          <= \<Down> ?R (WHILE\<^sub>T\<^bsup>?I'\<^esup> ?b' ?f' ?x')",
     template_implication
      ([template_implication
         ([template_predicate
            (template_app (template_var 8, template_var 7))],
          template_predicate
           (
              template_app
               (template_app
                 (template_hole 8,
                  template_app
                   (template_app (template_hole 7, template_var 6),
                    template_var 7)),
                template_var 5)
              )),
        template_predicate (template_app (template_hole 6, t_empty)),
        template_predicate (template_app (template_hole 6, t_empty)),
        template_predicate (template_app (template_hole 6, t_empty))],
       template_inequation
        (less_equals,
         template_app
          (template_app
            (template_app
              (template_app (template_hole 1, template_var 4),
               template_var 3),
             template_var 1),
           template_var 6),
         template_app
          (template_app (template_hole 2, template_var 5),
           template_app
            (template_app
              (template_app
                (template_app (template_hole 0, template_var 8),
                 template_var 2),
               template_var 0),
             template_var 7))))),
    ("Refine_While.WHILET_refine_genR'",
     "[| ?I' ?x' ==> (?x, ?x') : ?R';
         !!x x'. [| (x, x') : ?R'; ?I' x' |] ==> ?b x = ?b' x';
         !!x x'.
            [| (x, x') : ?R'; ?b x; ?b' x'; ?I' x' |]
            ==> ?f x <= \<Down> ?R' (?f' x');
         !!x x'.
            [| (x, x') : ?R'; ~ ?b x; ~ ?b' x'; ?I' x' |]
            ==> (x, x') : ?R |]
      ==> WHILE\<^sub>T ?b ?f ?x
          <= \<Down> ?R (WHILE\<^sub>T\<^bsup>?I'\<^esup> ?b' ?f' ?x')",
     template_implication
      ([template_implication
         ([template_predicate
            (template_app (template_var 8, template_var 7))],
          template_predicate
           (
              template_app
               (template_app
                 (template_hole 9,
                  template_app
                   (template_app (template_hole 8, template_var 6),
                    template_var 7)),
                template_var 5)
              )),
        template_predicate (template_app (template_hole 7, t_empty)),
        template_predicate (template_app (template_hole 7, t_empty)),
        template_predicate (template_app (template_hole 7, t_empty))],
       template_inequation
        (less_equals,
         template_app
          (template_app
            (template_app (template_hole 1, template_var 4),
             template_var 2),
           template_var 6),
         template_app
          (template_app (template_hole 3, template_var 0),
           template_app
            (template_app
              (template_app
                (template_app (template_hole 0, template_var 8),
                 template_var 3),
               template_var 1),
             template_var 7))))),
    ("Refine_While.rwof_refine",
     "[| rwof ?m ?c ?f ?s; nofail (?m' >>= WHILE ?c' ?f');
         ?m \<le>\<^sub>n \<Down> ?R ?m';
         !!s s'.
            [| (s, s') : ?R; rwof ?m ?c ?f s; rwof ?m' ?c' ?f' s' |]
            ==> ?c s = ?c' s';
         !!s s'.
            [| (s, s') : ?R; rwof ?m ?c ?f s; rwof ?m' ?c' ?f' s'; ?c s;
               ?c' s' |]
            ==> ?f s \<le>\<^sub>n \<Down> ?R (?f' s') |]
      ==> EX s'. (?s, s') : ?R & rwof ?m' ?c' ?f' s'",
     template_implication
      ([template_predicate
         (
            template_app
             (template_app
               (template_app
                 (template_app (template_hole 13, template_var 7),
                  template_var 6),
                template_var 5),
              template_var 4)
            ),
        template_predicate
         (
            template_app
             (template_hole 12,
              template_app
               (template_app (template_hole 11, template_var 3),
                template_app
                 (template_app (template_hole 10, template_var 2),
                  template_var 1)))
            ),
        template_predicate
         (
            template_app
             (template_app (template_hole 9, template_var 7),
              template_app
               (template_app (template_hole 8, template_var 0),
                template_var 3))
            ),
        template_predicate (template_app (template_hole 7, t_empty)),
        template_predicate (template_app (template_hole 7, t_empty))],
       template_predicate (template_app (template_hole 1, t_empty)))),
    ("Refine_While.WHILEI_invisible_refine",
     "[| ?I' ?s' ==> (?s, ?s') : ?R;
         !!s s'. [| (s, s') : ?R; ?I' s' |] ==> ?I s;
         !!s s'. [| (s, s') : ?R; ?I' s'; ?I s; ?b' s' |] ==> ?b s;
         !!s s'.
            [| (s, s') : ?R; ?I' s'; ?I s; ?b s |]
            ==> ?f s
                <= sup (\<Down> ?R (ASSUME (?b' s') >>= (%_. ?f' s')))
                    (\<Down> ?R (RETURN s')) |]
      ==> WHILE\<^bsup>?I\<^esup> ?b ?f ?s
          <= \<Down> ?R (WHILE\<^bsup>?I'\<^esup> ?b' ?f' ?s')",
     template_implication
      ([template_implication
         ([template_predicate
            (template_app (template_var 8, template_var 7))],
          template_predicate
           (
              template_app
               (template_app
                 (template_hole 11,
                  template_app
                   (template_app (template_hole 10, template_var 6),
                    template_var 7)),
                template_var 5)
              )),
        template_predicate (template_app (template_hole 9, t_empty)),
        template_predicate (template_app (template_hole 9, t_empty)),
        template_predicate (template_app (template_hole 9, t_empty))],
       template_inequation
        (less_equals,
         template_app
          (template_app
            (template_app
              (template_app (template_hole 1, template_var 4),
               template_var 2),
             template_var 1),
           template_var 6),
         template_app
          (template_app (template_hole 5, template_var 5),
           template_app
            (template_app
              (template_app
                (template_app (template_hole 0, template_var 8),
                 template_var 3),
               template_var 0),
             template_var 7))))),
    ("Refine_While.autoref_WHILEI",
     "[| !!x x'. [| ?I x'; (x, x') : ?R |] ==> (?c x, ?c' $ x') : bool_rel;
         !!x x'.
            [| REMOVE_INTERNAL ?c' x'; ?I x'; (x, x') : ?R |]
            ==> (?f x, ?f' $ x') : \<langle>?R\<rangle>nres_rel;
         ?I ?s' ==> (?s, ?s') : ?R |]
      ==> (WHILE ?c ?f ?s,
           (Autoref_Tagging.OP WHILE\<^bsup>?I\<^esup> :::
            (?R \<rightarrow> bool_rel) \<rightarrow>
            (?R \<rightarrow> \<langle>?R\<rangle>nres_rel) \<rightarrow>
            ?R \<rightarrow> \<langle>?R\<rangle>nres_rel) $
           ?c' $
           ?f' $
           ?s')
          : \<langle>?R\<rangle>nres_rel",
     template_implication
      ([template_predicate (template_app (template_hole 33, t_empty)),
        template_predicate (template_app (template_hole 33, t_empty)),
        template_implication
         ([template_predicate
            (template_app (template_var 7, template_var 1))],
          template_predicate
           (
              template_app
               (template_app
                 (template_hole 30,
                  template_app
                   (template_app (template_hole 29, template_var 0),
                    template_var 1)),
                template_var 6)
              ))],
       template_predicate
        (
           template_app
            (template_app
              (template_hole 23,
               template_app
                (template_app
                  (template_hole 22,
                   template_app
                    (template_app
                      (template_app (template_hole 18, template_var 5),
                       template_var 3),
                     template_var 0)),
                 template_app
                  (template_app
                    (template_hole 21,
                     template_app
                      (template_app
                        (template_hole 17,
                         template_app
                          (template_app
                            (template_hole 16,
                             template_app
                              (template_app
                                (template_hole 15,
                                 template_app
                                  (template_hole 14,
                                   template_app
                                    (template_hole 13, template_var 7))),
                               template_app
                                (template_hole 12,
                                 template_app
                                  (template_app
                                    (template_hole 11,
                                     template_app
(template_app (template_hole 10, template_hole 9),
 template_app
  (template_app
    (template_hole 8,
     template_app
      (template_app (template_hole 7, template_hole 6), template_var 6)),
   template_hole 25))),
                                   template_app
                                    (template_app
(template_hole 5,
 template_app
  (template_app (template_hole 4, template_hole 3),
   template_app
    (template_app
      (template_hole 2,
       template_app
        (template_app (template_hole 1, template_hole 0), template_var 6)),
     template_app
      (template_app (template_hole 20, template_hole 19),
       template_var 6)))),
                                     template_app
(template_app
  (template_hole 2,
   template_app
    (template_app (template_hole 1, template_hole 0), template_var 6)),
 template_app
  (template_app (template_hole 20, template_hole 19), template_var 6))))))),
                           template_var 4)),
                       template_var 2)),
                   template_var 1))),
             template_app
              (template_app (template_hole 20, template_hole 19),
               template_var 6))
           ))),
    ("Refine_While.autoref_WHILEIT",
     "[| !!x x'. [| ?I x'; (x, x') : ?R |] ==> (?c x, ?c' $ x') : bool_rel;
         !!x x'.
            [| REMOVE_INTERNAL ?c' x'; ?I x'; (x, x') : ?R |]
            ==> (?f x, ?f' $ x') : \<langle>?R\<rangle>nres_rel;
         ?I ?s' ==> (?s, ?s') : ?R |]
      ==> (WHILE\<^sub>T ?c ?f ?s,
           (Autoref_Tagging.OP WHILE\<^sub>T\<^bsup>?I\<^esup> :::
            (?R \<rightarrow> bool_rel) \<rightarrow>
            (?R \<rightarrow> \<langle>?R\<rangle>nres_rel) \<rightarrow>
            ?R \<rightarrow> \<langle>?R\<rangle>nres_rel) $
           ?c' $
           ?f' $
           ?s')
          : \<langle>?R\<rangle>nres_rel",
     template_implication
      ([template_predicate (template_app (template_hole 33, t_empty)),
        template_predicate (template_app (template_hole 33, t_empty)),
        template_implication
         ([template_predicate
            (template_app (template_var 7, template_var 1))],
          template_predicate
           (
              template_app
               (template_app
                 (template_hole 30,
                  template_app
                   (template_app (template_hole 29, template_var 0),
                    template_var 1)),
                template_var 6)
              ))],
       template_predicate
        (
           template_app
            (template_app
              (template_hole 23,
               template_app
                (template_app
                  (template_hole 22,
                   template_app
                    (template_app
                      (template_app (template_hole 18, template_var 5),
                       template_var 3),
                     template_var 0)),
                 template_app
                  (template_app
                    (template_hole 21,
                     template_app
                      (template_app
                        (template_hole 17,
                         template_app
                          (template_app
                            (template_hole 16,
                             template_app
                              (template_app
                                (template_hole 15,
                                 template_app
                                  (template_hole 14,
                                   template_app
                                    (template_hole 13, template_var 7))),
                               template_app
                                (template_hole 12,
                                 template_app
                                  (template_app
                                    (template_hole 11,
                                     template_app
(template_app (template_hole 10, template_hole 9),
 template_app
  (template_app
    (template_hole 8,
     template_app
      (template_app (template_hole 7, template_hole 6), template_var 6)),
   template_hole 25))),
                                   template_app
                                    (template_app
(template_hole 5,
 template_app
  (template_app (template_hole 4, template_hole 3),
   template_app
    (template_app
      (template_hole 2,
       template_app
        (template_app (template_hole 1, template_hole 0), template_var 6)),
     template_app
      (template_app (template_hole 20, template_hole 19),
       template_var 6)))),
                                     template_app
(template_app
  (template_hole 2,
   template_app
    (template_app (template_hole 1, template_hole 0), template_var 6)),
 template_app
  (template_app (template_hole 20, template_hole 19), template_var 6))))))),
                           template_var 4)),
                       template_var 2)),
                   template_var 1))),
             template_app
              (template_app (template_hole 20, template_hole 19),
               template_var 6))
           ))),
    ("Refine_While.WHILEIT_refine_new_invar",
     "[| ?I' ?x' ==> (?x, ?x') : ?R;
         [| ?I' ?x'; (?x, ?x') : ?R |] ==> ?I ?x;
         !!x x'. [| (x, x') : ?R; ?I x; ?I' x' |] ==> ?b x = ?b' x';
         !!x x'.
            [| (x, x') : ?R; ?b x; ?b' x'; ?I x; ?I' x' |]
            ==> ?f x <= \<Down> ?R (?f' x');
         !!x x'.
            [| nofail (?f x); (x, x') : ?R; ?b x; ?b' x'; ?I x; ?I' x' |]
            ==> ?f x <= SPEC ?I |]
      ==> WHILE\<^sub>T\<^bsup>?I\<^esup> ?b ?f ?x
          <= \<Down> ?R (WHILE\<^sub>T\<^bsup>?I'\<^esup> ?b' ?f' ?x')",
     template_implication
      ([template_implication
         ([template_predicate
            (template_app (template_var 8, template_var 7))],
          template_predicate
           (
              template_app
               (template_app
                 (template_hole 11,
                  template_app
                   (template_app (template_hole 10, template_var 6),
                    template_var 7)),
                template_var 5)
              )),
        template_implication
         ([template_predicate
            (template_app (template_var 8, template_var 7))],
          template_implication
           ([template_predicate
              (
                 template_app
                  (template_app
                    (template_hole 11,
                     template_app
                      (template_app (template_hole 10, template_var 6),
                       template_var 7)),
                   template_var 5)
                 )],
            template_predicate
             (template_app (template_var 4, template_var 6)))),
        template_predicate (template_app (template_hole 9, t_empty)),
        template_predicate (template_app (template_hole 9, t_empty)),
        template_predicate (template_app (template_hole 9, t_empty))],
       template_inequation
        (less_equals,
         template_app
          (template_app
            (template_app
              (template_app (template_hole 1, template_var 4),
               template_var 3),
             template_var 1),
           template_var 6),
         template_app
          (template_app (template_hole 5, template_var 5),
           template_app
            (template_app
              (template_app
                (template_app (template_hole 0, template_var 8),
                 template_var 2),
               template_var 0),
             template_var 7))))),
    ("Refine_While.WHILEI_refine_new_invar",
     "[| ?I' ?x' ==> (?x, ?x') : ?R;
         [| ?I' ?x'; (?x, ?x') : ?R |] ==> ?I ?x;
         !!x x'. [| (x, x') : ?R; ?I x; ?I' x' |] ==> ?b x = ?b' x';
         !!x x'.
            [| (x, x') : ?R; ?b x; ?b' x'; ?I x; ?I' x' |]
            ==> ?f x <= \<Down> ?R (?f' x');
         !!x x'.
            [| (x, x') : ?R; ?b x; ?b' x'; ?I x; ?I' x'; nofail (?f x) |]
            ==> ?f x <= SPEC ?I |]
      ==> WHILE\<^bsup>?I\<^esup> ?b ?f ?x
          <= \<Down> ?R (WHILE\<^bsup>?I'\<^esup> ?b' ?f' ?x')",
     template_implication
      ([template_implication
         ([template_predicate
            (template_app (template_var 8, template_var 7))],
          template_predicate
           (
              template_app
               (template_app
                 (template_hole 11,
                  template_app
                   (template_app (template_hole 10, template_var 6),
                    template_var 7)),
                template_var 5)
              )),
        template_implication
         ([template_predicate
            (template_app (template_var 8, template_var 7))],
          template_implication
           ([template_predicate
              (
                 template_app
                  (template_app
                    (template_hole 11,
                     template_app
                      (template_app (template_hole 10, template_var 6),
                       template_var 7)),
                   template_var 5)
                 )],
            template_predicate
             (template_app (template_var 4, template_var 6)))),
        template_predicate (template_app (template_hole 9, t_empty)),
        template_predicate (template_app (template_hole 9, t_empty)),
        template_predicate (template_app (template_hole 9, t_empty))],
       template_inequation
        (less_equals,
         template_app
          (template_app
            (template_app
              (template_app (template_hole 1, template_var 4),
               template_var 3),
             template_var 1),
           template_var 6),
         template_app
          (template_app (template_hole 5, template_var 5),
           template_app
            (template_app
              (template_app
                (template_app (template_hole 0, template_var 8),
                 template_var 2),
               template_var 0),
             template_var 7))))),
    ("Refine_While.WHILEI_refine_genR",
     "[| ?I' ?x' ==> (?x, ?x') : ?R';
         !!x x'. [| (x, x') : ?R'; ?I' x' |] ==> ?I x;
         !!x x'. [| (x, x') : ?R'; ?I x; ?I' x' |] ==> ?b x = ?b' x';
         !!x x'.
            [| (x, x') : ?R'; ?b x; ?b' x'; ?I x; ?I' x' |]
            ==> ?f x <= \<Down> ?R' (?f' x');
         !!x x'.
            [| (x, x') : ?R'; ~ ?b x; ~ ?b' x'; ?I x; ?I' x' |]
            ==> (x, x') : ?R |]
      ==> WHILE\<^bsup>?I\<^esup> ?b ?f ?x
          <= \<Down> ?R (WHILE\<^bsup>?I'\<^esup> ?b' ?f' ?x')",
     template_implication
      ([template_implication
         ([template_predicate
            (template_app (template_var 9, template_var 8))],
          template_predicate
           (
              template_app
               (template_app
                 (template_hole 9,
                  template_app
                   (template_app (template_hole 8, template_var 7),
                    template_var 8)),
                template_var 6)
              )),
        template_predicate (template_app (template_hole 7, t_empty)),
        template_predicate (template_app (template_hole 7, t_empty)),
        template_predicate (template_app (template_hole 7, t_empty)),
        template_predicate (template_app (template_hole 7, t_empty))],
       template_inequation
        (less_equals,
         template_app
          (template_app
            (template_app
              (template_app (template_hole 1, template_var 5),
               template_var 4),
             template_var 2),
           template_var 7),
         template_app
          (template_app (template_hole 3, template_var 0),
           template_app
            (template_app
              (template_app
                (template_app (template_hole 0, template_var 9),
                 template_var 3),
               template_var 1),
             template_var 8))))),
    ("Refine_While.WHILEIT_refine_genR",
     "[| ?I' ?x' ==> (?x, ?x') : ?R';
         !!x x'. [| (x, x') : ?R'; ?I' x' |] ==> ?I x;
         !!x x'. [| (x, x') : ?R'; ?I x; ?I' x' |] ==> ?b x = ?b' x';
         !!x x'.
            [| (x, x') : ?R'; ?b x; ?b' x'; ?I x; ?I' x' |]
            ==> ?f x <= \<Down> ?R' (?f' x');
         !!x x'.
            [| (x, x') : ?R'; ~ ?b x; ~ ?b' x'; ?I x; ?I' x' |]
            ==> (x, x') : ?R |]
      ==> WHILE\<^sub>T\<^bsup>?I\<^esup> ?b ?f ?x
          <= \<Down> ?R (WHILE\<^sub>T\<^bsup>?I'\<^esup> ?b' ?f' ?x')",
     template_implication
      ([template_implication
         ([template_predicate
            (template_app (template_var 9, template_var 8))],
          template_predicate
           (
              template_app
               (template_app
                 (template_hole 9,
                  template_app
                   (template_app (template_hole 8, template_var 7),
                    template_var 8)),
                template_var 6)
              )),
        template_predicate (template_app (template_hole 7, t_empty)),
        template_predicate (template_app (template_hole 7, t_empty)),
        template_predicate (template_app (template_hole 7, t_empty)),
        template_predicate (template_app (template_hole 7, t_empty))],
       template_inequation
        (less_equals,
         template_app
          (template_app
            (template_app
              (template_app (template_hole 1, template_var 5),
               template_var 4),
             template_var 2),
           template_var 7),
         template_app
          (template_app (template_hole 3, template_var 0),
           template_app
            (template_app
              (template_app
                (template_app (template_hole 0, template_var 9),
                 template_var 3),
               template_var 1),
             template_var 8))))),
    ("Refine_While.WHILEI_invisible_refine_genR",
     "[| ?I' ?s' ==> (?s, ?s') : ?R';
         !!s s'. [| (s, s') : ?R'; ?I' s' |] ==> ?I s;
         !!s s'. [| (s, s') : ?R'; ?I' s'; ?I s; ?b' s' |] ==> ?b s;
         !!s s'.
            [| (s, s') : ?R'; ?I' s'; ?I s; ?b s |]
            ==> ?f s
                <= sup (\<Down> ?R' (ASSUME (?b' s') >>= (%_. ?f' s')))
                    (\<Down> ?R' (RETURN s'));
         !!x x'.
            [| (x, x') : ?R'; ~ ?b x; ~ ?b' x'; ?I x; ?I' x' |]
            ==> (x, x') : ?R |]
      ==> WHILE\<^bsup>?I\<^esup> ?b ?f ?s
          <= \<Down> ?R (WHILE\<^bsup>?I'\<^esup> ?b' ?f' ?s')",
     template_implication
      ([template_implication
         ([template_predicate
            (template_app (template_var 9, template_var 8))],
          template_predicate
           (
              template_app
               (template_app
                 (template_hole 12,
                  template_app
                   (template_app (template_hole 11, template_var 7),
                    template_var 8)),
                template_var 6)
              )),
        template_predicate (template_app (template_hole 10, t_empty)),
        template_predicate (template_app (template_hole 10, t_empty)),
        template_predicate (template_app (template_hole 10, t_empty)),
        template_predicate (template_app (template_hole 10, t_empty))],
       template_inequation
        (less_equals,
         template_app
          (template_app
            (template_app
              (template_app (template_hole 1, template_var 5),
               template_var 3),
             template_var 2),
           template_var 7),
         template_app
          (template_app (template_hole 6, template_var 0),
           template_app
            (template_app
              (template_app
                (template_app (template_hole 0, template_var 9),
                 template_var 4),
               template_var 1),
             template_var 8)))))]
