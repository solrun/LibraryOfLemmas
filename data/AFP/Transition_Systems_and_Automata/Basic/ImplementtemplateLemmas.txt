   [("Implement.dflt_ahm_rel_finite_nat",
     "finite_map_rel (\<langle>nat_rel, ?V\<rangle>dflt_ahm_rel)",
     template_predicate
      (
         template_app
          (template_hole 5,
           template_app
            (template_app
              (template_hole 4,
               template_app
                (template_app
                  (template_hole 3,
                   template_app (template_hole 2, template_hole 1)),
                 template_hole 0)),
             template_var 0))
         )),
    ("Implement.list_set_card",
     "(length, card)
      : \<langle>?A\<rangle>list_set_rel \<rightarrow> nat_rel",
     template_predicate
      (
         template_app
          (template_app
            (template_hole 9,
             template_app
              (template_app (template_hole 8, template_hole 7),
               template_hole 6)),
           template_app
            (template_app
              (template_hole 5,
               template_app
                (template_app (template_hole 4, template_hole 3),
                 template_app
                  (template_app (template_hole 2, template_hole 1),
                   template_var 0))),
             template_hole 0))
         )),
    ("Implement.list_set_rel_Id_on",
     "\<langle>Id_on ?A\<rangle>list_set_rel =
      \<langle>Id\<rangle>list_set_rel Int UNIV \<times> Pow ?A",
     template_equation
      (template_app
        (template_app (template_hole 7, template_hole 6),
         template_app (template_hole 5, template_var 0)),
       template_app
        (template_app
          (template_hole 4,
           template_app
            (template_app (template_hole 7, template_hole 6),
             template_hole 3)),
         template_app
          (template_app (template_hole 2, template_hole 1), t_empty)))),
    ("Implement.RETURN_nres_relD",
     "(RETURN ?x, RETURN ?y) : \<langle>?A\<rangle>nres_rel ==>
      (?x, ?y) : ?A",
     template_implication
      ([template_predicate
         (
            template_app
             (template_app
               (template_hole 7,
                template_app
                 (template_app
                   (template_hole 6,
                    template_app (template_hole 5, template_var 2)),
                  template_app (template_hole 4, template_var 1))),
              template_app
               (template_app (template_hole 3, template_hole 2),
                template_var 0))
            )],
       template_predicate
        (
           template_app
            (template_app
              (template_hole 1,
               template_app
                (template_app (template_hole 0, template_var 2),
                 template_var 1)),
             template_var 0)
           ))),
    ("Implement.vcg0",
     "[| (?f, ?g) : \<langle>Id\<rangle>nres_rel; ?g <= ?h |] ==> ?f <= ?h",
     template_implication
      ([template_predicate
         (
            template_app
             (template_app
               (template_hole 5,
                template_app
                 (template_app (template_hole 4, template_var 2),
                  template_var 1)),
              template_app
               (template_app (template_hole 3, template_hole 2),
                template_hole 1))
            ),
        template_inequation (less_equals, template_var 1, template_var 0)],
       template_inequation (less_equals, template_var 2, template_var 0))),
    ("Implement.map2set_to_list",
     "GEN_ALGO_tag (is_map_to_list ?Rk unit_rel ?R ?it) ==>
      is_set_to_list ?Rk (map2set_rel ?R)
       (to_list ((map_iterator_dom \<circ>\<circ>\<circ> (o)) foldli ?it))",
     template_implication
      ([template_predicate
         (
            template_app
             (template_hole 9,
              template_app
               (template_app
                 (template_app
                   (template_app (template_hole 8, template_var 2),
                    template_hole 7),
                  template_var 1),
                template_var 0))
            )],
       template_predicate
        (
           template_app
            (template_app
              (template_app (template_hole 6, template_var 2),
               template_app (template_hole 5, template_var 1)),
             template_app
              (template_hole 4,
               template_app
                (template_app (template_hole 3, template_hole 2),
                 template_app
                  (template_app (template_hole 1, template_hole 0),
                   template_var 0))))
           ))),
    ("Implement.vcg1",
     "[| (?f, ?g) : Id \<rightarrow> \<langle>Id\<rangle>nres_rel;
         ?g ?x <= ?h ?x |]
      ==> ?f ?x <= ?h ?x",
     template_implication
      ([template_predicate
         (
            template_app
             (template_app
               (template_hole 9,
                template_app
                 (template_app (template_hole 8, template_var 3),
                  template_var 2)),
              template_app
               (template_app
                 (template_hole 7,
                  template_app
                   (template_app (template_hole 6, template_hole 5),
                    template_hole 4)),
                template_app
                 (template_app (template_hole 3, template_hole 2),
                  template_hole 1)))
            ),
        template_inequation
         (less_equals, template_app (template_var 2, template_var 1),
          template_app (template_var 0, template_var 1))],
       template_inequation
        (less_equals, template_app (template_var 3, template_var 1),
         template_app (template_var 0, template_var 1)))),
    ("Implement.gen_enumerate_it_to_list",
     "gen_enumerate (it_to_list ?it) =
      (%upd emp S.
          snd (foldli (it_to_list ?it S) (%_. True)
                (%x s. case s of (k, m) => (Suc k, upd x k m)) (0, emp)))",
     template_equation
      (template_app
        (template_hole 8, template_app (template_hole 7, template_var 0)),
       t_empty)),
    ("Implement.CAST_to_list",
     "[| PRIO_TAG_GEN_ALGO; SIDE_GEN_ALGO (is_set_to_list ?A ?Rs ?tol) |]
      ==> (?tol, CAST)
          : \<langle>?A\<rangle>?Rs \<rightarrow>
            \<langle>?A\<rangle>list_set_rel",
     template_implication
      ([template_predicate
         (
            template_app
             (template_app (template_hole 18, template_hole 17),
              template_app
               (template_hole 16,
                template_app
                 (template_hole 15,
                  template_app
                   (template_hole 14,
                    template_app
                     (template_hole 13,
                      template_app (template_hole 14, template_hole 12))))))
            ),
        template_predicate
         (
            template_app
             (template_hole 11,
              template_app
               (template_hole 10,
                template_app
                 (template_app
                   (template_app (template_hole 9, template_var 2),
                    template_var 1),
                  template_var 0)))
            )],
       template_predicate
        (
           template_app
            (template_app
              (template_hole 8,
               template_app
                (template_app (template_hole 7, template_var 0),
                 template_hole 6)),
             template_app
              (template_app
                (template_hole 5,
                 template_app
                  (template_app (template_hole 4, template_hole 3),
                   template_app
                    (template_app (template_hole 2, template_var 1),
                     template_var 2))),
               template_app
                (template_app (template_hole 1, template_hole 0),
                 template_var 2)))
           ))),
    ("Implement.vcg2",
     "[| (?f, ?g)
         : Id \<rightarrow> Id \<rightarrow> \<langle>Id\<rangle>nres_rel;
         ?g ?x ?y <= ?h ?x ?y |]
      ==> ?f ?x ?y <= ?h ?x ?y",
     template_implication
      ([template_predicate
         (
            template_app
             (template_app
               (template_hole 13,
                template_app
                 (template_app (template_hole 12, template_var 4),
                  template_var 3)),
              template_app
               (template_app
                 (template_hole 11,
                  template_app
                   (template_app (template_hole 10, template_hole 9),
                    template_hole 8)),
                template_app
                 (template_app
                   (template_hole 7,
                    template_app
                     (template_app (template_hole 6, template_hole 5),
                      template_hole 4)),
                  template_app
                   (template_app (template_hole 3, template_hole 2),
                    template_hole 1))))
            ),
        template_inequation
         (less_equals,
          template_app
           (template_app (template_var 3, template_var 2), template_var 1),
          template_app
           (template_app (template_var 0, template_var 2),
            template_var 1))],
       template_inequation
        (less_equals,
         template_app
          (template_app (template_var 4, template_var 2), template_var 1),
         template_app
          (template_app (template_var 0, template_var 2),
           template_var 1)))),
    ("Implement.list_set_insert",
     "[| ?y ~: ?Y; (?x, ?y) : ?A;
         (?xs, ?Y) : \<langle>?A\<rangle>list_set_rel |]
      ==> (?x # ?xs, insert ?y ?Y) : \<langle>?A\<rangle>list_set_rel",
     template_implication
      ([template_negation
         (
            template_predicate
             (
                template_app
                 (template_app (template_hole 8, template_var 4),
                  template_var 3)
                )
            ),
        template_predicate
         (
            template_app
             (template_app
               (template_hole 7,
                template_app
                 (template_app (template_hole 6, template_var 2),
                  template_var 4)),
              template_var 1)
            ),
        template_predicate
         (
            template_app
             (template_app
               (template_hole 5,
                template_app
                 (template_app (template_hole 4, template_var 0),
                  template_var 3)),
              template_app
               (template_app (template_hole 3, template_hole 2),
                template_var 1))
            )],
       template_predicate
        (
           template_app
            (template_app
              (template_hole 5,
               template_app
                (template_app
                  (template_hole 4,
                   template_app
                    (template_app (template_hole 1, template_var 2),
                     template_var 0)),
                 template_app
                  (template_app (template_hole 0, template_var 4),
                   template_var 3))),
             template_app
              (template_app (template_hole 3, template_hole 2),
               template_var 1))
           ))),
    ("Implement.FOREACH_rule_map_map",
     "(FOREACH (map_to_set ?m) (%(k, v). ?F k (?f k v)),
       FOREACH (map_to_set (%k. map_option (?f k) (?m k)))
        (%(k, v). ?F k v))
      : Id \<rightarrow> \<langle>Id\<rangle>nres_rel",
     template_predicate
      (
         template_app
          (template_app
            (template_hole 14,
             template_app
              (template_app
                (template_hole 13,
                 template_app
                  (template_app
                    (template_hole 12,
                     template_app (template_hole 11, template_var 2)),
                   template_app (template_hole 10, t_empty))),
               template_app
                (template_app
                  (template_hole 9,
                   template_app (template_hole 8, t_empty)),
                 template_app (template_hole 6, t_empty)))),
           template_app
            (template_app
              (template_hole 5,
               template_app
                (template_app (template_hole 4, template_hole 3),
                 template_hole 2)),
             template_app
              (template_app (template_hole 1, template_hole 0),
               template_hole 2)))
         )),
    ("Implement.list_set_image",
     "[| inj_on ?g ?S; (?f, ?g) : ?A \<rightarrow> ?B;
         (?xs, ?S) : \<langle>?A\<rangle>list_set_rel |]
      ==> (map ?f ?xs, ?g ` ?S) : \<langle>?B\<rangle>list_set_rel",
     template_implication
      ([template_predicate
         (
            template_app
             (template_app (template_hole 15, template_var 5),
              template_var 4)
            ),
        template_predicate
         (
            template_app
             (template_app
               (template_hole 14,
                template_app
                 (template_app (template_hole 13, template_var 3),
                  template_var 5)),
              template_app
               (template_app
                 (template_hole 12,
                  template_app
                   (template_app (template_hole 11, template_hole 10),
                    template_var 2)),
                template_var 1))
            ),
        template_predicate
         (
            template_app
             (template_app
               (template_hole 9,
                template_app
                 (template_app (template_hole 8, template_var 0),
                  template_var 4)),
              template_app
               (template_app (template_hole 7, template_hole 6),
                template_var 2))
            )],
       template_predicate
        (
           template_app
            (template_app
              (template_hole 5,
               template_app
                (template_app
                  (template_hole 4,
                   template_app
                    (template_app (template_hole 3, template_var 3),
                     template_var 0)),
                 template_app
                  (template_app (template_hole 2, template_var 5),
                   template_var 4))),
             template_app
              (template_app (template_hole 1, template_hole 0),
               template_var 1))
           ))),
    ("Implement.list_set_union",
     "[| ?X Int ?Y = {}; (?xs, ?X) : \<langle>?A\<rangle>list_set_rel;
         (?ys, ?Y) : \<langle>?A\<rangle>list_set_rel |]
      ==> (?xs @ ?ys, ?X Un ?Y) : \<langle>?A\<rangle>list_set_rel",
     template_implication
      ([template_equation
         (template_app
           (template_app (template_hole 7, template_var 4), template_var 3),
          template_hole 6),
        template_predicate
         (
            template_app
             (template_app
               (template_hole 5,
                template_app
                 (template_app (template_hole 4, template_var 2),
                  template_var 4)),
              template_app
               (template_app (template_hole 3, template_hole 2),
                template_var 1))
            ),
        template_predicate
         (
            template_app
             (template_app
               (template_hole 5,
                template_app
                 (template_app (template_hole 4, template_var 0),
                  template_var 3)),
              template_app
               (template_app (template_hole 3, template_hole 2),
                template_var 1))
            )],
       template_predicate
        (
           template_app
            (template_app
              (template_hole 5,
               template_app
                (template_app
                  (template_hole 4,
                   template_app
                    (template_app (template_hole 1, template_var 2),
                     template_var 0)),
                 template_app
                  (template_app (template_hole 0, template_var 4),
                   template_var 3))),
             template_app
              (template_app (template_hole 3, template_hole 2),
               template_var 1))
           ))),
    ("Implement.list_set_Union",
     "[| !!X Y. [| X : ?S; Y : ?S; X ~= Y |] ==> X Int Y = {};
         (?xs, ?S)
         : \<langle>\<langle>?A\<rangle>list_set_rel\<rangle>list_set_rel |]
      ==> (concat ?xs, \<Union> ?S) : \<langle>?A\<rangle>list_set_rel",
     template_implication
      ([template_predicate (template_app (template_hole 16, t_empty)),
        template_predicate
         (
            template_app
             (template_app
               (template_hole 9,
                template_app
                 (template_app (template_hole 8, template_var 1),
                  template_var 2)),
              template_app
               (template_app (template_hole 7, template_hole 6),
                template_app
                 (template_app (template_hole 5, template_hole 4),
                  template_var 0)))
            )],
       template_predicate
        (
           template_app
            (template_app
              (template_hole 3,
               template_app
                (template_app
                  (template_hole 2,
                   template_app (template_hole 1, template_var 1)),
                 template_app (template_hole 0, template_var 2))),
             template_app
              (template_app (template_hole 5, template_hole 4),
               template_var 0))
           ))),
    ("Implement.FOREACH_rule_insert_eq",
     "[| finite ?S; ?X {} = ?s; ?X ?S = ?t;
         !!T x.
            [| T <= ?S; x : ?S; x ~: T |]
            ==> ?f x (?X T) <= SPEC ((=) (?X (insert x T))) |]
      ==> FOREACH ?S ?f ?s <= SPEC ((=) ?t)",
     template_implication
      ([template_predicate
         (template_app (template_hole 12, template_var 4)),
        template_equation
         (template_app (template_var 3, template_hole 10), template_var 2),
        template_equation
         (template_app (template_var 3, template_var 4), template_var 1),
        template_predicate (template_app (template_hole 9, t_empty))],
       template_inequation
        (less_equals,
         template_app
          (template_app
            (template_app (template_hole 0, template_var 4),
             template_var 0),
           template_var 2),
         template_app
          (template_hole 3,
           template_app
            (template_hole 2,
             template_app (template_hole 11, template_var 1)))))),
    ("Implement.list_set_bind",
     "[| !!x y. [| x : ?S; y : ?S; x ~= y |] ==> ?g x Int ?g y = {};
         (?xs, ?S) : \<langle>?A\<rangle>list_set_rel;
         (?f, ?g) : ?A \<rightarrow> \<langle>?B\<rangle>list_set_rel |]
      ==> (?xs >>= ?f, ?S >>= ?g) : \<langle>?B\<rangle>list_set_rel",
     template_implication
      ([template_predicate (template_app (template_hole 22, t_empty)),
        template_predicate
         (
            template_app
             (template_app
               (template_hole 14,
                template_app
                 (template_app (template_hole 13, template_var 3),
                  template_var 5)),
              template_app
               (template_app (template_hole 12, template_hole 11),
                template_var 2))
            ),
        template_predicate
         (
            template_app
             (template_app
               (template_hole 10,
                template_app
                 (template_app (template_hole 9, template_var 1),
                  template_var 4)),
              template_app
               (template_app
                 (template_hole 8,
                  template_app
                   (template_app (template_hole 7, template_hole 6),
                    template_var 2)),
                template_app
                 (template_app (template_hole 5, template_hole 4),
                  template_var 0)))
            )],
       template_predicate
        (
           template_app
            (template_app
              (template_hole 3,
               template_app
                (template_app
                  (template_hole 2,
                   template_app
                    (template_app (template_hole 1, template_var 3),
                     template_var 1)),
                 template_app
                  (template_app (template_hole 0, template_var 5),
                   template_var 4))),
             template_app
              (template_app (template_hole 5, template_hole 4),
               template_var 0))
           ))),
    ("Implement.FOREACH_rule_insert",
     "[| finite ?S; ?I {} ?s; !!s. ?I ?S s ==> ?P s;
         !!T x s.
            [| T <= ?S; ?I T s; x : ?S; x ~: T |]
            ==> ?f x s <= SPEC (?I (insert x T)) |]
      ==> FOREACH ?S ?f ?s <= SPEC ?P",
     template_implication
      ([template_predicate
         (template_app (template_hole 12, template_var 4)),
        template_predicate
         (
            template_app
             (template_app (template_var 3, template_hole 11),
              template_var 2)
            ),
        template_predicate (template_app (template_hole 10, t_empty)),
        template_predicate (template_app (template_hole 9, t_empty))],
       template_inequation
        (less_equals,
         template_app
          (template_app
            (template_app (template_hole 0, template_var 4),
             template_var 0),
           template_var 2),
         template_app
          (template_hole 3,
           template_app (template_hole 2, template_var 1))))),
    ("Implement.list_set_union_autoref",
     "[| PRIO_TAG_OPTIMIZATION; SIDE_PRECOND_OPT (?a' Int ?b' = {});
         (?a, ?a') : \<langle>?R\<rangle>list_set_rel;
         (?b, ?b') : \<langle>?R\<rangle>list_set_rel |]
      ==> (?a @ ?b,
           (Autoref_Tagging.OP (Un) :::
            \<langle>?R\<rangle>list_set_rel \<rightarrow>
            \<langle>?R\<rangle>list_set_rel \<rightarrow>
            \<langle>?R\<rangle>list_set_rel) $
           ?a' $
           ?b')
          : \<langle>?R\<rangle>list_set_rel",
     template_implication
      ([template_predicate
         (
            template_app
             (template_app (template_hole 28, template_hole 27),
              template_app
               (template_hole 26,
                template_app
                 (template_hole 25,
                  template_app
                   (template_hole 24,
                    template_app (template_hole 25, template_hole 23)))))
            ),
        template_predicate
         (
            template_app
             (template_hole 22,
              template_app
               (template_hole 21,
                template_app
                 (template_hole 20,
                  template_app
                   (template_app
                     (template_hole 19,
                      template_app
                       (template_app (template_hole 18, template_var 4),
                        template_var 3)),
                    template_hole 17))))
            ),
        template_predicate
         (
            template_app
             (template_app
               (template_hole 16,
                template_app
                 (template_app (template_hole 15, template_var 2),
                  template_var 4)),
              template_app
               (template_app (template_hole 14, template_hole 13),
                template_var 1))
            ),
        template_predicate
         (
            template_app
             (template_app
               (template_hole 16,
                template_app
                 (template_app (template_hole 15, template_var 0),
                  template_var 3)),
              template_app
               (template_app (template_hole 14, template_hole 13),
                template_var 1))
            )],
       template_predicate
        (
           template_app
            (template_app
              (template_hole 16,
               template_app
                (template_app
                  (template_hole 15,
                   template_app
                    (template_app (template_hole 12, template_var 2),
                     template_var 0)),
                 template_app
                  (template_app
                    (template_hole 11,
                     template_app
                      (template_app
                        (template_hole 10,
                         template_app
                          (template_app
                            (template_hole 9,
                             template_app
                              (template_hole 8, template_hole 7)),
                           template_app
                            (template_hole 6,
                             template_app
                              (template_app
                                (template_hole 5,
                                 template_app
                                  (template_app
                                    (template_hole 4, template_hole 3),
                                   template_app
                                    (template_app
(template_hole 14, template_hole 13),
                                     template_var 1))),
                               template_app
                                (template_app
                                  (template_hole 2,
                                   template_app
                                    (template_app
(template_hole 1, template_hole 0),
                                     template_app
(template_app (template_hole 14, template_hole 13), template_var 1))),
                                 template_app
                                  (template_app
                                    (template_hole 14, template_hole 13),
                                   template_var 1)))))),
                       template_var 4)),
                   template_var 3))),
             template_app
              (template_app (template_hole 14, template_hole 13),
               template_var 1))
           ))),
    ("Implement.FOREACH_rule_map_eq",
     "[| finite (dom ?g); ?X Map.empty = ?s; ?X ?g = ?t;
         !!h k v.
            [| h \<subseteq>\<^sub>m ?g; ?g k = Some v; k ~: dom h |]
            ==> ?f (k, v) (?X h) <= SPEC ((=) (?X (h(k |-> v)))) |]
      ==> FOREACH (map_to_set ?g) ?f ?s <= SPEC ((=) ?t)",
     template_implication
      ([template_predicate
         (
            template_app
             (template_hole 18,
              template_app (template_hole 17, template_var 4))
            ),
        template_equation
         (template_app (template_var 3, t_empty), template_var 2),
        template_equation
         (template_app (template_var 3, template_var 4), template_var 1),
        template_predicate (template_app (template_hole 14, t_empty))],
       template_inequation
        (less_equals,
         template_app
          (template_app
            (template_app
              (template_hole 1,
               template_app (template_hole 0, template_var 4)),
             template_var 0),
           template_var 2),
         template_app
          (template_hole 4,
           template_app
            (template_hole 3,
             template_app (template_hole 16, template_var 1)))))),
    ("Implement.param_foldli",
     "[| (?xs, ?ys) : \<langle>?Ra\<rangle>list_rel;
         (?c, ?d) : ?Rs \<rightarrow> bool_rel;
         !!x y.
            [| (x, y) : ?Ra; x : set ?xs; y : set ?ys |]
            ==> (?f x, ?g y) : ?Rs \<rightarrow> ?Rs;
         (?a, ?b) : ?Rs |]
      ==> (foldli ?xs ?c ?f ?a, foldli ?ys ?d ?g ?b) : ?Rs",
     template_implication
      ([template_predicate
         (
            template_app
             (template_app
               (template_hole 26,
                template_app
                 (template_app (template_hole 25, template_var 9),
                  template_var 8)),
              template_app
               (template_app (template_hole 24, template_hole 23),
                template_var 7))
            ),
        template_predicate
         (
            template_app
             (template_app
               (template_hole 22,
                template_app
                 (template_app (template_hole 21, template_var 6),
                  template_var 5)),
              template_app
               (template_app
                 (template_hole 20,
                  template_app
                   (template_app (template_hole 19, template_hole 18),
                    template_var 4)),
                template_hole 17))
            ),
        template_predicate (template_app (template_hole 16, t_empty)),
        template_predicate
         (
            template_app
             (template_app
               (template_hole 3,
                template_app
                 (template_app (template_hole 2, template_var 1),
                  template_var 0)),
              template_var 4)
            )],
       template_predicate
        (
           template_app
            (template_app
              (template_hole 3,
               template_app
                (template_app
                  (template_hole 2,
                   template_app
                    (template_app
                      (template_app
                        (template_app (template_hole 1, template_var 9),
                         template_var 6),
                       template_var 3),
                     template_var 1)),
                 template_app
                  (template_app
                    (template_app
                      (template_app (template_hole 0, template_var 8),
                       template_var 5),
                     template_var 2),
                   template_var 0))),
             template_var 4)
           ))),
    ("Implement.FOREACH_rule_map",
     "[| finite (dom ?g); ?I Map.empty ?s; !!s. ?I ?g s ==> ?P s;
         !!h k v s.
            [| h \<subseteq>\<^sub>m ?g; ?I h s; ?g k = Some v;
               k ~: dom h |]
            ==> ?f (k, v) s <= SPEC (?I (h(k |-> v))) |]
      ==> FOREACH (map_to_set ?g) ?f ?s <= SPEC ?P",
     template_implication
      ([template_predicate
         (
            template_app
             (template_hole 18,
              template_app (template_hole 17, template_var 4))
            ),
        template_predicate
         (
            template_app
             (template_app (template_var 3, t_empty), template_var 2)
            ),
        template_predicate (template_app (template_hole 15, t_empty)),
        template_predicate (template_app (template_hole 14, t_empty))],
       template_inequation
        (less_equals,
         template_app
          (template_app
            (template_app
              (template_hole 1,
               template_app (template_hole 0, template_var 4)),
             template_var 0),
           template_var 2),
         template_app
          (template_hole 4,
           template_app (template_hole 3, template_var 1))))),
    ("Implement.det_fold_sorted_set",
     "[| det_fold_set ?ordR ?c' ?f' ?\<sigma>' ?result;
         is_set_to_sorted_list ?ordR ?Rk ?Rs ?tsl;
         (?s, ?s') : \<langle>?Rk\<rangle>?Rs;
         (?c, ?c') : ?R\<sigma> \<rightarrow> bool_rel;
         !!x y.
            [| (x, y) : ?Rk; y : ?s' |]
            ==> (?f x, ?f' y) : ?R\<sigma> \<rightarrow> ?R\<sigma>;
         (?\<sigma>, ?\<sigma>') : ?R\<sigma> |]
      ==> (foldli (?tsl ?s) ?c ?f ?\<sigma>, ?result ?s') : ?R\<sigma>",
     template_implication
      ([template_predicate
         (
            template_app
             (template_app
               (template_app
                 (template_app
                   (template_app (template_hole 23, template_var 13),
                    template_var 12),
                  template_var 11),
                template_var 10),
              template_var 9)
            ),
        template_predicate
         (
            template_app
             (template_app
               (template_app
                 (template_app (template_hole 22, template_var 13),
                  template_var 8),
                template_var 7),
              template_var 6)
            ),
        template_predicate
         (
            template_app
             (template_app
               (template_hole 21,
                template_app
                 (template_app (template_hole 20, template_var 5),
                  template_var 4)),
              template_app
               (template_app (template_hole 19, template_var 7),
                template_var 8))
            ),
        template_predicate
         (
            template_app
             (template_app
               (template_hole 18,
                template_app
                 (template_app (template_hole 17, template_var 3),
                  template_var 12)),
              template_app
               (template_app
                 (template_hole 16,
                  template_app
                   (template_app (template_hole 15, template_hole 14),
                    template_var 2)),
                template_hole 13))
            ),
        template_predicate (template_app (template_hole 12, t_empty)),
        template_predicate
         (
            template_app
             (template_app
               (template_hole 2,
                template_app
                 (template_app (template_hole 1, template_var 0),
                  template_var 10)),
              template_var 2)
            )],
       template_predicate
        (
           template_app
            (template_app
              (template_hole 2,
               template_app
                (template_app
                  (template_hole 1,
                   template_app
                    (template_app
                      (template_app
                        (template_app
                          (template_hole 0,
                           template_app (template_var 6, template_var 5)),
                         template_var 3),
                       template_var 1),
                     template_var 0)),
                 template_app (template_var 9, template_var 4))),
             template_var 2)
           ))),
    ("Implement.det_fold_set",
     "[| det_fold_set (%_ _. True) ?c' ?f' ?\<sigma>' ?result;
         is_set_to_list ?Rk ?Rs ?tsl; (?s, ?s') : \<langle>?Rk\<rangle>?Rs;
         (?c, ?c') : ?R\<sigma> \<rightarrow> bool_rel;
         !!x y.
            [| (x, y) : ?Rk; y : ?s' |]
            ==> (?f x, ?f' y) : ?R\<sigma> \<rightarrow> ?R\<sigma>;
         (?\<sigma>, ?\<sigma>') : ?R\<sigma> |]
      ==> (foldli (?tsl ?s) ?c ?f ?\<sigma>, ?result ?s') : ?R\<sigma>",
     template_implication
      ([template_predicate
         (
            template_app
             (template_app
               (template_app
                 (template_app
                   (template_app (template_hole 24, t_empty),
                    template_var 12),
                  template_var 11),
                template_var 10),
              template_var 9)
            ),
        template_predicate
         (
            template_app
             (template_app
               (template_app (template_hole 22, template_var 8),
                template_var 7),
              template_var 6)
            ),
        template_predicate
         (
            template_app
             (template_app
               (template_hole 21,
                template_app
                 (template_app (template_hole 20, template_var 5),
                  template_var 4)),
              template_app
               (template_app (template_hole 19, template_var 7),
                template_var 8))
            ),
        template_predicate
         (
            template_app
             (template_app
               (template_hole 18,
                template_app
                 (template_app (template_hole 17, template_var 3),
                  template_var 12)),
              template_app
               (template_app
                 (template_hole 16,
                  template_app
                   (template_app (template_hole 15, template_hole 14),
                    template_var 2)),
                template_hole 13))
            ),
        template_predicate (template_app (template_hole 12, t_empty)),
        template_predicate
         (
            template_app
             (template_app
               (template_hole 2,
                template_app
                 (template_app (template_hole 1, template_var 0),
                  template_var 10)),
              template_var 2)
            )],
       template_predicate
        (
           template_app
            (template_app
              (template_hole 2,
               template_app
                (template_app
                  (template_hole 1,
                   template_app
                    (template_app
                      (template_app
                        (template_app
                          (template_hole 0,
                           template_app (template_var 6, template_var 5)),
                         template_var 3),
                       template_var 1),
                     template_var 0)),
                 template_app (template_var 9, template_var 4))),
             template_var 2)
           ))),
    ("Implement.list_set_image_autoref",
     "[| PRIO_TAG_OPTIMIZATION; SIDE_PRECOND_OPT (inj_on ?f ?s);
         !!xi x. [| (xi, x) : ?Ra; x : ?s |] ==> (?fi xi, ?f $ x) : ?Rb;
         (?l, ?s) : \<langle>?Ra\<rangle>list_set_rel |]
      ==> (map ?fi ?l,
           (Autoref_Tagging.OP (`) :::
            (?Ra \<rightarrow> ?Rb) \<rightarrow>
            \<langle>?Ra\<rangle>list_set_rel \<rightarrow>
            \<langle>?Rb\<rangle>list_set_rel) $
           ?f $
           ?s)
          : \<langle>?Rb\<rangle>list_set_rel",
     template_implication
      ([template_predicate
         (
            template_app
             (template_app (template_hole 41, template_hole 40),
              template_app
               (template_hole 39,
                template_app
                 (template_hole 38,
                  template_app
                   (template_hole 37,
                    template_app (template_hole 38, template_hole 36)))))
            ),
        template_predicate
         (
            template_app
             (template_hole 35,
              template_app
               (template_hole 34,
                template_app
                 (template_hole 33,
                  template_app
                   (template_app (template_hole 32, template_var 5),
                    template_var 4))))
            ),
        template_predicate (template_app (template_hole 31, t_empty)),
        template_predicate
         (
            template_app
             (template_app
               (template_hole 23,
                template_app
                 (template_app (template_hole 22, template_var 0),
                  template_var 4)),
              template_app
               (template_app (template_hole 21, template_hole 20),
                template_var 3))
            )],
       template_predicate
        (
           template_app
            (template_app
              (template_hole 19,
               template_app
                (template_app
                  (template_hole 18,
                   template_app
                    (template_app (template_hole 17, template_var 2),
                     template_var 0)),
                 template_app
                  (template_app
                    (template_hole 16,
                     template_app
                      (template_app
                        (template_hole 15,
                         template_app
                          (template_app
                            (template_hole 14,
                             template_app
                              (template_hole 13, template_hole 12)),
                           template_app
                            (template_hole 11,
                             template_app
                              (template_app
                                (template_hole 10,
                                 template_app
                                  (template_app
                                    (template_hole 9, template_hole 8),
                                   template_app
                                    (template_app
(template_hole 7,
 template_app
  (template_app (template_hole 6, template_hole 5), template_var 3)),
                                     template_var 1))),
                               template_app
                                (template_app
                                  (template_hole 4,
                                   template_app
                                    (template_app
(template_hole 3, template_hole 2),
                                     template_app
(template_app (template_hole 21, template_hole 20), template_var 3))),
                                 template_app
                                  (template_app
                                    (template_hole 1, template_hole 0),
                                   template_var 1)))))),
                       template_var 5)),
                   template_var 4))),
             template_app
              (template_app (template_hole 1, template_hole 0),
               template_var 1))
           ))),
    ("Implement.list_set_UNION_autoref",
     "[| PRIO_TAG_OPTIMIZATION;
         SIDE_PRECOND_OPT
          (ALL x:?S. ALL y:?S. x ~= y --> ?g x Int ?g y = {});
         (?xs, ?S) : \<langle>?A\<rangle>list_set_rel;
         (?f, ?g) : ?A \<rightarrow> \<langle>?B\<rangle>list_set_rel |]
      ==> (?xs >>= ?f,
           (Autoref_Tagging.OP (%A f. \<Union> (f ` A)) :::
            \<langle>?A\<rangle>list_set_rel \<rightarrow>
            (?A \<rightarrow>
             \<langle>?B\<rangle>list_set_rel) \<rightarrow>
            \<langle>?B\<rangle>list_set_rel) $
           ?S $
           ?g)
          : \<langle>?B\<rangle>list_set_rel",
     template_implication
      ([template_predicate
         (
            template_app
             (template_app (template_hole 42, template_hole 41),
              template_app
               (template_hole 40,
                template_app
                 (template_hole 39,
                  template_app
                   (template_hole 38,
                    template_app (template_hole 39, template_hole 37)))))
            ),
        template_predicate
         (
            template_app
             (template_hole 36,
              template_app
               (template_hole 35,
                template_app
                 (template_hole 34,
                  template_app
                   (template_app (template_hole 33, template_var 5),
                    t_empty))))
            ),
        template_predicate
         (
            template_app
             (template_app
               (template_hole 26,
                template_app
                 (template_app (template_hole 25, template_var 3),
                  template_var 5)),
              template_app
               (template_app (template_hole 24, template_hole 23),
                template_var 2))
            ),
        template_predicate
         (
            template_app
             (template_app
               (template_hole 22,
                template_app
                 (template_app (template_hole 21, template_var 1),
                  template_var 4)),
              template_app
               (template_app
                 (template_hole 20,
                  template_app
                   (template_app (template_hole 19, template_hole 18),
                    template_var 2)),
                template_app
                 (template_app (template_hole 17, template_hole 16),
                  template_var 0)))
            )],
       template_predicate
        (
           template_app
            (template_app
              (template_hole 15,
               template_app
                (template_app
                  (template_hole 14,
                   template_app
                    (template_app (template_hole 13, template_var 3),
                     template_var 1)),
                 template_app
                  (template_app
                    (template_hole 12,
                     template_app
                      (template_app
                        (template_hole 11,
                         template_app
                          (template_app
                            (template_hole 10,
                             template_app (template_hole 9, t_empty)),
                           template_app
                            (template_hole 6,
                             template_app
                              (template_app
                                (template_hole 5,
                                 template_app
                                  (template_app
                                    (template_hole 4, template_hole 3),
                                   template_app
                                    (template_app
(template_hole 24, template_hole 23),
                                     template_var 2))),
                               template_app
                                (template_app
                                  (template_hole 2,
                                   template_app
                                    (template_app
(template_hole 1, template_hole 0),
                                     template_app
(template_app
  (template_hole 20,
   template_app
    (template_app (template_hole 19, template_hole 18), template_var 2)),
 template_app
  (template_app (template_hole 17, template_hole 16), template_var 0)))),
                                 template_app
                                  (template_app
                                    (template_hole 17, template_hole 16),
                                   template_var 0)))))),
                       template_var 5)),
                   template_var 4))),
             template_app
              (template_app (template_hole 17, template_hole 16),
               template_var 0))
           ))),
    ("Implement.gen_UNION",
     "[| PRIO_TAG_GEN_ALGO; SIDE_GEN_ALGO (is_set_to_list ?A ?Rs1.0 ?tol);
         GEN_OP ?emp {} (\<langle>?B\<rangle>?Rs3.0);
         GEN_OP ?un (Un)
          (\<langle>?B\<rangle>?Rs2.0 \<rightarrow>
           \<langle>?B\<rangle>?Rs3.0 \<rightarrow>
           \<langle>?B\<rangle>?Rs3.0) |]
      ==> (gen_UNION ?tol ?emp ?un, %A f. \<Union> (f ` A))
          : \<langle>?A\<rangle>?Rs1.0 \<rightarrow>
            (?A \<rightarrow> \<langle>?B\<rangle>?Rs2.0) \<rightarrow>
            \<langle>?B\<rangle>?Rs3.0",
     template_implication
      ([template_predicate
         (
            template_app
             (template_app (template_hole 45, template_hole 44),
              template_app
               (template_hole 43,
                template_app
                 (template_hole 42,
                  template_app
                   (template_hole 41,
                    template_app
                     (template_hole 40,
                      template_app (template_hole 41, template_hole 39))))))
            ),
        template_predicate
         (
            template_app
             (template_hole 38,
              template_app
               (template_hole 37,
                template_app
                 (template_app
                   (template_app (template_hole 36, template_var 7),
                    template_var 6),
                  template_var 5)))
            ),
        template_predicate
         (
            template_app
             (template_hole 38,
              template_app
               (template_hole 35,
                template_app
                 (template_app
                   (template_hole 34,
                    template_app
                     (template_app (template_hole 33, template_var 4),
                      template_app
                       (template_app
                         (template_hole 32,
                          template_app
                           (template_hole 31, template_hole 30)),
                        template_app
                         (template_hole 29,
                          template_app
                           (template_app (template_hole 28, template_var 3),
                            template_var 2))))),
                  template_app
                   (template_app (template_hole 28, template_var 3),
                    template_var 2))))
            ),
        template_predicate
         (
            template_app
             (template_hole 38,
              template_app
               (template_hole 35,
                template_app
                 (template_app
                   (template_hole 27,
                    template_app
                     (template_app (template_hole 26, template_var 1),
                      template_app
                       (template_app
                         (template_hole 25,
                          template_app
                           (template_hole 24, template_hole 23)),
                        template_app
                         (template_hole 22,
                          template_app
                           (template_app
                             (template_hole 21,
                              template_app
                               (template_app
                                 (template_hole 20, template_hole 19),
                                template_app
                                 (template_app
                                   (template_hole 18, template_var 0),
                                  template_var 2))),
                            template_app
                             (template_app
                               (template_hole 17,
                                template_app
                                 (template_app
                                   (template_hole 16, template_hole 15),
                                  template_app
                                   (template_app
                                     (template_hole 28, template_var 3),
                                    template_var 2))),
                              template_app
                               (template_app
                                 (template_hole 28, template_var 3),
                                template_var 2))))))),
                  template_app
                   (template_app
                     (template_hole 21,
                      template_app
                       (template_app (template_hole 20, template_hole 19),
                        template_app
                         (template_app (template_hole 18, template_var 0),
                          template_var 2))),
                    template_app
                     (template_app
                       (template_hole 17,
                        template_app
                         (template_app (template_hole 16, template_hole 15),
                          template_app
                           (template_app (template_hole 28, template_var 3),
                            template_var 2))),
                      template_app
                       (template_app (template_hole 28, template_var 3),
                        template_var 2))))))
            )],
       template_predicate
        (
           template_app
            (template_app
              (template_hole 14,
               template_app
                (template_app
                  (template_hole 13,
                   template_app
                    (template_app
                      (template_app (template_hole 12, template_var 5),
                       template_var 4),
                     template_var 1)),
                 t_empty)),
             template_app
              (template_app
                (template_hole 9,
                 template_app
                  (template_app (template_hole 8, template_hole 7),
                   template_app
                    (template_app (template_hole 6, template_var 6),
                     template_var 7))),
               template_app
                (template_app
                  (template_hole 5,
                   template_app
                    (template_app (template_hole 4, template_hole 3),
                     template_app
                      (template_app
                        (template_hole 2,
                         template_app
                          (template_app (template_hole 1, template_hole 0),
                           template_var 7)),
                       template_app
                        (template_app (template_hole 18, template_var 0),
                         template_var 2)))),
                 template_app
                  (template_app (template_hole 28, template_var 3),
                   template_var 2))))
           ))),
    ("Implement.gen_enumerate",
     "[| PRIO_TAG_GEN_ALGO; SIDE_GEN_ALGO (is_set_to_list ?A ?Rs ?tol);
         GEN_OP ?emp op_map_empty (\<langle>?A, nat_rel\<rangle>?Rm);
         GEN_OP ?upd op_map_update
          (?A \<rightarrow>
           nat_rel \<rightarrow>
           \<langle>?A, nat_rel\<rangle>?Rm \<rightarrow> \<langle>?A,
           nat_rel\<rangle>?Rm) |]
      ==> (%S. RETURN (gen_enumerate ?tol ?upd ?emp S), op_set_enumerate)
          : \<langle>?A\<rangle>?Rs \<rightarrow> \<langle>\<langle>?A,
            nat_rel\<rangle>?Rm\<rangle>nres_rel",
     template_implication
      ([template_predicate
         (
            template_app
             (template_app (template_hole 45, template_hole 44),
              template_app
               (template_hole 43,
                template_app
                 (template_hole 42,
                  template_app
                   (template_hole 41,
                    template_app
                     (template_hole 40,
                      template_app (template_hole 41, template_hole 39))))))
            ),
        template_predicate
         (
            template_app
             (template_hole 38,
              template_app
               (template_hole 37,
                template_app
                 (template_app
                   (template_app (template_hole 36, template_var 5),
                    template_var 4),
                  template_var 3)))
            ),
        template_predicate
         (
            template_app
             (template_hole 38,
              template_app
               (template_hole 35,
                template_app
                 (template_app
                   (template_hole 34,
                    template_app
                     (template_app (template_hole 33, template_var 2),
                      template_app
                       (template_app
                         (template_hole 32,
                          template_app
                           (template_hole 31, template_hole 30)),
                        template_app
                         (template_hole 29,
                          template_app
                           (template_app
                             (template_hole 28,
                              template_app
                               (template_app
                                 (template_hole 27, template_var 1),
                                template_var 5)),
                            template_hole 26))))),
                  template_app
                   (template_app
                     (template_hole 28,
                      template_app
                       (template_app (template_hole 27, template_var 1),
                        template_var 5)),
                    template_hole 26))))
            ),
        template_predicate
         (
            template_app
             (template_hole 38,
              template_app
               (template_hole 35,
                template_app
                 (template_app
                   (template_hole 25,
                    template_app
                     (template_app (template_hole 24, template_var 0),
                      template_app
                       (template_app
                         (template_hole 23,
                          template_app
                           (template_hole 22, template_hole 21)),
                        template_app
                         (template_hole 20,
                          template_app
                           (template_app
                             (template_hole 19,
                              template_app
                               (template_app
                                 (template_hole 18, template_hole 17),
                                template_var 5)),
                            template_app
                             (template_app
                               (template_hole 16,
                                template_app
                                 (template_app
                                   (template_hole 15, template_hole 14),
                                  template_hole 26)),
                              template_app
                               (template_app
                                 (template_hole 13,
                                  template_app
                                   (template_app
                                     (template_hole 12, template_hole 11),
                                    template_app
                                     (template_app
 (template_hole 28,
  template_app
   (template_app (template_hole 27, template_var 1), template_var 5)),
template_hole 26))),
                                template_app
                                 (template_app
                                   (template_hole 28,
                                    template_app
                                     (template_app
 (template_hole 27, template_var 1),
template_var 5)),
                                  template_hole 26)))))))),
                  template_app
                   (template_app
                     (template_hole 19,
                      template_app
                       (template_app (template_hole 18, template_hole 17),
                        template_var 5)),
                    template_app
                     (template_app
                       (template_hole 16,
                        template_app
                         (template_app (template_hole 15, template_hole 14),
                          template_hole 26)),
                      template_app
                       (template_app
                         (template_hole 13,
                          template_app
                           (template_app
                             (template_hole 12, template_hole 11),
                            template_app
                             (template_app
                               (template_hole 28,
                                template_app
                                 (template_app
                                   (template_hole 27, template_var 1),
                                  template_var 5)),
                              template_hole 26))),
                        template_app
                         (template_app
                           (template_hole 28,
                            template_app
                             (template_app
                               (template_hole 27, template_var 1),
                              template_var 5)),
                          template_hole 26)))))))
            )],
       template_predicate
        (
           template_app
            (template_app
              (template_hole 10,
               template_app
                (template_app (template_hole 9, t_empty), template_hole 6)),
             template_app
              (template_app
                (template_hole 5,
                 template_app
                  (template_app (template_hole 4, template_hole 3),
                   template_app
                    (template_app (template_hole 2, template_var 4),
                     template_var 5))),
               template_app
                (template_app (template_hole 1, template_hole 0),
                 template_app
                  (template_app
                    (template_hole 28,
                     template_app
                      (template_app (template_hole 27, template_var 1),
                       template_var 5)),
                   template_hole 26))))
           ))),
    ("Implement.gen_build",
     "[| PRIO_TAG_GEN_ALGO; SIDE_GEN_ALGO (is_set_to_list ?A ?Rs ?tol);
         GEN_OP ?emp op_map_empty (\<langle>?A, ?B\<rangle>?Rm);
         GEN_OP ?upd op_map_update
          (?A \<rightarrow>
           ?B \<rightarrow>
           \<langle>?A, ?B\<rangle>?Rm \<rightarrow> \<langle>?A,
           ?B\<rangle>?Rm) |]
      ==> (gen_build ?tol ?upd ?emp, %f. (|`) (Some o f))
          : (?A \<rightarrow> ?B) \<rightarrow>
            \<langle>?A\<rangle>?Rs \<rightarrow> \<langle>?A,
            ?B\<rangle>?Rm",
     template_implication
      ([template_predicate
         (
            template_app
             (template_app (template_hole 49, template_hole 48),
              template_app
               (template_hole 47,
                template_app
                 (template_hole 46,
                  template_app
                   (template_hole 45,
                    template_app
                     (template_hole 44,
                      template_app (template_hole 45, template_hole 43))))))
            ),
        template_predicate
         (
            template_app
             (template_hole 42,
              template_app
               (template_hole 41,
                template_app
                 (template_app
                   (template_app (template_hole 40, template_var 6),
                    template_var 5),
                  template_var 4)))
            ),
        template_predicate
         (
            template_app
             (template_hole 42,
              template_app
               (template_hole 39,
                template_app
                 (template_app
                   (template_hole 38,
                    template_app
                     (template_app (template_hole 37, template_var 3),
                      template_app
                       (template_app
                         (template_hole 36,
                          template_app
                           (template_hole 35, template_hole 34)),
                        template_app
                         (template_hole 33,
                          template_app
                           (template_app
                             (template_hole 32,
                              template_app
                               (template_app
                                 (template_hole 31, template_var 2),
                                template_var 6)),
                            template_var 1))))),
                  template_app
                   (template_app
                     (template_hole 32,
                      template_app
                       (template_app (template_hole 31, template_var 2),
                        template_var 6)),
                    template_var 1))))
            ),
        template_predicate
         (
            template_app
             (template_hole 42,
              template_app
               (template_hole 39,
                template_app
                 (template_app
                   (template_hole 30,
                    template_app
                     (template_app (template_hole 29, template_var 0),
                      template_app
                       (template_app
                         (template_hole 28,
                          template_app
                           (template_hole 27, template_hole 26)),
                        template_app
                         (template_hole 25,
                          template_app
                           (template_app
                             (template_hole 24,
                              template_app
                               (template_app
                                 (template_hole 23, template_hole 22),
                                template_var 6)),
                            template_app
                             (template_app
                               (template_hole 21,
                                template_app
                                 (template_app
                                   (template_hole 20, template_hole 19),
                                  template_var 1)),
                              template_app
                               (template_app
                                 (template_hole 18,
                                  template_app
                                   (template_app
                                     (template_hole 17, template_hole 16),
                                    template_app
                                     (template_app
 (template_hole 32,
  template_app
   (template_app (template_hole 31, template_var 2), template_var 6)),
template_var 1))),
                                template_app
                                 (template_app
                                   (template_hole 32,
                                    template_app
                                     (template_app
 (template_hole 31, template_var 2),
template_var 6)),
                                  template_var 1)))))))),
                  template_app
                   (template_app
                     (template_hole 24,
                      template_app
                       (template_app (template_hole 23, template_hole 22),
                        template_var 6)),
                    template_app
                     (template_app
                       (template_hole 21,
                        template_app
                         (template_app (template_hole 20, template_hole 19),
                          template_var 1)),
                      template_app
                       (template_app
                         (template_hole 18,
                          template_app
                           (template_app
                             (template_hole 17, template_hole 16),
                            template_app
                             (template_app
                               (template_hole 32,
                                template_app
                                 (template_app
                                   (template_hole 31, template_var 2),
                                  template_var 6)),
                              template_var 1))),
                        template_app
                         (template_app
                           (template_hole 32,
                            template_app
                             (template_app
                               (template_hole 31, template_var 2),
                              template_var 6)),
                          template_var 1)))))))
            )],
       template_predicate
        (
           template_app
            (template_app
              (template_hole 15,
               template_app
                (template_app (template_hole 14, t_empty), t_empty)),
             template_app
              (template_app
                (template_hole 9,
                 template_app
                  (template_app (template_hole 8, template_hole 7),
                   template_app
                    (template_app
                      (template_hole 6,
                       template_app
                        (template_app (template_hole 5, template_hole 4),
                         template_var 6)),
                     template_var 1))),
               template_app
                (template_app
                  (template_hole 3,
                   template_app
                    (template_app (template_hole 2, template_hole 1),
                     template_app
                      (template_app (template_hole 0, template_var 5),
                       template_var 6))),
                 template_app
                  (template_app
                    (template_hole 32,
                     template_app
                      (template_app (template_hole 31, template_var 2),
                       template_var 6)),
                   template_var 1))))
           ))),
    ("Implement.gen_Image",
     "[| PRIO_TAG_GEN_ALGO;
         SIDE_GEN_ALGO
          (is_set_to_list (?A \<times>\<^sub>r ?B) ?Rs1.0 ?tol1.0);
         GEN_OP ?mem2.0 (:)
          (?A \<rightarrow>
           \<langle>?A\<rangle>?Rs2.0 \<rightarrow> bool_rel);
         GEN_OP ?emp3.0 {} (\<langle>?B\<rangle>?Rs3.0);
         GEN_OP ?ins3.0 insert
          (?B \<rightarrow>
           \<langle>?B\<rangle>?Rs3.0 \<rightarrow>
           \<langle>?B\<rangle>?Rs3.0) |]
      ==> (gen_Image ?tol1.0 ?mem2.0 ?emp3.0 ?ins3.0, (``))
          : \<langle>?A \<times>\<^sub>r ?B\<rangle>?Rs1.0 \<rightarrow>
            \<langle>?A\<rangle>?Rs2.0 \<rightarrow>
            \<langle>?B\<rangle>?Rs3.0",
     template_implication
      ([template_predicate
         (
            template_app
             (template_app (template_hole 57, template_hole 56),
              template_app
               (template_hole 55,
                template_app
                 (template_hole 54,
                  template_app
                   (template_hole 53,
                    template_app
                     (template_hole 52,
                      template_app (template_hole 53, template_hole 51))))))
            ),
        template_predicate
         (
            template_app
             (template_hole 50,
              template_app
               (template_hole 49,
                template_app
                 (template_app
                   (template_app
                     (template_hole 48,
                      template_app
                       (template_app
                         (template_hole 47,
                          template_app
                           (template_app
                             (template_hole 46, template_hole 45),
                            template_var 8)),
                        template_var 7)),
                    template_var 6),
                  template_var 5)))
            ),
        template_predicate
         (
            template_app
             (template_hole 50,
              template_app
               (template_hole 44,
                template_app
                 (template_app
                   (template_hole 43,
                    template_app
                     (template_app (template_hole 42, template_var 4),
                      template_app
                       (template_app
                         (template_hole 41,
                          template_app
                           (template_hole 40, template_hole 39)),
                        template_app
                         (template_hole 38,
                          template_app
                           (template_app
                             (template_hole 37,
                              template_app
                               (template_app
                                 (template_hole 36, template_hole 35),
                                template_var 8)),
                            template_app
                             (template_app
                               (template_hole 34,
                                template_app
                                 (template_app
                                   (template_hole 33, template_hole 32),
                                  template_app
                                   (template_app
                                     (template_hole 31, template_var 3),
                                    template_var 8))),
                              template_hole 30)))))),
                  template_app
                   (template_app
                     (template_hole 37,
                      template_app
                       (template_app (template_hole 36, template_hole 35),
                        template_var 8)),
                    template_app
                     (template_app
                       (template_hole 34,
                        template_app
                         (template_app (template_hole 33, template_hole 32),
                          template_app
                           (template_app (template_hole 31, template_var 3),
                            template_var 8))),
                      template_hole 30)))))
            ),
        template_predicate
         (
            template_app
             (template_hole 50,
              template_app
               (template_hole 44,
                template_app
                 (template_app
                   (template_hole 29,
                    template_app
                     (template_app (template_hole 28, template_var 2),
                      template_app
                       (template_app
                         (template_hole 27,
                          template_app
                           (template_hole 26, template_hole 25)),
                        template_app
                         (template_hole 24,
                          template_app
                           (template_app (template_hole 23, template_var 1),
                            template_var 7))))),
                  template_app
                   (template_app (template_hole 23, template_var 1),
                    template_var 7))))
            ),
        template_predicate
         (
            template_app
             (template_hole 50,
              template_app
               (template_hole 44,
                template_app
                 (template_app
                   (template_hole 22,
                    template_app
                     (template_app (template_hole 21, template_var 0),
                      template_app
                       (template_app
                         (template_hole 20,
                          template_app
                           (template_hole 19, template_hole 18)),
                        template_app
                         (template_hole 17,
                          template_app
                           (template_app
                             (template_hole 16,
                              template_app
                               (template_app
                                 (template_hole 15, template_hole 14),
                                template_var 7)),
                            template_app
                             (template_app
                               (template_hole 13,
                                template_app
                                 (template_app
                                   (template_hole 12, template_hole 11),
                                  template_app
                                   (template_app
                                     (template_hole 23, template_var 1),
                                    template_var 7))),
                              template_app
                               (template_app
                                 (template_hole 23, template_var 1),
                                template_var 7))))))),
                  template_app
                   (template_app
                     (template_hole 16,
                      template_app
                       (template_app (template_hole 15, template_hole 14),
                        template_var 7)),
                    template_app
                     (template_app
                       (template_hole 13,
                        template_app
                         (template_app (template_hole 12, template_hole 11),
                          template_app
                           (template_app (template_hole 23, template_var 1),
                            template_var 7))),
                      template_app
                       (template_app (template_hole 23, template_var 1),
                        template_var 7))))))
            )],
       template_predicate
        (
           template_app
            (template_app
              (template_hole 10,
               template_app
                (template_app
                  (template_hole 9,
                   template_app
                    (template_app
                      (template_app
                        (template_app (template_hole 8, template_var 5),
                         template_var 4),
                       template_var 2),
                     template_var 0)),
                 template_hole 7)),
             template_app
              (template_app
                (template_hole 6,
                 template_app
                  (template_app (template_hole 5, template_hole 4),
                   template_app
                    (template_app (template_hole 3, template_var 6),
                     template_app
                      (template_app
                        (template_hole 47,
                         template_app
                          (template_app
                            (template_hole 46, template_hole 45),
                           template_var 8)),
                       template_var 7)))),
               template_app
                (template_app
                  (template_hole 2,
                   template_app
                    (template_app (template_hole 1, template_hole 0),
                     template_app
                      (template_app (template_hole 31, template_var 3),
                       template_var 8))),
                 template_app
                  (template_app (template_hole 23, template_var 1),
                   template_var 7))))
           ))),
    ("Implement.gen_image",
     "[| PRIO_TAG_GEN_ALGO;
         SIDE_GEN_ALGO (is_set_to_list ?Rk ?Rs1.0 ?it1.0);
         GEN_OP ?ins2.0 insert
          (?Rk' \<rightarrow>
           \<langle>?Rk'\<rangle>?Rs2.0 \<rightarrow>
           \<langle>?Rk'\<rangle>?Rs2.0);
         GEN_OP ?empty2.0 {} (\<langle>?Rk'\<rangle>?Rs2.0);
         !!xi x. [| (xi, x) : ?Rk; x : ?s |] ==> (?fi xi, ?f $ x) : ?Rk';
         (?l, ?s) : \<langle>?Rk\<rangle>?Rs1.0 |]
      ==> (gen_image (%x. foldli (?it1.0 x)) ?empty2.0 ?ins2.0 ?fi ?l,
           (Autoref_Tagging.OP (`) :::
            (?Rk \<rightarrow> ?Rk') \<rightarrow>
            \<langle>?Rk\<rangle>?Rs1.0 \<rightarrow>
            \<langle>?Rk'\<rangle>?Rs2.0) $
           ?f $
           ?s)
          : \<langle>?Rk'\<rangle>?Rs2.0",
     template_implication
      ([template_predicate
         (
            template_app
             (template_app (template_hole 57, template_hole 56),
              template_app
               (template_hole 55,
                template_app
                 (template_hole 54,
                  template_app
                   (template_hole 53,
                    template_app
                     (template_hole 52,
                      template_app (template_hole 53, template_hole 51))))))
            ),
        template_predicate
         (
            template_app
             (template_hole 50,
              template_app
               (template_hole 49,
                template_app
                 (template_app
                   (template_app (template_hole 48, template_var 10),
                    template_var 9),
                  template_var 8)))
            ),
        template_predicate
         (
            template_app
             (template_hole 50,
              template_app
               (template_hole 47,
                template_app
                 (template_app
                   (template_hole 46,
                    template_app
                     (template_app (template_hole 45, template_var 7),
                      template_app
                       (template_app
                         (template_hole 44,
                          template_app
                           (template_hole 43, template_hole 42)),
                        template_app
                         (template_hole 41,
                          template_app
                           (template_app
                             (template_hole 40,
                              template_app
                               (template_app
                                 (template_hole 39, template_hole 38),
                                template_var 6)),
                            template_app
                             (template_app
                               (template_hole 37,
                                template_app
                                 (template_app
                                   (template_hole 36, template_hole 35),
                                  template_app
                                   (template_app
                                     (template_hole 34, template_var 5),
                                    template_var 6))),
                              template_app
                               (template_app
                                 (template_hole 34, template_var 5),
                                template_var 6))))))),
                  template_app
                   (template_app
                     (template_hole 40,
                      template_app
                       (template_app (template_hole 39, template_hole 38),
                        template_var 6)),
                    template_app
                     (template_app
                       (template_hole 37,
                        template_app
                         (template_app (template_hole 36, template_hole 35),
                          template_app
                           (template_app (template_hole 34, template_var 5),
                            template_var 6))),
                      template_app
                       (template_app (template_hole 34, template_var 5),
                        template_var 6))))))
            ),
        template_predicate
         (
            template_app
             (template_hole 50,
              template_app
               (template_hole 47,
                template_app
                 (template_app
                   (template_hole 33,
                    template_app
                     (template_app (template_hole 32, template_var 4),
                      template_app
                       (template_app
                         (template_hole 31,
                          template_app
                           (template_hole 30, template_hole 29)),
                        template_app
                         (template_hole 28,
                          template_app
                           (template_app (template_hole 34, template_var 5),
                            template_var 6))))),
                  template_app
                   (template_app (template_hole 34, template_var 5),
                    template_var 6))))
            ),
        template_predicate (template_app (template_hole 27, t_empty)),
        template_predicate
         (
            template_app
             (template_app
               (template_hole 19,
                template_app
                 (template_app (template_hole 18, template_var 0),
                  template_var 3)),
              template_app
               (template_app (template_hole 17, template_var 9),
                template_var 10))
            )],
       template_predicate
        (
           template_app
            (template_app
              (template_hole 33,
               template_app
                (template_app
                  (template_hole 32,
                   template_app
                    (template_app
                      (template_app
                        (template_app
                          (template_app (template_hole 16, t_empty),
                           template_var 4),
                         template_var 7),
                       template_var 2),
                     template_var 0)),
                 template_app
                  (template_app
                    (template_hole 14,
                     template_app
                      (template_app
                        (template_hole 13,
                         template_app
                          (template_app
                            (template_hole 12,
                             template_app
                              (template_hole 11, template_hole 10)),
                           template_app
                            (template_hole 9,
                             template_app
                              (template_app
                                (template_hole 8,
                                 template_app
                                  (template_app
                                    (template_hole 7, template_hole 6),
                                   template_app
                                    (template_app
(template_hole 5,
 template_app
  (template_app (template_hole 4, template_hole 3), template_var 10)),
                                     template_var 6))),
                               template_app
                                (template_app
                                  (template_hole 2,
                                   template_app
                                    (template_app
(template_hole 1, template_hole 0),
                                     template_app
(template_app (template_hole 17, template_var 9), template_var 10))),
                                 template_app
                                  (template_app
                                    (template_hole 34, template_var 5),
                                   template_var 6)))))),
                       template_var 1)),
                   template_var 3))),
             template_app
              (template_app (template_hole 34, template_var 5),
               template_var 6))
           ))),
    ("Implement.gen_equals",
     "[| PRIO_TAG_GEN_ALGO;
         GEN_OP ?ball op_map_ball
          (\<langle>?Rk, ?Rv\<rangle>?Rm \<rightarrow>
           (?Rk \<times>\<^sub>r ?Rv \<rightarrow> bool_rel) \<rightarrow>
           bool_rel);
         GEN_OP ?lu op_map_lookup
          (?Rk \<rightarrow>
           \<langle>?Rk, ?Rv\<rangle>?Rm \<rightarrow>
           \<langle>?Rv\<rangle>option_rel);
         GEN_OP ?eq (=) (?Rv \<rightarrow> ?Rv \<rightarrow> bool_rel) |]
      ==> (gen_equals ?ball ?lu ?eq, (=))
          : \<langle>?Rk, ?Rv\<rangle>?Rm \<rightarrow>
            \<langle>?Rk, ?Rv\<rangle>?Rm \<rightarrow> bool_rel",
     template_implication
      ([template_predicate
         (
            template_app
             (template_app (template_hole 65, template_hole 64),
              template_app
               (template_hole 63,
                template_app
                 (template_hole 62,
                  template_app
                   (template_hole 61,
                    template_app
                     (template_hole 60,
                      template_app (template_hole 61, template_hole 59))))))
            ),
        template_predicate
         (
            template_app
             (template_hole 58,
              template_app
               (template_hole 57,
                template_app
                 (template_app
                   (template_hole 56,
                    template_app
                     (template_app (template_hole 55, template_var 5),
                      template_app
                       (template_app
                         (template_hole 54,
                          template_app
                           (template_hole 53, template_hole 52)),
                        template_app
                         (template_hole 51,
                          template_app
                           (template_app
                             (template_hole 50,
                              template_app
                               (template_app
                                 (template_hole 49, template_hole 48),
                                template_app
                                 (template_app
                                   (template_hole 47,
                                    template_app
                                     (template_app
 (template_hole 46, template_var 4),
template_var 3)),
                                  template_var 2))),
                            template_app
                             (template_app
                               (template_hole 45,
                                template_app
                                 (template_app
                                   (template_hole 44, template_hole 43),
                                  template_app
                                   (template_app
                                     (template_hole 42,
template_app
 (template_app (template_hole 41, template_hole 40),
  template_app
   (template_app
     (template_hole 39,
      template_app
       (template_app (template_hole 38, template_hole 37), template_var 3)),
    template_var 2))),
                                    template_hole 36))),
                              template_hole 36)))))),
                  template_app
                   (template_app
                     (template_hole 50,
                      template_app
                       (template_app (template_hole 49, template_hole 48),
                        template_app
                         (template_app
                           (template_hole 47,
                            template_app
                             (template_app
                               (template_hole 46, template_var 4),
                              template_var 3)),
                          template_var 2))),
                    template_app
                     (template_app
                       (template_hole 45,
                        template_app
                         (template_app (template_hole 44, template_hole 43),
                          template_app
                           (template_app
                             (template_hole 42,
                              template_app
                               (template_app
                                 (template_hole 41, template_hole 40),
                                template_app
                                 (template_app
                                   (template_hole 39,
                                    template_app
                                     (template_app
 (template_hole 38, template_hole 37),
template_var 3)),
                                  template_var 2))),
                            template_hole 36))),
                      template_hole 36)))))
            ),
        template_predicate
         (
            template_app
             (template_hole 58,
              template_app
               (template_hole 57,
                template_app
                 (template_app
                   (template_hole 35,
                    template_app
                     (template_app (template_hole 34, template_var 1),
                      template_app
                       (template_app
                         (template_hole 33,
                          template_app
                           (template_hole 32, template_hole 31)),
                        template_app
                         (template_hole 30,
                          template_app
                           (template_app
                             (template_hole 29,
                              template_app
                               (template_app
                                 (template_hole 28, template_hole 27),
                                template_var 3)),
                            template_app
                             (template_app
                               (template_hole 26,
                                template_app
                                 (template_app
                                   (template_hole 25, template_hole 24),
                                  template_app
                                   (template_app
                                     (template_hole 47,
template_app
 (template_app (template_hole 46, template_var 4), template_var 3)),
                                    template_var 2))),
                              template_app
                               (template_app
                                 (template_hole 23, template_hole 22),
                                template_var 2))))))),
                  template_app
                   (template_app
                     (template_hole 29,
                      template_app
                       (template_app (template_hole 28, template_hole 27),
                        template_var 3)),
                    template_app
                     (template_app
                       (template_hole 26,
                        template_app
                         (template_app (template_hole 25, template_hole 24),
                          template_app
                           (template_app
                             (template_hole 47,
                              template_app
                               (template_app
                                 (template_hole 46, template_var 4),
                                template_var 3)),
                            template_var 2))),
                      template_app
                       (template_app (template_hole 23, template_hole 22),
                        template_var 2))))))
            ),
        template_predicate
         (
            template_app
             (template_hole 58,
              template_app
               (template_hole 57,
                template_app
                 (template_app
                   (template_hole 21,
                    template_app
                     (template_app (template_hole 20, template_var 0),
                      template_app
                       (template_app
                         (template_hole 19,
                          template_app
                           (template_hole 18, template_hole 17)),
                        template_app
                         (template_hole 16,
                          template_app
                           (template_app
                             (template_hole 15,
                              template_app
                               (template_app
                                 (template_hole 14, template_hole 13),
                                template_var 2)),
                            template_app
                             (template_app
                               (template_hole 12,
                                template_app
                                 (template_app
                                   (template_hole 11, template_hole 10),
                                  template_var 2)),
                              template_hole 36)))))),
                  template_app
                   (template_app
                     (template_hole 15,
                      template_app
                       (template_app (template_hole 14, template_hole 13),
                        template_var 2)),
                    template_app
                     (template_app
                       (template_hole 12,
                        template_app
                         (template_app (template_hole 11, template_hole 10),
                          template_var 2)),
                      template_hole 36)))))
            )],
       template_predicate
        (
           template_app
            (template_app
              (template_hole 9,
               template_app
                (template_app
                  (template_hole 8,
                   template_app
                    (template_app
                      (template_app (template_hole 7, template_var 5),
                       template_var 1),
                     template_var 0)),
                 template_hole 6)),
             template_app
              (template_app
                (template_hole 5,
                 template_app
                  (template_app (template_hole 4, template_hole 3),
                   template_app
                    (template_app
                      (template_hole 47,
                       template_app
                        (template_app (template_hole 46, template_var 4),
                         template_var 3)),
                     template_var 2))),
               template_app
                (template_app
                  (template_hole 2,
                   template_app
                    (template_app (template_hole 1, template_hole 0),
                     template_app
                      (template_app
                        (template_hole 47,
                         template_app
                          (template_app (template_hole 46, template_var 4),
                           template_var 3)),
                       template_var 2))),
                 template_hole 36)))
           )))]
